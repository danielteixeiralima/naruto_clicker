### TREE

  .gitignore
  HP_PROGRESSION_ANALYSIS.md
  SISTEMA_DROP.md
  app.py
  bundle.py
  bundle.txt
icones/
  icones/choji.png
  icones/gaara.png
  icones/hinata.png
  icones/ino.png
  icones/kankuro.png
  icones/kiba.png
  icones/lee.png
  icones/naruto.png
  icones/neji.png
  icones/png-clipart-backpack-baggage-school-paul-verlaine-student-backpack-backpack-logo-thumbnail.png
  icones/sakura.png
  icones/sasuke.png
  icones/shikamaru.png
  icones/shino.png
  icones/temari.png
  icones/tenten.png
static/
static/css/
  static/css/admin_panel.css
  static/css/hero_details.css
  static/css/mission_complete.css
  static/css/mission_notification.css
  static/css/style.css
  static/css/tabs_missions.css
static/img/
  static/img/backpack_icon.png
  static/img/battle_bg.png
  static/img/cloud.png
  static/img/day_bg.png
  static/img/elemental_cycle.png
  static/img/kunai.png
  static/img/kunai_cursor.png
  static/img/naruto_face.png
  static/img/naruto_full.png
  static/img/sakura_face.png
  static/img/sakura_full.png
  static/img/sasuke_face.png
  static/img/sasuke_full.png
static/img/elements/
  static/img/elements/earth.png
  static/img/elements/fire.png
  static/img/elements/lightning.png
  static/img/elements/water.png
  static/img/elements/wind.png
static/img/enemies/
  static/img/enemies/boss.png
  static/img/enemies/enemy_1.png
  static/img/enemies/enemy_main.png
  static/img/enemies/enemy_v4.png
  static/img/enemies/enemy_v5.png
  static/img/enemies/enemy_v6.png
static/img/heroes/
static/img/heroes/icons/
  static/img/heroes/icons/choji_icon.png
  static/img/heroes/icons/chouji_icon.png
  static/img/heroes/icons/gaara_icon.png
  static/img/heroes/icons/hinata_icon.png
  static/img/heroes/icons/ino_icon.png
  static/img/heroes/icons/kankuro_icon.png
  static/img/heroes/icons/kiba_icon.png
  static/img/heroes/icons/lee_icon.png
  static/img/heroes/icons/naruto_icon.png
  static/img/heroes/icons/neji_icon.png
  static/img/heroes/icons/rocklee_icon.png
  static/img/heroes/icons/sakura_icon.png
  static/img/heroes/icons/sasuke_icon.png
  static/img/heroes/icons/shikamaru_icon.png
  static/img/heroes/icons/shino_icon.png
  static/img/heroes/icons/temari_icon.png
  static/img/heroes/icons/tenten_icon.png
static/img/items/
  static/img/items/poison.png
static/img/skills/
  static/img/skills/skill_1_1.png
  static/img/skills/skill_1_2.png
  static/img/skills/skill_1_3.png
  static/img/skills/skill_1_4.png
  static/img/skills/skill_2_1.png
  static/img/skills/skill_2_2.png
  static/img/skills/skill_2_3.png
  static/img/skills/skill_2_4.png
  static/img/skills/skill_3_1.png
  static/img/skills/skill_3_2.png
  static/img/skills/skill_3_3.png
  static/img/skills/skill_3_4.png
static/js/
  static/js/anti_zoom.js
  static/js/game.js
  static/js/game_data.js
  static/js/game_data_v3.js
  static/js/game_v3.js
  static/js/hero_details_modal.js
  static/js/missions_panel.js
templates/
  templates/index.html


### FILES


----- FILE: HP_PROGRESSION_ANALYSIS.md  (sha1:68b66bff781f, bytes:4220) -----
# An√°lise de Progress√£o de HP - Naruto Clicker

## üìä Configura√ß√£o Atual

```javascript
const zoneData = {
    baseHp: 10,
    hpMultiplier: 2.05,  // ‚Üê PROBLEMA: Muito alto!
    coinsMultiplier: 1.5,
    monstersPerZone: 10
};
```

## üìà F√≥rmula de HP

```
HP = baseHp √ó (hpMultiplier ^ (zona - 1))
HP = 10 √ó (2.05 ^ (zona - 1))
```

## üî¢ Tabela de Progress√£o (Atual - 2.05)

| Zona | HP Normal | HP Boss (10x) | Crescimento |
|------|-----------|---------------|-------------|
| 1    | 10        | 100           | -           |
| 10   | 1,755     | 17,550        | 175x        |
| 20   | 308,122   | 3,081,220     | 30,812x     |
| 30   | 54,074,896| 540,748,960   | 5,407,490x  |
| 40   | 9.5B      | 95B           | 950M x      |
| 50   | 1.67T     | 16.7T         | 167B x      |
| 60   | 293T      | 2,930T        | 29.3T x     |
| 100  | 6.3 √ó 10¬≤‚Å∏| 6.3 √ó 10¬≤‚Åπ    | ABSURDO     |
| 200  | 1.6 √ó 10‚Å∂¬π| 1.6 √ó 10‚Å∂¬≤    | IMPOSS√çVEL  |

**Problema**: Zona 60 tem **293 TRILH√ïES** de HP!

---

## ‚úÖ Configura√ß√£o Recomendada

```javascript
const zoneData = {
    baseHp: 10,
    hpMultiplier: 1.15,  // ‚Üê REDUZIDO de 2.05 para 1.15
    coinsMultiplier: 1.5,
    monstersPerZone: 10
};
```

## üìà Tabela de Progress√£o (Novo - 1.15)

| Zona | HP Normal | HP Boss (10x) | Crescimento | Tempo (Madara Lv50) |
|------|-----------|---------------|-------------|---------------------|
| 1    | 10        | 100           | -           | Instant√¢neo         |
| 10   | 35        | 350           | 3.5x        | Instant√¢neo         |
| 20   | 123       | 1,230         | 12x         | Instant√¢neo         |
| 30   | 432       | 4,320         | 43x         | Instant√¢neo         |
| 40   | 1,517     | 15,170        | 152x        | Instant√¢neo         |
| 50   | 5,324     | 53,240        | 532x        | Instant√¢neo         |
| 60   | 18,680    | 186,800       | 1,868x      | Instant√¢neo         |
| 100  | 1,174,313 | 11,743,130    | 117,431x    | R√°pido              |
| 200  | 69.8B     | 698B          | 6.98B x     | Moderado            |
| 300  | 4.15T     | 41.5T         | 415B x      | Desafiador          |

**Benef√≠cio**: Zona 60 tem apenas **18,680** HP (vs 293T)!

---

## üéÆ Compara√ß√£o de Multiplicadores

| Multiplicador | Zona 10 | Zona 50 | Zona 100 | Zona 200 | Recomenda√ß√£o |
|---------------|---------|---------|----------|----------|--------------|
| **2.05** (atual) | 1,755 | 1.67T | 6.3√ó10¬≤‚Å∏ | 1.6√ó10‚Å∂¬π | ‚ùå Muito dif√≠cil |
| **1.50** | 39 | 1,532 | 2.35M | 5.53B | ‚ö†Ô∏è Muito f√°cil |
| **1.15** | 35 | 5,324 | 1.17M | 69.8B | ‚úÖ **IDEAL** |
| **1.20** | 52 | 9,100 | 8.28M | 686B | ‚úÖ Bom |
| **1.25** | 93 | 70,065 | 4.9B | 24T | ‚ö†Ô∏è Desafiador |

---

## üí° Recomenda√ß√µes por Estilo de Jogo

### üü¢ Casual (Progress√£o R√°pida)
```javascript
hpMultiplier: 1.12  // Muito suave
```
- Zona 100: ~300k HP
- Zona 200: ~9B HP

### üü° Balanceado (Recomendado)
```javascript
hpMultiplier: 1.15  // ‚Üê MELHOR OP√á√ÉO
```
- Zona 100: ~1.17M HP
- Zona 200: ~69.8B HP

### üü† Desafiador
```javascript
hpMultiplier: 1.20
```
- Zona 100: ~8.28M HP
- Zona 200: ~686B HP

### üî¥ Hardcore
```javascript
hpMultiplier: 1.25
```
- Zona 100: ~4.9B HP
- Zona 200: ~24T HP

---

## üìä F√≥rmula para Calcular HP de Qualquer Zona

```javascript
function calculateZoneHP(zona, multiplier = 1.15) {
    const baseHp = 10;
    const normalHP = baseHp * Math.pow(multiplier, zona - 1);
    const bossHP = normalHP * 10;
    
    return {
        normal: normalHP,
        boss: bossHP
    };
}

// Exemplo:
calculateZoneHP(60, 1.15);  // { normal: 18680, boss: 186800 }
calculateZoneHP(200, 1.15); // { normal: 6.98B, boss: 69.8B }
```

---

## üéØ Conclus√£o

**Mudan√ßa Recomendada:**
- **De**: `hpMultiplier: 2.05`
- **Para**: `hpMultiplier: 1.15`

**Impacto:**
- Zona 60: De **293 TRILH√ïES** para **18,680** HP
- Zona 200: De **IMPOSS√çVEL** para **69.8 BILH√ïES** HP
- Madara Lv50 passa instantaneamente at√© zona 100+

**Arquivo a Modificar:**
`static/js/game_data_v3.js` - Linha 124


----- FILE: SISTEMA_DROP.md  (sha1:760d4e6051cb, bytes:3352) -----
# Sistema de Drop do Kenji - Rasengan

## Vis√£o Geral

Sistema especial de desbloqueio da terceira skill do Naruto (Rasengan) atrav√©s de drops do inimigo Kenji.

## Mec√¢nica

### Drop do Fragmento
- **Inimigo:** Kenji (um dos 4 sprites de inimigos normais)
- **Chance de Drop:** 20% (0.20)
- **Item:** Fragmento de Chakra üîÆ
- **Requisito:** Matar especificamente o inimigo Kenji

### Desbloqueio da Skill
- **Skill:** Rasengan (h1_u3)
- **Requisito:** Coletar 10 Fragmentos de Chakra
- **Efeito:** DPS de Todos +10%
- **Desbloqueio:** Autom√°tico ao coletar o 10¬∫ fragmento

## Implementa√ß√£o T√©cnica

### 1. GameState
```javascript
gameState.kenjiFragments = 0; // Contador de fragmentos
gameState.currentEnemyName = ""; // Nome do inimigo atual
```

### 2. Sistema de Drop (monterDeath)
```javascript
if (gameState.currentEnemyName === "Kenji" && Math.random() < 0.20) {
    // Drop do fragmento
    gameState.kenjiFragments++;
    
    // Verificar desbloqueio
    if (gameState.kenjiFragments >= 10 && !gameState.upgrades.includes('h1_u3')) {
        unlockNarutoRasengan();
    }
}
```

### 3. Renderiza√ß√£o da Skill
- **Bloqueada:** Exibe progresso de fragmentos (X/10)
- **Dispon√≠vel:** Quando kenjiFragments >= 10
- **Tooltip:** Mostra contador e instru√ß√£o para matar Kenji

### 4. Verifica√ß√£o de Compra
```javascript
if (upgId === 'h1_u3') {
    if (gameState.kenjiFragments < 10) {
        return; // Bloqueia compra
    }
}
```

### 5. Persist√™ncia
- Fragmentos salvos em `localStorage`
- Carregados automaticamente ao iniciar o jogo

## Caracter√≠sticas

‚úÖ **Drop Espec√≠fico:** Apenas Kenji dropa fragmentos
‚úÖ **Chance Balanceada:** 20% de chance por morte
‚úÖ **Progresso Vis√≠vel:** Tooltip mostra X/10 fragmentos
‚úÖ **Desbloqueio Autom√°tico:** Skill liberada ao coletar 10
‚úÖ **Notifica√ß√£o Especial:** Anima√ß√£o ao desbloquear Rasengan
‚úÖ **Persist√™ncia:** Progresso salvo automaticamente

## Fluxo do Jogador

1. **Encontrar Kenji:** Jogar at√© spawnar o inimigo Kenji
2. **Matar Kenji:** 20% de chance de dropar fragmento
3. **Coletar Fragmentos:** Acumular at√© 10 fragmentos
4. **Desbloqueio:** Rasengan √© automaticamente desbloqueado
5. **Compra:** Pode comprar a skill normalmente com ouro

## Diferen√ßas das Outras Skills

| Aspecto | Skills Normais | Rasengan (h1_u3) |
|---------|---------------|------------------|
| Requisito | N√≠vel do her√≥i | 10 Fragmentos do Kenji |
| Desbloqueio | Ao atingir n√≠vel | Ao coletar fragmentos |
| Compra | Manual com ouro | Manual ap√≥s desbloquear |
| Tooltip | Apenas custo | Custo + Progresso de fragmentos |

## Mensagens do Sistema

### Console
- `üîÆ Fragmento de Chakra coletado! Total: X/10`
- `üåÄ Desbloqueando Rasengan!`
- `‚úÖ Rasengan desbloqueado com sucesso!`
- `‚ùå Voc√™ precisa de 10 Fragmentos de Chakra para desbloquear o Rasengan!`

### Notifica√ß√µes Visuais
1. **Drop de Fragmento:** Notifica√ß√£o padr√£o de item
2. **Desbloqueio:** Notifica√ß√£o especial com emoji üåÄ e dura√ß√£o de 5s

## Balanceamento

- **Chance de Kenji spawnar:** 1/4 (25%)
- **Chance de drop:** 20%
- **Chance efetiva por inimigo:** 5%
- **M√©dia de inimigos para 10 fragmentos:** ~200 mortes
- **Tempo estimado:** Vari√°vel, depende do DPS do jogador


----- FILE: app.py  (sha1:bc952a68aa95, bytes:775) -----
from flask import Flask, render_template, send_from_directory
import os

app = Flask(__name__)

# Desabilitar cache completamente
app.config['SEND_FILE_MAX_AGE_DEFAULT'] = 0
app.config['TEMPLATES_AUTO_RELOAD'] = True

@app.route('/')
def home():
    return render_template('index.html')

@app.route('/static/<path:path>')
def send_static(path):
    return send_from_directory('static', path)

if __name__ == '__main__':
    print("\n" + "="*60)
    print("NARUTO CLICKER - Servidor Iniciado!")
    print("="*60)
    print("Acesse: http://localhost:8080")
    print("Cache desabilitado - mudancas aparecem imediatamente")
    print("Pressione Ctrl+C para parar o servidor")
    print("="*60 + "\n")
    app.run(debug=True, port=8080, host='0.0.0.0')


----- FILE: bundle.py  (sha1:995d1eb04172, bytes:2349) -----
# make_bundle.py
import os, hashlib

ROOT = os.getcwd()
EXCLUDE_DIRS = {
    '.git','node_modules','venv','.venv','__pycache__','.pytest_cache',
    'dist','build','.next','.idea','.vscode',
    'rpa_screenshots','rpa_artifacts','uploads','logs',
    # 'instance',  # <- descomente para n√£o incluir nada de instance/
}
INCLUDE_EXTS = {
    '.py','.ts','.tsx','.js','.jsx','.json','.yml','.yaml','.toml',
    '.ini','.cfg','.txt','.md','.sql','.html','.css','.env.example',
    '.jinja','.jinja2','.j2',
}
MAX_BYTES = 800_000  # sobe um pouco pra evitar truncar texto √∫til

def rel(p): 
    r = os.path.relpath(p, ROOT)
    return '.' if r == '.' else r.replace('\\','/')

lines = []

# 1) √Årvore do projeto
lines.append("### TREE\n")
for base, dirs, files in os.walk(ROOT):
    dirs[:] = [d for d in dirs if d not in EXCLUDE_DIRS]
    base_rel = rel(base)
    if base_rel != '.':
        lines.append(f"{base_rel}/")
    for f in sorted(files):
        lines.append(f"  {rel(os.path.join(base,f))}")

# 2) Conte√∫do dos arquivos de texto
lines.append("\n\n### FILES\n")
rpa_sha = ""
files_count = 0

for base, dirs, files in os.walk(ROOT):
    dirs[:] = [d for d in dirs if d not in EXCLUDE_DIRS]
    for f in sorted(files):
        p = os.path.join(base, f)
        ext = os.path.splitext(f)[1].lower()
        if ext in INCLUDE_EXTS and os.path.getsize(p) <= MAX_BYTES:
            with open(p, 'rb') as fh:
                raw = fh.read()
            # tenta decodificar como texto
            txt = None
            for enc in ('utf-8', 'latin-1'):
                try:
                    txt = raw.decode(enc)
                    break
                except UnicodeDecodeError:
                    continue
            if txt is None:
                continue
            sha = hashlib.sha1(raw).hexdigest()[:12]
            files_count += 1
            if rel(p).endswith("rpa.py"):
                rpa_sha = sha
            lines.append(
                f"\n----- FILE: {rel(p)}  (sha1:{sha}, bytes:{len(raw)}) -----\n{txt}"
            )

with open('bundle.txt','w',encoding='utf-8') as f:
    f.write('\n'.join(lines))

print(f"Gerado bundle.txt na pasta do projeto. Arquivos inclu√≠dos: {files_count}")
if rpa_sha:
    print(f"SHA do rpa.py no bundle: {rpa_sha}")


----- FILE: bundle.txt  (sha1:8dc1a6ff359b, bytes:423402) -----
### TREE

  .gitignore
  SISTEMA_DROP.md
  app.py
  bundle.py
  bundle.txt
icones/
  icones/choji.png
  icones/gaara.png
  icones/hinata.png
  icones/ino.png
  icones/kankuro.png
  icones/kiba.png
  icones/lee.png
  icones/naruto.png
  icones/neji.png
  icones/sakura.png
  icones/sasuke.png
  icones/shikamaru.png
  icones/shino.png
  icones/temari.png
  icones/tenten.png
static/
static/css/
  static/css/style.css
static/img/
  static/img/battle_bg.png
  static/img/cloud.png
  static/img/day_bg.png
  static/img/elemental_cycle.png
  static/img/kunai.png
  static/img/kunai_cursor.png
  static/img/naruto_face.png
  static/img/naruto_full.png
  static/img/sakura_face.png
  static/img/sakura_full.png
  static/img/sasuke_face.png
  static/img/sasuke_full.png
static/img/elements/
  static/img/elements/earth.png
  static/img/elements/fire.png
  static/img/elements/lightning.png
  static/img/elements/water.png
  static/img/elements/wind.png
static/img/enemies/
  static/img/enemies/boss.png
  static/img/enemies/enemy_1.png
  static/img/enemies/enemy_main.png
  static/img/enemies/enemy_v4.png
  static/img/enemies/enemy_v5.png
  static/img/enemies/enemy_v6.png
static/img/heroes/
static/img/heroes/icons/
  static/img/heroes/icons/choji_icon.png
  static/img/heroes/icons/chouji_icon.png
  static/img/heroes/icons/gaara_icon.png
  static/img/heroes/icons/hinata_icon.png
  static/img/heroes/icons/ino_icon.png
  static/img/heroes/icons/kankuro_icon.png
  static/img/heroes/icons/kiba_icon.png
  static/img/heroes/icons/lee_icon.png
  static/img/heroes/icons/naruto_icon.png
  static/img/heroes/icons/neji_icon.png
  static/img/heroes/icons/rocklee_icon.png
  static/img/heroes/icons/sakura_icon.png
  static/img/heroes/icons/sasuke_icon.png
  static/img/heroes/icons/shikamaru_icon.png
  static/img/heroes/icons/shino_icon.png
  static/img/heroes/icons/temari_icon.png
  static/img/heroes/icons/tenten_icon.png
static/img/items/
  static/img/items/poison.png
static/img/skills/
  static/img/skills/skill_1_1.png
  static/img/skills/skill_1_2.png
  static/img/skills/skill_1_3.png
  static/img/skills/skill_1_4.png
  static/img/skills/skill_2_1.png
  static/img/skills/skill_2_2.png
  static/img/skills/skill_2_3.png
  static/img/skills/skill_2_4.png
  static/img/skills/skill_3_1.png
  static/img/skills/skill_3_2.png
  static/img/skills/skill_3_3.png
  static/img/skills/skill_3_4.png
static/js/
  static/js/game.js
  static/js/game_data.js
  static/js/game_data_v3.js
  static/js/game_v3.js
templates/
  templates/index.html


### FILES


----- FILE: SISTEMA_DROP.md  (sha1:760d4e6051cb, bytes:3352) -----
# Sistema de Drop do Kenji - Rasengan

## Vis√£o Geral

Sistema especial de desbloqueio da terceira skill do Naruto (Rasengan) atrav√©s de drops do inimigo Kenji.

## Mec√¢nica

### Drop do Fragmento
- **Inimigo:** Kenji (um dos 4 sprites de inimigos normais)
- **Chance de Drop:** 20% (0.20)
- **Item:** Fragmento de Chakra üîÆ
- **Requisito:** Matar especificamente o inimigo Kenji

### Desbloqueio da Skill
- **Skill:** Rasengan (h1_u3)
- **Requisito:** Coletar 10 Fragmentos de Chakra
- **Efeito:** DPS de Todos +10%
- **Desbloqueio:** Autom√°tico ao coletar o 10¬∫ fragmento

## Implementa√ß√£o T√©cnica

### 1. GameState
```javascript
gameState.kenjiFragments = 0; // Contador de fragmentos
gameState.currentEnemyName = ""; // Nome do inimigo atual
```

### 2. Sistema de Drop (monterDeath)
```javascript
if (gameState.currentEnemyName === "Kenji" && Math.random() < 0.20) {
    // Drop do fragmento
    gameState.kenjiFragments++;
    
    // Verificar desbloqueio
    if (gameState.kenjiFragments >= 10 && !gameState.upgrades.includes('h1_u3')) {
        unlockNarutoRasengan();
    }
}
```

### 3. Renderiza√ß√£o da Skill
- **Bloqueada:** Exibe progresso de fragmentos (X/10)
- **Dispon√≠vel:** Quando kenjiFragments >= 10
- **Tooltip:** Mostra contador e instru√ß√£o para matar Kenji

### 4. Verifica√ß√£o de Compra
```javascript
if (upgId === 'h1_u3') {
    if (gameState.kenjiFragments < 10) {
        return; // Bloqueia compra
    }
}
```

### 5. Persist√™ncia
- Fragmentos salvos em `localStorage`
- Carregados automaticamente ao iniciar o jogo

## Caracter√≠sticas

‚úÖ **Drop Espec√≠fico:** Apenas Kenji dropa fragmentos
‚úÖ **Chance Balanceada:** 20% de chance por morte
‚úÖ **Progresso Vis√≠vel:** Tooltip mostra X/10 fragmentos
‚úÖ **Desbloqueio Autom√°tico:** Skill liberada ao coletar 10
‚úÖ **Notifica√ß√£o Especial:** Anima√ß√£o ao desbloquear Rasengan
‚úÖ **Persist√™ncia:** Progresso salvo automaticamente

## Fluxo do Jogador

1. **Encontrar Kenji:** Jogar at√© spawnar o inimigo Kenji
2. **Matar Kenji:** 20% de chance de dropar fragmento
3. **Coletar Fragmentos:** Acumular at√© 10 fragmentos
4. **Desbloqueio:** Rasengan √© automaticamente desbloqueado
5. **Compra:** Pode comprar a skill normalmente com ouro

## Diferen√ßas das Outras Skills

| Aspecto | Skills Normais | Rasengan (h1_u3) |
|---------|---------------|------------------|
| Requisito | N√≠vel do her√≥i | 10 Fragmentos do Kenji |
| Desbloqueio | Ao atingir n√≠vel | Ao coletar fragmentos |
| Compra | Manual com ouro | Manual ap√≥s desbloquear |
| Tooltip | Apenas custo | Custo + Progresso de fragmentos |

## Mensagens do Sistema

### Console
- `üîÆ Fragmento de Chakra coletado! Total: X/10`
- `üåÄ Desbloqueando Rasengan!`
- `‚úÖ Rasengan desbloqueado com sucesso!`
- `‚ùå Voc√™ precisa de 10 Fragmentos de Chakra para desbloquear o Rasengan!`

### Notifica√ß√µes Visuais
1. **Drop de Fragmento:** Notifica√ß√£o padr√£o de item
2. **Desbloqueio:** Notifica√ß√£o especial com emoji üåÄ e dura√ß√£o de 5s

## Balanceamento

- **Chance de Kenji spawnar:** 1/4 (25%)
- **Chance de drop:** 20%
- **Chance efetiva por inimigo:** 5%
- **M√©dia de inimigos para 10 fragmentos:** ~200 mortes
- **Tempo estimado:** Vari√°vel, depende do DPS do jogador


----- FILE: app.py  (sha1:70d1f21d0ff8, bytes:799) -----
from flask import Flask, render_template, send_from_directory
import os

app = Flask(__name__)

# Desabilitar cache completamente
app.config['SEND_FILE_MAX_AGE_DEFAULT'] = 0
app.config['TEMPLATES_AUTO_RELOAD'] = True

@app.route('/')
def home():
    return render_template('index.html')

@app.route('/static/<path:path>')
def send_static(path):
    return send_from_directory('static', path)

if __name__ == '__main__':
    print("\n" + "="*60)
    print("üéÆ NARUTO CLICKER - Servidor Iniciado!")
    print("="*60)
    print("üìç Acesse: http://localhost:8080")
    print("üîÑ Cache desabilitado - mudan√ßas aparecem imediatamente")
    print("‚ö†Ô∏è  Pressione Ctrl+C para parar o servidor")
    print("="*60 + "\n")
    app.run(debug=True, port=8080, host='0.0.0.0')


----- FILE: bundle.py  (sha1:995d1eb04172, bytes:2349) -----
# make_bundle.py
import os, hashlib

ROOT = os.getcwd()
EXCLUDE_DIRS = {
    '.git','node_modules','venv','.venv','__pycache__','.pytest_cache',
    'dist','build','.next','.idea','.vscode',
    'rpa_screenshots','rpa_artifacts','uploads','logs',
    # 'instance',  # <- descomente para n√£o incluir nada de instance/
}
INCLUDE_EXTS = {
    '.py','.ts','.tsx','.js','.jsx','.json','.yml','.yaml','.toml',
    '.ini','.cfg','.txt','.md','.sql','.html','.css','.env.example',
    '.jinja','.jinja2','.j2',
}
MAX_BYTES = 800_000  # sobe um pouco pra evitar truncar texto √∫til

def rel(p): 
    r = os.path.relpath(p, ROOT)
    return '.' if r == '.' else r.replace('\\','/')

lines = []

# 1) √Årvore do projeto
lines.append("### TREE\n")
for base, dirs, files in os.walk(ROOT):
    dirs[:] = [d for d in dirs if d not in EXCLUDE_DIRS]
    base_rel = rel(base)
    if base_rel != '.':
        lines.append(f"{base_rel}/")
    for f in sorted(files):
        lines.append(f"  {rel(os.path.join(base,f))}")

# 2) Conte√∫do dos arquivos de texto
lines.append("\n\n### FILES\n")
rpa_sha = ""
files_count = 0

for base, dirs, files in os.walk(ROOT):
    dirs[:] = [d for d in dirs if d not in EXCLUDE_DIRS]
    for f in sorted(files):
        p = os.path.join(base, f)
        ext = os.path.splitext(f)[1].lower()
        if ext in INCLUDE_EXTS and os.path.getsize(p) <= MAX_BYTES:
            with open(p, 'rb') as fh:
                raw = fh.read()
            # tenta decodificar como texto
            txt = None
            for enc in ('utf-8', 'latin-1'):
                try:
                    txt = raw.decode(enc)
                    break
                except UnicodeDecodeError:
                    continue
            if txt is None:
                continue
            sha = hashlib.sha1(raw).hexdigest()[:12]
            files_count += 1
            if rel(p).endswith("rpa.py"):
                rpa_sha = sha
            lines.append(
                f"\n----- FILE: {rel(p)}  (sha1:{sha}, bytes:{len(raw)}) -----\n{txt}"
            )

with open('bundle.txt','w',encoding='utf-8') as f:
    f.write('\n'.join(lines))

print(f"Gerado bundle.txt na pasta do projeto. Arquivos inclu√≠dos: {files_count}")
if rpa_sha:
    print(f"SHA do rpa.py no bundle: {rpa_sha}")


----- FILE: bundle.txt  (sha1:6dd088058212, bytes:259433) -----
### TREE

  .gitignore
  SISTEMA_DROP.md
  app.py
  bundle.py
  bundle.txt
icones/
  icones/choji.png
  icones/gaara.png
  icones/hinata.png
  icones/ino.png
  icones/kankuro.png
  icones/kiba.png
  icones/lee.png
  icones/naruto.png
  icones/neji.png
  icones/sakura.png
  icones/sasuke.png
  icones/shikamaru.png
  icones/shino.png
  icones/temari.png
  icones/tenten.png
static/
static/css/
  static/css/style.css
static/img/
  static/img/battle_bg.png
  static/img/cloud.png
  static/img/day_bg.png
  static/img/elemental_cycle.png
  static/img/kunai.png
  static/img/kunai_cursor.png
  static/img/naruto_face.png
  static/img/naruto_full.png
  static/img/sakura_face.png
  static/img/sakura_full.png
  static/img/sasuke_face.png
  static/img/sasuke_full.png
static/img/elements/
  static/img/elements/earth.png
  static/img/elements/fire.png
  static/img/elements/lightning.png
  static/img/elements/water.png
  static/img/elements/wind.png
static/img/enemies/
  static/img/enemies/boss.png
  static/img/enemies/enemy_1.png
  static/img/enemies/enemy_main.png
  static/img/enemies/enemy_v4.png
  static/img/enemies/enemy_v5.png
  static/img/enemies/enemy_v6.png
static/img/heroes/
static/img/heroes/icons/
  static/img/heroes/icons/choji_icon.png
  static/img/heroes/icons/chouji_icon.png
  static/img/heroes/icons/gaara_icon.png
  static/img/heroes/icons/hinata_icon.png
  static/img/heroes/icons/ino_icon.png
  static/img/heroes/icons/kankuro_icon.png
  static/img/heroes/icons/kiba_icon.png
  static/img/heroes/icons/lee_icon.png
  static/img/heroes/icons/naruto_icon.png
  static/img/heroes/icons/neji_icon.png
  static/img/heroes/icons/rocklee_icon.png
  static/img/heroes/icons/sakura_icon.png
  static/img/heroes/icons/sasuke_icon.png
  static/img/heroes/icons/shikamaru_icon.png
  static/img/heroes/icons/shino_icon.png
  static/img/heroes/icons/temari_icon.png
  static/img/heroes/icons/tenten_icon.png
static/img/items/
  static/img/items/poison.png
static/img/skills/
  static/img/skills/skill_1_1.png
  static/img/skills/skill_1_2.png
  static/img/skills/skill_1_3.png
  static/img/skills/skill_1_4.png
  static/img/skills/skill_2_1.png
  static/img/skills/skill_2_2.png
  static/img/skills/skill_2_3.png
  static/img/skills/skill_2_4.png
  static/img/skills/skill_3_1.png
  static/img/skills/skill_3_2.png
  static/img/skills/skill_3_3.png
  static/img/skills/skill_3_4.png
static/js/
  static/js/game.js
  static/js/game_data.js
  static/js/game_data_v3.js
  static/js/game_v3.js
templates/
  templates/index.html


### FILES


----- FILE: SISTEMA_DROP.md  (sha1:760d4e6051cb, bytes:3352) -----
# Sistema de Drop do Kenji - Rasengan

## Vis√£o Geral

Sistema especial de desbloqueio da terceira skill do Naruto (Rasengan) atrav√©s de drops do inimigo Kenji.

## Mec√¢nica

### Drop do Fragmento
- **Inimigo:** Kenji (um dos 4 sprites de inimigos normais)
- **Chance de Drop:** 20% (0.20)
- **Item:** Fragmento de Chakra üîÆ
- **Requisito:** Matar especificamente o inimigo Kenji

### Desbloqueio da Skill
- **Skill:** Rasengan (h1_u3)
- **Requisito:** Coletar 10 Fragmentos de Chakra
- **Efeito:** DPS de Todos +10%
- **Desbloqueio:** Autom√°tico ao coletar o 10¬∫ fragmento

## Implementa√ß√£o T√©cnica

### 1. GameState
```javascript
gameState.kenjiFragments = 0; // Contador de fragmentos
gameState.currentEnemyName = ""; // Nome do inimigo atual
```

### 2. Sistema de Drop (monterDeath)
```javascript
if (gameState.currentEnemyName === "Kenji" && Math.random() < 0.20) {
    // Drop do fragmento
    gameState.kenjiFragments++;
    
    // Verificar desbloqueio
    if (gameState.kenjiFragments >= 10 && !gameState.upgrades.includes('h1_u3')) {
        unlockNarutoRasengan();
    }
}
```

### 3. Renderiza√ß√£o da Skill
- **Bloqueada:** Exibe progresso de fragmentos (X/10)
- **Dispon√≠vel:** Quando kenjiFragments >= 10
- **Tooltip:** Mostra contador e instru√ß√£o para matar Kenji

### 4. Verifica√ß√£o de Compra
```javascript
if (upgId === 'h1_u3') {
    if (gameState.kenjiFragments < 10) {
        return; // Bloqueia compra
    }
}
```

### 5. Persist√™ncia
- Fragmentos salvos em `localStorage`
- Carregados automaticamente ao iniciar o jogo

## Caracter√≠sticas

‚úÖ **Drop Espec√≠fico:** Apenas Kenji dropa fragmentos
‚úÖ **Chance Balanceada:** 20% de chance por morte
‚úÖ **Progresso Vis√≠vel:** Tooltip mostra X/10 fragmentos
‚úÖ **Desbloqueio Autom√°tico:** Skill liberada ao coletar 10
‚úÖ **Notifica√ß√£o Especial:** Anima√ß√£o ao desbloquear Rasengan
‚úÖ **Persist√™ncia:** Progresso salvo automaticamente

## Fluxo do Jogador

1. **Encontrar Kenji:** Jogar at√© spawnar o inimigo Kenji
2. **Matar Kenji:** 20% de chance de dropar fragmento
3. **Coletar Fragmentos:** Acumular at√© 10 fragmentos
4. **Desbloqueio:** Rasengan √© automaticamente desbloqueado
5. **Compra:** Pode comprar a skill normalmente com ouro

## Diferen√ßas das Outras Skills

| Aspecto | Skills Normais | Rasengan (h1_u3) |
|---------|---------------|------------------|
| Requisito | N√≠vel do her√≥i | 10 Fragmentos do Kenji |
| Desbloqueio | Ao atingir n√≠vel | Ao coletar fragmentos |
| Compra | Manual com ouro | Manual ap√≥s desbloquear |
| Tooltip | Apenas custo | Custo + Progresso de fragmentos |

## Mensagens do Sistema

### Console
- `üîÆ Fragmento de Chakra coletado! Total: X/10`
- `üåÄ Desbloqueando Rasengan!`
- `‚úÖ Rasengan desbloqueado com sucesso!`
- `‚ùå Voc√™ precisa de 10 Fragmentos de Chakra para desbloquear o Rasengan!`

### Notifica√ß√µes Visuais
1. **Drop de Fragmento:** Notifica√ß√£o padr√£o de item
2. **Desbloqueio:** Notifica√ß√£o especial com emoji üåÄ e dura√ß√£o de 5s

## Balanceamento

- **Chance de Kenji spawnar:** 1/4 (25%)
- **Chance de drop:** 20%
- **Chance efetiva por inimigo:** 5%
- **M√©dia de inimigos para 10 fragmentos:** ~200 mortes
- **Tempo estimado:** Vari√°vel, depende do DPS do jogador


----- FILE: app.py  (sha1:70d1f21d0ff8, bytes:799) -----
from flask import Flask, render_template, send_from_directory
import os

app = Flask(__name__)

# Desabilitar cache completamente
app.config['SEND_FILE_MAX_AGE_DEFAULT'] = 0
app.config['TEMPLATES_AUTO_RELOAD'] = True

@app.route('/')
def home():
    return render_template('index.html')

@app.route('/static/<path:path>')
def send_static(path):
    return send_from_directory('static', path)

if __name__ == '__main__':
    print("\n" + "="*60)
    print("üéÆ NARUTO CLICKER - Servidor Iniciado!")
    print("="*60)
    print("üìç Acesse: http://localhost:8080")
    print("üîÑ Cache desabilitado - mudan√ßas aparecem imediatamente")
    print("‚ö†Ô∏è  Pressione Ctrl+C para parar o servidor")
    print("="*60 + "\n")
    app.run(debug=True, port=8080, host='0.0.0.0')


----- FILE: bundle.py  (sha1:995d1eb04172, bytes:2349) -----
# make_bundle.py
import os, hashlib

ROOT = os.getcwd()
EXCLUDE_DIRS = {
    '.git','node_modules','venv','.venv','__pycache__','.pytest_cache',
    'dist','build','.next','.idea','.vscode',
    'rpa_screenshots','rpa_artifacts','uploads','logs',
    # 'instance',  # <- descomente para n√£o incluir nada de instance/
}
INCLUDE_EXTS = {
    '.py','.ts','.tsx','.js','.jsx','.json','.yml','.yaml','.toml',
    '.ini','.cfg','.txt','.md','.sql','.html','.css','.env.example',
    '.jinja','.jinja2','.j2',
}
MAX_BYTES = 800_000  # sobe um pouco pra evitar truncar texto √∫til

def rel(p): 
    r = os.path.relpath(p, ROOT)
    return '.' if r == '.' else r.replace('\\','/')

lines = []

# 1) √Årvore do projeto
lines.append("### TREE\n")
for base, dirs, files in os.walk(ROOT):
    dirs[:] = [d for d in dirs if d not in EXCLUDE_DIRS]
    base_rel = rel(base)
    if base_rel != '.':
        lines.append(f"{base_rel}/")
    for f in sorted(files):
        lines.append(f"  {rel(os.path.join(base,f))}")

# 2) Conte√∫do dos arquivos de texto
lines.append("\n\n### FILES\n")
rpa_sha = ""
files_count = 0

for base, dirs, files in os.walk(ROOT):
    dirs[:] = [d for d in dirs if d not in EXCLUDE_DIRS]
    for f in sorted(files):
        p = os.path.join(base, f)
        ext = os.path.splitext(f)[1].lower()
        if ext in INCLUDE_EXTS and os.path.getsize(p) <= MAX_BYTES:
            with open(p, 'rb') as fh:
                raw = fh.read()
            # tenta decodificar como texto
            txt = None
            for enc in ('utf-8', 'latin-1'):
                try:
                    txt = raw.decode(enc)
                    break
                except UnicodeDecodeError:
                    continue
            if txt is None:
                continue
            sha = hashlib.sha1(raw).hexdigest()[:12]
            files_count += 1
            if rel(p).endswith("rpa.py"):
                rpa_sha = sha
            lines.append(
                f"\n----- FILE: {rel(p)}  (sha1:{sha}, bytes:{len(raw)}) -----\n{txt}"
            )

with open('bundle.txt','w',encoding='utf-8') as f:
    f.write('\n'.join(lines))

print(f"Gerado bundle.txt na pasta do projeto. Arquivos inclu√≠dos: {files_count}")
if rpa_sha:
    print(f"SHA do rpa.py no bundle: {rpa_sha}")


----- FILE: bundle.txt  (sha1:cae8558a65e9, bytes:122546) -----
### TREE

  .gitignore
  SISTEMA_DROP.md
  app.py
  bundle.py
icones/
  icones/choji.png
  icones/gaara.png
  icones/hinata.png
  icones/ino.png
  icones/kankuro.png
  icones/kiba.png
  icones/lee.png
  icones/naruto.png
  icones/neji.png
  icones/sakura.png
  icones/sasuke.png
  icones/shikamaru.png
  icones/shino.png
  icones/temari.png
  icones/tenten.png
static/
static/css/
  static/css/style.css
static/img/
  static/img/battle_bg.png
  static/img/cloud.png
  static/img/day_bg.png
  static/img/elemental_cycle.png
  static/img/kunai.png
  static/img/kunai_cursor.png
  static/img/naruto_face.png
  static/img/naruto_full.png
  static/img/sakura_face.png
  static/img/sakura_full.png
  static/img/sasuke_face.png
  static/img/sasuke_full.png
static/img/elements/
  static/img/elements/earth.png
  static/img/elements/fire.png
  static/img/elements/lightning.png
  static/img/elements/water.png
  static/img/elements/wind.png
static/img/enemies/
  static/img/enemies/boss.png
  static/img/enemies/enemy_1.png
  static/img/enemies/enemy_main.png
  static/img/enemies/enemy_v4.png
  static/img/enemies/enemy_v5.png
  static/img/enemies/enemy_v6.png
static/img/heroes/
static/img/heroes/icons/
  static/img/heroes/icons/choji_icon.png
  static/img/heroes/icons/chouji_icon.png
  static/img/heroes/icons/gaara_icon.png
  static/img/heroes/icons/hinata_icon.png
  static/img/heroes/icons/ino_icon.png
  static/img/heroes/icons/kankuro_icon.png
  static/img/heroes/icons/kiba_icon.png
  static/img/heroes/icons/lee_icon.png
  static/img/heroes/icons/naruto_icon.png
  static/img/heroes/icons/neji_icon.png
  static/img/heroes/icons/rocklee_icon.png
  static/img/heroes/icons/sakura_icon.png
  static/img/heroes/icons/sasuke_icon.png
  static/img/heroes/icons/shikamaru_icon.png
  static/img/heroes/icons/shino_icon.png
  static/img/heroes/icons/temari_icon.png
  static/img/heroes/icons/tenten_icon.png
static/img/items/
  static/img/items/poison.png
static/img/skills/
  static/img/skills/skill_1_1.png
  static/img/skills/skill_1_2.png
  static/img/skills/skill_1_3.png
  static/img/skills/skill_1_4.png
  static/img/skills/skill_2_1.png
  static/img/skills/skill_2_2.png
  static/img/skills/skill_2_3.png
  static/img/skills/skill_2_4.png
  static/img/skills/skill_3_1.png
  static/img/skills/skill_3_2.png
  static/img/skills/skill_3_3.png
  static/img/skills/skill_3_4.png
static/js/
  static/js/game.js
  static/js/game_data.js
  static/js/game_data_v3.js
  static/js/game_v3.js
templates/
  templates/index.html


### FILES


----- FILE: SISTEMA_DROP.md  (sha1:171b8b098bc5, bytes:3397) -----
# Sistema de Drop de Itens - Naruto Clicker

## Resumo da Implementa√ß√£o

Foi implementado um sistema completo de drop de itens no jogo Naruto Clicker com as seguintes caracter√≠sticas:

### Caracter√≠sticas Principais

1. **Zona de Drop**: Arenas 10 a 15
2. **Chance de Drop**: 2% por inimigo morto (muito raro!)
3. **Restri√ß√£o**: Apenas inimigos comuns dropam itens (bosses n√£o dropam)
4. **Item**: Frasco de Veneno
5. **Destino**: O item vai automaticamente para a mochila do jogador

### Arquivos Modificados

#### 1. `static/js/game_v3.js`
- **Fun√ß√£o `monterDeath()`**: Adicionada l√≥gica de drop de itens
  - Verifica se o inimigo √© um boss (zona m√∫ltipla de 5)
  - Verifica se est√° na zona de drop (10-15)
  - Gera n√∫mero aleat√≥rio para chance de 20%
  - Cria objeto do item dropado
  - Adiciona ao invent√°rio e mostra notifica√ß√£o

- **Fun√ß√£o `addItemToInventory(newItem)`**: Nova fun√ß√£o
  - Verifica se o item j√° existe no invent√°rio
  - Se existe, incrementa a contagem
  - Se n√£o existe, adiciona em um slot vazio
  - Retorna true/false para sucesso/falha
  - Salva o jogo automaticamente

- **Fun√ß√£o `showItemDropNotification(item)`**: Nova fun√ß√£o
  - Cria notifica√ß√£o visual animada
  - Mostra √≠cone do item, texto "ITEM DROPADO!" e nome do item
  - Desaparece automaticamente ap√≥s 3 segundos

- **Fun√ß√£o `renderInventory()`**: Atualizada
  - Suporta tanto emojis quanto imagens como √≠cones
  - Renderiza corretamente itens com imagens

- **Fun√ß√µes `saveGame()` e `loadGame()`**: Atualizadas
  - Agora salvam e carregam o invent√°rio do localStorage

#### 2. `static/css/style.css`
- **`.item-drop-notification`**: Estilos para notifica√ß√£o de drop
  - Fundo escuro com borda dourada brilhante
  - Anima√ß√µes de aparecimento e desaparecimento
  - Centralizado na tela
  - Z-index alto para ficar sobre tudo

- **`.item-icon-img`**: Estilos para imagens de itens no invent√°rio
  - Tamanho 100% do slot
  - Object-fit contain para manter propor√ß√µes
  - Drop shadow para destaque

#### 3. `static/img/items/poison.png`
- Imagem do frasco de veneno criada
- Estilo pixel art com l√≠quido verde brilhante
- Caveira no r√≥tulo
- Fundo transparente

### Como Funciona

1. Quando um inimigo comum (n√£o boss) √© morto nas arenas 10-15:
   - O jogo gera um n√∫mero aleat√≥rio
   - Se for menor que 0.20 (20%), um item dropa

2. Quando um item dropa:
   - √â criado um objeto com as propriedades do item
   - O item √© adicionado ao invent√°rio via `addItemToInventory()`
   - Uma notifica√ß√£o visual aparece na tela
   - O jogo √© salvo automaticamente

3. O invent√°rio:
   - Itens id√™nticos s√£o empilhados (count aumenta)
   - Itens diferentes ocupam slots separados
   - M√°ximo de 40 slots
   - Persistido no localStorage

### Exemplo de Item Dropado

```javascript
{
    icon: './static/img/items/poison.png',
    name: 'Frasco de Veneno',
    description: 'Um veneno mortal usado por ninjas',
    count: 1,
    isImage: true
}
```

### Pr√≥ximos Passos Poss√≠veis

1. Adicionar mais tipos de itens com diferentes raridades
2. Implementar efeitos dos itens (buffs, dano extra, etc.)
3. Adicionar diferentes chances de drop por arena
4. Criar sistema de uso de itens
5. Adicionar sons quando itens dropam
6. Criar diferentes pools de itens por zona


----- FILE: app.py  (sha1:70d1f21d0ff8, bytes:799) -----
from flask import Flask, render_template, send_from_directory
import os

app = Flask(__name__)

# Desabilitar cache completamente
app.config['SEND_FILE_MAX_AGE_DEFAULT'] = 0
app.config['TEMPLATES_AUTO_RELOAD'] = True

@app.route('/')
def home():
    return render_template('index.html')

@app.route('/static/<path:path>')
def send_static(path):
    return send_from_directory('static', path)

if __name__ == '__main__':
    print("\n" + "="*60)
    print("üéÆ NARUTO CLICKER - Servidor Iniciado!")
    print("="*60)
    print("üìç Acesse: http://localhost:8080")
    print("üîÑ Cache desabilitado - mudan√ßas aparecem imediatamente")
    print("‚ö†Ô∏è  Pressione Ctrl+C para parar o servidor")
    print("="*60 + "\n")
    app.run(debug=True, port=8080, host='0.0.0.0')


----- FILE: bundle.py  (sha1:995d1eb04172, bytes:2349) -----
# make_bundle.py
import os, hashlib

ROOT = os.getcwd()
EXCLUDE_DIRS = {
    '.git','node_modules','venv','.venv','__pycache__','.pytest_cache',
    'dist','build','.next','.idea','.vscode',
    'rpa_screenshots','rpa_artifacts','uploads','logs',
    # 'instance',  # <- descomente para n√£o incluir nada de instance/
}
INCLUDE_EXTS = {
    '.py','.ts','.tsx','.js','.jsx','.json','.yml','.yaml','.toml',
    '.ini','.cfg','.txt','.md','.sql','.html','.css','.env.example',
    '.jinja','.jinja2','.j2',
}
MAX_BYTES = 800_000  # sobe um pouco pra evitar truncar texto √∫til

def rel(p): 
    r = os.path.relpath(p, ROOT)
    return '.' if r == '.' else r.replace('\\','/')

lines = []

# 1) √Årvore do projeto
lines.append("### TREE\n")
for base, dirs, files in os.walk(ROOT):
    dirs[:] = [d for d in dirs if d not in EXCLUDE_DIRS]
    base_rel = rel(base)
    if base_rel != '.':
        lines.append(f"{base_rel}/")
    for f in sorted(files):
        lines.append(f"  {rel(os.path.join(base,f))}")

# 2) Conte√∫do dos arquivos de texto
lines.append("\n\n### FILES\n")
rpa_sha = ""
files_count = 0

for base, dirs, files in os.walk(ROOT):
    dirs[:] = [d for d in dirs if d not in EXCLUDE_DIRS]
    for f in sorted(files):
        p = os.path.join(base, f)
        ext = os.path.splitext(f)[1].lower()
        if ext in INCLUDE_EXTS and os.path.getsize(p) <= MAX_BYTES:
            with open(p, 'rb') as fh:
                raw = fh.read()
            # tenta decodificar como texto
            txt = None
            for enc in ('utf-8', 'latin-1'):
                try:
                    txt = raw.decode(enc)
                    break
                except UnicodeDecodeError:
                    continue
            if txt is None:
                continue
            sha = hashlib.sha1(raw).hexdigest()[:12]
            files_count += 1
            if rel(p).endswith("rpa.py"):
                rpa_sha = sha
            lines.append(
                f"\n----- FILE: {rel(p)}  (sha1:{sha}, bytes:{len(raw)}) -----\n{txt}"
            )

with open('bundle.txt','w',encoding='utf-8') as f:
    f.write('\n'.join(lines))

print(f"Gerado bundle.txt na pasta do projeto. Arquivos inclu√≠dos: {files_count}")
if rpa_sha:
    print(f"SHA do rpa.py no bundle: {rpa_sha}")


----- FILE: static/css/style.css  (sha1:415d8d757cba, bytes:40724) -----
:root {
    --bg-color: #2c2c2c;
    --panel-bg: #f5e6ca;
    /* Cor de pergaminho */
    --panel-border: #4a3b2a;
    --primary-orange: #ff6600;
    --text-color: #333;
    --gold-color: #ffd700;
    --dps-color: #ff4500;
}

body {
    margin: 0;
    padding: 0;
    font-family: 'Roboto', sans-serif;
    background-image: url('../img/battle_bg.png');
    background-size: cover;
    background-position: center;
    color: var(--text-color);
    height: 100vh;
    overflow: hidden;
    user-select: none;
    position: relative;
}



.game-container {
    display: flex;
    height: 100vh;
    width: 100%;
    max-width: 100%;
    padding: 20px;
    box-sizing: border-box;
    margin: 0;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.8);
}

.panel {
    background-color: var(--panel-bg);
    border: 5px solid var(--panel-border);
    border-radius: 8px;
    margin: 0 15px;
    /* Espa√ßo entre as faixas */
    padding: 15px;
    display: flex;
    flex-direction: column;
    position: relative;
    box-shadow: inset 0 0 50px rgba(0, 0, 0, 0.1);
}

.panel::before {
    content: "";
    /* Textura de papel */
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-image: url('https://www.transparenttextures.com/patterns/aged-paper.png');
    opacity: 0.4;
    pointer-events: none;
    z-index: 0;
}

.left-panel {
    flex: 2.5;
    /* Aumentado de 2.2 para 2.5 para dar mais espa√ßo */
    min-width: 480px;
    /* Aumentado de 450px para 480px */
    z-index: 1;
}

/* Mais larga */
.center-panel {
    flex: 6;
    /* Abre muito mais espa√ßo no meio */
    z-index: 1;
    background-color: rgba(255, 255, 255, 0.1);
    border: none;
    box-shadow: none;
    background: none;
}

/* Center panel is transparent to see bg */

.center-panel .battle-arena {
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
    /* Centraliza verticalmente o conjunto */
    align-items: center;
    position: relative;
    padding-top: 0;
}

.right-panel {
    flex: 1.2;
    min-width: 280px;
    z-index: 1;
    display: flex;
    flex-direction: column;
    padding: 20px;
    background-image: url('https://www.transparenttextures.com/patterns/aged-paper.png'),
        linear-gradient(to bottom, #f5e6ca 0%, #e8d5b5 100%);
    border-left: 5px solid #4a3b2a;
    box-shadow: -5px 0 15px rgba(0, 0, 0, 0.3);
    position: relative;
}

.right-panel h3 {
    text-align: center;
    font-size: 1.8em;
    color: #4e342e;
    border-bottom: 2px solid #8d6e63;
    padding-bottom: 10px;
    margin-bottom: 20px;
    text-transform: uppercase;
}

#stats-list {
    list-style: none;
    padding: 0;
    margin: 0;
    flex: 1;
}

#stats-list li {
    font-family: 'Roboto', sans-serif;
    font-size: 1.1em;
    padding: 12px 10px;
    border-bottom: 1px dashed #a1887f;
    color: #3e2723;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

#stats-list li span {
    font-family: 'Bangers', cursive;
    color: #bf360c;
    font-size: 1.2em;
}

/* Estiliza√ß√£o do Bot√£o de Reset */
.reset-container {
    margin-top: auto;
    padding-top: 20px;
    text-align: center;
}

.reset-btn {
    background: linear-gradient(to bottom, #d32f2f 0%, #b71c1c 100%);
    color: white;
    border: 2px solid #7f0000;
    padding: 12px 20px;
    font-family: 'Bangers', cursive;
    font-size: 1.2em;
    border-radius: 8px;
    cursor: pointer;
    box-shadow: 0 4px 0 #5f0000;
    transition: all 0.1s;
    width: 100%;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
}

.reset-btn:hover {
    background: linear-gradient(to bottom, #e53935 0%, #c62828 100%);
}

.reset-btn:active {
    transform: translateY(4px);
    box-shadow: none;
}

/* Scroll Lists */
.scroll-content {
    overflow-y: auto;
    overflow-x: hidden;
    /* Remove a barra horizontal */
    flex: 1;
    padding-right: 15px;
    /* Aumentado de 5px para 15px para afastar a barra dos cards */
}

.scroll-content::-webkit-scrollbar {
    width: 8px;
}

.scroll-content::-webkit-scrollbar-thumb {
    background: var(--primary-orange);
    border-radius: 4px;
}

/* Heroes List Expanded */

.gold-display-left {
    font-family: 'Bangers', cursive;
    font-size: 2.5em;
    /* Bem grande */
    color: var(--gold-color);
    text-shadow: 2px 2px 0 #000;
    text-align: center;
    margin-bottom: 20px;
    background: rgba(0, 0, 0, 0.6);
    padding: 10px;
    border-radius: 10px;
    border: 2px solid #8b4513;
}

/* Header Panel (Equipe Ninja) */
.header-panel {
    border-bottom: 2px solid #8b4513;
    margin-bottom: 15px;
    padding-bottom: 10px;
}

.header-panel h2 {
    font-family: 'Shojumaru', cursive;
    margin: 0;
    color: #b33e00;
    font-size: 1.8em;
    text-align: center;
}

/* Stats Display (DPS/Click) */
.stats-display-container {
    display: flex;
    justify-content: space-around;
    gap: 10px;
    margin-top: 10px;
}

.dps-display,
.click-display {
    flex: 1;
    background: linear-gradient(135deg, #444, #222);
    border: 2px solid #ff9800;
    border-radius: 8px;
    padding: 8px 5px;
    color: #fff;
    font-family: 'Bangers', cursive;
    font-size: 1.4em;
    text-align: center;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
    text-shadow: 1px 1px 2px #000;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}

.dps-display span,
.click-display span {
    color: #ffd700;
    font-size: 1.1em;
}

.dps-display {
    border-color: #ff5722;
}

.click-display {
    border-color: #2196f3;
}

/* Heroes List Expanded */
.hero-item {
    background: rgba(255, 255, 255, 0.85);
    /* Mais opaco para leitura */
    border: 3px solid #8b4513;
    border-radius: 8px;
    margin-bottom: 12px;
    padding: 15px;
    /* Box maior */
    display: flex;
    align-items: center;
    transition: transform 0.1s;
    cursor: pointer;
    min-height: 80px;
    /* Garante altura */
}

.hero-item:hover {
    transform: scale(1.02);
    background: rgba(255, 255, 255, 0.95);
}

.hero-item.disabled {
    filter: grayscale(1);
    opacity: 0.7;
    cursor: not-allowed;
}

.hero-img {
    width: 80px;
    /* Imagem bem maior */
    height: 80px;
    border-radius: 10px;
    /* Quadrado arredondado em vez de circulo para mostrar mais arte */
    border: 3px solid var(--panel-border);
    margin-right: 15px;
    background: #ccc;
    flex-shrink: 0;
}

.hero-info {
    flex: 1;
}

.hero-name {
    font-weight: bold;
    font-family: 'Shojumaru', cursive;
    font-size: 1.4em;
    color: #b33e00;
    margin-bottom: 5px;
}

.hero-stats {
    font-size: 1.1em;
    color: #333;
    font-weight: bold;
}

.hero-cost {
    font-weight: bold;
    color: #d68910;
    font-size: 1.2em;
}

.hero-level {
    background: var(--panel-border);
    color: #fff;
    padding: 4px 10px;
    border-radius: 12px;
    font-size: 0.9em;
    float: right;
    margin-left: 10px;
}

/* Monster & Battle */
.monster-container {
    text-align: center;
    position: relative;
    cursor: url('../img/kunai_cursor.png') 0 0, crosshair;
}

.monster-visual {
    width: 440px;
    /* Aumentado para 440px */
    height: 440px;
    margin: 80px auto 0 auto;
    /* Aumenta espa√ßo superior para descer o ninja conforme pedido */
    transition: transform 0.05s;
    display: flex;
    align-items: center;
    justify-content: center;
}

.monster-visual img {
    max-width: 100%;
    max-height: 100%;
    filter: drop-shadow(0 10px 10px rgba(0, 0, 0, 0.5));
}

.monster-visual:active {
    transform: scale(0.95);
}

.shake {
    animation: shake 0.2s;
}

.hit-scale {
    animation: hitScale 0.1s ease-out;
}

@keyframes hitScale {
    0% {
        transform: scale(1);
    }

    50% {
        transform: scale(1.15);
    }

    /* Aumenta levemente */
    100% {
        transform: scale(1);
    }
}

@keyframes shake {
    0% {
        transform: translate(1px, 1px) rotate(0deg);
    }

    10% {
        transform: translate(-1px, -2px) rotate(-1deg);
    }

    20% {
        transform: translate(-3px, 0px) rotate(1deg);
    }

    30% {
        transform: translate(3px, 2px) rotate(0deg);
    }

    40% {
        transform: translate(1px, -1px) rotate(1deg);
    }

    50% {
        transform: translate(-1px, 2px) rotate(-1deg);
    }

    60% {
        transform: translate(-3px, 1px) rotate(0deg);
    }

    70% {
        transform: translate(3px, 1px) rotate(-1deg);
    }

    80% {
        transform: translate(-1px, -1px) rotate(1deg);
    }

    90% {
        transform: translate(1px, 2px) rotate(0deg);
    }

    100% {
        transform: translate(1px, -2px) rotate(-1deg);
    }
}

.monster-hp-bar {
    width: 380px;
    /* Aumentado para acompanhar o monstro */
    height: 22px;
    background: #555;
    border: 3px solid #000;
    border-radius: 12px;
    overflow: hidden;
    margin: 5px auto;
}

#hp-fill {
    height: 100%;
    background: linear-gradient(90deg, #ff0000, #ff6600);
    transition: width 0.1s linear;
}

.monster-hp-text {
    font-family: 'Bangers', cursive;
    font-size: 1.5em;
    color: #fff;
    text-shadow: 2px 2px 0 #000;
    margin-top: -22px;
    position: relative;
    z-index: 2;
}

#damage-numbers-container {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
}

.damage-number {
    position: absolute;
    font-family: 'Bangers', cursive;
    font-size: 2em;
    color: #fff;
    text-shadow: 2px 2px 0 #000;
    animation: floatUp 1s ease-out forwards;
}

.damage-crit {
    color: #ff0000;
    font-size: 3em;
}

@keyframes floatUp {
    0% {
        opacity: 1;
        transform: translateY(0) scale(1);
    }

    100% {
        opacity: 0;
        transform: translateY(-100px) scale(1.2);
    }
}

/* Headers & Fonts */
h2,
h3 {
    font-family: 'Shojumaru', cursive;
    letter-spacing: 1px;
    margin: 0 0 10px 0;
    color: #2c2c2c;
}

.gold-display {
    font-family: 'Bangers', cursive;
    font-size: 2em;
    color: var(--gold-color);
    text-shadow: 2px 2px 0 #000;
    background: rgba(0, 0, 0, 0.6);
    padding: 10px;
    border-radius: 10px;
    margin-bottom: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.gold-icon {
    height: 30px;
    margin-right: 10px;
}

/* Log Removido, adicionando estilos de Arena */
.arena-selector-container {
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 10px;
    background: rgba(0, 0, 0, 0.5);
    padding: 10px;
    border-radius: 15px;
    border: 2px solid #8b4513;
}

.nav-btn {
    background: #ff6600;
    border: 2px solid #4a0000;
    color: white;
    font-weight: bold;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    cursor: pointer;
    font-family: 'Bangers', cursive;
    font-size: 1.2em;
}

.nav-btn:hover {
    background: #ff8533;
}

.nav-btn:active {
    transform: scale(0.95);
}

.arenas-scroll {
    flex: 1;
    overflow: hidden;
    margin: 0 10px;
    height: 60px;
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
}

#arenas-display {
    display: flex;
    gap: 10px;
    transition: transform 0.3s ease;
}

.arena-box {
    width: 50px;
    height: 50px;
    background: #4a3b2a;
    border: 2px solid #8b4513;
    color: #ffd700;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: 'Bangers', cursive;
    font-size: 1.2em;
    border-radius: 5px;
    cursor: pointer;
    flex-shrink: 0;
    opacity: 0.6;
}

.arena-box.active {
    background: #ff6600;
    border-color: #ffff00;
    transform: scale(1.1);
    opacity: 1;
    box-shadow: 0 0 10px #ff6600;
}

.arena-box.locked {
    background: #222;
    color: #555;
    cursor: not-allowed;
    border-color: #333;
}

/* Upgrade Boxes Compact */
.upgrades-row {
    display: flex;
    gap: 5px;
    margin-top: 5px;
    width: 100%;
    padding-left: 95px;
    /* Alinhar com o nome do heroi (img width + margin) */
}

.upgrade-box {
    width: 30px;
    height: 30px;
    background-color: #4a3b2a;
    border: 2px solid #8b4513;
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 1.2em;
    position: relative;
    transition: all 0.2s;
}

.upgrade-box.locked {
    opacity: 0;
    /* Totalmente invis√≠vel se bloqueado (se n√£o tiver nivel 20, 40...) */
    pointer-events: none;
}

.upgrade-box.available {
    background-color: #5d4a35;
    border-color: #ffd700;
    /* Borda dourada para indicar disponivel */
    animation: pulseBorder 2s infinite;
}

.upgrade-box.bought {
    background-color: #228b22;
    /* Verde comprado */
    border-color: #00ff00;
    box-shadow: 0 0 5px #00ff00;
    cursor: default;
}

/* Tooltip (S√≥ no hover) */
.tooltip {
    visibility: hidden;
    background-color: rgba(0, 0, 0, 0.95);
    color: #fff;
    text-align: left;
    border-radius: 6px;
    padding: 8px;
    position: absolute;
    z-index: 1000;
    bottom: 125%;
    left: 50%;
    margin-left: -60px;
    width: 150px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
    border: 1px solid #ffd700;
    font-size: 0.8em;
    font-family: 'Roboto', sans-serif;
    pointer-events: none;
    opacity: 0;
    transition: opacity 0.2s;
}

.upgrade-box:hover .tooltip {
    visibility: visible;
    opacity: 1;
}

@keyframes pulseBorder {
    0% {
        border-color: #ffd700;
    }

    50% {
        border-color: #ffaa00;
    }

    100% {
        border-color: #ffd700;
    }
}

.zone-progress-info {
    text-align: center;
    font-family: 'Shojumaru', cursive;
    color: #ffd700;
    background: transparent;
    padding: 0;
    margin-bottom: 20px;
    /* Mais espa√ßo para a barra de vida abaixo */
    margin-top: -20px;
    /* Sobe um pouco mais */
    font-size: 2.8em;
    /* Aumentado levemente */
    text-shadow: 4px 4px 0 #000;
    z-index: 10;
}

/* Boss Timer */
.boss-timer {
    text-align: center;
    font-family: 'Bangers', cursive;
    color: #ff4444;
    background: rgba(0, 0, 0, 0.7);
    padding: 10px 20px;
    margin: -10px auto 20px auto;
    border-radius: 15px;
    font-size: 2.5em;
    text-shadow: 3px 3px 0 #000;
    border: 3px solid #ff0000;
    box-shadow: 0 0 20px rgba(255, 0, 0, 0.5);
    width: fit-content;
    animation: timerPulse 1s infinite;
}

.boss-timer.warning {
    animation: timerWarning 0.5s infinite;
    color: #ff0000;
    border-color: #ff0000;
}

@keyframes timerPulse {

    0%,
    100% {
        transform: scale(1);
    }

    50% {
        transform: scale(1.05);
    }
}

@keyframes timerWarning {

    0%,
    100% {
        transform: scale(1);
        box-shadow: 0 0 20px rgba(255, 0, 0, 0.8);
    }

    50% {
        transform: scale(1.1);
        box-shadow: 0 0 30px rgba(255, 0, 0, 1);
    }
}


/* HERO ITEM REDESIGN (Reference Style) */
.hero-item-new {
    background: #fdf5e6;
    /* Cor de papiro claro */
    border-radius: 12px;
    margin-bottom: 25px;
    padding: 10px;
    position: relative;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    border: 2px solid #dba669;
    min-height: 180px;
    /* Garante espa√ßo para imagem full */
}

/* Header: Nome e Nivel */
.hero-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-end;
    /* Alinha na base do texto */
    margin-bottom: 5px;
    border-bottom: 1px dashed #dba669;
    padding-bottom: 5px;
}

.hero-name-title {
    font-family: 'Shojumaru', cursive;
    font-size: 1.6em;
    color: #333;
    text-shadow: 1px 1px 0 #fff;
    margin-left: 5px;
}

.hero-level-badge {
    font-family: 'Bangers', cursive;
    font-size: 2em;
    color: #fff;
    text-shadow: 2px 2px 0 #000;
}

/* Body: Esquerda (Botao + Skills) | Direita (Imagem) */
.hero-body-row {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
}

.left-section {
    display: flex;
    flex-direction: row;
    /* Botao e Skills lado a lado */
    align-items: center;
    gap: 15px;
    margin-top: 10px;
}

/* Bot√£o de Compra (Azul/Dourado estilo fish game) */
.buy-box {
    background: linear-gradient(to bottom, #4facfe 0%, #00f2fe 100%);
    width: 130px;
    height: 70px;
    border-radius: 10px;
    border: 4px solid #ffd700;
    box-shadow: 0 4px 0 #0056b3, 0 5px 10px rgba(0, 0, 0, 0.3);
    cursor: pointer;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    transition: transform 0.1s;
}

.buy-box:active {
    transform: translateY(4px);
    box-shadow: 0 0 0 #0056b3;
}

.buy-box.locked {
    background: #555;
    border-color: #333;
    cursor: not-allowed;
    box-shadow: none;
}

.buy-action {
    font-family: 'Bangers', cursive;
    font-size: 1.5em;
    color: #fff;
    text-shadow: 1px 1px 0 #000;
    line-height: 1;
}

.buy-cost {
    font-family: 'Roboto', sans-serif;
    font-weight: bold;
    font-size: 1em;
    color: #fff4e6;
    text-shadow: 1px 1px 0 #000;
    margin-top: 2px;
}

/* Skills Container */
.upgrades-container {
    display: flex;
    gap: 8px;
}

.upgrade-box-new {
    width: 45px;
    height: 45px;
    background: #3e2723;
    border: 3px solid #5d4037;
    border-radius: 6px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5em;
    cursor: pointer;
    position: relative;
    box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.8);
}

.upgrade-box-new.locked {
    opacity: 0;
    pointer-events: none;
}

.upgrade-box-new.available {
    background: #5d4037;
    border-color: #ffd700;
    animation: pulseBorder 2s infinite;
}

.upgrade-box-new.bought {
    border-color: #00ff00;
}

.check-mark {
    position: absolute;
    top: -5px;
    right: -5px;
    color: #00ff00;
    font-size: 1em;
    text-shadow: 1px 1px 0 #000;
    font-weight: bold;
}

/* Imagem do Heroi (Full Body, Saindo pra fora se precisar) */
.hero-image-container {
    width: 200px;
    /* Largura fixa para imagem */
    height: 250px;
    margin-top: -60px;
    /* Puxa pra cima para sobrepor header se quiser, ou ajustar */
    margin-right: -10px;
    display: flex;
    align-items: flex-end;
    justify-content: center;
    pointer-events: none;
    /* Deixar clicar atrav√©s se precisar */
    overflow: hidden;
    /* Corta se for muito grande */
}

.hero-full-img {
    max-height: 100%;
    max-width: 100%;
    filter: drop-shadow(5px 5px 10px rgba(0, 0, 0, 0.4));
    transition: transform 0.2s;
}

.hero-item-new:hover .hero-full-img {
    transform: scale(1.05);
}

/* HERO CONTAINER (Holds Title + Card) */
.hero-card-split {
    background: transparent;
    border: none;
    box-shadow: none;
    margin-bottom: 30px;
    display: flex;
    flex-direction: column;
}

/* NAME HEADER OUTSIDE */
.hero-title-header {
    font-family: 'Shojumaru', cursive;
    font-size: 1.4em;
    /* Reduzido */
    color: #e65100;
    text-shadow: 2px 2px 0 #fff;
    text-align: left;
    /* Alinhado com a esquerda da caixa */
    margin-bottom: 2px;
    /* Espa√ßo positivo, sem sobrepor */
    z-index: 10;
    position: relative;
    width: 100%;
    /* Permitir largura total */
    padding-left: 20px;
    white-space: nowrap;
    /* For√ßar uma linha */
    display: flex;
    align-items: center;
    gap: 10px;
}

.hero-element-icon {
    height: 28px;
    width: auto;
    filter: drop-shadow(0 2px 2px rgba(0, 0, 0, 0.3));
}

/* THE ACTUAL CARD BOX */
.hero-card-inner-split {
    background: #fff;
    border: 3px solid #8b4513;
    border-radius: 12px;
    display: flex;
    flex-direction: row;
    height: 190px;
    /* Altura reduzida para quadrado aproximado */
    position: relative;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
    overflow: visible;
    /* Permitir que o overlay saia pra fora */
    z-index: 1;
    margin-top: 5px;
}

/* LEFT COLUMN (50%) */
.card-left-col {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    /* Imagem no topo */
    padding: 0;
    /* Sem padding para imagem encostar */
    background: #fff;
    border-right: none;
    /* Removida a linha pontilhada */
    position: relative;
    overflow: hidden;
    /* Cortar excesso */
}

.hero-image-wrapper {
    width: 100%;
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: flex-start;
    /* Alinhar topo */
    position: relative;
    padding: 0;
}

.hero-full-body-img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: top center;
    image-rendering: -webkit-optimize-contrast;
    image-rendering: crisp-edges;
    filter: drop-shadow(0 5px 5px rgba(0, 0, 0, 0.3));
    transition: transform 0.3s ease;
    /* Transi√ß√£o mais suave */
    margin: 0;
    cursor: pointer;
}

.hero-full-body-img:hover {
    transform: scale(1.1);
    z-index: 10;
}

/* RIGHT COLUMN (50%) */
.card-right-col {
    flex: 1;
    display: flex;
    flex-direction: column;
    padding: 10px 15px;
    background: rgba(255, 255, 255, 0.9);
    border-top-right-radius: 8px;
    border-bottom-right-radius: 8px;
    justify-content: flex-start;
    gap: 8px;
    /* Espa√ßo uniforme entre os elementos */
    position: relative;
}

.hero-level-display {
    font-family: 'Bangers', cursive;
    font-size: 2.2em;
    color: #333;
    border-bottom: 2px solid #ff6600;
    margin-bottom: 5px;
    text-align: right;
}

/* OVERLAY DETALHES (Preto com opacidade) Popup */
.hero-stats-overlay {
    position: absolute;
    top: -10px;
    /* Mais pra cima */
    right: -10px;
    /* Mais pra direita */
    width: 200px;
    height: auto;
    min-height: 60px;
    background: rgba(0, 0, 0, 0.9);
    color: #fff;
    padding: 15px;
    z-index: 100;
    opacity: 0;
    pointer-events: none;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    transform: translateY(10px);
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    border-radius: 8px;
    border: 1px solid #ff9800;
    font-family: 'Roboto', sans-serif;
    text-align: left;
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.5);
}

/* Abrir ao passar o mouse apenas na Imagem ou no Bot√£o de Upgrade */
.hero-card-inner-split:hover .hero-stats-overlay {
    opacity: 0;
}

.hero-card-inner-split:has(.card-left-col:hover) .hero-stats-overlay,
.hero-card-inner-split:has(.hero-buy-btn:hover) .hero-stats-overlay {
    opacity: 1;
    transform: translateY(0);
}

.overlay-title {
    font-family: 'Shojumaru', cursive;
    color: #ff9800;
    font-size: 1.1em;
    margin-bottom: 8px;
    border-bottom: 1px solid #444;
    padding-bottom: 4px;
}

.stat-line {
    font-size: 1em;
    margin: 3px 0;
}

.stat-line strong {
    color: #ffd700;
}

.dps-increment {
    color: #4caf50;
    font-weight: bold;
    margin-left: 5px;
    text-shadow: 0 0 5px rgba(76, 175, 80, 0.5);
}

.stat-line-desc {
    font-size: 0.85em;
    color: #bbb;
    margin-top: 5px;
    line-height: 1.2;
}

hr {
    border: 0;
    border-top: 1px solid #444;
    margin: 8px 0;
}

.hero-skills-row {
    display: flex;
    gap: 12px;
    /* Mais espa√ßo entre √≠cones */
    margin: 10px 0 10px 15px;
    /* Adicionado 15px na esquerda para chegar pra direita */
    min-height: 50px;
    align-items: center;
    justify-content: flex-start;
}

.skill-box {
    width: 45px;
    height: 45px;
    background: #1a1a1a;
    border-radius: 8px;
    border: 2px solid #5d4037;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    position: relative;
    overflow: hidden;
    /* Cortar imagem nos cantos arredondados */
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
    transition: transform 0.1s;
}

.skill-box:hover:not(.locked) {
    transform: scale(1.1);
    z-index: 10;
}

.skill-img-icon {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.skill-box.locked {
    opacity: 0.3;
    filter: grayscale(1);
    cursor: not-allowed;
}

.skill-box.available {
    background: #5d4037;
    border-color: #ffd700;
    animation: pulseBorder 1.5s infinite;
}

.skill-box.bought {
    border-color: #00ff00;
}

.skill-check {
    position: absolute;
    top: -8px;
    right: -8px;
    color: #00ff00;
    font-size: 1.2em;
    font-weight: bold;
    text-shadow: 1px 1px 0 #000;
}

/* API Button at Bottom Right */
.hero-buy-btn {
    background: linear-gradient(to bottom, #ff9800 0%, #f57c00 100%);
    border: 2px solid #e65100;
    border-radius: 6px;
    padding: 5px 10px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    cursor: pointer;
    box-shadow: 0 3px 0 #bf360c;
    transition: active 0.1s;
    margin-top: 5px;
}

.hero-buy-btn:active {
    transform: translateY(3px);
    box-shadow: none;
}

.hero-buy-btn.locked {
    background: #777;
    border-color: #555;
    box-shadow: none;
    cursor: not-allowed;
    justify-content: center;
    color: #ccc;
}

.buy-label {
    font-family: 'Bangers', cursive;
    color: white;
    font-size: 1.2em;
}

.buy-value {
    font-weight: bold;
    color: #fff;
    font-size: 1em;
}

.hero-buy-btn.disabled {
    background: #9e9e9e;
    border-color: #757575;
    cursor: not-allowed;
    box-shadow: none;
    opacity: 0.8;
}

/* Mobile Adjust */
@media (max-width: 900px) {
    .hero-card-split {
        height: auto;
        flex-direction: column;
    }

    .card-left-col {
        border-right: none;
        border-bottom: 2px dashed #dba669;
    }

    .hero-image-wrapper {
        min-height: 200px;
    }

    .hero-full-body-img {
        height: auto;
        max-height: 250px;
    }
}

/* ===== BACKPACK ICON ===== */
.backpack-icon {
    font-size: 1.2em;
    cursor: pointer;
    margin-left: 10px;
    display: inline-block;
    transition: transform 0.2s ease, filter 0.2s ease;
    filter: drop-shadow(2px 2px 4px rgba(0, 0, 0, 0.5));
}

.backpack-icon:hover {
    transform: scale(1.15) rotate(-5deg);
    filter: drop-shadow(3px 3px 6px rgba(255, 215, 0, 0.6));
}

.backpack-icon:active {
    transform: scale(1.05);
}

/* ===== MODAL OVERLAY ===== */
.modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.85);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 9999;
    backdrop-filter: blur(5px);
    animation: fadeIn 0.3s ease;
}

@keyframes fadeIn {
    from {
        opacity: 0;
    }

    to {
        opacity: 1;
    }
}

/* ===== BACKPACK MODAL ===== */
.backpack-modal {
    background: linear-gradient(135deg, #d4a574 0%, #c89860 50%, #b8885a 100%);
    border: 6px solid #8b6f47;
    border-radius: 20px;
    box-shadow: 0 15px 50px rgba(0, 0, 0, 0.8),
        inset 0 2px 10px rgba(255, 255, 255, 0.2);
    width: 90%;
    max-width: 900px;
    max-height: 85vh;
    overflow: hidden;
    position: relative;
    animation: modalSlideIn 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

@keyframes modalSlideIn {
    from {
        transform: scale(0.7) translateY(-50px);
        opacity: 0;
    }

    to {
        transform: scale(1) translateY(0);
        opacity: 1;
    }
}

.modal-header {
    background: linear-gradient(to bottom, #8b6f47, #6d5638);
    padding: 20px 30px;
    border-bottom: 4px solid #5d4a2f;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.4);
}

.modal-header h2 {
    font-family: 'Shojumaru', cursive;
    font-size: 2.2em;
    color: #fff;
    text-shadow: 3px 3px 0 #000,
        -1px -1px 0 #000,
        1px -1px 0 #000,
        -1px 1px 0 #000,
        0 0 15px rgba(255, 215, 0, 0.5);
    margin: 0;
}

.modal-close {
    background: #d32f2f;
    border: 3px solid #8b0000;
    color: #fff;
    font-size: 1.8em;
    font-weight: bold;
    width: 45px;
    height: 45px;
    border-radius: 50%;
    cursor: pointer;
    transition: all 0.2s ease;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.4);
    display: flex;
    align-items: center;
    justify-content: center;
}

.modal-close:hover {
    background: #ff5252;
    transform: rotate(90deg) scale(1.1);
    box-shadow: 0 6px 12px rgba(255, 0, 0, 0.6);
}

.modal-close:active {
    transform: rotate(90deg) scale(0.95);
}

.modal-body {
    padding: 30px;
    overflow-y: auto;
    max-height: calc(85vh - 100px);
    background: linear-gradient(to bottom, rgba(255, 255, 255, 0.1), rgba(0, 0, 0, 0.1));
}

/* ===== INVENTORY GRID ===== */
.inventory-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(90px, 1fr));
    gap: 15px;
    padding: 10px;
}

.inventory-slot {
    width: 90px;
    height: 90px;
    background: linear-gradient(135deg, #8b0000, #a52a2a);
    border: 4px solid #5d0000;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.6),
        0 4px 10px rgba(0, 0, 0, 0.5);
}

.inventory-slot:hover {
    transform: translateY(-5px) scale(1.05);
    box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.6),
        0 8px 20px rgba(255, 215, 0, 0.4);
    border-color: #ffd700;
}

.inventory-slot.empty::before {
    content: 'üîí';
    font-size: 2.5em;
    opacity: 0.3;
    filter: grayscale(1);
}

.inventory-slot.has-item {
    background: linear-gradient(135deg, #1a472a, #2e7d32);
    border-color: #1b5e20;
}

.inventory-slot.has-item:hover {
    border-color: #4caf50;
}

.item-icon {
    font-size: 3em;
    filter: drop-shadow(2px 2px 4px rgba(0, 0, 0, 0.8));
}

.item-count {
    position: absolute;
    bottom: 5px;
    right: 8px;
    background: rgba(0, 0, 0, 0.85);
    color: #fff;
    font-size: 0.9em;
    font-weight: bold;
    padding: 2px 6px;
    border-radius: 8px;
    border: 2px solid #ffd700;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.6);
}

/* ===== ADMIN PANEL ===== */
#admin-trigger {
    position: fixed;
    bottom: 20px;
    right: 20px;
    width: 50px;
    height: 50px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border: 3px solid #4a5568;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.8em;
    cursor: pointer;
    z-index: 8888;
    transition: all 0.3s ease;
    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
}

#admin-trigger:hover {
    transform: scale(1.15) rotate(90deg);
    box-shadow: 0 6px 25px rgba(102, 126, 234, 0.7);
}

.admin-modal {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border: 6px solid #4a5568;
    border-radius: 20px;
    box-shadow: 0 15px 50px rgba(0, 0, 0, 0.8),
        inset 0 2px 10px rgba(255, 255, 255, 0.2);
    width: 90%;
    max-width: 500px;
    overflow: hidden;
    position: relative;
    animation: modalSlideIn 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

.admin-input-group {
    display: flex;
    flex-direction: column;
    gap: 15px;
    padding: 10px;
}

.admin-input-group label {
    font-family: 'Shojumaru', cursive;
    font-size: 1.3em;
    color: #fff;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
}

.admin-input-group input {
    padding: 12px 15px;
    font-size: 1.2em;
    border: 3px solid #4a5568;
    border-radius: 10px;
    background: rgba(255, 255, 255, 0.95);
    color: #333;
    font-weight: bold;
    transition: all 0.3s ease;
}

.admin-input-group input:focus {
    outline: none;
    border-color: #ffd700;
    box-shadow: 0 0 15px rgba(255, 215, 0, 0.5);
}

.admin-btn {
    padding: 15px 30px;
    font-size: 1.3em;
    font-weight: bold;
    background: linear-gradient(to bottom, #ffd700, #ffb700);
    border: 3px solid #8b6f00;
    border-radius: 12px;
    color: #000;
    cursor: pointer;
    transition: all 0.2s ease;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.4);
    text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.5);
}

.admin-btn:hover {
    background: linear-gradient(to bottom, #ffed4e, #ffd700);
    transform: translateY(-2px);
    box-shadow: 0 6px 15px rgba(255, 215, 0, 0.6);
}

.admin-btn:active {
    transform: translateY(0);
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.4);
}

/* Elemental Cycle Guide */
.elemental-cycle-guide {
    position: absolute;
    top: 100px;
    right: 20px;
    width: 250px;
    height: auto;
    z-index: 100;
    pointer-events: none;
    filter: drop-shadow(0 0 15px rgba(0, 0, 0, 0.6));
    opacity: 1;
    transition: opacity 0.3s ease;
}

.center-panel:hover .elemental-cycle-guide {
    opacity: 0.7;
}

/* Item Drop Notification - Redesenhada */
.item-drop-notification {
    position: fixed;
    bottom: 120px;
    right: 30px;
    background: linear-gradient(135deg, rgba(45, 27, 0, 0.95) 0%, rgba(93, 58, 26, 0.95) 100%);
    border: 3px solid #ffd700;
    border-radius: 10px;
    padding: 12px 18px;
    z-index: 10000;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.6), 0 0 20px rgba(255, 215, 0, 0.3);
    animation: dropSlideIn 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55), dropFadeOut 0.4s ease-in 2.6s forwards;
    pointer-events: none;
    display: flex;
    align-items: center;
    gap: 12px;
    max-width: 280px;
}

.item-drop-notification img {
    width: 45px;
    height: 45px;
    flex-shrink: 0;
    filter: drop-shadow(0 2px 6px rgba(255, 215, 0, 0.4));
}

.item-drop-notification .drop-content {
    display: flex;
    flex-direction: column;
    gap: 2px;
}

.item-drop-notification .drop-text {
    font-family: 'Bangers', cursive;
    font-size: 1.1em;
    color: #ffd700;
    text-shadow: 1px 1px 3px #000;
    letter-spacing: 0.5px;
    line-height: 1;
}

.item-drop-notification .item-name {
    font-family: 'Roboto', sans-serif;
    font-size: 0.95em;
    font-weight: 500;
    color: #f0e6d2;
    text-shadow: 1px 1px 2px #000;
    line-height: 1.2;
}

@keyframes dropSlideIn {
    0% {
        opacity: 0;
        transform: translateX(100px);
    }

    100% {
        opacity: 1;
        transform: translateX(0);
    }
}

@keyframes dropFadeOut {
    0% {
        opacity: 1;
        transform: translateX(0);
    }

    100% {
        opacity: 0;
        transform: translateX(50px);
    }
}

/* Item Icon Image in Inventory */
.item-icon-img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
}

/* ===== SISTEMA DE MOCHILA - DESIGN MODERNO E PROFISSIONAL ===== */

/* Modal Backdrop */
.backpack-modal {
    display: flex !important;
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
    width: 100vw !important;
    height: 100vh !important;
    background: rgba(0, 0, 0, 0.5);
    backdrop-filter: blur(4px);
    z-index: 99999 !important;
    justify-content: center !important;
    align-items: center !important;
    animation: fadeIn 0.2s ease-out;
    visibility: hidden;
    opacity: 0;
    transition: opacity 0.2s, visibility 0.2s;
}

.backpack-modal.active {
    visibility: visible;
    opacity: 1;
}

@keyframes fadeIn {
    from {
        opacity: 0;
    }

    to {
        opacity: 1;
    }
}

/* Container Principal */
.backpack-container {
    background: linear-gradient(145deg, #1a1a1a 0%, #2d2d2d 100%);
    border: 1px solid #404040;
    border-radius: 12px;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.8), 0 0 0 1px rgba(255, 255, 255, 0.05);
    max-width: 700px;
    width: 90%;
    max-height: 85vh;
    overflow: hidden;
    animation: slideUp 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    margin: auto;
}

@keyframes slideUp {
    from {
        opacity: 0;
        transform: translateY(30px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Header */
.backpack-header {
    background: linear-gradient(135deg, #2a2a2a 0%, #1f1f1f 100%);
    border-bottom: 1px solid #404040;
    padding: 20px 25px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.backpack-title {
    display: flex;
    align-items: center;
    gap: 12px;
    font-family: 'Roboto', sans-serif;
    font-size: 1.4em;
    font-weight: 600;
    color: #e0e0e0;
    letter-spacing: 0.5px;
}

.close-backpack {
    background: transparent;
    border: none;
    color: #999;
    font-size: 1.8em;
    cursor: pointer;
    width: 36px;
    height: 36px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 6px;
    transition: all 0.2s;
}

.close-backpack:hover {
    background: rgba(255, 255, 255, 0.05);
    color: #fff;
}

/* Body */
.backpack-body {
    padding: 25px;
    max-height: calc(85vh - 80px);
    overflow-y: auto;
}

.backpack-body::-webkit-scrollbar {
    width: 8px;
}

.backpack-body::-webkit-scrollbar-track {
    background: #1a1a1a;
    border-radius: 4px;
}

.backpack-body::-webkit-scrollbar-thumb {
    background: #404040;
    border-radius: 4px;
}

.backpack-body::-webkit-scrollbar-thumb:hover {
    background: #505050;
}

/* Grid de Invent√°rio */
.inventory-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(70px, 1fr));
    gap: 10px;
    padding: 5px;
}

/* Slots */
.inventory-slot {
    aspect-ratio: 1;
    background: linear-gradient(145deg, #242424 0%, #1a1a1a 100%);
    border: 1px solid #333;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    transition: all 0.2s;
    cursor: default;
    box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.5);
}

.inventory-slot.empty {
    opacity: 0.4;
}

.inventory-slot.empty:hover {
    background: linear-gradient(145deg, #2a2a2a 0%, #202020 100%);
    border-color: #3a3a3a;
}

.inventory-slot.has-item {
    background: linear-gradient(145deg, #2d2d2d 0%, #232323 100%);
    border-color: #4a4a4a;
    opacity: 1;
    cursor: pointer;
}

.inventory-slot.has-item:hover {
    background: linear-gradient(145deg, #353535 0%, #2a2a2a 100%);
    border-color: #5a5a5a;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.6), inset 0 1px 2px rgba(255, 255, 255, 0.05);
}

/* √çcone do Item */
.item-icon {
    font-size: 2.2em;
    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.5));
}

/* Contador de Itens */
.item-count {
    position: absolute;
    bottom: 4px;
    right: 4px;
    background: rgba(0, 0, 0, 0.85);
    color: #fff;
    font-family: 'Roboto', sans-serif;
    font-size: 0.75em;
    font-weight: 600;
    padding: 2px 6px;
    border-radius: 4px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
    line-height: 1;
}

/* √çcone da Mochila no Header */
.backpack-icon {
    cursor: pointer;
    font-size: 0.9em;
    transition: transform 0.2s;
    display: inline-block;
    margin-left: 8px;
}

.backpack-icon:hover {
    transform: scale(1.15);
}

----- FILE: static/js/game.js  (sha1:c383fffdb132, bytes:11091) -----
// Estado Global do Jogo
const gameState = {
    gold: 0,
    totalDps: 0,
    clickDamage: 1,
    currentZone: 1,
    monstersKilledInZone: 0,
    heroes: [], // { id, level, currentDps, cost }
    currentMonster: {
        hp: 10,
        maxHp: 10,
        name: "Bandido",
        img: ""
    },
    statistics: {
        totalClicks: 0,
        totalKills: 0,
        maxZone: 1
    }
};

// Configura√ß√µes
const TICKS_PER_SECOND = 10;
let autoSaveInterval;

// Inicializa√ß√£o
function initGame() {
    loadGame();
    setupHeroes();
    spawnMonster();
    updateUI();
    startGameLoop();
    setupEventListeners();

    // Auto-save a cada 30s
    autoSaveInterval = setInterval(saveGame, 30000);
}

// Configura lista de her√≥is baseada no game_data.js
function setupHeroes() {
    gameState.heroes = heroesData.map(heroData => {
        // Tenta carregar estado salvo ou inicia do zero
        const savedHero = gameState.savedHeroes ? gameState.savedHeroes.find(h => h.id === heroData.id) : null;
        return {
            ...heroData,
            level: savedHero ? savedHero.level : 0,
            currentCost: savedHero ? calculateCost(heroData.baseCost, savedHero.level) : heroData.baseCost,
            currentDps: savedHero ? heroData.baseDps * savedHero.level : 0
        };
    });
    recalculateTotalDps();
    renderHeroesList();
}

function calculateCost(baseCost, currentLevel) {
    return Math.floor(baseCost * Math.pow(1.07, currentLevel));
}

function recalculateTotalDps() {
    gameState.totalDps = gameState.heroes.reduce((sum, hero) => sum + hero.currentDps, 0);
    // Dano de clique √© 1 + 1% do DPS total (m√≠nimo 1)
    gameState.clickDamage = 1 + Math.ceil(gameState.totalDps * 0.01);
}

// Renderiza√ß√£o da Lista de Her√≥is
function renderHeroesList() {
    const listContainer = document.getElementById('heroes-list');
    listContainer.innerHTML = '';

    gameState.heroes.forEach(hero => {
        const item = document.createElement('div');
        item.className = 'hero-item';
        item.id = `hero-${hero.id}`;
        item.dataset.id = hero.id;
        item.onclick = () => buyHero(hero.id);

        item.innerHTML = `
            <div class="hero-img" style="background-image: url('static/img/${hero.img}'); background-size: cover;"></div>
            <div class="hero-info">
                <div class="hero-name">${hero.name} <span class="hero-level">Nv. ${hero.level}</span></div>
                <div class="hero-stats">DPS: ${formatNumber(hero.baseDps * (hero.level || 1))} | +${formatNumber(hero.baseDps)} DPS/Lv</div>
                <div class="hero-cost">Custo: ${formatNumber(hero.currentCost)} Ryo</div>
            </div>
        `;
        listContainer.appendChild(item);
    });
}

function updateHeroUI(heroId) {
    const hero = gameState.heroes.find(h => h.id === heroId);
    if (!hero) return;

    const item = document.getElementById(`hero-${heroId}`);
    if (item) {
        item.querySelector('.hero-level').textContent = `Nv. ${hero.level}`;
        item.querySelector('.hero-cost').textContent = `Custo: ${formatNumber(hero.currentCost)} Ryo`;

        // Verifica se pode comprar visualmente
        if (gameState.gold >= hero.currentCost) {
            item.classList.remove('disabled');
        } else {
            item.classList.add('disabled');
        }
    }
}

// Mec√¢nica de Compra
function buyHero(heroId) {
    const hero = gameState.heroes.find(h => h.id === heroId);
    if (hero && gameState.gold >= hero.currentCost) {
        gameState.gold -= hero.currentCost;
        hero.level++;
        hero.currentCost = calculateCost(hero.baseCost, hero.level);
        hero.currentDps = hero.baseDps * hero.level;

        recalculateTotalDps();
        updateUI();
        renderHeroesList(); // Re-render para atualizar tudo
        logMessage(`Voc√™ contratou/treinou ${hero.name}!`);
    }
}

// Spawning de Monstros
function spawnMonster() {
    const zoneMultiplier = Math.pow(zoneData.hpMultiplier, gameState.currentZone - 1);
    gameState.currentMonster.maxHp = Math.floor(zoneData.baseHp * zoneMultiplier);
    gameState.currentMonster.hp = gameState.currentMonster.maxHp;

    const randomName = monsterNames[Math.floor(Math.random() * monsterNames.length)];
    gameState.currentMonster.name = `${randomName} (Lv. ${gameState.currentZone})`;

    // Atualiza visual
    document.getElementById('monster-name').textContent = gameState.currentMonster.name;
    // URL placeholder aleat√≥ria para monstros, em um app real usaria assets locais
    const monsterId = Math.floor(Math.random() * 10) + 1;
    document.getElementById('monster-img').src = `https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/${monsterId}.png`; // Placeholder tempor√°rio

    updateMonsterUI();
}

function damageMonster(amount, isClick = false) {
    gameState.currentMonster.hp -= amount;
    if (gameState.currentMonster.hp < 0) gameState.currentMonster.hp = 0;

    if (isClick) {
        createDamageNumber(amount, true);
        animateMonsterShake();
        gameState.statistics.totalClicks++;
    }

    if (gameState.currentMonster.hp <= 0) {
        monterDeath();
    }

    updateMonsterUI();
}

function monterDeath() {
    // Recompensa
    const zoneMultiplier = Math.pow(zoneData.coinsMultiplier, gameState.currentZone - 1);
    const goldDrop = Math.ceil(Math.random() * 5 * zoneMultiplier); // Base 1-5 * multi

    gameState.gold += goldDrop;
    gameState.statistics.totalKills++;
    gameState.monstersKilledInZone++;

    logMessage(`Monstro derrotado! +${formatNumber(goldDrop)} Ryo`);

    // Progress√£o de Zona
    if (gameState.monstersKilledInZone >= zoneData.monstersPerZone) {
        gameState.currentZone++;
        gameState.monstersKilledInZone = 0;
        if (gameState.currentZone > gameState.statistics.maxZone) {
            gameState.statistics.maxZone = gameState.currentZone;
            logMessage(`AVAN√áOU PARA ZONA ${gameState.currentZone}!`);
        }
    }

    spawnMonster();
    updateUI();
}

// Loop Principal
function startGameLoop() {
    setInterval(() => {
        // Dano autom√°tico (DPS) aplicado a cada d√©cimo de segundo
        if (gameState.totalDps > 0) {
            const dpsTick = gameState.totalDps / TICKS_PER_SECOND;
            if (dpsTick > 0 && gameState.currentMonster.hp > 0) {
                damageMonster(dpsTick, false);
            }
        }

        // Verifica bot√µes habilitados
        checkBuyButtons();

    }, 1000 / TICKS_PER_SECOND);
}

function checkBuyButtons() {
    gameState.heroes.forEach(hero => {
        const item = document.getElementById(`hero-${hero.id}`);
        if (item) {
            if (gameState.gold >= hero.currentCost) {
                item.classList.remove('disabled');
            } else {
                item.classList.add('disabled');
            }
        }
    });
}

// Event Listeners
function setupEventListeners() {
    const clickTarget = document.getElementById('click-target');
    clickTarget.addEventListener('mousedown', () => {
        damageMonster(gameState.clickDamage, true);
        clickTarget.querySelector('.monster-visual').style.transform = "scale(0.9)";
    });

    clickTarget.addEventListener('mouseup', () => {
        clickTarget.querySelector('.monster-visual').style.transform = "scale(1)";
    });
}

// UI Helpers
function updateUI() {
    document.getElementById('player-gold').textContent = formatNumber(Math.floor(gameState.gold));
    document.getElementById('total-dps').textContent = formatNumber(Math.floor(gameState.totalDps));
    document.getElementById('click-damage').textContent = formatNumber(Math.floor(gameState.clickDamage));

    document.getElementById('current-zone').textContent = gameState.currentZone;
    document.getElementById('monsters-killed').textContent = gameState.monstersKilledInZone;

    document.getElementById('stat-killed').textContent = formatNumber(gameState.statistics.totalKills);
    document.getElementById('stat-clicks').textContent = formatNumber(gameState.statistics.totalClicks);
    document.getElementById('stat-max-zone').textContent = gameState.statistics.maxZone;
}

function updateMonsterUI() {
    const pct = (gameState.currentMonster.hp / gameState.currentMonster.maxHp) * 100;
    document.getElementById('hp-fill').style.width = `${pct}%`;
    document.getElementById('current-hp').textContent = formatNumber(Math.ceil(gameState.currentMonster.hp));
}

function createDamageNumber(amount, isCrit) {
    const container = document.getElementById('damage-numbers-container');
    const el = document.createElement('div');
    el.className = 'damage-number';
    if (isCrit && Math.random() < 0.05) { // 5% chance crit visual
        el.classList.add('damage-crit');
        amount *= 2; // Cr√≠tico visual simples
    }
    el.textContent = formatNumber(Math.floor(amount));

    // Posi√ß√£o aleat√≥ria perto do centro
    const x = 50 + (Math.random() * 20 - 10);
    const y = 50 + (Math.random() * 20 - 10);

    el.style.left = `${x}%`;
    el.style.top = `${y}%`;

    container.appendChild(el);

    setTimeout(() => el.remove(), 1000);
}

function animateMonsterShake() {
    const visual = document.querySelector('.monster-visual');
    visual.classList.remove('shake');
    void visual.offsetWidth; // Trigger reflow
    visual.classList.add('shake');
}

function logMessage(msg) {
    const log = document.getElementById('battle-log');
    const p = document.createElement('p');
    p.textContent = msg;
    log.prepend(p);
    if (log.children.length > 20) log.lastChild.remove();
}

function formatNumber(num) {
    if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';
    if (num >= 1000) return (num / 1000).toFixed(1) + 'k';
    return Math.floor(num).toString();
}

// Persistence
function saveGame() {
    const saveObj = {
        gold: gameState.gold,
        currentZone: gameState.currentZone,
        savedHeroes: gameState.heroes.map(h => ({ id: h.id, level: h.level })),
        statistics: gameState.statistics
    };
    localStorage.setItem('narutoClickerSave', JSON.stringify(saveObj));
    // console.log("Jogo Salvo");
}

function loadGame() {
    const saveStr = localStorage.getItem('narutoClickerSave');
    if (saveStr) {
        try {
            const saved = JSON.parse(saveStr);
            gameState.gold = saved.gold || 0;
            gameState.currentZone = saved.currentZone || 1;
            gameState.savedHeroes = saved.savedHeroes || [];
            gameState.statistics = { ...gameState.statistics, ...saved.statistics };
            logMessage("Progresso carregado!");
        } catch (e) {
            console.error("Erro ao carregar save", e);
        }
    }
}

// Start
window.onload = initGame;


----- FILE: static/js/game_data.js  (sha1:ee8ff0e04b9f, bytes:4368) -----
const heroesData = [
    { id: 1, name: "Iruka Umino", baseCost: 10, baseDps: 1, img: "iruka.png" },
    { id: 2, name: "Mizuki", baseCost: 100, baseDps: 5, img: "mizuki.png" },
    { id: 3, name: "Konohamaru Sarutobi", baseCost: 500, baseDps: 12, img: "konohamaru.png" },
    { id: 4, name: "Ebisu", baseCost: 1000, baseDps: 25, img: "ebisu.png" },
    { id: 5, name: "Tenten", baseCost: 2500, baseDps: 50, img: "tenten.png" },
    { id: 6, name: "Ino Yamanaka", baseCost: 5000, baseDps: 80, img: "ino.png" },
    { id: 7, name: "Kiba Inuzuka", baseCost: 12000, baseDps: 150, img: "kiba.png" },
    { id: 8, name: "Shino Aburame", baseCost: 25000, baseDps: 300, img: "shino.png" },
    { id: 9, name: "Hinata Hyuga (Genin)", baseCost: 60000, baseDps: 550, img: "hinata_genin.png" },
    { id: 10, name: "Choji Akimichi", baseCost: 150000, baseDps: 1000, img: "choji.png" },
    { id: 11, name: "Shikamaru Nara", baseCost: 400000, baseDps: 2200, img: "shikamaru.png" },
    { id: 12, name: "Sakura Haruno (Genin)", baseCost: 1000000, baseDps: 4500, img: "sakura_genin.png" },
    { id: 13, name: "Sasuke Uchiha (Genin)", baseCost: 2500000, baseDps: 9000, img: "sasuke_genin.png" },
    { id: 14, name: "Naruto Uzumaki (Genin)", baseCost: 6000000, baseDps: 18000, img: "naruto_genin.png" },
    { id: 15, name: "Haku", baseCost: 15000000, baseDps: 40000, img: "haku.png" },
    { id: 16, name: "Zabuza Momochi", baseCost: 40000000, baseDps: 90000, img: "zabuza.png" },
    { id: 17, name: "Rock Lee (Port√µes)", baseCost: 100000000, baseDps: 200000, img: "rocklee.png" },
    { id: 18, name: "Neji Hyuga", baseCost: 300000000, baseDps: 500000, img: "neji.png" },
    { id: 19, name: "Gaara do Deserto", baseCost: 800000000, baseDps: 1200000, img: "gaara.png" },
    { id: 20, name: "Kabuto Yakushi", baseCost: 2000000000, baseDps: 3000000, img: "kabuto.png" },
    { id: 21, name: "Kimimaro", baseCost: 5000000000, baseDps: 7000000, img: "kimimaro.png" },
    { id: 22, name: "Yamato", baseCost: 12000000000, baseDps: 15000000, img: "yamato.png" },
    { id: 23, name: "Sai", baseCost: 30000000000, baseDps: 35000000, img: "sai.png" },
    { id: 24, name: "Asuma Sarutobi", baseCost: 80000000000, baseDps: 85000000, img: "asuma.png" },
    { id: 25, name: "Kakashi Hatake", baseCost: 200000000000, baseDps: 200000000, img: "kakashi.png" },
    { id: 26, name: "Might Guy (7 Port√µes)", baseCost: 500000000000, baseDps: 500000000, img: "guy.png" },
    { id: 27, name: "Kisame Hoshigaki", baseCost: 1500000000000, baseDps: 1200000000, img: "kisame.png" },
    { id: 28, name: "Deidara", baseCost: 4000000000000, baseDps: 3000000000, img: "deidara.png" },
    { id: 29, name: "Sasori", baseCost: 10000000000000, baseDps: 7000000000, img: "sasori.png" },
    { id: 30, name: "Kakuzu", baseCost: 25000000000000, baseDps: 15000000000, img: "kakuzu.png" },
    { id: 31, name: "Hidan", baseCost: 70000000000000, baseDps: 40000000000, img: "hidan.png" },
    { id: 32, name: "Itachi Uchiha", baseCost: 200000000000000, baseDps: 100000000000, img: "itachi.png" },
    { id: 33, name: "Jiraiya", baseCost: 600000000000000, baseDps: 300000000000, img: "jiraiya.png" },
    { id: 34, name: "Orochimaru", baseCost: 2000000000000000, baseDps: 800000000000, img: "orochimaru.png" },
    { id: 35, name: "Tsunade Senju", baseCost: 7000000000000000, baseDps: 2500000000000, img: "tsunade.png" },
    { id: 36, name: "Pain (Nagato)", baseCost: 25000000000000000, baseDps: 8000000000000, img: "pain.png" },
    { id: 37, name: "Minato Namikaze", baseCost: 100000000000000000, baseDps: 30000000000000, img: "minato.png" },
    { id: 38, name: "Hashirama Senju", baseCost: 500000000000000000, baseDps: 150000000000000, img: "hashirama.png" },
    { id: 39, name: "Madara Uchiha (Rikudou)", baseCost: 2000000000000000000, baseDps: 800000000000000, img: "madara.png" },
    { id: 40, name: "Naruto (Modo Baryon)", baseCost: 10000000000000000000, baseDps: 5000000000000000, img: "naruto_baryon.png" }
];

const zoneData = {
    baseHp: 10,
    hpMultiplier: 1.55, // HP cresce 55% por level
    coinsMultiplier: 1.5,
    monstersPerZone: 10
};

const monsterNames = [
    "Bandido", "Ninja Renegado", "Zetsu Branco", "Clone das Sombras", "Marionete", 
    "Cobra Gigante", "Sapo Gigante", "Lesma Gigante", "Corvo", "Guerreiro Susanoo"
];


----- FILE: static/js/game_data_v3.js  (sha1:ec69e900d8ca, bytes:10523) -----
const heroesData = [
    { id: 1, name: "Naruto Uzumaki", baseCost: 10, baseDps: 1, img: "./static/img/heroes/icons/naruto_icon.png", focus: "center center", element: "wind" },
    { id: 2, name: "Sasuke Uchiha", baseCost: 100, baseDps: 5, img: "./static/img/heroes/icons/sasuke_icon.png", focus: "center center", element: "fire" },
    { id: 3, name: "Sakura Haruno", baseCost: 500, baseDps: 12, img: "./static/img/heroes/icons/sakura_icon.png", focus: "center center", element: "water" },
    { id: 4, name: "Kiba Inuzuka", baseCost: 1000, baseDps: 25, img: "./static/img/heroes/icons/kiba_icon.png", element: "wind" },
    { id: 5, name: "Shino Aburame", baseCost: 2500, baseDps: 50, img: "./static/img/heroes/icons/shino_icon.png", element: "water" },
    { id: 6, name: "Hinata Hyuga", baseCost: 5000, baseDps: 80, img: "./static/img/heroes/icons/hinata_icon.png", element: "water" },
    { id: 7, name: "Shikamaru Nara", baseCost: 12000, baseDps: 150, img: "./static/img/heroes/icons/shikamaru_icon.png", element: "earth" },
    { id: 8, name: "Choji Akimichi", baseCost: 25000, baseDps: 300, img: "./static/img/heroes/icons/choji_icon.png", element: "fire" },
    { id: 9, name: "Ino Yamanaka", baseCost: 60000, baseDps: 550, img: "./static/img/heroes/icons/ino_icon.png", element: "fire" },
    { id: 10, name: "Rock Lee", baseCost: 150000, baseDps: 1000, img: "./static/img/heroes/icons/lee_icon.png", element: null },
    { id: 11, name: "Tenten", baseCost: 400000, baseDps: 2200, img: "./static/img/heroes/icons/tenten_icon.png", element: "lightning" },
    { id: 12, name: "Neji", baseCost: 1000000, baseDps: 4500, img: "./static/img/heroes/icons/neji_icon.png", element: "lightning" },
    { id: 13, name: "Gaara", baseCost: 2500000, baseDps: 9000, img: "./static/img/heroes/icons/gaara_icon.png", element: "earth" },
    { id: 14, name: "Temari", baseCost: 6000000, baseDps: 18000, img: "./static/img/heroes/icons/temari_icon.png", element: "wind" },
    { id: 15, name: "Kankuro", baseCost: 15000000, baseDps: 40000, img: "./static/img/heroes/icons/kankuro_icon.png", element: "earth" },
    { id: 16, name: "Iruka Umino", baseCost: 40000000, baseDps: 90000, img: "https://placehold.co/100x100/4a3b2a/ffffff?text=Iruka" },
    { id: 17, name: "Mizuki", baseCost: 100000000, baseDps: 200000, img: "https://placehold.co/100x100/555555/ffffff?text=Mizuki" },
    { id: 18, name: "Konohamaru", baseCost: 300000000, baseDps: 500000, img: "https://placehold.co/100x100/ffd700/000000?text=Konohamaru" },
    { id: 19, name: "Haku", baseCost: 800000000, baseDps: 1200000, img: "https://placehold.co/100x100/add8e6/000000?text=Haku" },
    { id: 20, name: "Zabuza", baseCost: 2000000000, baseDps: 3000000, img: "https://placehold.co/100x100/2f4f4f/ffffff?text=Zabuza" },
    { id: 21, name: "Kabuto", baseCost: 5000000000, baseDps: 7000000, img: "https://placehold.co/100x100/4b0082/ffffff?text=Kabuto" },
    { id: 22, name: "Kimimaro", baseCost: 12000000000, baseDps: 15000000, img: "https://placehold.co/100x100/f5f5f5/000000?text=Kimimaro" },
    { id: 23, name: "Itachi", baseCost: 30000000000, baseDps: 35000000, img: "https://placehold.co/100x100/000000/ff0000?text=Itachi" },
    { id: 24, name: "Kisame", baseCost: 80000000000, baseDps: 85000000, img: "https://placehold.co/100x100/000080/ffffff?text=Kisame" },
    { id: 25, name: "Jiraiya", baseCost: 200000000000, baseDps: 200000000, img: "https://placehold.co/100x100/8b4513/ffffff?text=Jiraiya" },
    { id: 26, name: "Tsunade", baseCost: 500000000000, baseDps: 500000000, img: "https://placehold.co/100x100/98fb98/000000?text=Tsunade" },
    { id: 27, name: "Orochimaru", baseCost: 1500000000000, baseDps: 1200000000, img: "https://placehold.co/100x100/483d8b/ffffff?text=Orochimaru" },
    { id: 28, name: "Kakashi", baseCost: 4000000000000, baseDps: 3000000000, img: "https://placehold.co/100x100/778899/ffffff?text=Kakashi" },
    { id: 29, name: "Guy", baseCost: 10000000000000, baseDps: 7000000000, img: "https://placehold.co/100x100/006400/ffffff?text=Might+Guy" },
    { id: 30, name: "Asuma", baseCost: 25000000000000, baseDps: 15000000000, img: "https://placehold.co/100x100/2f4f4f/ffffff?text=Asuma" },
    { id: 31, name: "Yamato", baseCost: 70000000000000, baseDps: 40000000000, img: "https://placehold.co/100x100/8b4513/ffffff?text=Yamato" },
    { id: 32, name: "Sai", baseCost: 200000000000000, baseDps: 100000000000, img: "https://placehold.co/100x100/000000/ffffff?text=Sai" },
    { id: 33, name: "Deidara", baseCost: 600000000000000, baseDps: 300000000000, img: "https://placehold.co/100x100/ffd700/000000?text=Deidara" },
    { id: 34, name: "Sasori", baseCost: 2000000000000000, baseDps: 800000000000, img: "https://placehold.co/100x100/8b0000/ffffff?text=Sasori" },
    { id: 35, name: "Hidan", baseCost: 7000000000000000, baseDps: 2500000000000, img: "https://placehold.co/100x100/dc143c/ffffff?text=Hidan" },
    { id: 36, name: "Kakuzu", baseCost: 25000000000000000, baseDps: 8000000000000, img: "https://placehold.co/100x100/2f4f4f/ffffff?text=Kakuzu" },
    { id: 37, name: "Pain", baseCost: 100000000000000000, baseDps: 30000000000000, img: "https://placehold.co/100x100/ff4500/ffffff?text=Pain" },
    { id: 38, name: "Konan", baseCost: 500000000000000000, baseDps: 150000000000000, img: "https://placehold.co/100x100/4169e1/ffffff?text=Konan" },
    { id: 39, name: "Obito", baseCost: 2000000000000000000, baseDps: 800000000000000, img: "https://placehold.co/100x100/4b0082/ffffff?text=Obito" },
    { id: 40, name: "Madara", baseCost: 10000000000000000000, baseDps: 5000000000000000, img: "https://placehold.co/100x100/800000/ffffff?text=Madara" }
];

// Defini√ß√£o Manual de Skills para os Principais (Fiel ao Anime)
const specificUpgrades = {
    1: [ // Naruto
        { id: "h1_u1", reqLevel: 20, type: "SELF_DPS_MULT", value: 2, costMultiplier: 10, icon: "./static/img/skills/skill_1_1.png", name: "Kage Bunshin no Jutsu", desc: "Dano de Clique x2" },
        { id: "h1_u2", reqLevel: 40, type: "SELF_DPS_MULT", value: 2, costMultiplier: 50, icon: "./static/img/skills/skill_1_2.png", name: "Tajuu Kage Bunshin", desc: "Dano de Clique x2" },
        { id: "h1_u3", reqLevel: 60, type: "GLOBAL_DPS_MULT", value: 1.1, costMultiplier: 200, icon: "./static/img/skills/skill_1_3.png", name: "Rasengan", desc: "DPS de Todos +10%" },
        { id: "h1_u4", reqLevel: 80, type: "CRIT_CHANCE", value: 0.01, costMultiplier: 1000, icon: "./static/img/skills/skill_1_4.png", name: "Chakra da Kyuubi", desc: "Chance Cr√≠tica +1%" }
    ],
    2: [ // Sasuke
        { id: "h2_u1", reqLevel: 20, type: "SELF_DPS_MULT", value: 2, costMultiplier: 10, icon: "./static/img/skills/skill_3_1.png", name: "Sharingan", desc: "DPS do Sasuke x2" },
        { id: "h2_u2", reqLevel: 40, type: "SELF_DPS_MULT", value: 2, costMultiplier: 50, icon: "./static/img/skills/skill_3_2.png", name: "Chidori", desc: "DPS do Sasuke x2" },
        { id: "h2_u3", reqLevel: 60, type: "GLOBAL_DPS_MULT", value: 1.1, costMultiplier: 200, icon: "./static/img/skills/skill_3_3.png", name: "Katon: Goukakyuu no Jutsu", desc: "DPS de Todos +10%" },
        { id: "h2_u4", reqLevel: 80, type: "CRIT_CHANCE", value: 0.01, costMultiplier: 1000, icon: "./static/img/skills/skill_3_4.png", name: "Shurikenjutsu Uchiha", desc: "Chance Cr√≠tica +1%" }
    ],
    3: [ // Sakura
        { id: "h3_u1", reqLevel: 20, type: "SELF_DPS_MULT", value: 2, costMultiplier: 10, icon: "./static/img/skills/skill_2_1.png", name: "Controle Preciso de Chakra", desc: "DPS da Sakura x2" },
        { id: "h3_u2", reqLevel: 40, type: "GLOBAL_DPS_MULT", value: 1.1, costMultiplier: 50, icon: "./static/img/skills/skill_2_2.png", name: "Golpe de F√¥r√ßa Concentrada", desc: "DPS de Todos +10%" },
        { id: "h3_u3", reqLevel: 60, type: "SELF_DPS_MULT", value: 2, costMultiplier: 200, icon: "./static/img/skills/skill_2_3.png", name: "An√°lise de Combate", desc: "DPS da Sakura x2" },
        { id: "h3_u4", reqLevel: 80, type: "GLOBAL_DPS_MULT", value: 1.2, costMultiplier: 1000, icon: "./static/img/skills/skill_2_4.png", name: "Resist√™ncia Mental", desc: "DPS de Todos +20%" }
    ]
};

const heroUpgrades = {}; // Map heroId -> Array of upgrades

heroesData.forEach(hero => {
    if (specificUpgrades[hero.id]) {
        heroUpgrades[hero.id] = specificUpgrades[hero.id].map(u => ({ ...u, heroId: hero.id }));
    } else {
        // Gerador Gen√©rico Tem√°tico
        heroUpgrades[hero.id] = [
            {
                id: `h${hero.id}_u1`,
                heroId: hero.id,
                reqLevel: 20,
                type: "SELF_DPS_MULT",
                value: 2,
                costMultiplier: 10,
                icon: "üó°Ô∏è",
                name: `T√©cnica Secreta I`,
                desc: "Dano deste her√≥i x2"
            },
            {
                id: `h${hero.id}_u2`,
                heroId: hero.id,
                reqLevel: 40,
                type: "GLOBAL_DPS_MULT",
                value: 1.1,
                costMultiplier: 50,
                icon: "üìú",
                name: "Estrat√©gia Ninja",
                desc: "DPS de todos +10%"
            },
            {
                id: `h${hero.id}_u3`,
                heroId: hero.id,
                reqLevel: 60,
                type: "SELF_DPS_MULT",
                value: 2,
                costMultiplier: 200,
                icon: "‚ú®",
                name: `T√©cnica Secreta II`,
                desc: "Dano deste her√≥i x2"
            },
            {
                id: `h${hero.id}_u4`,
                heroId: hero.id,
                reqLevel: 80,
                type: "GLOBAL_DPS_MULT",
                value: 1.2, // Buff global gen√©rico forte
                costMultiplier: 1000,
                icon: "üõ°Ô∏è",
                name: "Poder Oculto",
                desc: "DPS de todos +20%"
            }
        ];
    }
});

const zoneData = {
    baseHp: 10,
    hpMultiplier: 2.05,
    coinsMultiplier: 1.5,
    monstersPerZone: 10
};

const monsterNames = ["Ninja de Elite"];

// Lista de varia√ß√µes do Ninja de Elite
const monsterImages = [
    "./static/img/enemies/enemy_main.png",
    "./static/img/enemies/enemy_v4.png",
    "./static/img/enemies/enemy_v5.png",
    "./static/img/enemies/enemy_v6.png"
];

// Imagem do Boss (aparece a cada 5 fases)
const bossImage = "./static/img/enemies/boss.png";


----- FILE: static/js/game_v3.js  (sha1:c32d25ccb42b, bytes:36843) -----
console.log('üéÆ Game v3.js carregado - VERS√ÉO 5 - Boss Timer');
// Estado Global do Jogo
const gameState = {
    gold: 0,
    totalDps: 0,
    clickDamage: 1,
    critChance: 0, // Inicia em 0%
    clickCritMultiplier: 2,
    currentZone: 1,
    monstersKilledInZone: 0,
    heroes: [],
    upgrades: [], // IDs dos upgrades comprados
    currentMonster: {
        hp: 10,
        maxHp: 10,
        name: "Bandido",
        img: ""
    },
    statistics: {
        totalClicks: 0,
        totalKills: 0,
        maxZone: 1
    },
    lastEnemyIndex: -1, // Para evitar repeti√ß√£o consecutiva
    inventory: [], // Mochila de itens
    bossTimer: 30, // Cron√¥metro de boss (30 segundos)
    bossTimerInterval: null // Refer√™ncia ao intervalo do cron√¥metro
};

// Configura√ß√µes
const TICKS_PER_SECOND = 10;
let autoSaveInterval;

// Inicializa√ß√£o
function initGame() {
    loadGame();
    setupHeroes();
    spawnMonster();
    renderArenas();
    updateUI();
    startGameLoop();
    setupEventListeners();

    // Auto-save a cada 30s
    autoSaveInterval = setInterval(saveGame, 30000);
}

// Configura lista de her√≥is baseada no game_data.js
function setupHeroes() {
    gameState.heroes = heroesData.map(heroData => {
        const savedHero = gameState.savedHeroes ? gameState.savedHeroes.find(h => h.id === heroData.id) : null;
        return {
            ...heroData,
            level: savedHero ? savedHero.level : 0,
            currentCost: savedHero ? calculateCost(heroData.baseCost, savedHero.level) : heroData.baseCost,
            currentDps: savedHero ? heroData.baseDps * savedHero.level : 0
        };
    });
    recalculateTotalDps();
    renderHeroesList();
}

function calculateCost(baseCost, currentLevel) {
    return Math.floor(baseCost * Math.pow(1.07, currentLevel));
}

function recalculateTotalDps() {
    let dps = 0;
    let clickCtx = 1;
    let globalMulti = 1;
    let critChanceAcc = 0;

    // Processar Global Upgrades & Crit
    gameState.upgrades.forEach(uId => {
        // Encontrar info do upgrade
        for (const hid in heroUpgrades) {
            const upg = heroUpgrades[hid].find(u => u.id === uId);
            if (upg) {
                if (upg.type === 'GLOBAL_DPS_MULT') globalMulti *= upg.value;
                if (upg.type === 'CRIT_CHANCE') critChanceAcc += upg.value;
            }
        }
    });

    gameState.critChance = critChanceAcc;

    // Calcular DPS Individual com Multiplicadores Self
    gameState.heroes.forEach(hero => {
        let heroDps = hero.baseDps * hero.level;

        // Self Multipliers
        const heroUps = heroUpgrades[hero.id];
        if (heroUps) {
            heroUps.forEach(upg => {
                if (gameState.upgrades.includes(upg.id) && upg.type === 'SELF_DPS_MULT') {
                    heroDps *= upg.value;
                }
            });
        }

        hero.currentDps = heroDps;

        if (hero.id === 1) {
            clickCtx += hero.currentDps;
        } else {
            dps += hero.currentDps;
        }
    });

    gameState.totalDps = dps * globalMulti;
    gameState.clickDamage = clickCtx * globalMulti;
}

// Renderiza√ß√£o da Lista de Her√≥is (Split Layout: Left Name/Img, Right Info)
function renderHeroesList() {
    const listContainer = document.getElementById('heroes-list');
    listContainer.innerHTML = '';

    for (let i = 0; i < gameState.heroes.length; i++) {
        const hero = gameState.heroes[i];
        let status = 'hidden';

        if (i === 0) status = 'revealed';
        else {
            const prevHero = gameState.heroes[i - 1];
            if (prevHero.level > 0) status = 'revealed';
            else {
                if (i === 1) status = 'mystery';
                else {
                    const prevPrevHero = gameState.heroes[i - 2];
                    if (prevPrevHero && prevPrevHero.level > 0) status = 'mystery';
                }
            }
        }

        if (status === 'hidden') break;

        const item = document.createElement('div');
        item.className = 'hero-card-split'; // Usando nova classe de layout
        if (status === 'mystery') item.classList.add('mystery-hero');
        item.id = `hero-${hero.id}`;

        const isLocked = status === 'mystery';

        let displayName = isLocked ? "???" : hero.name;
        // Se estiver bloqueado mostra placeholder, se n√£o mostra a imagem definida (agora full body pro naruto)
        let displayImg = isLocked ? "https://placehold.co/100x100/000000/ffffff?text=?" : hero.img;
        let displayCost = formatNumber(hero.currentCost);
        let dpsVal = hero.currentDps;

        // HTML Structure

        // --- NAME OUTSIDE (Side-by-Side) ---
        // Se estiver bloqueado mostra ???
        // Se disponivel, mostra Nome + Sobrenome (ou apenas nome completo estilizado)
        // O usuario pediu "nome e sobrenome um ao lado do outro".
        // displayName j√° √© "Naruto Uzumaki".

        let elementImg = "";
        if (!isLocked && hero.element) {
            elementImg = `<img src="./static/img/elements/${hero.element}.png" class="hero-element-icon" title="Elemento: ${hero.element}">`;
        }

        let nameTitleHTML = `
            <div class="hero-title-header">
                ${displayName} ${elementImg}
            </div>
        `;

        // --- COLUNA ESQUERDA: APENAS IMAGEM ---
        // Remover nome daqui de dentro
        // Aplicando foco din√¢mico (inteligente) se definido, sen√£o padr√£o topo
        let focusStyle = hero.focus ? `style="object-position: ${hero.focus}"` : '';

        let leftColHTML = `
            <div class="card-left-col">
                <div class="hero-image-wrapper">
                    <img src="${displayImg}" class="hero-full-body-img" alt="${displayName}" ${focusStyle}>
                </div>
            </div>
        `;

        // --- COLUNA DIREITA: NIVEL -> STATUS -> SKILLS -> BOTAO ---

        // 1. N√≠vel
        let levelHTML = isLocked ? `<div class="hero-level-display">???</div>` : `<div class="hero-level-display" id="hero-level-text-${hero.id}">N√≠vel ${hero.level}</div>`;

        // 2. Status (Dano/DPS) agora vai para o OVERLAY
        let statsHTML = "";
        if (isLocked) {
            statsHTML = `<div class="hero-stats-text">???</div>`;
        } else {
            // Calcular o incremento de DPS do pr√≥ximo n√≠vel
            const nextLevelDps = hero.baseDps * Math.pow(1.07, hero.level + 1);
            const dpsIncrement = Math.abs(nextLevelDps - dpsVal);

            if (hero.id === 1) {
                statsHTML = `<div class="stat-line"><strong>Dano de Clique:</strong> <span id="hero-stat-val-${hero.id}">${formatNumber(dpsVal)}</span> <span class="dps-increment">+${formatNumber(dpsIncrement)}</span></div>`;
            } else {
                statsHTML = `<div class="stat-line"><strong>Dano por Segundo:</strong> <span id="hero-stat-val-${hero.id}">${formatNumber(dpsVal)}</span> <span class="dps-increment">+${formatNumber(dpsIncrement)}</span></div>`;
            }
        }

        // 4. Bot√£o de Compra
        let buyButtonHTML = "";
        if (!isLocked) {
            buyButtonHTML = `
                <div class="hero-buy-btn" onclick="buyHero(${hero.id})">
                    <span class="buy-label">UPGRADE</span>
                    <span class="buy-value">üí∞ <span id="hero-cost-text-${hero.id}">${displayCost}</span></span>
                </div>
            `;
        } else {
            buyButtonHTML = `
                <div class="hero-buy-btn locked">
                    <span>BLOQUEADO</span>
                </div>
            `;
        }

        // 3. Skills (NOW BELOW UPGRADE)
        let skillsHTML = '<div class="hero-skills-row">';
        if (!isLocked) {
            const upgrades = heroUpgrades[hero.id];
            if (upgrades) {
                upgrades.forEach(upg => {
                    const isBought = gameState.upgrades.includes(upg.id);
                    const isUnlocked = hero.level >= upg.reqLevel;

                    let upgClass = 'skill-box';
                    if (isBought) upgClass += ' bought';
                    else if (isUnlocked) upgClass += ' available';
                    else upgClass += ' locked';

                    const upgCost = hero.baseCost * upg.costMultiplier;

                    // Handle Image Icons
                    const isImageIcon = upg.icon.startsWith('./') || upg.icon.startsWith('http');
                    const iconContent = isImageIcon ? `<img src="${upg.icon}" class="skill-img-icon">` : upg.icon;

                    skillsHTML += `
                        <div class="${upgClass}" 
                             id="upg-${upg.id}"
                             onclick="buyUpgrade('${upg.id}', ${upgCost}, ${hero.id})">
                             <div class="skill-icon">${iconContent}</div>
                             ${isBought ? '<div class="skill-check">‚úî</div>' : ''}
                             <div class="tooltip">
                                <strong>${upg.name}</strong><br>
                                ${upg.desc}<br>
                                Custo: ${formatNumber(upgCost)}
                             </div>
                        </div>
                    `;
                });
            }
        }
        skillsHTML += '</div>';

        let rightColHTML = `
            <div class="card-right-col">
                ${levelHTML}
                ${skillsHTML}
                ${buyButtonHTML}
            </div>
        `;

        let overlayHTML = `
            <div class="hero-stats-overlay">
                ${statsHTML}
            </div>
        `;

        item.innerHTML = nameTitleHTML + `
            <div class="hero-card-inner-split">
                ${leftColHTML}
                ${rightColHTML}
                ${overlayHTML}
            </div>
        `;

        if (isLocked) {
            item.classList.add('locked-mystery');
        }

        listContainer.appendChild(item);
    }
}

function updateHeroUI(heroId) {
    const hero = gameState.heroes.find(h => h.id === heroId);
    if (!hero) return;

    // Atualizar N√≠vel
    const levelEl = document.getElementById(`hero-level-text-${hero.id}`);
    if (levelEl) levelEl.textContent = `N√≠vel ${hero.level}`;

    // Atualizar Custo
    const costEl = document.getElementById(`hero-cost-text-${hero.id}`);
    if (costEl) costEl.textContent = formatNumber(hero.currentCost);

    // Atualizar Valor de Dano no Overlay
    const statEl = document.getElementById(`hero-stat-val-${hero.id}`);
    if (statEl) statEl.textContent = formatNumber(hero.currentDps);

    // Verificar se desbloqueou algum slot de upgrade (20, 40, 60, 80)
    // Se sim, precisamos re-renderizar para mostrar o quadradinho
    const upgradeThresholds = [20, 40, 60, 80];
    if (upgradeThresholds.includes(hero.level)) {
        renderHeroesList();
    }
}

// Mec√¢nica de Compra de Heroi
function buyHero(heroId) {
    // Note: click event is handled via HTML onclick, arguments passed directly
    const hero = gameState.heroes.find(h => h.id === heroId);

    if (hero && gameState.gold >= hero.currentCost) {
        gameState.gold -= hero.currentCost;
        const oldLevel = hero.level;
        hero.level++;
        hero.currentCost = calculateCost(hero.baseCost, hero.level);
        hero.currentDps = hero.baseDps * hero.level;

        recalculateTotalDps();
        updateUI();

        if (oldLevel === 0) {
            renderHeroesList(); // Desbloqueia pr√≥ximo
        } else {
            updateHeroUI(heroId);
        }
    }
}

// Mec√¢nica de Compra de Upgrade
function buyUpgrade(upgId, cost, heroId) {
    event.stopPropagation(); // Impede borbulhar para compra de heroi
    if (gameState.upgrades.includes(upgId)) return;

    const hero = gameState.heroes.find(h => h.id === heroId);
    if (!hero) return;

    // Verificar requisitos
    const upg = heroUpgrades[heroId].find(u => u.id === upgId);
    if (!upg || hero.level < upg.reqLevel) return;

    if (gameState.gold >= cost) {
        gameState.gold -= cost;
        gameState.upgrades.push(upgId);
        recalculateTotalDps();
        updateUI();
        renderHeroesList();
    }
}

// Arena / Zoning Logic
function changeZone(direction) {
    if (direction === 'next') {
        if (gameState.currentZone < gameState.statistics.maxZone) {
            gameState.currentZone++;
            gameState.monstersKilledInZone = 0;
            spawnMonster();
            renderArenas();
            updateUI();
        }
    } else if (direction === 'prev') {
        if (gameState.currentZone > 1) {
            gameState.currentZone--;
            gameState.monstersKilledInZone = 0;
            spawnMonster();
            renderArenas();
            updateUI();
        }
    }
}

function renderArenas() {
    const container = document.getElementById('arenas-display');
    if (!container) return; // Safety
    container.innerHTML = '';

    let startZone = Math.max(1, gameState.currentZone - 2);
    let endZone = Math.max(gameState.currentZone + 2, gameState.statistics.maxZone + 1);

    if (endZone - startZone < 4) {
        endZone = startZone + 4;
    }

    for (let z = startZone; z <= endZone; z++) {
        if (z > gameState.statistics.maxZone + 1 && z > 1) continue;

        const box = document.createElement('div');
        box.className = 'arena-box';
        box.textContent = z;

        if (z === gameState.currentZone) {
            box.classList.add('active');
        }

        if (z > gameState.statistics.maxZone) {
            box.classList.add('locked');
        } else {
            box.onclick = () => {
                if (z !== gameState.currentZone) {
                    gameState.currentZone = z;
                    gameState.monstersKilledInZone = 0;
                    spawnMonster();
                    renderArenas();
                    updateUI();
                }
            };
        }
        container.appendChild(box);
    }
}


// Spawning de Monstros
function spawnMonster() {
    if (!gameState.currentMonster) return;

    // Verifica se √© uma fase de boss (m√∫ltiplo de 5)
    const isBossZone = gameState.currentZone % 5 === 0;

    // Calcular HP baseado na progress√£o SEM contar fases de boss
    // Fases de boss n√£o contam para a progress√£o
    // Exemplo: Fase 1, 2, 3, 4, 6, 7, 8, 9, 11, 12...
    // A fase 5 (boss) n√£o conta, ent√£o fase 6 = progress√£o 5
    // A fase 10 (boss) n√£o conta, ent√£o fase 11 = progress√£o 9

    let effectiveZone;
    if (isBossZone) {
        // Boss: usar a zona anterior (que n√£o √© boss)
        effectiveZone = gameState.currentZone - 1;
    } else {
        // Inimigo normal: calcular quantas fases de boss j√° passaram
        const bossPhasesPassed = Math.floor((gameState.currentZone - 1) / 5);
        effectiveZone = gameState.currentZone - bossPhasesPassed;
    }

    // Calcular HP do inimigo normal baseado na zona efetiva
    const zoneMultiplier = Math.pow(zoneData.hpMultiplier, effectiveZone - 1);
    const normalEnemyHp = Math.floor(zoneData.baseHp * zoneMultiplier);

    if (isBossZone) {
        // Boss tem multiplicador progressivo baseado na f√≥rmula:
        // BossMultiplier(n) = 8 + (n √ó 0.1)
        // Com limite m√°ximo de 20x
        let bossMultiplier = 8 + (gameState.currentZone * 0.1);
        bossMultiplier = Math.min(bossMultiplier, 20); // Limitar a 20x

        gameState.currentMonster.maxHp = Math.floor(normalEnemyHp * bossMultiplier);
    } else {
        // Inimigo normal
        gameState.currentMonster.maxHp = normalEnemyHp;
    }

    gameState.currentMonster.hp = gameState.currentMonster.maxHp;

    const randomName = monsterNames[Math.floor(Math.random() * monsterNames.length)];
    gameState.currentMonster.name = `${randomName} (Lv. ${gameState.currentZone})`;

    const nameEl = document.getElementById('monster-name');
    if (nameEl) nameEl.textContent = gameState.currentMonster.name;

    const imgEl = document.getElementById('monster-img');
    if (imgEl) {
        if (isBossZone) {
            // Boss: usa imagem especial
            imgEl.src = bossImage;

            // Iniciar cron√¥metro de boss
            startBossTimer();

            // Esconder contador de monstros e mostrar cron√¥metro
            const monstersKilledEl = document.querySelector('.zone-progress-info');
            if (monstersKilledEl) monstersKilledEl.style.display = 'none';

            const bossTimerEl = document.getElementById('boss-timer');
            if (bossTimerEl) bossTimerEl.style.display = 'block';
        } else {
            // Inimigo normal: l√≥gica para evitar repetir o mesmo monstro em seguida
            let newIdx;
            do {
                newIdx = Math.floor(Math.random() * monsterImages.length);
            } while (newIdx === gameState.lastEnemyIndex && monsterImages.length > 1);

            gameState.lastEnemyIndex = newIdx;
            imgEl.src = monsterImages[newIdx];

            // Parar cron√¥metro se estiver rodando
            stopBossTimer();

            // Mostrar contador de monstros e esconder cron√¥metro
            const monstersKilledEl = document.querySelector('.zone-progress-info');
            if (monstersKilledEl) monstersKilledEl.style.display = 'block';

            const bossTimerEl = document.getElementById('boss-timer');
            if (bossTimerEl) bossTimerEl.style.display = 'none';
        }

        // Escalamento: a cada 5 fases aumenta 2% (1.02) para inimigos normais
        // Boss √© sempre 120% do tamanho do inimigo anterior
        let sizeMultiplier;
        if (isBossZone) {
            // Boss = tamanho base da zona anterior * 1.2
            const previousZoneMultiplier = Math.pow(1.02, Math.floor((gameState.currentZone - 1) / 5));
            sizeMultiplier = previousZoneMultiplier * 1.2;
        } else {
            sizeMultiplier = Math.pow(1.02, Math.floor(gameState.currentZone / 5));
        }

        imgEl.style.transform = `scale(${sizeMultiplier})`;
    }

    updateMonsterUI();
}

function damageMonster(amount, isClick = false) {
    let finalDmg = amount;
    let isCrit = false;

    if (isClick && gameState.critChance > 0) {
        if (Math.random() < gameState.critChance) {
            finalDmg *= gameState.clickCritMultiplier;
            isCrit = true;
        }
    }

    gameState.currentMonster.hp -= finalDmg;
    if (gameState.currentMonster.hp < 0) gameState.currentMonster.hp = 0;

    if (isClick) {
        createDamageNumber(finalDmg, isCrit);
        animateMonsterShake();
        animateMonsterHitScale(); // Nova anima√ß√£o de aumento
        gameState.statistics.totalClicks++;
    }

    if (gameState.currentMonster.hp <= 0) {
        monterDeath();
    }

    updateMonsterUI();
}

function monterDeath() {
    // Recompensa
    const zoneMultiplier = Math.pow(zoneData.coinsMultiplier, gameState.currentZone - 1);
    const goldDrop = Math.ceil(Math.random() * 3 * zoneMultiplier);

    gameState.gold += goldDrop;
    gameState.statistics.totalKills++;

    // Verificar se √© boss
    const isBoss = gameState.currentZone % 5 === 0;

    if (isBoss) {
        // Boss morto: parar cron√¥metro e avan√ßar para pr√≥xima zona
        stopBossTimer();

        // Desbloquear pr√≥xima zona se for a zona m√°xima
        if (gameState.currentZone === gameState.statistics.maxZone) {
            gameState.statistics.maxZone++;
            renderArenas();
        }

        // Resetar contador de monstros mortos
        gameState.monstersKilledInZone = 0;
    } else {
        // Inimigo normal: incrementar contador
        gameState.monstersKilledInZone++;

        // Sistema de Drop de Itens
        // Apenas inimigos comuns (n√£o bosses) nas arenas 10-15 com 2% de chance
        const isInDropZone = gameState.currentZone >= 10 && gameState.currentZone <= 15;
        const dropChance = 0.02; // 2%

        if (isInDropZone && Math.random() < dropChance) {
            // Item dropado: Veneno
            const droppedItem = {
                icon: './static/img/items/poison.png',
                name: 'Frasco de Veneno',
                description: 'Um veneno mortal usado por ninjas',
                count: 1,
                isImage: true
            };

            // Adicionar ao invent√°rio
            if (addItemToInventory(droppedItem)) {
                // Mostrar notifica√ß√£o visual
                showItemDropNotification(droppedItem);
            }
        }

        // Desbloqueia pr√≥xima zona se matar o necess√°rio na zona MAXIMA atual
        if (gameState.monstersKilledInZone >= zoneData.monstersPerZone) {
            if (gameState.currentZone === gameState.statistics.maxZone) {
                gameState.statistics.maxZone++;
                renderArenas();
                gameState.monstersKilledInZone = 0;
            } else {
                gameState.monstersKilledInZone = 0;
            }
        }
    }

    spawnMonster();
    updateUI();
}

// ===== SISTEMA DE CRON√îMETRO DE BOSS =====
function startBossTimer() {
    // Parar qualquer cron√¥metro anterior
    stopBossTimer();

    // Resetar para 30 segundos
    gameState.bossTimer = 30;
    updateBossTimerDisplay();

    // Iniciar intervalo de 1 segundo
    gameState.bossTimerInterval = setInterval(() => {
        gameState.bossTimer--;
        updateBossTimerDisplay();

        // Adicionar classe de aviso quando restarem 10 segundos ou menos
        const bossTimerEl = document.getElementById('boss-timer');
        if (gameState.bossTimer <= 10) {
            if (bossTimerEl) bossTimerEl.classList.add('warning');
        } else {
            if (bossTimerEl) bossTimerEl.classList.remove('warning');
        }

        // Quando chegar a 0, resetar vida do boss
        if (gameState.bossTimer <= 0) {
            resetBossHealth();
        }
    }, 1000);
}

function stopBossTimer() {
    if (gameState.bossTimerInterval) {
        clearInterval(gameState.bossTimerInterval);
        gameState.bossTimerInterval = null;
    }

    // Remover classe de aviso
    const bossTimerEl = document.getElementById('boss-timer');
    if (bossTimerEl) bossTimerEl.classList.remove('warning');
}

function updateBossTimerDisplay() {
    const bossTimerValueEl = document.getElementById('boss-timer-value');
    if (bossTimerValueEl) {
        bossTimerValueEl.textContent = gameState.bossTimer;
    }
}

function resetBossHealth() {
    // Resetar vida do boss para o m√°ximo
    gameState.currentMonster.hp = gameState.currentMonster.maxHp;
    updateMonsterUI();

    // Reiniciar cron√¥metro
    startBossTimer();

    console.log('‚è±Ô∏è Tempo esgotado! Vida do boss resetada.');
}

// Loop Principal
function startGameLoop() {
    setInterval(() => {
        if (gameState.totalDps > 0) {
            const dpsTick = gameState.totalDps / TICKS_PER_SECOND;
            if (dpsTick > 0 && gameState.currentMonster.hp > 0) {
                damageMonster(dpsTick, false);
            }
        }
        checkBuyButtons();
    }, 1000 / TICKS_PER_SECOND);
}

function checkBuyButtons() {
    // Apenas verifica se tem dinheiro para remover classe disabled nos herois?
    // Visualmente apenas. A logica √© checada no clique.
    // Como agora usamos renderHeroesList com frequencia, pode ser redundante se nao otimizado.
    // Mas vamos manter simples:
    gameState.heroes.forEach(hero => {
        const item = document.getElementById(`hero-${hero.id}`);
        if (item) {
            const btn = item.querySelector('.hero-buy-btn');
            if (btn && !btn.classList.contains('locked')) { // locked class is for mystery
                if (gameState.gold >= hero.currentCost) {
                    btn.classList.remove('disabled');
                } else {
                    btn.classList.add('disabled');
                }
            }
        }
    });

    // Upgrades
    gameState.heroes.forEach(hero => {
        const ups = heroUpgrades[hero.id];
        if (ups) {
            ups.forEach(u => {
                const el = document.getElementById(`upg-${u.id}`);
                const cost = hero.baseCost * u.costMultiplier;
                if (el) {
                    if (gameState.gold >= cost) {
                        el.style.borderColor = "#00ff00"; // Highlight available?
                        // ou usar classe .available se level permitir.
                        // renderHeroesList ja define .available baseado em level.
                    } else {
                        // el.style.borderColor = "";
                    }
                }
            });
        }
    });
}

// Event Listeners
function setupEventListeners() {
    const clickTarget = document.getElementById('click-target');
    if (clickTarget) {
        clickTarget.addEventListener('mousedown', (e) => {
            e.preventDefault();
            damageMonster(gameState.clickDamage, true);
            const vis = clickTarget.querySelector('.monster-visual');
            if (vis) vis.style.transform = "scale(0.9)";
        });

        clickTarget.addEventListener('mouseup', () => {
            const vis = clickTarget.querySelector('.monster-visual');
            if (vis) vis.style.transform = "scale(1)";
        });
    }

    const prevBtn = document.getElementById('prev-zone');
    if (prevBtn) prevBtn.onclick = () => changeZone('prev');
    const nextBtn = document.getElementById('next-zone');
    if (nextBtn) nextBtn.onclick = () => changeZone('next');

    // Configurar eventos da mochila
    setupBackpackEventListeners();
}

// UI Helpers
function updateUI() {
    const goldEl = document.getElementById('player-gold');
    if (goldEl) goldEl.textContent = formatNumber(Math.floor(gameState.gold));

    const dpsEl = document.getElementById('total-dps');
    if (dpsEl) dpsEl.textContent = formatNumber(Math.floor(gameState.totalDps));

    const clickValEl = document.getElementById('click-damage-val');
    if (clickValEl) clickValEl.textContent = formatNumber(Math.floor(gameState.clickDamage));

    const mkEl = document.getElementById('monsters-killed');
    if (mkEl) mkEl.textContent = gameState.monstersKilledInZone;

    // Stats footer/header
    const skEl = document.getElementById('stat-killed');
    if (skEl) skEl.textContent = formatNumber(gameState.statistics.totalKills);
    const scEl = document.getElementById('stat-clicks');
    if (scEl) scEl.textContent = formatNumber(gameState.statistics.totalClicks);
    const smzEl = document.getElementById('stat-max-zone');
    if (smzEl) smzEl.textContent = gameState.statistics.maxZone;
}

function updateMonsterUI() {
    if (!gameState.currentMonster) return;
    const pct = (gameState.currentMonster.hp / gameState.currentMonster.maxHp) * 100;
    const fill = document.getElementById('hp-fill');
    if (fill) fill.style.width = `${pct}%`;

    const curHp = document.getElementById('current-hp');
    if (curHp) curHp.textContent = formatNumber(Math.ceil(gameState.currentMonster.hp));
}

function createDamageNumber(amount, isCrit) {
    const container = document.getElementById('damage-numbers-container');
    if (!container) return;

    const el = document.createElement('div');
    el.className = 'damage-number';
    if (isCrit) {
        el.classList.add('damage-crit');
    }
    el.textContent = formatNumber(Math.floor(amount));

    const x = 50 + (Math.random() * 20 - 10);
    const y = 50 + (Math.random() * 20 - 10);

    el.style.left = `${x}%`;
    el.style.top = `${y}%`;

    container.appendChild(el);

    setTimeout(() => el.remove(), 1000);
}

function animateMonsterShake() {
    const visual = document.querySelector('.monster-visual');
    if (visual) {
        visual.classList.remove('shake');
        void visual.offsetWidth;
        visual.classList.add('shake');
    }
}

function animateMonsterHitScale() {
    const visual = document.querySelector('.monster-visual');
    if (visual) {
        visual.classList.remove('hit-scale');
        void visual.offsetWidth; // Reflow
        visual.classList.add('hit-scale');
    }
}

function showItemDropNotification(item) {
    // Criar elemento de notifica√ß√£o
    const notification = document.createElement('div');
    notification.className = 'item-drop-notification';

    // Criar conte√∫do
    const iconHTML = item.isImage
        ? `<img src="${item.icon}" alt="${item.name}">`
        : `<div style="font-size: 2.5em;">${item.icon}</div>`;

    notification.innerHTML = `
        ${iconHTML}
        <div class="drop-content">
            <div class="drop-text">ITEM ENCONTRADO!</div>
            <div class="item-name">${item.name}</div>
        </div>
    `;

    // Adicionar ao body
    document.body.appendChild(notification);

    // Remover ap√≥s 3 segundos
    setTimeout(() => {
        notification.remove();
    }, 3000);
}

function formatNumber(num) {
    if (num >= 1000000000000) return (num / 1000000000000).toFixed(2) + 'T';
    if (num >= 1000000000) return (num / 1000000000).toFixed(2) + 'B';
    if (num >= 1000000) return (num / 1000000).toFixed(2) + 'M';
    if (num >= 1000) return (num / 1000).toFixed(1) + 'k';
    return Math.floor(num).toString();
}

// Persistence
function saveGame() {
    const saveObj = {
        gold: gameState.gold,
        currentZone: gameState.currentZone,
        savedHeroes: gameState.heroes.map(h => ({ id: h.id, level: h.level })),
        upgrades: gameState.upgrades,
        statistics: gameState.statistics,
        inventory: gameState.inventory
    };
    localStorage.setItem('narutoClickerSave', JSON.stringify(saveObj));
}

function loadGame() {
    const saveStr = localStorage.getItem('narutoClickerSave');
    if (saveStr) {
        try {
            const saved = JSON.parse(saveStr);
            gameState.gold = saved.gold || 0;
            gameState.currentZone = saved.currentZone || 1;
            gameState.savedHeroes = saved.savedHeroes || [];
            gameState.upgrades = saved.upgrades || [];
            gameState.statistics = { ...gameState.statistics, ...saved.statistics };
            gameState.inventory = saved.inventory || [];
            if (!gameState.statistics.maxZone) gameState.statistics.maxZone = 1;
        } catch (e) {
            console.error("Erro save", e);
        }
    }
}

function resetGame() {
    if (confirm("TEM CERTEZA? Isso apagar√° todo o seu progresso para sempre!")) {
        localStorage.removeItem('narutoClickerSave');
        location.reload();
    }
}

// ===== SISTEMA DE MOCHILA =====
function setupBackpackEventListeners() {
    console.log('üéí Configurando eventos da mochila...');
    const openBackpackBtn = document.getElementById('open-backpack');
    const closeBackpackBtn = document.getElementById('close-backpack');
    const backpackModal = document.getElementById('backpack-modal');

    if (!openBackpackBtn || !closeBackpackBtn || !backpackModal) {
        console.warn('‚ö†Ô∏è Elementos da mochila n√£o encontrados');
        return;
    }
    console.log('‚úÖ Elementos da mochila encontrados, configurando listeners...');

    // Abrir modal
    openBackpackBtn.addEventListener('click', () => {
        console.log('üéí Abrindo mochila...');
        backpackModal.classList.add('active');
        console.log('Classes do modal:', backpackModal.className);
        renderInventory();
    });

    // Fechar modal
    closeBackpackBtn.addEventListener('click', () => {
        console.log('‚ùå Fechando mochila (bot√£o X)...');
        backpackModal.classList.remove('active');
    });

    // Fechar ao clicar fora do modal (no backdrop)
    backpackModal.addEventListener('click', (e) => {
        if (e.target === backpackModal) {
            console.log('‚ùå Fechando mochila (clique fora)...');
            backpackModal.classList.remove('active');
        }
    });

    // Inicializar grid de invent√°rio
    initializeInventory();

    // Inicializar painel admin
    setupAdminPanel();
}

function initializeInventory() {
    const inventoryGrid = document.getElementById('inventory-grid');
    const totalSlots = 40;

    for (let i = 0; i < totalSlots; i++) {
        const slot = document.createElement('div');
        slot.className = 'inventory-slot empty';
        slot.dataset.slotIndex = i;
        inventoryGrid.appendChild(slot);
    }
}

function addItemToInventory(newItem) {
    // Verificar se o item j√° existe no invent√°rio (mesmo nome)
    const existingItem = gameState.inventory.find(item => item && item.name === newItem.name);

    if (existingItem) {
        // Se j√° existe, aumentar a contagem
        existingItem.count += newItem.count;
    } else {
        // Se n√£o existe, adicionar em um slot vazio
        const emptySlotIndex = gameState.inventory.findIndex(item => !item);

        if (emptySlotIndex !== -1) {
            // Tem slot vazio, adicionar l√°
            gameState.inventory[emptySlotIndex] = newItem;
        } else if (gameState.inventory.length < 40) {
            // N√£o tem slot vazio mas ainda tem espa√ßo
            gameState.inventory.push(newItem);
        } else {
            // Invent√°rio cheio
            console.warn('‚ö†Ô∏è Invent√°rio cheio! N√£o foi poss√≠vel adicionar o item.');
            return false;
        }
    }

    // Salvar o jogo ap√≥s adicionar item
    saveGame();
    return true;
}

function renderInventory() {
    const slots = document.querySelectorAll('.inventory-slot');

    slots.forEach((slot, index) => {
        const item = gameState.inventory[index];

        if (item) {
            slot.className = 'inventory-slot has-item';

            // Verificar se o √≠cone √© uma imagem ou emoji
            const iconHTML = item.isImage
                ? `<img src="${item.icon}" class="item-icon-img" alt="${item.name}">`
                : `<span class="item-icon">${item.icon}</span>`;

            slot.innerHTML = `
                ${iconHTML}
                ${item.count > 1 ? `<span class="item-count">x${item.count}</span>` : ''}
            `;
            slot.title = `${item.name}\n${item.description}`;
        } else {
            slot.className = 'inventory-slot empty';
            slot.innerHTML = '';
            slot.title = 'Slot vazio';
        }
    });
}

// ===== ADMIN PANEL =====
function setupAdminPanel() {
    const adminTrigger = document.getElementById('admin-trigger');
    const adminModal = document.getElementById('admin-modal');
    const closeAdminBtn = document.getElementById('close-admin');
    const addGoldBtn = document.getElementById('add-gold-btn');
    const goldInput = document.getElementById('gold-input');

    // Abrir modal admin
    adminTrigger.addEventListener('click', () => {
        adminModal.style.display = 'flex';
        goldInput.value = '';
        goldInput.focus();
    });

    // Fechar modal admin
    closeAdminBtn.addEventListener('click', () => {
        adminModal.style.display = 'none';
    });

    // Fechar ao clicar fora
    adminModal.addEventListener('click', (e) => {
        if (e.target === adminModal) {
            adminModal.style.display = 'none';
        }
    });

    // Adicionar ouro
    addGoldBtn.addEventListener('click', () => {
        const amount = parseFloat(goldInput.value);
        if (amount && amount > 0) {
            gameState.gold += amount;
            updateUI();
            saveGame();
            goldInput.value = '';
            console.log(`‚úÖ Admin: Adicionado ${formatNumber(amount)} de ouro`);
        }
    });

    // Enter para adicionar
    goldInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
            addGoldBtn.click();
        }
    });
}

window.onload = initGame;



----- FILE: templates/index.html  (sha1:7ddc7467d3a1, bytes:5385) -----
<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Naruto Clicker Heroes</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}?v=8">
    <link
        href="https://fonts.googleapis.com/css2?family=Bangers&family=Shojumaru&family=Roboto:wght@400;700&display=swap"
        rel="stylesheet">
</head>

<body>
    <div class="game-container">
        <!-- Coluna Esquerda: Her√≥is -->
        <div class="panel left-panel">
            <div class="gold-display-left">
                üí∞ <span id="player-gold">0</span>
            </div>
            <div class="header-panel">
                <h2>Equipe Ninja <span class="backpack-icon" id="open-backpack" title="Mochila">üéí</span></h2>
                <div class="stats-display-container">
                    <div class="dps-display">DPS: <span id="total-dps">0</span></div>
                    <div class="click-display">Click: <span id="click-damage-val">1</span></div>
                </div>
            </div>
            <div id="heroes-list" class="scroll-content">
                <!-- Her√≥is ser√£o inseridos aqui via JS -->
            </div>
        </div>

        <!-- Coluna Central: A√ß√£o -->
        <div class="panel center-panel">
            <img src="{{ url_for('static', filename='img/elemental_cycle.png') }}" class="elemental-cycle-guide"
                alt="Ciclo Elemental">


            <div class="arena-selector-container">
                <button id="prev-zone" class="nav-btn">‚óÄ</button>
                <div class="arenas-scroll">
                    <div id="arenas-display">
                        <!-- Arenas visuais -->
                    </div>
                </div>
                <button id="next-zone" class="nav-btn">‚ñ∂</button>
            </div>


            <div class="battle-arena">
                <div class="zone-progress-info">
                    <span id="monsters-killed">0</span>/10
                </div>
                <!-- Cron√¥metro de Boss -->
                <div id="boss-timer" class="boss-timer" style="display: none;">
                    ‚è±Ô∏è <span id="boss-timer-value">30</span>s
                </div>
                <div id="damage-numbers-container"></div>
                <div class="monster-container" id="click-target">
                    <div class="monster-hp-bar">
                        <div id="hp-fill" style="width: 100%;"></div>
                    </div>
                    <div class="monster-hp-text"><span id="current-hp">10</span> HP</div>
                    <div class="monster-visual">
                        <img id="monster-img" src="" alt="Monstro">
                    </div>
                </div>

                <div class="player-controls">
                    <!-- Controls -->
                </div>
            </div>
        </div>

        <!-- Coluna Direita: Progresso e Status -->
        <div class="panel right-panel">
            <h3>Estat√≠sticas</h3>
            <ul id="stats-list">
                <li>Monstros Derrotados: <span id="stat-killed">0</span></li>
                <li>Cliques Realizados: <span id="stat-clicks">0</span></li>
                <li>Maior Zona: <span id="stat-max-zone">1</span></li>
            </ul>
            <div class="reset-container">
                <button id="reset-save-btn" class="reset-btn" onclick="resetGame()">RESETAR PROGRESSO</button>
            </div>
        </div>
    </div>

    <!-- Modal da Mochila -->
    <div id="backpack-modal" class="backpack-modal">
        <div class="backpack-container">
            <div class="backpack-header">
                <div class="backpack-title">
                    <span class="backpack-icon">üéí</span>
                    Invent√°rio
                </div>
                <button class="close-backpack" id="close-backpack">‚úñ</button>
            </div>
            <div class="backpack-body">
                <div id="inventory-grid" class="inventory-grid">
                    <!-- Slots ser√£o gerados via JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Admin (Cheat) -->
    <div id="admin-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content admin-modal">
            <div class="modal-header">
                <h2>‚öôÔ∏è Admin Panel</h2>
                <button class="modal-close" id="close-admin">‚úñ</button>
            </div>
            <div class="modal-body">
                <div class="admin-input-group">
                    <label for="gold-input">Adicionar Ouro:</label>
                    <input type="number" id="gold-input" placeholder="Digite a quantidade..." min="0" step="1000">
                    <button id="add-gold-btn" class="admin-btn">üí∞ Adicionar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bot√£o Admin (Discreto) -->
    <div id="admin-trigger" title="Admin Panel">‚öôÔ∏è</div>

    <script src="{{ url_for('static', filename='js/game_data_v3.js') }}?v=5"></script>
    <script src="{{ url_for('static', filename='js/game_v3.js') }}?v=8"></script>
</body>

</html>

----- FILE: static/css/style.css  (sha1:1468044cc0f6, bytes:43322) -----
:root {
    --bg-color: #2c2c2c;
    --panel-bg: #f5e6ca;
    /* Cor de pergaminho */
    --panel-border: #4a3b2a;
    --primary-orange: #ff6600;
    --text-color: #333;
    --gold-color: #ffd700;
    --dps-color: #ff4500;
}

body {
    margin: 0;
    padding: 0;
    font-family: 'Roboto', sans-serif;
    background-image: url('../img/battle_bg.png');
    background-size: cover;
    background-position: center;
    color: var(--text-color);
    height: 100vh;
    overflow: hidden;
    user-select: none;
    position: relative;
}



.game-container {
    display: flex;
    height: 100vh;
    width: 100%;
    max-width: 100%;
    padding: 20px;
    box-sizing: border-box;
    margin: 0;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.8);
}

.panel {
    background-color: var(--panel-bg);
    border: 5px solid var(--panel-border);
    border-radius: 8px;
    margin: 0 15px;
    /* Espa√ßo entre as faixas */
    padding: 15px;
    display: flex;
    flex-direction: column;
    position: relative;
    box-shadow: inset 0 0 50px rgba(0, 0, 0, 0.1);
}

.panel::before {
    content: "";
    /* Textura de papel */
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-image: url('https://www.transparenttextures.com/patterns/aged-paper.png');
    opacity: 0.4;
    pointer-events: none;
    z-index: 0;
}

.left-panel {
    flex: 2.5;
    /* Aumentado de 2.2 para 2.5 para dar mais espa√ßo */
    min-width: 480px;
    /* Aumentado de 450px para 480px */
    z-index: 1;
}

/* Mais larga */
.center-panel {
    flex: 6;
    /* Abre muito mais espa√ßo no meio */
    z-index: 1;
    background-color: rgba(255, 255, 255, 0.1);
    border: none;
    box-shadow: none;
    background: none;
}

/* Center panel is transparent to see bg */

.center-panel .battle-arena {
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
    /* Centraliza verticalmente o conjunto */
    align-items: center;
    position: relative;
    padding-top: 0;
}

.right-panel {
    flex: 1.2;
    min-width: 280px;
    z-index: 1;
    display: flex;
    flex-direction: column;
    padding: 20px;
    background-image: url('https://www.transparenttextures.com/patterns/aged-paper.png'),
        linear-gradient(to bottom, #f5e6ca 0%, #e8d5b5 100%);
    border-left: 5px solid #4a3b2a;
    box-shadow: -5px 0 15px rgba(0, 0, 0, 0.3);
    position: relative;
}

.right-panel h3 {
    text-align: center;
    font-size: 1.8em;
    color: #4e342e;
    border-bottom: 2px solid #8d6e63;
    padding-bottom: 10px;
    margin-bottom: 20px;
    text-transform: uppercase;
}

#stats-list {
    list-style: none;
    padding: 0;
    margin: 0;
    flex: 1;
}

#stats-list li {
    font-family: 'Roboto', sans-serif;
    font-size: 1.1em;
    padding: 12px 10px;
    border-bottom: 1px dashed #a1887f;
    color: #3e2723;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

#stats-list li span {
    font-family: 'Bangers', cursive;
    color: #bf360c;
    font-size: 1.2em;
}

/* Estiliza√ß√£o do Bot√£o de Reset */
.reset-container {
    margin-top: auto;
    padding-top: 20px;
    text-align: center;
}

.reset-btn {
    background: linear-gradient(to bottom, #d32f2f 0%, #b71c1c 100%);
    color: white;
    border: 2px solid #7f0000;
    padding: 12px 20px;
    font-family: 'Bangers', cursive;
    font-size: 1.2em;
    border-radius: 8px;
    cursor: pointer;
    box-shadow: 0 4px 0 #5f0000;
    transition: all 0.1s;
    width: 100%;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
}

.reset-btn:hover {
    background: linear-gradient(to bottom, #e53935 0%, #c62828 100%);
}

.reset-btn:active {
    transform: translateY(4px);
    box-shadow: none;
}

/* Scroll Lists */
.scroll-content {
    overflow-y: auto;
    overflow-x: hidden;
    /* Remove a barra horizontal */
    flex: 1;
    padding-right: 15px;
    /* Aumentado de 5px para 15px para afastar a barra dos cards */
}

.scroll-content::-webkit-scrollbar {
    width: 8px;
}

.scroll-content::-webkit-scrollbar-thumb {
    background: var(--primary-orange);
    border-radius: 4px;
}

/* Heroes List Expanded */

/* Container de Moedas */
.currency-display-container {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
}

.gold-display-left {
    font-family: 'Bangers', cursive;
    font-size: 2.5em;
    color: var(--gold-color);
    text-shadow: 2px 2px 0 #000;
    text-align: center;
    background: rgba(0, 0, 0, 0.6);
    padding: 10px;
    border-radius: 10px;
    border: 2px solid #8b4513;
    flex: 1;
}

.diamonds-display-left {
    font-family: 'Bangers', cursive;
    font-size: 2.5em;
    color: #00d4ff;
    text-shadow: 2px 2px 0 #000, 0 0 10px rgba(0, 212, 255, 0.5);
    text-align: center;
    background: rgba(0, 0, 0, 0.6);
    padding: 10px;
    border-radius: 10px;
    border: 2px solid #0088cc;
    flex: 1;
}

/* Header Panel (Equipe Ninja) */
.header-panel {
    border-bottom: 2px solid #8b4513;
    margin-bottom: 15px;
    padding-bottom: 10px;
}

.header-panel h2 {
    font-family: 'Shojumaru', cursive;
    margin: 0;
    color: #b33e00;
    font-size: 1.8em;
    text-align: center;
}

/* Stats Display (DPS/Click) */
.stats-display-container {
    display: flex;
    justify-content: space-around;
    gap: 10px;
    margin-top: 10px;
}

.dps-display,
.click-display {
    flex: 1;
    background: linear-gradient(135deg, #444, #222);
    border: 2px solid #ff9800;
    border-radius: 8px;
    padding: 8px 5px;
    color: #fff;
    font-family: 'Bangers', cursive;
    font-size: 1.4em;
    text-align: center;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
    text-shadow: 1px 1px 2px #000;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}

.dps-display span,
.click-display span {
    color: #ffd700;
    font-size: 1.1em;
}

.dps-display {
    border-color: #ff5722;
}

.click-display {
    border-color: #2196f3;
}

/* Heroes List Expanded */
.hero-item {
    background: rgba(255, 255, 255, 0.85);
    /* Mais opaco para leitura */
    border: 3px solid #8b4513;
    border-radius: 8px;
    margin-bottom: 12px;
    padding: 15px;
    /* Box maior */
    display: flex;
    align-items: center;
    transition: transform 0.1s;
    cursor: pointer;
    min-height: 80px;
    /* Garante altura */
}

.hero-item:hover {
    transform: scale(1.02);
    background: rgba(255, 255, 255, 0.95);
}

.hero-item.disabled {
    filter: grayscale(1);
    opacity: 0.7;
    cursor: not-allowed;
}

.hero-img {
    width: 80px;
    /* Imagem bem maior */
    height: 80px;
    border-radius: 10px;
    /* Quadrado arredondado em vez de circulo para mostrar mais arte */
    border: 3px solid var(--panel-border);
    margin-right: 15px;
    background: #ccc;
    flex-shrink: 0;
}

.hero-info {
    flex: 1;
}

.hero-name {
    font-weight: bold;
    font-family: 'Shojumaru', cursive;
    font-size: 1.4em;
    color: #b33e00;
    margin-bottom: 5px;
}

.hero-stats {
    font-size: 1.1em;
    color: #333;
    font-weight: bold;
}

.hero-cost {
    font-weight: bold;
    color: #d68910;
    font-size: 1.2em;
}

.hero-level {
    background: var(--panel-border);
    color: #fff;
    padding: 4px 10px;
    border-radius: 12px;
    font-size: 0.9em;
    float: right;
    margin-left: 10px;
}

/* Monster & Battle */
.monster-container {
    text-align: center;
    position: relative;
    cursor: url('../img/kunai_cursor.png') 0 0, crosshair;
}

.monster-visual {
    width: 440px;
    /* Aumentado para 440px */
    height: 440px;
    margin: 80px auto 0 auto;
    /* Aumenta espa√ßo superior para descer o ninja conforme pedido */
    transition: transform 0.05s;
    display: flex;
    align-items: center;
    justify-content: center;
}

.monster-visual img {
    max-width: 100%;
    max-height: 100%;
    filter: drop-shadow(0 10px 10px rgba(0, 0, 0, 0.5));
}

.monster-visual:active {
    transform: scale(0.95);
}

.shake {
    animation: shake 0.2s;
}

.hit-scale {
    animation: hitScale 0.1s ease-out;
}

@keyframes hitScale {
    0% {
        transform: scale(1);
    }

    50% {
        transform: scale(1.15);
    }

    /* Aumenta levemente */
    100% {
        transform: scale(1);
    }
}

@keyframes shake {
    0% {
        transform: translate(1px, 1px) rotate(0deg);
    }

    10% {
        transform: translate(-1px, -2px) rotate(-1deg);
    }

    20% {
        transform: translate(-3px, 0px) rotate(1deg);
    }

    30% {
        transform: translate(3px, 2px) rotate(0deg);
    }

    40% {
        transform: translate(1px, -1px) rotate(1deg);
    }

    50% {
        transform: translate(-1px, 2px) rotate(-1deg);
    }

    60% {
        transform: translate(-3px, 1px) rotate(0deg);
    }

    70% {
        transform: translate(3px, 1px) rotate(-1deg);
    }

    80% {
        transform: translate(-1px, -1px) rotate(1deg);
    }

    90% {
        transform: translate(1px, 2px) rotate(0deg);
    }

    100% {
        transform: translate(1px, -2px) rotate(-1deg);
    }
}

.monster-hp-bar {
    width: 380px;
    /* Aumentado para acompanhar o monstro */
    height: 22px;
    background: #555;
    border: 3px solid #000;
    border-radius: 12px;
    overflow: hidden;
    margin: 5px auto;
}

#hp-fill {
    height: 100%;
    background: linear-gradient(90deg, #ff0000, #ff6600);
    transition: width 0.1s linear;
}

.monster-hp-text {
    font-family: 'Bangers', cursive;
    font-size: 1.5em;
    color: #fff;
    text-shadow: 2px 2px 0 #000;
    margin-top: -22px;
    position: relative;
    z-index: 2;
}

/* Monster Name and Level Display */
.monster-info {
    text-align: center;
    margin-top: 15px;
    pointer-events: none;
}

.monster-name {
    font-family: 'Shojumaru', cursive;
    font-size: 2.2em;
    color: #ff6600;
    text-shadow: 3px 3px 0 #000, 0 0 10px rgba(255, 102, 0, 0.5);
    margin-bottom: 5px;
    font-weight: bold;
    letter-spacing: 2px;
}

.monster-level {
    font-family: 'Bangers', cursive;
    font-size: 1.6em;
    color: #ffd700;
    text-shadow: 2px 2px 0 #000;
    background: rgba(0, 0, 0, 0.6);
    display: inline-block;
    padding: 5px 15px;
    border-radius: 8px;
    border: 2px solid #8b4513;
}

#damage-numbers-container {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
}

.damage-number {
    position: absolute;
    font-family: 'Bangers', cursive;
    font-size: 2em;
    color: #fff;
    text-shadow: 2px 2px 0 #000;
    animation: floatUp 1s ease-out forwards;
}

.damage-crit {
    color: #ff0000;
    font-size: 3em;
}

@keyframes floatUp {
    0% {
        opacity: 1;
        transform: translateY(0) scale(1);
    }

    100% {
        opacity: 0;
        transform: translateY(-100px) scale(1.2);
    }
}

/* Anima√ß√£o de Moedas de Ouro */
.gold-coin {
    position: absolute;
    font-size: 2em;
    color: #ffd700;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8),
        0 0 10px rgba(255, 215, 0, 0.6);
    pointer-events: none;
    z-index: 100;
    animation: coinFall 0.8s ease-out forwards;
}

@keyframes coinFall {
    0% {
        opacity: 1;
        transform: translateY(0) rotate(0deg) scale(1);
    }

    60% {
        opacity: 1;
        transform: translateY(80px) rotate(180deg) scale(1.1);
    }

    100% {
        opacity: 0;
        transform: translateY(120px) rotate(360deg) scale(0.6);
    }
}

/* Headers & Fonts */
h2,
h3 {
    font-family: 'Shojumaru', cursive;
    letter-spacing: 1px;
    margin: 0 0 10px 0;
    color: #2c2c2c;
}

.gold-display {
    font-family: 'Bangers', cursive;
    font-size: 2em;
    color: var(--gold-color);
    text-shadow: 2px 2px 0 #000;
    background: rgba(0, 0, 0, 0.6);
    padding: 10px;
    border-radius: 10px;
    margin-bottom: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.gold-icon {
    height: 30px;
    margin-right: 10px;
}

/* Log Removido, adicionando estilos de Arena */
.arena-selector-container {
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 10px;
    background: rgba(0, 0, 0, 0.5);
    padding: 10px;
    border-radius: 15px;
    border: 2px solid #8b4513;
}

.nav-btn {
    background: #ff6600;
    border: 2px solid #4a0000;
    color: white;
    font-weight: bold;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    cursor: pointer;
    font-family: 'Bangers', cursive;
    font-size: 1.2em;
}

.nav-btn:hover {
    background: #ff8533;
}

.nav-btn:active {
    transform: scale(0.95);
}

.arenas-scroll {
    flex: 1;
    overflow: hidden;
    margin: 0 10px;
    height: 60px;
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
}

#arenas-display {
    display: flex;
    gap: 10px;
    transition: transform 0.3s ease;
}

.arena-box {
    width: 50px;
    height: 50px;
    background: #4a3b2a;
    border: 2px solid #8b4513;
    color: #ffd700;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: 'Bangers', cursive;
    font-size: 1.2em;
    border-radius: 5px;
    cursor: pointer;
    flex-shrink: 0;
    opacity: 0.6;
}

.arena-box.active {
    background: #ff6600;
    border-color: #ffff00;
    transform: scale(1.1);
    opacity: 1;
    box-shadow: 0 0 10px #ff6600;
}

.arena-box.locked {
    background: #222;
    color: #555;
    cursor: not-allowed;
    border-color: #333;
}

/* Upgrade Boxes Compact */
.upgrades-row {
    display: flex;
    gap: 5px;
    margin-top: 5px;
    width: 100%;
    padding-left: 95px;
    /* Alinhar com o nome do heroi (img width + margin) */
}

.upgrade-box {
    width: 30px;
    height: 30px;
    background-color: #4a3b2a;
    border: 2px solid #8b4513;
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 1.2em;
    position: relative;
    transition: all 0.2s;
}

.upgrade-box.locked {
    opacity: 0;
    /* Totalmente invis√≠vel se bloqueado (se n√£o tiver nivel 20, 40...) */
    pointer-events: none;
}

.upgrade-box.available {
    background-color: #5d4a35;
    border-color: #ffd700;
    /* Borda dourada para indicar disponivel */
    animation: pulseBorder 2s infinite;
}

.upgrade-box.bought {
    background-color: #228b22;
    /* Verde comprado */
    border-color: #00ff00;
    box-shadow: 0 0 5px #00ff00;
    cursor: default;
}

/* Tooltip (S√≥ no hover) */
.tooltip {
    visibility: hidden;
    background-color: rgba(0, 0, 0, 0.95);
    color: #fff;
    text-align: left;
    border-radius: 6px;
    padding: 8px;
    position: absolute;
    z-index: 1000;
    bottom: 125%;
    left: 50%;
    margin-left: -60px;
    width: 150px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
    border: 1px solid #ffd700;
    font-size: 0.8em;
    font-family: 'Roboto', sans-serif;
    pointer-events: none;
    opacity: 0;
    transition: opacity 0.2s;
}

.upgrade-box:hover .tooltip {
    visibility: visible;
    opacity: 1;
}

@keyframes pulseBorder {
    0% {
        border-color: #ffd700;
    }

    50% {
        border-color: #ffaa00;
    }

    100% {
        border-color: #ffd700;
    }
}

.zone-progress-info {
    text-align: center;
    font-family: 'Shojumaru', cursive;
    color: #ffd700;
    background: transparent;
    padding: 0;
    margin-bottom: 20px;
    /* Mais espa√ßo para a barra de vida abaixo */
    margin-top: -20px;
    /* Sobe um pouco mais */
    font-size: 2.8em;
    /* Aumentado levemente */
    text-shadow: 4px 4px 0 #000;
    z-index: 10;
}

/* Boss Timer */
.boss-timer {
    text-align: center;
    font-family: 'Bangers', cursive;
    color: #ff4444;
    background: rgba(0, 0, 0, 0.7);
    padding: 10px 20px;
    margin: -10px auto 20px auto;
    border-radius: 15px;
    font-size: 2.5em;
    text-shadow: 3px 3px 0 #000;
    border: 3px solid #ff0000;
    box-shadow: 0 0 20px rgba(255, 0, 0, 0.5);
    width: fit-content;
    animation: timerPulse 1s infinite;
}

.boss-timer.warning {
    animation: timerWarning 0.5s infinite;
    color: #ff0000;
    border-color: #ff0000;
}

@keyframes timerPulse {

    0%,
    100% {
        transform: scale(1);
    }

    50% {
        transform: scale(1.05);
    }
}

@keyframes timerWarning {

    0%,
    100% {
        transform: scale(1);
        box-shadow: 0 0 20px rgba(255, 0, 0, 0.8);
    }

    50% {
        transform: scale(1.1);
        box-shadow: 0 0 30px rgba(255, 0, 0, 1);
    }
}


/* HERO ITEM REDESIGN (Reference Style) */
.hero-item-new {
    background: #fdf5e6;
    /* Cor de papiro claro */
    border-radius: 12px;
    margin-bottom: 25px;
    padding: 10px;
    position: relative;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    border: 2px solid #dba669;
    min-height: 180px;
    /* Garante espa√ßo para imagem full */
}

/* Header: Nome e Nivel */
.hero-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-end;
    /* Alinha na base do texto */
    margin-bottom: 5px;
    border-bottom: 1px dashed #dba669;
    padding-bottom: 5px;
}

.hero-name-title {
    font-family: 'Shojumaru', cursive;
    font-size: 1.6em;
    color: #333;
    text-shadow: 1px 1px 0 #fff;
    margin-left: 5px;
}

.hero-level-badge {
    font-family: 'Bangers', cursive;
    font-size: 2em;
    color: #fff;
    text-shadow: 2px 2px 0 #000;
}

/* Body: Esquerda (Botao + Skills) | Direita (Imagem) */
.hero-body-row {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
}

.left-section {
    display: flex;
    flex-direction: row;
    /* Botao e Skills lado a lado */
    align-items: center;
    gap: 15px;
    margin-top: 10px;
}

/* Bot√£o de Compra (Azul/Dourado estilo fish game) */
.buy-box {
    background: linear-gradient(to bottom, #4facfe 0%, #00f2fe 100%);
    width: 130px;
    height: 70px;
    border-radius: 10px;
    border: 4px solid #ffd700;
    box-shadow: 0 4px 0 #0056b3, 0 5px 10px rgba(0, 0, 0, 0.3);
    cursor: pointer;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    transition: transform 0.1s;
}

.buy-box:active {
    transform: translateY(4px);
    box-shadow: 0 0 0 #0056b3;
}

.buy-box.locked {
    background: #555;
    border-color: #333;
    cursor: not-allowed;
    box-shadow: none;
}

.buy-action {
    font-family: 'Bangers', cursive;
    font-size: 1.5em;
    color: #fff;
    text-shadow: 1px 1px 0 #000;
    line-height: 1;
}

.buy-cost {
    font-family: 'Roboto', sans-serif;
    font-weight: bold;
    font-size: 1em;
    color: #fff4e6;
    text-shadow: 1px 1px 0 #000;
    margin-top: 2px;
}

/* Skills Container */
.upgrades-container {
    display: flex;
    gap: 8px;
}

.upgrade-box-new {
    width: 45px;
    height: 45px;
    background: #3e2723;
    border: 3px solid #5d4037;
    border-radius: 6px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5em;
    cursor: pointer;
    position: relative;
    box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.8);
}

.upgrade-box-new.locked {
    opacity: 0;
    pointer-events: none;
}

.upgrade-box-new.available {
    background: #5d4037;
    border-color: #ffd700;
    animation: pulseBorder 2s infinite;
}

.upgrade-box-new.bought {
    border-color: #00ff00;
}

.check-mark {
    position: absolute;
    top: -5px;
    right: -5px;
    color: #00ff00;
    font-size: 1em;
    text-shadow: 1px 1px 0 #000;
    font-weight: bold;
}

/* Imagem do Heroi (Full Body, Saindo pra fora se precisar) */
.hero-image-container {
    width: 200px;
    /* Largura fixa para imagem */
    height: 250px;
    margin-top: -60px;
    /* Puxa pra cima para sobrepor header se quiser, ou ajustar */
    margin-right: -10px;
    display: flex;
    align-items: flex-end;
    justify-content: center;
    pointer-events: none;
    /* Deixar clicar atrav√©s se precisar */
    overflow: hidden;
    /* Corta se for muito grande */
}

.hero-full-img {
    max-height: 100%;
    max-width: 100%;
    filter: drop-shadow(5px 5px 10px rgba(0, 0, 0, 0.4));
    transition: transform 0.2s;
}

.hero-item-new:hover .hero-full-img {
    transform: scale(1.05);
}

/* HERO CONTAINER (Holds Title + Card) */
.hero-card-split {
    background: transparent;
    border: none;
    box-shadow: none;
    margin-bottom: 30px;
    display: flex;
    flex-direction: column;
}

/* NAME HEADER OUTSIDE */
.hero-title-header {
    font-family: 'Shojumaru', cursive;
    font-size: 1.4em;
    /* Reduzido */
    color: #e65100;
    text-shadow: 2px 2px 0 #fff;
    text-align: left;
    /* Alinhado com a esquerda da caixa */
    margin-bottom: 2px;
    /* Espa√ßo positivo, sem sobrepor */
    z-index: 10;
    position: relative;
    width: 100%;
    /* Permitir largura total */
    padding-left: 20px;
    white-space: nowrap;
    /* For√ßar uma linha */
    display: flex;
    align-items: center;
    gap: 10px;
}

.hero-element-icon {
    height: 28px;
    width: auto;
    filter: drop-shadow(0 2px 2px rgba(0, 0, 0, 0.3));
}

/* THE ACTUAL CARD BOX */
.hero-card-inner-split {
    background: #fff;
    border: 3px solid #8b4513;
    border-radius: 12px;
    display: flex;
    flex-direction: row;
    height: 190px;
    /* Altura reduzida para quadrado aproximado */
    position: relative;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
    overflow: visible;
    /* Permitir que o overlay saia pra fora */
    z-index: 1;
    margin-top: 5px;
}

/* LEFT COLUMN (50%) */
.card-left-col {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    /* Imagem no topo */
    padding: 0;
    /* Sem padding para imagem encostar */
    background: #fff;
    border-right: none;
    /* Removida a linha pontilhada */
    position: relative;
    overflow: hidden;
    /* Cortar excesso */
}

.hero-image-wrapper {
    width: 100%;
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: flex-start;
    /* Alinhar topo */
    position: relative;
    padding: 0;
}

.hero-full-body-img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: top center;
    image-rendering: -webkit-optimize-contrast;
    image-rendering: crisp-edges;
    filter: drop-shadow(0 5px 5px rgba(0, 0, 0, 0.3));
    transition: transform 0.3s ease;
    /* Transi√ß√£o mais suave */
    margin: 0;
    cursor: pointer;
}

.hero-full-body-img:hover {
    transform: scale(1.1);
    z-index: 10;
}

/* RIGHT COLUMN (50%) */
.card-right-col {
    flex: 1;
    display: flex;
    flex-direction: column;
    padding: 10px 15px;
    background: rgba(255, 255, 255, 0.9);
    border-top-right-radius: 8px;
    border-bottom-right-radius: 8px;
    justify-content: flex-start;
    gap: 8px;
    /* Espa√ßo uniforme entre os elementos */
    position: relative;
}

.hero-level-display {
    font-family: 'Bangers', cursive;
    font-size: 2.2em;
    color: #333;
    border-bottom: 2px solid #ff6600;
    margin-bottom: 5px;
    text-align: right;
}

/* OVERLAY DETALHES (Preto com opacidade) Popup */
.hero-stats-overlay {
    position: absolute;
    top: -10px;
    /* Mais pra cima */
    right: -10px;
    /* Mais pra direita */
    width: 200px;
    height: auto;
    min-height: 60px;
    background: rgba(0, 0, 0, 0.9);
    color: #fff;
    padding: 15px;
    z-index: 100;
    opacity: 0;
    pointer-events: none;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    transform: translateY(10px);
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    border-radius: 8px;
    border: 1px solid #ff9800;
    font-family: 'Roboto', sans-serif;
    text-align: left;
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.5);
}

/* Abrir ao passar o mouse apenas na Imagem ou no Bot√£o de Upgrade */
.hero-card-inner-split:hover .hero-stats-overlay {
    opacity: 0;
}

.hero-card-inner-split:has(.card-left-col:hover) .hero-stats-overlay,
.hero-card-inner-split:has(.hero-buy-btn:hover) .hero-stats-overlay {
    opacity: 1;
    transform: translateY(0);
}

.overlay-title {
    font-family: 'Shojumaru', cursive;
    color: #ff9800;
    font-size: 1.1em;
    margin-bottom: 8px;
    border-bottom: 1px solid #444;
    padding-bottom: 4px;
}

.stat-line {
    font-size: 1em;
    margin: 3px 0;
}

.stat-line strong {
    color: #ffd700;
}

.dps-increment {
    color: #4caf50;
    font-weight: bold;
    margin-left: 5px;
    text-shadow: 0 0 5px rgba(76, 175, 80, 0.5);
}

.stat-line-desc {
    font-size: 0.85em;
    color: #bbb;
    margin-top: 5px;
    line-height: 1.2;
}

hr {
    border: 0;
    border-top: 1px solid #444;
    margin: 8px 0;
}

.hero-skills-row {
    display: flex;
    gap: 12px;
    /* Mais espa√ßo entre √≠cones */
    margin: 10px 0 10px 15px;
    /* Adicionado 15px na esquerda para chegar pra direita */
    min-height: 50px;
    align-items: center;
    justify-content: flex-start;
}

.skill-box {
    width: 45px;
    height: 45px;
    background: #1a1a1a;
    border-radius: 8px;
    border: 2px solid #5d4037;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    position: relative;
    overflow: hidden;
    /* Cortar imagem nos cantos arredondados */
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
    transition: transform 0.1s;
}

.skill-box:hover:not(.locked) {
    transform: scale(1.1);
    z-index: 10;
}

.skill-img-icon {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.skill-box.locked {
    opacity: 0.3;
    filter: grayscale(1);
    cursor: not-allowed;
}

.skill-box.available {
    background: #5d4037;
    border-color: #ffd700;
    animation: pulseBorder 1.5s infinite;
}

.skill-box.bought {
    border-color: #00ff00;
}

.skill-check {
    position: absolute;
    top: -8px;
    right: -8px;
    color: #00ff00;
    font-size: 1.2em;
    font-weight: bold;
    text-shadow: 1px 1px 0 #000;
}

/* API Button at Bottom Right */
.hero-buy-btn {
    background: linear-gradient(to bottom, #ff9800 0%, #f57c00 100%);
    border: 2px solid #e65100;
    border-radius: 6px;
    padding: 5px 10px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    cursor: pointer;
    box-shadow: 0 3px 0 #bf360c;
    transition: active 0.1s;
    margin-top: 5px;
}

.hero-buy-btn:active {
    transform: translateY(3px);
    box-shadow: none;
}

.hero-buy-btn.locked {
    background: #777;
    border-color: #555;
    box-shadow: none;
    cursor: not-allowed;
    justify-content: center;
    color: #ccc;
}

.buy-label {
    font-family: 'Bangers', cursive;
    color: white;
    font-size: 1.2em;
}

.buy-value {
    font-weight: bold;
    color: #fff;
    font-size: 1em;
}

.hero-buy-btn.disabled {
    background: #9e9e9e;
    border-color: #757575;
    cursor: not-allowed;
    box-shadow: none;
    opacity: 0.8;
}

/* Mobile Adjust */
@media (max-width: 900px) {
    .hero-card-split {
        height: auto;
        flex-direction: column;
    }

    .card-left-col {
        border-right: none;
        border-bottom: 2px dashed #dba669;
    }

    .hero-image-wrapper {
        min-height: 200px;
    }

    .hero-full-body-img {
        height: auto;
        max-height: 250px;
    }
}

/* ===== BACKPACK ICON ===== */
.backpack-icon {
    font-size: 1.2em;
    cursor: pointer;
    margin-left: 20px;
    display: inline-block;
    transition: transform 0.2s ease, filter 0.2s ease;
    filter: drop-shadow(2px 2px 4px rgba(0, 0, 0, 0.5));
}

.backpack-icon:hover {
    transform: scale(1.15) rotate(-5deg);
    filter: drop-shadow(3px 3px 6px rgba(139, 69, 19, 0.8));
}

.backpack-icon:active {
    transform: scale(1.05);
}

/* ===== MODAL OVERLAY ===== */
.modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.85);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 9999;
    backdrop-filter: blur(5px);
    animation: fadeIn 0.3s ease;
}

@keyframes fadeIn {
    from {
        opacity: 0;
    }

    to {
        opacity: 1;
    }
}

/* ===== BACKPACK MODAL ===== */
.backpack-modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: rgba(0, 0, 0, 0.85);
    backdrop-filter: blur(5px);
    z-index: 10000;
    display: none;
    align-items: center;
    justify-content: center;
}

.backpack-modal.active {
    display: flex;
}

.backpack-container {
    background: linear-gradient(135deg, #d4a574 0%, #c89860 50%, #b8885a 100%);
    border: 6px solid #8b6f47;
    border-radius: 20px;
    box-shadow: 0 15px 50px rgba(0, 0, 0, 0.8),
        inset 0 2px 10px rgba(255, 255, 255, 0.2);
    width: 90%;
    max-width: 900px;
    max-height: 85vh;
    overflow: hidden;
    position: relative;
    animation: modalSlideIn 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

@keyframes modalSlideIn {
    from {
        transform: scale(0.7);
        opacity: 0;
    }

    to {
        transform: scale(1);
        opacity: 1;
    }
}

.modal-header {
    background: linear-gradient(to bottom, #8b6f47, #6d5638);
    padding: 20px 30px;
    border-bottom: 4px solid #5d4a2f;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.4);
}

.modal-header h2 {
    font-family: 'Shojumaru', cursive;
    font-size: 2.2em;
    color: #fff;
    text-shadow: 3px 3px 0 #000,
        -1px -1px 0 #000,
        1px -1px 0 #000,
        -1px 1px 0 #000,
        0 0 15px rgba(255, 215, 0, 0.5);
    margin: 0;
}

.modal-close {
    background: #d32f2f;
    border: 3px solid #8b0000;
    color: #fff;
    font-size: 1.8em;
    font-weight: bold;
    width: 45px;
    height: 45px;
    border-radius: 50%;
    cursor: pointer;
    transition: all 0.2s ease;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.4);
    display: flex;
    align-items: center;
    justify-content: center;
}

.modal-close:hover {
    background: #ff5252;
    transform: rotate(90deg) scale(1.1);
    box-shadow: 0 6px 12px rgba(255, 0, 0, 0.6);
}

.modal-close:active {
    transform: rotate(90deg) scale(0.95);
}

.modal-body {
    padding: 30px;
    overflow-y: auto;
    max-height: calc(85vh - 100px);
    background: linear-gradient(to bottom, rgba(255, 255, 255, 0.1), rgba(0, 0, 0, 0.1));
}

/* ===== INVENTORY GRID ===== */
.inventory-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(90px, 1fr));
    gap: 15px;
    padding: 10px;
}

.inventory-slot {
    width: 90px;
    height: 90px;
    background: linear-gradient(135deg, #8b0000, #a52a2a);
    border: 4px solid #5d0000;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.6),
        0 4px 10px rgba(0, 0, 0, 0.5);
}

.inventory-slot:hover {
    transform: translateY(-5px) scale(1.05);
    box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.6),
        0 8px 20px rgba(255, 215, 0, 0.4);
    border-color: #ffd700;
}

.inventory-slot.empty::before {
    content: 'üîí';
    font-size: 2.5em;
    opacity: 0.3;
    filter: grayscale(1);
}

.inventory-slot.has-item {
    background: linear-gradient(135deg, #1a472a, #2e7d32);
    border-color: #1b5e20;
}

.inventory-slot.has-item:hover {
    border-color: #4caf50;
}

.item-icon {
    font-size: 3em;
    filter: drop-shadow(2px 2px 4px rgba(0, 0, 0, 0.8));
}

.item-count {
    position: absolute;
    bottom: 5px;
    right: 8px;
    background: rgba(0, 0, 0, 0.85);
    color: #fff;
    font-size: 0.9em;
    font-weight: bold;
    padding: 2px 6px;
    border-radius: 8px;
    border: 2px solid #ffd700;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.6);
}

/* ===== ADMIN PANEL ===== */
#admin-trigger {
    position: fixed;
    bottom: 20px;
    right: 20px;
    width: 50px;
    height: 50px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border: 3px solid #4a5568;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.8em;
    cursor: pointer;
    z-index: 8888;
    transition: all 0.3s ease;
    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
}

#admin-trigger:hover {
    transform: scale(1.15) rotate(90deg);
    box-shadow: 0 6px 25px rgba(102, 126, 234, 0.7);
}

.admin-modal {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border: 6px solid #4a5568;
    border-radius: 20px;
    box-shadow: 0 15px 50px rgba(0, 0, 0, 0.8),
        inset 0 2px 10px rgba(255, 255, 255, 0.2);
    width: 90%;
    max-width: 500px;
    overflow: hidden;
    position: relative;
    animation: modalSlideIn 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

.admin-input-group {
    display: flex;
    flex-direction: column;
    gap: 15px;
    padding: 10px;
}

.admin-input-group label {
    font-family: 'Shojumaru', cursive;
    font-size: 1.3em;
    color: #fff;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
}

.admin-input-group input {
    padding: 12px 15px;
    font-size: 1.2em;
    border: 3px solid #4a5568;
    border-radius: 10px;
    background: rgba(255, 255, 255, 0.95);
    color: #333;
    font-weight: bold;
    transition: all 0.3s ease;
}

.admin-input-group input:focus {
    outline: none;
    border-color: #ffd700;
    box-shadow: 0 0 15px rgba(255, 215, 0, 0.5);
}

.admin-btn {
    padding: 15px 30px;
    font-size: 1.3em;
    font-weight: bold;
    background: linear-gradient(to bottom, #ffd700, #ffb700);
    border: 3px solid #8b6f00;
    border-radius: 12px;
    color: #000;
    cursor: pointer;
    transition: all 0.2s ease;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.4);
    text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.5);
}

.admin-btn:hover {
    background: linear-gradient(to bottom, #ffed4e, #ffd700);
    transform: translateY(-2px);
    box-shadow: 0 6px 15px rgba(255, 215, 0, 0.6);
}

.admin-btn:active {
    transform: translateY(0);
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.4);
}

/* Elemental Cycle Guide */
.elemental-cycle-guide {
    position: absolute;
    top: 100px;
    right: 20px;
    width: 250px;
    height: auto;
    z-index: 100;
    pointer-events: none;
    filter: drop-shadow(0 0 15px rgba(0, 0, 0, 0.6));
    opacity: 1;
    transition: opacity 0.3s ease;
}

.center-panel:hover .elemental-cycle-guide {
    opacity: 0.7;
}

/* Item Drop Notification - Redesenhada */
.item-drop-notification {
    position: fixed;
    bottom: 120px;
    right: 30px;
    background: linear-gradient(135deg, rgba(45, 27, 0, 0.95) 0%, rgba(93, 58, 26, 0.95) 100%);
    border: 3px solid #ffd700;
    border-radius: 10px;
    padding: 12px 18px;
    z-index: 10000;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.6), 0 0 20px rgba(255, 215, 0, 0.3);
    animation: dropSlideIn 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55), dropFadeOut 0.4s ease-in 2.6s forwards;
    pointer-events: none;
    display: flex;
    align-items: center;
    gap: 12px;
    max-width: 280px;
}

.item-drop-notification img {
    width: 45px;
    height: 45px;
    flex-shrink: 0;
    filter: drop-shadow(0 2px 6px rgba(255, 215, 0, 0.4));
}

.item-drop-notification .drop-content {
    display: flex;
    flex-direction: column;
    gap: 2px;
}

.item-drop-notification .drop-text {
    font-family: 'Bangers', cursive;
    font-size: 1.1em;
    color: #ffd700;
    text-shadow: 1px 1px 3px #000;
    letter-spacing: 0.5px;
    line-height: 1;
}

.item-drop-notification .item-name {
    font-family: 'Roboto', sans-serif;
    font-size: 0.95em;
    font-weight: 500;
    color: #f0e6d2;
    text-shadow: 1px 1px 2px #000;
    line-height: 1.2;
}

@keyframes dropSlideIn {
    0% {
        opacity: 0;
        transform: translateX(100px);
    }

    100% {
        opacity: 1;
        transform: translateX(0);
    }
}

@keyframes dropFadeOut {
    0% {
        opacity: 1;
        transform: translateX(0);
    }

    100% {
        opacity: 0;
        transform: translateX(50px);
    }
}

/* Item Icon Image in Inventory */
.item-icon-img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
}

/* ===== SISTEMA DE MOCHILA - DESIGN MODERNO E PROFISSIONAL ===== */

/* Modal Backdrop */
.backpack-modal {
    display: flex !important;
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
    width: 100vw !important;
    height: 100vh !important;
    background: rgba(0, 0, 0, 0.5);
    backdrop-filter: blur(4px);
    z-index: 99999 !important;
    justify-content: center !important;
    align-items: center !important;
    animation: fadeIn 0.2s ease-out;
    visibility: hidden;
    opacity: 0;
    transition: opacity 0.2s, visibility 0.2s;
}

.backpack-modal.active {
    visibility: visible;
    opacity: 1;
}

@keyframes fadeIn {
    from {
        opacity: 0;
    }

    to {
        opacity: 1;
    }
}

/* Container Principal */
.backpack-container {
    background: linear-gradient(145deg, #1a1a1a 0%, #2d2d2d 100%);
    border: 1px solid #404040;
    border-radius: 12px;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.8), 0 0 0 1px rgba(255, 255, 255, 0.05);
    max-width: 700px;
    width: 90%;
    max-height: 85vh;
    overflow: hidden;
    animation: slideUp 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    margin: auto;
}

@keyframes slideUp {
    from {
        opacity: 0;
        transform: translateY(30px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Header */
.backpack-header {
    background: linear-gradient(135deg, #2a2a2a 0%, #1f1f1f 100%);
    border-bottom: 1px solid #404040;
    padding: 20px 25px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.backpack-title {
    display: flex;
    align-items: center;
    gap: 12px;
    font-family: 'Roboto', sans-serif;
    font-size: 1.4em;
    font-weight: 600;
    color: #e0e0e0;
    letter-spacing: 0.5px;
}

.close-backpack {
    background: transparent;
    border: none;
    color: #999;
    font-size: 1.8em;
    cursor: pointer;
    width: 36px;
    height: 36px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 6px;
    transition: all 0.2s;
}

.close-backpack:hover {
    background: rgba(255, 255, 255, 0.05);
    color: #fff;
}

/* Body */
.backpack-body {
    padding: 25px;
    max-height: calc(85vh - 80px);
    overflow-y: auto;
}

.backpack-body::-webkit-scrollbar {
    width: 8px;
}

.backpack-body::-webkit-scrollbar-track {
    background: #1a1a1a;
    border-radius: 4px;
}

.backpack-body::-webkit-scrollbar-thumb {
    background: #404040;
    border-radius: 4px;
}

.backpack-body::-webkit-scrollbar-thumb:hover {
    background: #505050;
}

/* Grid de Invent√°rio */
.inventory-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(70px, 1fr));
    gap: 10px;
    padding: 5px;
}

/* Slots */
.inventory-slot {
    aspect-ratio: 1;
    background: linear-gradient(145deg, #242424 0%, #1a1a1a 100%);
    border: 1px solid #333;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    transition: all 0.2s;
    cursor: default;
    box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.5);
}

.inventory-slot.empty {
    opacity: 0.4;
}

.inventory-slot.empty:hover {
    background: linear-gradient(145deg, #2a2a2a 0%, #202020 100%);
    border-color: #3a3a3a;
}

.inventory-slot.has-item {
    background: linear-gradient(145deg, #2d2d2d 0%, #232323 100%);
    border-color: #4a4a4a;
    opacity: 1;
    cursor: pointer;
}

.inventory-slot.has-item:hover {
    background: linear-gradient(145deg, #353535 0%, #2a2a2a 100%);
    border-color: #5a5a5a;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.6), inset 0 1px 2px rgba(255, 255, 255, 0.05);
}

/* √çcone do Item */
.item-icon {
    font-size: 2.2em;
    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.5));
}

/* Contador de Itens */
.item-count {
    position: absolute;
    bottom: 4px;
    right: 4px;
    background: rgba(0, 0, 0, 0.85);
    color: #fff;
    font-family: 'Roboto', sans-serif;
    font-size: 0.75em;
    font-weight: 600;
    padding: 2px 6px;
    border-radius: 4px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
    line-height: 1;
}

/* √çcone da Mochila no Header */
.backpack-icon {
    cursor: pointer;
    font-size: 0.9em;
    transition: transform 0.2s;
    display: inline-block;
    margin-left: 8px;
}

.backpack-icon:hover {
    transform: scale(1.15);
}/* ===== ANIMA√á√ÉO DE DIAMANTES ===== */
.diamond-drop {
    position: absolute;
    font-size: 2em;
    pointer-events: none;
    z-index: 100;
    animation: diamondFall 1s ease-out forwards;
    filter: drop-shadow(0 0 8px rgba(0, 212, 255, 0.8));
}

@keyframes diamondFall {
    0% {
        transform: translateY(0) scale(1);
        opacity: 1;
    }

    50% {
        transform: translateY(-30px) scale(1.2);
        opacity: 1;
    }

    100% {
        transform: translateY(60px) scale(0.5);
        opacity: 0;
    }
}


----- FILE: static/js/game.js  (sha1:c383fffdb132, bytes:11091) -----
// Estado Global do Jogo
const gameState = {
    gold: 0,
    totalDps: 0,
    clickDamage: 1,
    currentZone: 1,
    monstersKilledInZone: 0,
    heroes: [], // { id, level, currentDps, cost }
    currentMonster: {
        hp: 10,
        maxHp: 10,
        name: "Bandido",
        img: ""
    },
    statistics: {
        totalClicks: 0,
        totalKills: 0,
        maxZone: 1
    }
};

// Configura√ß√µes
const TICKS_PER_SECOND = 10;
let autoSaveInterval;

// Inicializa√ß√£o
function initGame() {
    loadGame();
    setupHeroes();
    spawnMonster();
    updateUI();
    startGameLoop();
    setupEventListeners();

    // Auto-save a cada 30s
    autoSaveInterval = setInterval(saveGame, 30000);
}

// Configura lista de her√≥is baseada no game_data.js
function setupHeroes() {
    gameState.heroes = heroesData.map(heroData => {
        // Tenta carregar estado salvo ou inicia do zero
        const savedHero = gameState.savedHeroes ? gameState.savedHeroes.find(h => h.id === heroData.id) : null;
        return {
            ...heroData,
            level: savedHero ? savedHero.level : 0,
            currentCost: savedHero ? calculateCost(heroData.baseCost, savedHero.level) : heroData.baseCost,
            currentDps: savedHero ? heroData.baseDps * savedHero.level : 0
        };
    });
    recalculateTotalDps();
    renderHeroesList();
}

function calculateCost(baseCost, currentLevel) {
    return Math.floor(baseCost * Math.pow(1.07, currentLevel));
}

function recalculateTotalDps() {
    gameState.totalDps = gameState.heroes.reduce((sum, hero) => sum + hero.currentDps, 0);
    // Dano de clique √© 1 + 1% do DPS total (m√≠nimo 1)
    gameState.clickDamage = 1 + Math.ceil(gameState.totalDps * 0.01);
}

// Renderiza√ß√£o da Lista de Her√≥is
function renderHeroesList() {
    const listContainer = document.getElementById('heroes-list');
    listContainer.innerHTML = '';

    gameState.heroes.forEach(hero => {
        const item = document.createElement('div');
        item.className = 'hero-item';
        item.id = `hero-${hero.id}`;
        item.dataset.id = hero.id;
        item.onclick = () => buyHero(hero.id);

        item.innerHTML = `
            <div class="hero-img" style="background-image: url('static/img/${hero.img}'); background-size: cover;"></div>
            <div class="hero-info">
                <div class="hero-name">${hero.name} <span class="hero-level">Nv. ${hero.level}</span></div>
                <div class="hero-stats">DPS: ${formatNumber(hero.baseDps * (hero.level || 1))} | +${formatNumber(hero.baseDps)} DPS/Lv</div>
                <div class="hero-cost">Custo: ${formatNumber(hero.currentCost)} Ryo</div>
            </div>
        `;
        listContainer.appendChild(item);
    });
}

function updateHeroUI(heroId) {
    const hero = gameState.heroes.find(h => h.id === heroId);
    if (!hero) return;

    const item = document.getElementById(`hero-${heroId}`);
    if (item) {
        item.querySelector('.hero-level').textContent = `Nv. ${hero.level}`;
        item.querySelector('.hero-cost').textContent = `Custo: ${formatNumber(hero.currentCost)} Ryo`;

        // Verifica se pode comprar visualmente
        if (gameState.gold >= hero.currentCost) {
            item.classList.remove('disabled');
        } else {
            item.classList.add('disabled');
        }
    }
}

// Mec√¢nica de Compra
function buyHero(heroId) {
    const hero = gameState.heroes.find(h => h.id === heroId);
    if (hero && gameState.gold >= hero.currentCost) {
        gameState.gold -= hero.currentCost;
        hero.level++;
        hero.currentCost = calculateCost(hero.baseCost, hero.level);
        hero.currentDps = hero.baseDps * hero.level;

        recalculateTotalDps();
        updateUI();
        renderHeroesList(); // Re-render para atualizar tudo
        logMessage(`Voc√™ contratou/treinou ${hero.name}!`);
    }
}

// Spawning de Monstros
function spawnMonster() {
    const zoneMultiplier = Math.pow(zoneData.hpMultiplier, gameState.currentZone - 1);
    gameState.currentMonster.maxHp = Math.floor(zoneData.baseHp * zoneMultiplier);
    gameState.currentMonster.hp = gameState.currentMonster.maxHp;

    const randomName = monsterNames[Math.floor(Math.random() * monsterNames.length)];
    gameState.currentMonster.name = `${randomName} (Lv. ${gameState.currentZone})`;

    // Atualiza visual
    document.getElementById('monster-name').textContent = gameState.currentMonster.name;
    // URL placeholder aleat√≥ria para monstros, em um app real usaria assets locais
    const monsterId = Math.floor(Math.random() * 10) + 1;
    document.getElementById('monster-img').src = `https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/${monsterId}.png`; // Placeholder tempor√°rio

    updateMonsterUI();
}

function damageMonster(amount, isClick = false) {
    gameState.currentMonster.hp -= amount;
    if (gameState.currentMonster.hp < 0) gameState.currentMonster.hp = 0;

    if (isClick) {
        createDamageNumber(amount, true);
        animateMonsterShake();
        gameState.statistics.totalClicks++;
    }

    if (gameState.currentMonster.hp <= 0) {
        monterDeath();
    }

    updateMonsterUI();
}

function monterDeath() {
    // Recompensa
    const zoneMultiplier = Math.pow(zoneData.coinsMultiplier, gameState.currentZone - 1);
    const goldDrop = Math.ceil(Math.random() * 5 * zoneMultiplier); // Base 1-5 * multi

    gameState.gold += goldDrop;
    gameState.statistics.totalKills++;
    gameState.monstersKilledInZone++;

    logMessage(`Monstro derrotado! +${formatNumber(goldDrop)} Ryo`);

    // Progress√£o de Zona
    if (gameState.monstersKilledInZone >= zoneData.monstersPerZone) {
        gameState.currentZone++;
        gameState.monstersKilledInZone = 0;
        if (gameState.currentZone > gameState.statistics.maxZone) {
            gameState.statistics.maxZone = gameState.currentZone;
            logMessage(`AVAN√áOU PARA ZONA ${gameState.currentZone}!`);
        }
    }

    spawnMonster();
    updateUI();
}

// Loop Principal
function startGameLoop() {
    setInterval(() => {
        // Dano autom√°tico (DPS) aplicado a cada d√©cimo de segundo
        if (gameState.totalDps > 0) {
            const dpsTick = gameState.totalDps / TICKS_PER_SECOND;
            if (dpsTick > 0 && gameState.currentMonster.hp > 0) {
                damageMonster(dpsTick, false);
            }
        }

        // Verifica bot√µes habilitados
        checkBuyButtons();

    }, 1000 / TICKS_PER_SECOND);
}

function checkBuyButtons() {
    gameState.heroes.forEach(hero => {
        const item = document.getElementById(`hero-${hero.id}`);
        if (item) {
            if (gameState.gold >= hero.currentCost) {
                item.classList.remove('disabled');
            } else {
                item.classList.add('disabled');
            }
        }
    });
}

// Event Listeners
function setupEventListeners() {
    const clickTarget = document.getElementById('click-target');
    clickTarget.addEventListener('mousedown', () => {
        damageMonster(gameState.clickDamage, true);
        clickTarget.querySelector('.monster-visual').style.transform = "scale(0.9)";
    });

    clickTarget.addEventListener('mouseup', () => {
        clickTarget.querySelector('.monster-visual').style.transform = "scale(1)";
    });
}

// UI Helpers
function updateUI() {
    document.getElementById('player-gold').textContent = formatNumber(Math.floor(gameState.gold));
    document.getElementById('total-dps').textContent = formatNumber(Math.floor(gameState.totalDps));
    document.getElementById('click-damage').textContent = formatNumber(Math.floor(gameState.clickDamage));

    document.getElementById('current-zone').textContent = gameState.currentZone;
    document.getElementById('monsters-killed').textContent = gameState.monstersKilledInZone;

    document.getElementById('stat-killed').textContent = formatNumber(gameState.statistics.totalKills);
    document.getElementById('stat-clicks').textContent = formatNumber(gameState.statistics.totalClicks);
    document.getElementById('stat-max-zone').textContent = gameState.statistics.maxZone;
}

function updateMonsterUI() {
    const pct = (gameState.currentMonster.hp / gameState.currentMonster.maxHp) * 100;
    document.getElementById('hp-fill').style.width = `${pct}%`;
    document.getElementById('current-hp').textContent = formatNumber(Math.ceil(gameState.currentMonster.hp));
}

function createDamageNumber(amount, isCrit) {
    const container = document.getElementById('damage-numbers-container');
    const el = document.createElement('div');
    el.className = 'damage-number';
    if (isCrit && Math.random() < 0.05) { // 5% chance crit visual
        el.classList.add('damage-crit');
        amount *= 2; // Cr√≠tico visual simples
    }
    el.textContent = formatNumber(Math.floor(amount));

    // Posi√ß√£o aleat√≥ria perto do centro
    const x = 50 + (Math.random() * 20 - 10);
    const y = 50 + (Math.random() * 20 - 10);

    el.style.left = `${x}%`;
    el.style.top = `${y}%`;

    container.appendChild(el);

    setTimeout(() => el.remove(), 1000);
}

function animateMonsterShake() {
    const visual = document.querySelector('.monster-visual');
    visual.classList.remove('shake');
    void visual.offsetWidth; // Trigger reflow
    visual.classList.add('shake');
}

function logMessage(msg) {
    const log = document.getElementById('battle-log');
    const p = document.createElement('p');
    p.textContent = msg;
    log.prepend(p);
    if (log.children.length > 20) log.lastChild.remove();
}

function formatNumber(num) {
    if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';
    if (num >= 1000) return (num / 1000).toFixed(1) + 'k';
    return Math.floor(num).toString();
}

// Persistence
function saveGame() {
    const saveObj = {
        gold: gameState.gold,
        currentZone: gameState.currentZone,
        savedHeroes: gameState.heroes.map(h => ({ id: h.id, level: h.level })),
        statistics: gameState.statistics
    };
    localStorage.setItem('narutoClickerSave', JSON.stringify(saveObj));
    // console.log("Jogo Salvo");
}

function loadGame() {
    const saveStr = localStorage.getItem('narutoClickerSave');
    if (saveStr) {
        try {
            const saved = JSON.parse(saveStr);
            gameState.gold = saved.gold || 0;
            gameState.currentZone = saved.currentZone || 1;
            gameState.savedHeroes = saved.savedHeroes || [];
            gameState.statistics = { ...gameState.statistics, ...saved.statistics };
            logMessage("Progresso carregado!");
        } catch (e) {
            console.error("Erro ao carregar save", e);
        }
    }
}

// Start
window.onload = initGame;


----- FILE: static/js/game_data.js  (sha1:ee8ff0e04b9f, bytes:4368) -----
const heroesData = [
    { id: 1, name: "Iruka Umino", baseCost: 10, baseDps: 1, img: "iruka.png" },
    { id: 2, name: "Mizuki", baseCost: 100, baseDps: 5, img: "mizuki.png" },
    { id: 3, name: "Konohamaru Sarutobi", baseCost: 500, baseDps: 12, img: "konohamaru.png" },
    { id: 4, name: "Ebisu", baseCost: 1000, baseDps: 25, img: "ebisu.png" },
    { id: 5, name: "Tenten", baseCost: 2500, baseDps: 50, img: "tenten.png" },
    { id: 6, name: "Ino Yamanaka", baseCost: 5000, baseDps: 80, img: "ino.png" },
    { id: 7, name: "Kiba Inuzuka", baseCost: 12000, baseDps: 150, img: "kiba.png" },
    { id: 8, name: "Shino Aburame", baseCost: 25000, baseDps: 300, img: "shino.png" },
    { id: 9, name: "Hinata Hyuga (Genin)", baseCost: 60000, baseDps: 550, img: "hinata_genin.png" },
    { id: 10, name: "Choji Akimichi", baseCost: 150000, baseDps: 1000, img: "choji.png" },
    { id: 11, name: "Shikamaru Nara", baseCost: 400000, baseDps: 2200, img: "shikamaru.png" },
    { id: 12, name: "Sakura Haruno (Genin)", baseCost: 1000000, baseDps: 4500, img: "sakura_genin.png" },
    { id: 13, name: "Sasuke Uchiha (Genin)", baseCost: 2500000, baseDps: 9000, img: "sasuke_genin.png" },
    { id: 14, name: "Naruto Uzumaki (Genin)", baseCost: 6000000, baseDps: 18000, img: "naruto_genin.png" },
    { id: 15, name: "Haku", baseCost: 15000000, baseDps: 40000, img: "haku.png" },
    { id: 16, name: "Zabuza Momochi", baseCost: 40000000, baseDps: 90000, img: "zabuza.png" },
    { id: 17, name: "Rock Lee (Port√µes)", baseCost: 100000000, baseDps: 200000, img: "rocklee.png" },
    { id: 18, name: "Neji Hyuga", baseCost: 300000000, baseDps: 500000, img: "neji.png" },
    { id: 19, name: "Gaara do Deserto", baseCost: 800000000, baseDps: 1200000, img: "gaara.png" },
    { id: 20, name: "Kabuto Yakushi", baseCost: 2000000000, baseDps: 3000000, img: "kabuto.png" },
    { id: 21, name: "Kimimaro", baseCost: 5000000000, baseDps: 7000000, img: "kimimaro.png" },
    { id: 22, name: "Yamato", baseCost: 12000000000, baseDps: 15000000, img: "yamato.png" },
    { id: 23, name: "Sai", baseCost: 30000000000, baseDps: 35000000, img: "sai.png" },
    { id: 24, name: "Asuma Sarutobi", baseCost: 80000000000, baseDps: 85000000, img: "asuma.png" },
    { id: 25, name: "Kakashi Hatake", baseCost: 200000000000, baseDps: 200000000, img: "kakashi.png" },
    { id: 26, name: "Might Guy (7 Port√µes)", baseCost: 500000000000, baseDps: 500000000, img: "guy.png" },
    { id: 27, name: "Kisame Hoshigaki", baseCost: 1500000000000, baseDps: 1200000000, img: "kisame.png" },
    { id: 28, name: "Deidara", baseCost: 4000000000000, baseDps: 3000000000, img: "deidara.png" },
    { id: 29, name: "Sasori", baseCost: 10000000000000, baseDps: 7000000000, img: "sasori.png" },
    { id: 30, name: "Kakuzu", baseCost: 25000000000000, baseDps: 15000000000, img: "kakuzu.png" },
    { id: 31, name: "Hidan", baseCost: 70000000000000, baseDps: 40000000000, img: "hidan.png" },
    { id: 32, name: "Itachi Uchiha", baseCost: 200000000000000, baseDps: 100000000000, img: "itachi.png" },
    { id: 33, name: "Jiraiya", baseCost: 600000000000000, baseDps: 300000000000, img: "jiraiya.png" },
    { id: 34, name: "Orochimaru", baseCost: 2000000000000000, baseDps: 800000000000, img: "orochimaru.png" },
    { id: 35, name: "Tsunade Senju", baseCost: 7000000000000000, baseDps: 2500000000000, img: "tsunade.png" },
    { id: 36, name: "Pain (Nagato)", baseCost: 25000000000000000, baseDps: 8000000000000, img: "pain.png" },
    { id: 37, name: "Minato Namikaze", baseCost: 100000000000000000, baseDps: 30000000000000, img: "minato.png" },
    { id: 38, name: "Hashirama Senju", baseCost: 500000000000000000, baseDps: 150000000000000, img: "hashirama.png" },
    { id: 39, name: "Madara Uchiha (Rikudou)", baseCost: 2000000000000000000, baseDps: 800000000000000, img: "madara.png" },
    { id: 40, name: "Naruto (Modo Baryon)", baseCost: 10000000000000000000, baseDps: 5000000000000000, img: "naruto_baryon.png" }
];

const zoneData = {
    baseHp: 10,
    hpMultiplier: 1.55, // HP cresce 55% por level
    coinsMultiplier: 1.5,
    monstersPerZone: 10
};

const monsterNames = [
    "Bandido", "Ninja Renegado", "Zetsu Branco", "Clone das Sombras", "Marionete", 
    "Cobra Gigante", "Sapo Gigante", "Lesma Gigante", "Corvo", "Guerreiro Susanoo"
];


----- FILE: static/js/game_data_v3.js  (sha1:118f3ddf5a81, bytes:10721) -----
const heroesData = [
    { id: 1, name: "Naruto Uzumaki", baseCost: 10, baseDps: 1, img: "./static/img/heroes/icons/naruto_icon.png", focus: "center center", element: "wind" },
    { id: 2, name: "Sasuke Uchiha", baseCost: 100, baseDps: 5, img: "./static/img/heroes/icons/sasuke_icon.png", focus: "center center", element: "fire" },
    { id: 3, name: "Sakura Haruno", baseCost: 500, baseDps: 12, img: "./static/img/heroes/icons/sakura_icon.png", focus: "center center", element: "water" },
    { id: 4, name: "Kiba Inuzuka", baseCost: 1000, baseDps: 25, img: "./static/img/heroes/icons/kiba_icon.png", element: "wind" },
    { id: 5, name: "Shino Aburame", baseCost: 2500, baseDps: 50, img: "./static/img/heroes/icons/shino_icon.png", element: "water" },
    { id: 6, name: "Hinata Hyuga", baseCost: 5000, baseDps: 80, img: "./static/img/heroes/icons/hinata_icon.png", element: "water" },
    { id: 7, name: "Shikamaru Nara", baseCost: 12000, baseDps: 150, img: "./static/img/heroes/icons/shikamaru_icon.png", element: "earth" },
    { id: 8, name: "Choji Akimichi", baseCost: 25000, baseDps: 300, img: "./static/img/heroes/icons/choji_icon.png", element: "fire" },
    { id: 9, name: "Ino Yamanaka", baseCost: 60000, baseDps: 550, img: "./static/img/heroes/icons/ino_icon.png", element: "fire" },
    { id: 10, name: "Rock Lee", baseCost: 150000, baseDps: 1000, img: "./static/img/heroes/icons/lee_icon.png", element: null },
    { id: 11, name: "Tenten", baseCost: 400000, baseDps: 2200, img: "./static/img/heroes/icons/tenten_icon.png", element: "lightning" },
    { id: 12, name: "Neji", baseCost: 1000000, baseDps: 4500, img: "./static/img/heroes/icons/neji_icon.png", element: "lightning" },
    { id: 13, name: "Gaara", baseCost: 2500000, baseDps: 9000, img: "./static/img/heroes/icons/gaara_icon.png", element: "earth" },
    { id: 14, name: "Temari", baseCost: 6000000, baseDps: 18000, img: "./static/img/heroes/icons/temari_icon.png", element: "wind" },
    { id: 15, name: "Kankuro", baseCost: 15000000, baseDps: 40000, img: "./static/img/heroes/icons/kankuro_icon.png", element: "earth" },
    { id: 16, name: "Iruka Umino", baseCost: 40000000, baseDps: 90000, img: "https://placehold.co/100x100/4a3b2a/ffffff?text=Iruka" },
    { id: 17, name: "Mizuki", baseCost: 100000000, baseDps: 200000, img: "https://placehold.co/100x100/555555/ffffff?text=Mizuki" },
    { id: 18, name: "Konohamaru", baseCost: 300000000, baseDps: 500000, img: "https://placehold.co/100x100/ffd700/000000?text=Konohamaru" },
    { id: 19, name: "Haku", baseCost: 800000000, baseDps: 1200000, img: "https://placehold.co/100x100/add8e6/000000?text=Haku" },
    { id: 20, name: "Zabuza", baseCost: 2000000000, baseDps: 3000000, img: "https://placehold.co/100x100/2f4f4f/ffffff?text=Zabuza" },
    { id: 21, name: "Kabuto", baseCost: 5000000000, baseDps: 7000000, img: "https://placehold.co/100x100/4b0082/ffffff?text=Kabuto" },
    { id: 22, name: "Kimimaro", baseCost: 12000000000, baseDps: 15000000, img: "https://placehold.co/100x100/f5f5f5/000000?text=Kimimaro" },
    { id: 23, name: "Itachi", baseCost: 30000000000, baseDps: 35000000, img: "https://placehold.co/100x100/000000/ff0000?text=Itachi" },
    { id: 24, name: "Kisame", baseCost: 80000000000, baseDps: 85000000, img: "https://placehold.co/100x100/000080/ffffff?text=Kisame" },
    { id: 25, name: "Jiraiya", baseCost: 200000000000, baseDps: 200000000, img: "https://placehold.co/100x100/8b4513/ffffff?text=Jiraiya" },
    { id: 26, name: "Tsunade", baseCost: 500000000000, baseDps: 500000000, img: "https://placehold.co/100x100/98fb98/000000?text=Tsunade" },
    { id: 27, name: "Orochimaru", baseCost: 1500000000000, baseDps: 1200000000, img: "https://placehold.co/100x100/483d8b/ffffff?text=Orochimaru" },
    { id: 28, name: "Kakashi", baseCost: 4000000000000, baseDps: 3000000000, img: "https://placehold.co/100x100/778899/ffffff?text=Kakashi" },
    { id: 29, name: "Guy", baseCost: 10000000000000, baseDps: 7000000000, img: "https://placehold.co/100x100/006400/ffffff?text=Might+Guy" },
    { id: 30, name: "Asuma", baseCost: 25000000000000, baseDps: 15000000000, img: "https://placehold.co/100x100/2f4f4f/ffffff?text=Asuma" },
    { id: 31, name: "Yamato", baseCost: 70000000000000, baseDps: 40000000000, img: "https://placehold.co/100x100/8b4513/ffffff?text=Yamato" },
    { id: 32, name: "Sai", baseCost: 200000000000000, baseDps: 100000000000, img: "https://placehold.co/100x100/000000/ffffff?text=Sai" },
    { id: 33, name: "Deidara", baseCost: 600000000000000, baseDps: 300000000000, img: "https://placehold.co/100x100/ffd700/000000?text=Deidara" },
    { id: 34, name: "Sasori", baseCost: 2000000000000000, baseDps: 800000000000, img: "https://placehold.co/100x100/8b0000/ffffff?text=Sasori" },
    { id: 35, name: "Hidan", baseCost: 7000000000000000, baseDps: 2500000000000, img: "https://placehold.co/100x100/dc143c/ffffff?text=Hidan" },
    { id: 36, name: "Kakuzu", baseCost: 25000000000000000, baseDps: 8000000000000, img: "https://placehold.co/100x100/2f4f4f/ffffff?text=Kakuzu" },
    { id: 37, name: "Pain", baseCost: 100000000000000000, baseDps: 30000000000000, img: "https://placehold.co/100x100/ff4500/ffffff?text=Pain" },
    { id: 38, name: "Konan", baseCost: 500000000000000000, baseDps: 150000000000000, img: "https://placehold.co/100x100/4169e1/ffffff?text=Konan" },
    { id: 39, name: "Obito", baseCost: 2000000000000000000, baseDps: 800000000000000, img: "https://placehold.co/100x100/4b0082/ffffff?text=Obito" },
    { id: 40, name: "Madara", baseCost: 10000000000000000000, baseDps: 5000000000000000, img: "https://placehold.co/100x100/800000/ffffff?text=Madara" }
];

// Defini√ß√£o Manual de Skills para os Principais (Fiel ao Anime)
const specificUpgrades = {
    1: [ // Naruto
        { id: "h1_u1", reqLevel: 20, type: "SELF_DPS_MULT", value: 2, costMultiplier: 10, icon: "./static/img/skills/skill_1_1.png", name: "Kage Bunshin no Jutsu", desc: "Dano de Clique x2" },
        { id: "h1_u2", reqLevel: 40, type: "SELF_DPS_MULT", value: 2, costMultiplier: 50, icon: "./static/img/skills/skill_1_2.png", name: "Tajuu Kage Bunshin", desc: "Dano de Clique x2" },
        { id: "h1_u3", reqLevel: 60, type: "GLOBAL_DPS_MULT", value: 1.1, costMultiplier: 200, icon: "./static/img/skills/skill_1_3.png", name: "Rasengan", desc: "DPS de Todos +10%" },
        { id: "h1_u4", reqLevel: 80, type: "CRIT_CHANCE", value: 0.01, costMultiplier: 1000, icon: "./static/img/skills/skill_1_4.png", name: "Chakra da Kyuubi", desc: "Chance Cr√≠tica +1%" }
    ],
    2: [ // Sasuke
        { id: "h2_u1", reqLevel: 20, type: "SELF_DPS_MULT", value: 2, costMultiplier: 10, icon: "./static/img/skills/skill_3_1.png", name: "Sharingan", desc: "DPS do Sasuke x2" },
        { id: "h2_u2", reqLevel: 40, type: "SELF_DPS_MULT", value: 2, costMultiplier: 50, icon: "./static/img/skills/skill_3_2.png", name: "Chidori", desc: "DPS do Sasuke x2" },
        { id: "h2_u3", reqLevel: 60, type: "GLOBAL_DPS_MULT", value: 1.1, costMultiplier: 200, icon: "./static/img/skills/skill_3_3.png", name: "Katon: Goukakyuu no Jutsu", desc: "DPS de Todos +10%" },
        { id: "h2_u4", reqLevel: 80, type: "CRIT_CHANCE", value: 0.01, costMultiplier: 1000, icon: "./static/img/skills/skill_3_4.png", name: "Shurikenjutsu Uchiha", desc: "Chance Cr√≠tica +1%" }
    ],
    3: [ // Sakura
        { id: "h3_u1", reqLevel: 20, type: "SELF_DPS_MULT", value: 2, costMultiplier: 10, icon: "./static/img/skills/skill_2_1.png", name: "Controle Preciso de Chakra", desc: "DPS da Sakura x2" },
        { id: "h3_u2", reqLevel: 40, type: "GLOBAL_DPS_MULT", value: 1.1, costMultiplier: 50, icon: "./static/img/skills/skill_2_2.png", name: "Golpe de F√¥r√ßa Concentrada", desc: "DPS de Todos +10%" },
        { id: "h3_u3", reqLevel: 60, type: "SELF_DPS_MULT", value: 2, costMultiplier: 200, icon: "./static/img/skills/skill_2_3.png", name: "An√°lise de Combate", desc: "DPS da Sakura x2" },
        { id: "h3_u4", reqLevel: 80, type: "GLOBAL_DPS_MULT", value: 1.2, costMultiplier: 1000, icon: "./static/img/skills/skill_2_4.png", name: "Resist√™ncia Mental", desc: "DPS de Todos +20%" }
    ]
};

const heroUpgrades = {}; // Map heroId -> Array of upgrades

heroesData.forEach(hero => {
    if (specificUpgrades[hero.id]) {
        heroUpgrades[hero.id] = specificUpgrades[hero.id].map(u => ({ ...u, heroId: hero.id }));
    } else {
        // Gerador Gen√©rico Tem√°tico
        heroUpgrades[hero.id] = [
            {
                id: `h${hero.id}_u1`,
                heroId: hero.id,
                reqLevel: 20,
                type: "SELF_DPS_MULT",
                value: 2,
                costMultiplier: 10,
                icon: "üó°Ô∏è",
                name: `T√©cnica Secreta I`,
                desc: "Dano deste her√≥i x2"
            },
            {
                id: `h${hero.id}_u2`,
                heroId: hero.id,
                reqLevel: 40,
                type: "GLOBAL_DPS_MULT",
                value: 1.1,
                costMultiplier: 50,
                icon: "üìú",
                name: "Estrat√©gia Ninja",
                desc: "DPS de todos +10%"
            },
            {
                id: `h${hero.id}_u3`,
                heroId: hero.id,
                reqLevel: 60,
                type: "SELF_DPS_MULT",
                value: 2,
                costMultiplier: 200,
                icon: "‚ú®",
                name: `T√©cnica Secreta II`,
                desc: "Dano deste her√≥i x2"
            },
            {
                id: `h${hero.id}_u4`,
                heroId: hero.id,
                reqLevel: 80,
                type: "GLOBAL_DPS_MULT",
                value: 1.2, // Buff global gen√©rico forte
                costMultiplier: 1000,
                icon: "üõ°Ô∏è",
                name: "Poder Oculto",
                desc: "DPS de todos +20%"
            }
        ];
    }
});

const zoneData = {
    baseHp: 10,
    hpMultiplier: 2.05,
    coinsMultiplier: 1.5,
    monstersPerZone: 10
};

// Cada sprite tem seu pr√≥prio nome √∫nico
const enemyData = [
    { name: "Akira", img: "./static/img/enemies/enemy_main.png" },
    { name: "Kenji", img: "./static/img/enemies/enemy_v4.png" },
    { name: "Ryu", img: "./static/img/enemies/enemy_v5.png" },
    { name: "Takeshi", img: "./static/img/enemies/enemy_v6.png" }
];

// Manter compatibilidade com c√≥digo antigo
const monsterNames = enemyData.map(e => e.name);
const monsterImages = enemyData.map(e => e.img);

// Imagem do Boss (aparece a cada 5 fases)
const bossImage = "./static/img/enemies/boss.png";


----- FILE: static/js/game_v3.js  (sha1:c8403e90ab97, bytes:43678) -----
console.log('üéÆ Game v3.js carregado - VERS√ÉO 5 - Boss Timer');
// Estado Global do Jogo
const gameState = {
    gold: 0,
    totalDps: 0,
    clickDamage: 1,
    critChance: 0, // Inicia em 0%
    clickCritMultiplier: 2,
    currentZone: 1,
    monstersKilledInZone: 0,
    heroes: [],
    upgrades: [], // IDs dos upgrades comprados
    currentMonster: {
        hp: 10,
        maxHp: 10,
        name: "Bandido",
        img: ""
    },
    statistics: {
        totalClicks: 0,
        totalKills: 0,
        maxZone: 1
    },
    lastEnemyIndex: -1, // Para evitar repeti√ß√£o consecutiva
    inventory: [], // Mochila de itens
    bossTimer: 30, // Cron√¥metro de boss (30 segundos)
    bossTimerInterval: null, // Refer√™ncia ao intervalo do cron√¥metro
    kenjiFragments: 0, // Contador de fragmentos do Kenji para desbloquear skill do Naruto
    currentEnemyName: "", // Nome do inimigo atual para sistema de drop
    diamonds: 0 // Contador de diamantes
};

// Configura√ß√µes
const TICKS_PER_SECOND = 10;
let autoSaveInterval;

// Inicializa√ß√£o
function initGame() {
    loadGame();
    setupHeroes();
    spawnMonster();
    renderArenas();
    updateUI();
    startGameLoop();
    setupEventListeners();

    // Auto-save a cada 30s
    autoSaveInterval = setInterval(saveGame, 30000);
}

// Configura lista de her√≥is baseada no game_data.js
function setupHeroes() {
    gameState.heroes = heroesData.map(heroData => {
        const savedHero = gameState.savedHeroes ? gameState.savedHeroes.find(h => h.id === heroData.id) : null;
        return {
            ...heroData,
            level: savedHero ? savedHero.level : 0,
            currentCost: savedHero ? calculateCost(heroData.baseCost, savedHero.level) : heroData.baseCost,
            currentDps: savedHero ? heroData.baseDps * savedHero.level : 0
        };
    });
    recalculateTotalDps();
    renderHeroesList();
}

function calculateCost(baseCost, currentLevel) {
    return Math.floor(baseCost * Math.pow(1.07, currentLevel));
}

function recalculateTotalDps() {
    let dps = 0;
    let clickCtx = 1;
    let globalMulti = 1;
    let critChanceAcc = 0;

    // Processar Global Upgrades & Crit
    gameState.upgrades.forEach(uId => {
        // Encontrar info do upgrade
        for (const hid in heroUpgrades) {
            const upg = heroUpgrades[hid].find(u => u.id === uId);
            if (upg) {
                if (upg.type === 'GLOBAL_DPS_MULT') globalMulti *= upg.value;
                if (upg.type === 'CRIT_CHANCE') critChanceAcc += upg.value;
            }
        }
    });

    gameState.critChance = critChanceAcc;

    // Calcular DPS Individual com Multiplicadores Self
    gameState.heroes.forEach(hero => {
        let heroDps = hero.baseDps * hero.level;

        // Self Multipliers
        const heroUps = heroUpgrades[hero.id];
        if (heroUps) {
            heroUps.forEach(upg => {
                if (gameState.upgrades.includes(upg.id) && upg.type === 'SELF_DPS_MULT') {
                    heroDps *= upg.value;
                }
            });
        }

        hero.currentDps = heroDps;

        if (hero.id === 1) {
            clickCtx += hero.currentDps;
        } else {
            dps += hero.currentDps;
        }
    });

    gameState.totalDps = dps * globalMulti;
    gameState.clickDamage = clickCtx * globalMulti;
}

// Renderiza√ß√£o da Lista de Her√≥is (Split Layout: Left Name/Img, Right Info)
function renderHeroesList() {
    const listContainer = document.getElementById('heroes-list');
    listContainer.innerHTML = '';

    for (let i = 0; i < gameState.heroes.length; i++) {
        const hero = gameState.heroes[i];
        let status = 'hidden';

        if (i === 0) status = 'revealed';
        else {
            const prevHero = gameState.heroes[i - 1];
            if (prevHero.level > 0) status = 'revealed';
            else {
                if (i === 1) status = 'mystery';
                else {
                    const prevPrevHero = gameState.heroes[i - 2];
                    if (prevPrevHero && prevPrevHero.level > 0) status = 'mystery';
                }
            }
        }

        if (status === 'hidden') break;

        const item = document.createElement('div');
        item.className = 'hero-card-split'; // Usando nova classe de layout
        if (status === 'mystery') item.classList.add('mystery-hero');
        item.id = `hero-${hero.id}`;

        const isLocked = status === 'mystery';

        let displayName = isLocked ? "???" : hero.name;
        // Se estiver bloqueado mostra placeholder, se n√£o mostra a imagem definida (agora full body pro naruto)
        let displayImg = isLocked ? "https://placehold.co/100x100/000000/ffffff?text=?" : hero.img;
        let displayCost = formatNumber(hero.currentCost);
        let dpsVal = hero.currentDps;

        // HTML Structure

        // --- NAME OUTSIDE (Side-by-Side) ---
        // Se estiver bloqueado mostra ???
        // Se disponivel, mostra Nome + Sobrenome (ou apenas nome completo estilizado)
        // O usuario pediu "nome e sobrenome um ao lado do outro".
        // displayName j√° √© "Naruto Uzumaki".

        let elementImg = "";
        if (!isLocked && hero.element) {
            elementImg = `<img src="./static/img/elements/${hero.element}.png" class="hero-element-icon" title="Elemento: ${hero.element}">`;
        }

        let nameTitleHTML = `
            <div class="hero-title-header">
                ${displayName} ${elementImg}
            </div>
        `;

        // --- COLUNA ESQUERDA: APENAS IMAGEM ---
        // Remover nome daqui de dentro
        // Aplicando foco din√¢mico (inteligente) se definido, sen√£o padr√£o topo
        let focusStyle = hero.focus ? `style="object-position: ${hero.focus}"` : '';

        let leftColHTML = `
            <div class="card-left-col">
                <div class="hero-image-wrapper">
                    <img src="${displayImg}" class="hero-full-body-img" alt="${displayName}" ${focusStyle}>
                </div>
            </div>
        `;

        // --- COLUNA DIREITA: NIVEL -> STATUS -> SKILLS -> BOTAO ---

        // 1. N√≠vel
        let levelHTML = isLocked ? `<div class="hero-level-display">???</div>` : `<div class="hero-level-display" id="hero-level-text-${hero.id}">N√≠vel ${hero.level}</div>`;

        // 2. Status (Dano/DPS) agora vai para o OVERLAY
        let statsHTML = "";
        if (isLocked) {
            statsHTML = `<div class="hero-stats-text">???</div>`;
        } else {
            // Calcular o incremento de DPS do pr√≥ximo n√≠vel
            const nextLevelDps = hero.baseDps * Math.pow(1.07, hero.level + 1);
            const dpsIncrement = Math.abs(nextLevelDps - dpsVal);

            if (hero.id === 1) {
                statsHTML = `<div class="stat-line"><strong>Dano de Clique:</strong> <span id="hero-stat-val-${hero.id}">${formatNumber(dpsVal)}</span> <span class="dps-increment">+${formatNumber(dpsIncrement)}</span></div>`;
            } else {
                statsHTML = `<div class="stat-line"><strong>Dano por Segundo:</strong> <span id="hero-stat-val-${hero.id}">${formatNumber(dpsVal)}</span> <span class="dps-increment">+${formatNumber(dpsIncrement)}</span></div>`;
            }
        }

        // 4. Bot√£o de Compra
        let buyButtonHTML = "";
        if (!isLocked) {
            buyButtonHTML = `
                <div class="hero-buy-btn" onclick="buyHero(${hero.id})">
                    <span class="buy-label">UPGRADE</span>
                    <span class="buy-value">üí∞ <span id="hero-cost-text-${hero.id}">${displayCost}</span></span>
                </div>
            `;
        } else {
            buyButtonHTML = `
                <div class="hero-buy-btn locked">
                    <span>BLOQUEADO</span>
                </div>
            `;
        }

        // 3. Skills (NOW BELOW UPGRADE)
        let skillsHTML = '<div class="hero-skills-row">';
        if (!isLocked) {
            const upgrades = heroUpgrades[hero.id];
            if (upgrades) {
                upgrades.forEach(upg => {
                    const isBought = gameState.upgrades.includes(upg.id);

                    // L√≥gica especial para Rasengan (h1_u3)
                    let isUnlocked;
                    let tooltipExtra = '';
                    if (upg.id === 'h1_u3') {
                        // Rasengan s√≥ desbloqueia com 10 fragmentos do Kenji
                        isUnlocked = gameState.kenjiFragments >= 10;
                        tooltipExtra = `<br><br>üîÆ Fragmentos: ${gameState.kenjiFragments}/10<br><small>Mate Kenji para coletar fragmentos!</small>`;
                    } else {
                        isUnlocked = hero.level >= upg.reqLevel;
                    }

                    let upgClass = 'skill-box';
                    if (isBought) upgClass += ' bought';
                    else if (isUnlocked) upgClass += ' available';
                    else upgClass += ' locked';

                    const upgCost = hero.baseCost * upg.costMultiplier;

                    // Handle Image Icons
                    const isImageIcon = upg.icon.startsWith('./') || upg.icon.startsWith('http');
                    const iconContent = isImageIcon ? `<img src="${upg.icon}" class="skill-img-icon">` : upg.icon;

                    skillsHTML += `
                        <div class="${upgClass}" 
                             id="upg-${upg.id}"
                             onclick="buyUpgrade('${upg.id}', ${upgCost}, ${hero.id})">
                             <div class="skill-icon">${iconContent}</div>
                             ${isBought ? '<div class="skill-check">‚úî</div>' : ''}
                             <div class="tooltip">
                                <strong>${upg.name}</strong><br>
                                ${upg.desc}<br>
                                Custo: ${formatNumber(upgCost)}${tooltipExtra}
                             </div>
                        </div>
                    `;
                });
            }
        }
        skillsHTML += '</div>';

        let rightColHTML = `
            <div class="card-right-col">
                ${levelHTML}
                ${skillsHTML}
                ${buyButtonHTML}
            </div>
        `;

        let overlayHTML = `
            <div class="hero-stats-overlay">
                ${statsHTML}
            </div>
        `;

        item.innerHTML = nameTitleHTML + `
            <div class="hero-card-inner-split">
                ${leftColHTML}
                ${rightColHTML}
                ${overlayHTML}
            </div>
        `;

        if (isLocked) {
            item.classList.add('locked-mystery');
        }

        listContainer.appendChild(item);
    }
}

function updateHeroUI(heroId) {
    const hero = gameState.heroes.find(h => h.id === heroId);
    if (!hero) return;

    // Atualizar N√≠vel
    const levelEl = document.getElementById(`hero-level-text-${hero.id}`);
    if (levelEl) levelEl.textContent = `N√≠vel ${hero.level}`;

    // Atualizar Custo
    const costEl = document.getElementById(`hero-cost-text-${hero.id}`);
    if (costEl) costEl.textContent = formatNumber(hero.currentCost);

    // Atualizar Valor de Dano no Overlay
    const statEl = document.getElementById(`hero-stat-val-${hero.id}`);
    if (statEl) statEl.textContent = formatNumber(hero.currentDps);

    // Verificar se desbloqueou algum slot de upgrade (20, 40, 60, 80)
    // Se sim, precisamos re-renderizar para mostrar o quadradinho
    const upgradeThresholds = [20, 40, 60, 80];
    if (upgradeThresholds.includes(hero.level)) {
        renderHeroesList();
    }
}

// Mec√¢nica de Compra de Heroi
function buyHero(heroId) {
    // Note: click event is handled via HTML onclick, arguments passed directly
    const hero = gameState.heroes.find(h => h.id === heroId);

    if (hero && gameState.gold >= hero.currentCost) {
        gameState.gold -= hero.currentCost;
        const oldLevel = hero.level;
        hero.level++;
        hero.currentCost = calculateCost(hero.baseCost, hero.level);
        hero.currentDps = hero.baseDps * hero.level;

        recalculateTotalDps();
        updateUI();

        if (oldLevel === 0) {
            renderHeroesList(); // Desbloqueia pr√≥ximo
        } else {
            updateHeroUI(heroId);
        }
    }
}

// Mec√¢nica de Compra de Upgrade
function buyUpgrade(upgId, cost, heroId) {
    event.stopPropagation(); // Impede borbulhar para compra de heroi
    if (gameState.upgrades.includes(upgId)) return;

    const hero = gameState.heroes.find(h => h.id === heroId);
    if (!hero) return;

    // Verificar requisitos
    const upg = heroUpgrades[heroId].find(u => u.id === upgId);

    // Verifica√ß√£o especial para Rasengan (h1_u3)
    if (upgId === 'h1_u3') {
        if (gameState.kenjiFragments < 10) {
            console.log('‚ùå Voc√™ precisa de 10 Fragmentos de Chakra para desbloquear o Rasengan!');
            return;
        }
    } else {
        // Verifica√ß√£o normal de n√≠vel para outras skills
        if (!upg || hero.level < upg.reqLevel) return;
    }

    if (gameState.gold >= cost) {
        gameState.gold -= cost;
        gameState.upgrades.push(upgId);
        recalculateTotalDps();
        updateUI();
        renderHeroesList();
    }
}

// Arena / Zoning Logic
function changeZone(direction) {
    if (direction === 'next') {
        if (gameState.currentZone < gameState.statistics.maxZone) {
            gameState.currentZone++;
            gameState.monstersKilledInZone = 0;
            spawnMonster();
            renderArenas();
            updateUI();
        }
    } else if (direction === 'prev') {
        if (gameState.currentZone > 1) {
            gameState.currentZone--;
            gameState.monstersKilledInZone = 0;
            spawnMonster();
            renderArenas();
            updateUI();
        }
    }
}

function renderArenas() {
    const container = document.getElementById('arenas-display');
    if (!container) return; // Safety
    container.innerHTML = '';

    let startZone = Math.max(1, gameState.currentZone - 2);
    let endZone = Math.max(gameState.currentZone + 2, gameState.statistics.maxZone + 1);

    if (endZone - startZone < 4) {
        endZone = startZone + 4;
    }

    for (let z = startZone; z <= endZone; z++) {
        if (z > gameState.statistics.maxZone + 1 && z > 1) continue;

        const box = document.createElement('div');
        box.className = 'arena-box';
        box.textContent = z;

        if (z === gameState.currentZone) {
            box.classList.add('active');
        }

        if (z > gameState.statistics.maxZone) {
            box.classList.add('locked');
        } else {
            box.onclick = () => {
                if (z !== gameState.currentZone) {
                    gameState.currentZone = z;
                    gameState.monstersKilledInZone = 0;
                    spawnMonster();
                    renderArenas();
                    updateUI();
                }
            };
        }
        container.appendChild(box);
    }
}


// Spawning de Monstros
function spawnMonster() {
    if (!gameState.currentMonster) return;

    // Verifica se √© uma fase de boss (m√∫ltiplo de 5)
    const isBossZone = gameState.currentZone % 5 === 0;

    // Calcular HP baseado na progress√£o SEM contar fases de boss
    // Fases de boss n√£o contam para a progress√£o
    // Exemplo: Fase 1, 2, 3, 4, 6, 7, 8, 9, 11, 12...
    // A fase 5 (boss) n√£o conta, ent√£o fase 6 = progress√£o 5
    // A fase 10 (boss) n√£o conta, ent√£o fase 11 = progress√£o 9

    let effectiveZone;
    if (isBossZone) {
        // Boss: usar a zona anterior (que n√£o √© boss)
        effectiveZone = gameState.currentZone - 1;
    } else {
        // Inimigo normal: calcular quantas fases de boss j√° passaram
        const bossPhasesPassed = Math.floor((gameState.currentZone - 1) / 5);
        effectiveZone = gameState.currentZone - bossPhasesPassed;
    }

    // Calcular HP do inimigo normal baseado na zona efetiva
    const zoneMultiplier = Math.pow(zoneData.hpMultiplier, effectiveZone - 1);
    const normalEnemyHp = Math.floor(zoneData.baseHp * zoneMultiplier);

    if (isBossZone) {
        // Boss tem multiplicador progressivo baseado na f√≥rmula:
        // BossMultiplier(n) = 8 + (n √ó 0.1)
        // Com limite m√°ximo de 20x
        let bossMultiplier = 8 + (gameState.currentZone * 0.1);
        bossMultiplier = Math.min(bossMultiplier, 20); // Limitar a 20x

        gameState.currentMonster.maxHp = Math.floor(normalEnemyHp * bossMultiplier);
    } else {
        // Inimigo normal
        gameState.currentMonster.maxHp = normalEnemyHp;
    }

    gameState.currentMonster.hp = gameState.currentMonster.maxHp;

    // Para boss, usar nome gen√©rico
    let enemyName = "Boss";
    let enemyIndex = -1;

    const nameEl = document.getElementById('monster-name');
    const levelEl = document.getElementById('monster-level');

    const imgEl = document.getElementById('monster-img');
    if (imgEl) {
        if (isBossZone) {
            // Boss: usa imagem especial
            imgEl.src = bossImage;
            enemyName = "Boss";

            // Iniciar cron√¥metro de boss
            startBossTimer();

            // Esconder contador de monstros e mostrar cron√¥metro
            const monstersKilledEl = document.querySelector('.zone-progress-info');
            if (monstersKilledEl) monstersKilledEl.style.display = 'none';

            const bossTimerEl = document.getElementById('boss-timer');
            if (bossTimerEl) bossTimerEl.style.display = 'block';
        } else {
            // Inimigo normal: l√≥gica para evitar repetir o mesmo monstro em seguida
            let newIdx;
            do {
                newIdx = Math.floor(Math.random() * enemyData.length);
            } while (newIdx === gameState.lastEnemyIndex && enemyData.length > 1);

            gameState.lastEnemyIndex = newIdx;
            enemyIndex = newIdx;
            imgEl.src = enemyData[newIdx].img;
            enemyName = enemyData[newIdx].name;

            // Parar cron√¥metro se estiver rodando
            stopBossTimer();

            // Mostrar contador de monstros e esconder cron√¥metro
            const monstersKilledEl = document.querySelector('.zone-progress-info');
            if (monstersKilledEl) monstersKilledEl.style.display = 'block';

            const bossTimerEl = document.getElementById('boss-timer');
            if (bossTimerEl) bossTimerEl.style.display = 'none';
        }

        // Escalamento: a cada 5 fases aumenta 2% (1.02) para inimigos normais
        // Boss √© sempre 120% do tamanho do inimigo anterior
        let sizeMultiplier;
        if (isBossZone) {
            // Boss = tamanho base da zona anterior * 1.2
            const previousZoneMultiplier = Math.pow(1.02, Math.floor((gameState.currentZone - 1) / 5));
            sizeMultiplier = previousZoneMultiplier * 1.2;
        } else {
            sizeMultiplier = Math.pow(1.02, Math.floor(gameState.currentZone / 5));
        }

        imgEl.style.transform = `scale(${sizeMultiplier})`;
    }

    // Atualizar nome e n√≠vel do monstro
    gameState.currentMonster.name = enemyName;
    gameState.currentEnemyName = enemyName; // Salvar para sistema de drop
    if (nameEl) nameEl.textContent = enemyName;
    if (levelEl) levelEl.textContent = `N√≠vel ${gameState.currentZone}`;

    updateMonsterUI();
}

function damageMonster(amount, isClick = false) {
    let finalDmg = amount;
    let isCrit = false;

    if (isClick && gameState.critChance > 0) {
        if (Math.random() < gameState.critChance) {
            finalDmg *= gameState.clickCritMultiplier;
            isCrit = true;
        }
    }

    gameState.currentMonster.hp -= finalDmg;
    if (gameState.currentMonster.hp < 0) gameState.currentMonster.hp = 0;

    if (isClick) {
        createDamageNumber(finalDmg, isCrit);
        animateMonsterShake();
        animateMonsterHitScale(); // Nova anima√ß√£o de aumento
        gameState.statistics.totalClicks++;
    }

    if (gameState.currentMonster.hp <= 0) {
        monterDeath();
    }

    updateMonsterUI();
}

function monterDeath() {
    // Recompensa
    const zoneMultiplier = Math.pow(zoneData.coinsMultiplier, gameState.currentZone - 1);
    const goldDrop = Math.ceil(Math.random() * 3 * zoneMultiplier);

    gameState.gold += goldDrop;
    gameState.statistics.totalKills++;

    // Anima√ß√£o de moedas caindo
    createGoldCoins(goldDrop);

    // Verificar se √© boss
    const isBoss = gameState.currentZone % 5 === 0;

    if (isBoss) {
        // Boss morto: parar cron√¥metro e avan√ßar para pr√≥xima zona
        stopBossTimer();

        // Desbloquear pr√≥xima zona se for a zona m√°xima
        if (gameState.currentZone === gameState.statistics.maxZone) {
            gameState.statistics.maxZone++;
            renderArenas();
        }

        // Resetar contador de monstros mortos
        gameState.monstersKilledInZone = 0;
    } else {
        // Inimigo normal: incrementar contador
        gameState.monstersKilledInZone++;

        // Sistema de Drop Espec√≠fico do Kenji (20% de chance)
        if (gameState.currentEnemyName === "Kenji" && Math.random() < 0.20) {
            // Drop do fragmento do Kenji
            const kenjiFragment = {
                icon: 'üîÆ',
                name: 'Fragmento de Chakra',
                description: 'Um fragmento de chakra deixado por Kenji. Colete 10 para desbloquear o Rasengan!',
                count: 1,
                isImage: false,
                isKenjiFragment: true // Marcador especial
            };

            // Adicionar ao invent√°rio
            if (addItemToInventory(kenjiFragment)) {
                gameState.kenjiFragments++;
                console.log(`üîÆ Fragmento de Chakra coletado! Total: ${gameState.kenjiFragments}/10`);

                // Mostrar notifica√ß√£o visual
                showItemDropNotification(kenjiFragment);

                // Verificar se coletou 10 fragmentos
                if (gameState.kenjiFragments >= 10 && !gameState.upgrades.includes('h1_u3')) {
                    // Desbloquear a skill automaticamente
                    unlockNarutoRasengan();
                }
            }
        }

        // Sistema de Drop de Itens (Veneno)
        // Apenas inimigos comuns (n√£o bosses) nas arenas 10-15 com 2% de chance
        const isInDropZone = gameState.currentZone >= 10 && gameState.currentZone <= 15;
        const dropChance = 0.02; // 2%

        if (isInDropZone && Math.random() < dropChance) {
            // Item dropado: Veneno
            const droppedItem = {
                icon: './static/img/items/poison.png',
                name: 'Frasco de Veneno',
                description: 'Um veneno mortal usado por ninjas',
                count: 1,
                isImage: true
            };

            // Adicionar ao invent√°rio
            if (addItemToInventory(droppedItem)) {
                // Mostrar notifica√ß√£o visual
                showItemDropNotification(droppedItem);
            }
        }

        // Sistema de Drop de Diamantes (1% de chance para qualquer inimigo)
        if (Math.random() < 0.01) {
            const diamondsAmount = Math.floor(Math.random() * 3) + 1; // 1 a 3 diamantes
            gameState.diamonds += diamondsAmount;
            console.log(`üíé ${diamondsAmount} diamante(s) coletado(s)! Total: ${gameState.diamonds}`);

            // Criar anima√ß√£o de diamantes caindo
            createDiamondAnimation(diamondsAmount);
            updateUI();
        }

        // Desbloqueia pr√≥xima zona se matar o necess√°rio na zona MAXIMA atual
        if (gameState.monstersKilledInZone >= zoneData.monstersPerZone) {
            if (gameState.currentZone === gameState.statistics.maxZone) {
                gameState.statistics.maxZone++;
                renderArenas();
                gameState.monstersKilledInZone = 0;
            } else {
                gameState.monstersKilledInZone = 0;
            }
        }
    }

    spawnMonster();
    updateUI();
}

// ===== SISTEMA DE CRON√îMETRO DE BOSS =====
function startBossTimer() {
    // Parar qualquer cron√¥metro anterior
    stopBossTimer();

    // Resetar para 30 segundos
    gameState.bossTimer = 30;
    updateBossTimerDisplay();

    // Iniciar intervalo de 1 segundo
    gameState.bossTimerInterval = setInterval(() => {
        gameState.bossTimer--;
        updateBossTimerDisplay();

        // Adicionar classe de aviso quando restarem 10 segundos ou menos
        const bossTimerEl = document.getElementById('boss-timer');
        if (gameState.bossTimer <= 10) {
            if (bossTimerEl) bossTimerEl.classList.add('warning');
        } else {
            if (bossTimerEl) bossTimerEl.classList.remove('warning');
        }

        // Quando chegar a 0, resetar vida do boss
        if (gameState.bossTimer <= 0) {
            resetBossHealth();
        }
    }, 1000);
}

function stopBossTimer() {
    if (gameState.bossTimerInterval) {
        clearInterval(gameState.bossTimerInterval);
        gameState.bossTimerInterval = null;
    }

    // Remover classe de aviso
    const bossTimerEl = document.getElementById('boss-timer');
    if (bossTimerEl) bossTimerEl.classList.remove('warning');
}

function updateBossTimerDisplay() {
    const bossTimerValueEl = document.getElementById('boss-timer-value');
    if (bossTimerValueEl) {
        bossTimerValueEl.textContent = gameState.bossTimer;
    }
}

function resetBossHealth() {
    // Resetar vida do boss para o m√°ximo
    gameState.currentMonster.hp = gameState.currentMonster.maxHp;
    updateMonsterUI();

    // Reiniciar cron√¥metro
    startBossTimer();

    console.log('‚è±Ô∏è Tempo esgotado! Vida do boss resetada.');
}

// Loop Principal
function startGameLoop() {
    setInterval(() => {
        if (gameState.totalDps > 0) {
            const dpsTick = gameState.totalDps / TICKS_PER_SECOND;
            if (dpsTick > 0 && gameState.currentMonster.hp > 0) {
                damageMonster(dpsTick, false);
            }
        }
        checkBuyButtons();
    }, 1000 / TICKS_PER_SECOND);
}

function checkBuyButtons() {
    // Apenas verifica se tem dinheiro para remover classe disabled nos herois?
    // Visualmente apenas. A logica √© checada no clique.
    // Como agora usamos renderHeroesList com frequencia, pode ser redundante se nao otimizado.
    // Mas vamos manter simples:
    gameState.heroes.forEach(hero => {
        const item = document.getElementById(`hero-${hero.id}`);
        if (item) {
            const btn = item.querySelector('.hero-buy-btn');
            if (btn && !btn.classList.contains('locked')) { // locked class is for mystery
                if (gameState.gold >= hero.currentCost) {
                    btn.classList.remove('disabled');
                } else {
                    btn.classList.add('disabled');
                }
            }
        }
    });

    // Upgrades
    gameState.heroes.forEach(hero => {
        const ups = heroUpgrades[hero.id];
        if (ups) {
            ups.forEach(u => {
                const el = document.getElementById(`upg-${u.id}`);
                const cost = hero.baseCost * u.costMultiplier;
                if (el) {
                    if (gameState.gold >= cost) {
                        el.style.borderColor = "#00ff00"; // Highlight available?
                        // ou usar classe .available se level permitir.
                        // renderHeroesList ja define .available baseado em level.
                    } else {
                        // el.style.borderColor = "";
                    }
                }
            });
        }
    });
}

// Event Listeners
function setupEventListeners() {
    const clickTarget = document.getElementById('click-target');
    if (clickTarget) {
        clickTarget.addEventListener('mousedown', (e) => {
            e.preventDefault();
            damageMonster(gameState.clickDamage, true);
            const vis = clickTarget.querySelector('.monster-visual');
            if (vis) vis.style.transform = "scale(0.9)";
        });

        clickTarget.addEventListener('mouseup', () => {
            const vis = clickTarget.querySelector('.monster-visual');
            if (vis) vis.style.transform = "scale(1)";
        });
    }

    const prevBtn = document.getElementById('prev-zone');
    if (prevBtn) prevBtn.onclick = () => changeZone('prev');
    const nextBtn = document.getElementById('next-zone');
    if (nextBtn) nextBtn.onclick = () => changeZone('next');

    // Configurar eventos da mochila
    setupBackpackEventListeners();
}

// UI Helpers
function updateUI() {
    const goldEl = document.getElementById('player-gold');
    if (goldEl) goldEl.textContent = formatNumber(Math.floor(gameState.gold));

    const diamondsEl = document.getElementById('player-diamonds');
    if (diamondsEl) diamondsEl.textContent = formatNumber(gameState.diamonds);

    const dpsEl = document.getElementById('total-dps');
    if (dpsEl) dpsEl.textContent = formatNumber(Math.floor(gameState.totalDps));

    const clickValEl = document.getElementById('click-damage-val');
    if (clickValEl) clickValEl.textContent = formatNumber(Math.floor(gameState.clickDamage));

    const mkEl = document.getElementById('monsters-killed');
    if (mkEl) mkEl.textContent = gameState.monstersKilledInZone;

    // Stats footer/header
    const skEl = document.getElementById('stat-killed');
    if (skEl) skEl.textContent = formatNumber(gameState.statistics.totalKills);
    const scEl = document.getElementById('stat-clicks');
    if (scEl) scEl.textContent = formatNumber(gameState.statistics.totalClicks);
    const smzEl = document.getElementById('stat-max-zone');
    if (smzEl) smzEl.textContent = gameState.statistics.maxZone;
}

function updateMonsterUI() {
    if (!gameState.currentMonster) return;
    const pct = (gameState.currentMonster.hp / gameState.currentMonster.maxHp) * 100;
    const fill = document.getElementById('hp-fill');
    if (fill) fill.style.width = `${pct}%`;

    const curHp = document.getElementById('current-hp');
    if (curHp) curHp.textContent = formatNumber(Math.ceil(gameState.currentMonster.hp));
}

function createDamageNumber(amount, isCrit) {
    const container = document.getElementById('damage-numbers-container');
    if (!container) return;

    const el = document.createElement('div');
    el.className = 'damage-number';
    if (isCrit) {
        el.classList.add('damage-crit');
    }
    el.textContent = formatNumber(Math.floor(amount));

    const x = 50 + (Math.random() * 20 - 10);
    const y = 50 + (Math.random() * 20 - 10);

    el.style.left = `${x}%`;
    el.style.top = `${y}%`;

    container.appendChild(el);

    setTimeout(() => el.remove(), 1000);
}

function animateMonsterShake() {
    const visual = document.querySelector('.monster-visual');
    if (visual) {
        visual.classList.remove('shake');
        void visual.offsetWidth;
        visual.classList.add('shake');
    }
}

function animateMonsterHitScale() {
    const visual = document.querySelector('.monster-visual');
    if (visual) {
        visual.classList.remove('hit-scale');
        void visual.offsetWidth; // Reflow
        visual.classList.add('hit-scale');
    }
}

function createGoldCoins(amount) {
    const container = document.getElementById('damage-numbers-container');
    if (!container) return;

    // Criar entre 3 e 8 moedas dependendo da quantidade de ouro
    const numCoins = Math.min(Math.max(3, Math.floor(amount / 10)), 8);

    for (let i = 0; i < numCoins; i++) {
        const coin = document.createElement('div');
        coin.className = 'gold-coin';
        coin.textContent = 'üí∞';

        // Posi√ß√£o inicial aleat√≥ria ao redor do meio do monstro (mais para baixo)
        const x = 45 + (Math.random() * 10 - 5); // 40-50%
        const y = 50 + (Math.random() * 15 - 7.5); // 42.5-57.5% (meio do personagem)

        coin.style.left = `${x}%`;
        coin.style.top = `${y}%`;

        // Pequeno delay para cada moeda criar efeito cascata
        coin.style.animationDelay = `${i * 0.08}s`;

        container.appendChild(coin);

        // Remover ap√≥s a anima√ß√£o (mais curto agora)
        setTimeout(() => coin.remove(), 800 + (i * 80));
    }
}

function createDiamondAnimation(amount) {
    const container = document.getElementById('damage-numbers-container');
    if (!container) return;

    // Criar diamantes baseado na quantidade dropada
    const numDiamonds = Math.min(amount, 5);

    for (let i = 0; i < numDiamonds; i++) {
        const diamond = document.createElement('div');
        diamond.className = 'diamond-drop';
        diamond.textContent = 'üíé';

        // Posi√ß√£o inicial aleat√≥ria ao redor do meio do monstro
        const x = 45 + (Math.random() * 10 - 5);
        const y = 50 + (Math.random() * 15 - 7.5);

        diamond.style.left = `${x}%`;
        diamond.style.top = `${y}%`;

        // Delay para efeito cascata
        diamond.style.animationDelay = `${i * 0.1}s`;

        container.appendChild(diamond);

        // Remover ap√≥s a anima√ß√£o
        setTimeout(() => diamond.remove(), 1000 + (i * 100));
    }
}

function showItemDropNotification(item) {
    // Criar elemento de notifica√ß√£o
    const notification = document.createElement('div');
    notification.className = 'item-drop-notification';

    // Criar conte√∫do
    const iconHTML = item.isImage
        ? `<img src="${item.icon}" alt="${item.name}">`
        : `<div style="font-size: 2.5em;">${item.icon}</div>`;

    notification.innerHTML = `
        ${iconHTML}
        <div class="drop-content">
            <div class="drop-text">ITEM ENCONTRADO!</div>
            <div class="item-name">${item.name}</div>
        </div>
    `;

    // Adicionar ao body
    document.body.appendChild(notification);

    // Remover ap√≥s 3 segundos
    setTimeout(() => {
        notification.remove();
    }, 3000);
}

// Fun√ß√£o para desbloquear o Rasengan do Naruto
function unlockNarutoRasengan() {
    console.log('üåÄ Desbloqueando Rasengan!');

    // Adicionar a skill aos upgrades
    if (!gameState.upgrades.includes('h1_u3')) {
        gameState.upgrades.push('h1_u3');

        // Recalcular DPS com a nova skill
        recalculateTotalDps();
        updateUI();
        renderHeroesList();

        // Mostrar notifica√ß√£o especial
        const notification = document.createElement('div');
        notification.className = 'item-drop-notification rasengan-unlock';
        notification.innerHTML = `
            <div style="font-size: 3em;">üåÄ</div>
            <div class="drop-content">
                <div class="drop-text">SKILL DESBLOQUEADA!</div>
                <div class="item-name">Rasengan</div>
                <div style="font-size: 0.9em; margin-top: 5px;">DPS de Todos +10%</div>
            </div>
        `;
        document.body.appendChild(notification);
        setTimeout(() => notification.remove(), 5000);

        console.log('‚úÖ Rasengan desbloqueado com sucesso!');
    }
}

function formatNumber(num) {
    if (num >= 1000000000000) return (num / 1000000000000).toFixed(2) + 'T';
    if (num >= 1000000000) return (num / 1000000000).toFixed(2) + 'B';
    if (num >= 1000000) return (num / 1000000).toFixed(2) + 'M';
    if (num >= 1000) return (num / 1000).toFixed(1) + 'k';
    return Math.floor(num).toString();
}

// Persistence
function saveGame() {
    const saveObj = {
        gold: gameState.gold,
        currentZone: gameState.currentZone,
        savedHeroes: gameState.heroes.map(h => ({ id: h.id, level: h.level })),
        upgrades: gameState.upgrades,
        statistics: gameState.statistics,
        inventory: gameState.inventory,
        kenjiFragments: gameState.kenjiFragments, // Salvar fragmentos do Kenji
        diamonds: gameState.diamonds // Salvar diamantes
    };
    localStorage.setItem('narutoClickerSave', JSON.stringify(saveObj));
}

function loadGame() {
    const saveStr = localStorage.getItem('narutoClickerSave');
    if (saveStr) {
        try {
            const saved = JSON.parse(saveStr);
            gameState.gold = saved.gold || 0;
            gameState.currentZone = saved.currentZone || 1;
            gameState.savedHeroes = saved.savedHeroes || [];
            gameState.upgrades = saved.upgrades || [];
            gameState.statistics = { ...gameState.statistics, ...saved.statistics };
            gameState.inventory = saved.inventory || [];
            gameState.kenjiFragments = saved.kenjiFragments || 0; // Carregar fragmentos do Kenji
            gameState.diamonds = saved.diamonds || 0; // Carregar diamantes
            if (!gameState.statistics.maxZone) gameState.statistics.maxZone = 1;
        } catch (e) {
            console.error("Erro save", e);
        }
    }
}

function resetGame() {
    if (confirm("TEM CERTEZA? Isso apagar√° todo o seu progresso para sempre!")) {
        localStorage.removeItem('narutoClickerSave');
        location.reload();
    }
}

// ===== SISTEMA DE MOCHILA =====
function setupBackpackEventListeners() {
    console.log('üéí Configurando eventos da mochila...');
    const openBackpackBtn = document.getElementById('open-backpack');
    const closeBackpackBtn = document.getElementById('close-backpack');
    const backpackModal = document.getElementById('backpack-modal');

    if (!openBackpackBtn || !closeBackpackBtn || !backpackModal) {
        console.warn('‚ö†Ô∏è Elementos da mochila n√£o encontrados');
        return;
    }
    console.log('‚úÖ Elementos da mochila encontrados, configurando listeners...');

    // Abrir modal
    openBackpackBtn.addEventListener('click', () => {
        console.log('üéí Abrindo mochila...');
        backpackModal.classList.add('active');
        console.log('Classes do modal:', backpackModal.className);
        renderInventory();
    });

    // Fechar modal
    closeBackpackBtn.addEventListener('click', () => {
        console.log('‚ùå Fechando mochila (bot√£o X)...');
        backpackModal.classList.remove('active');
    });

    // Fechar ao clicar fora do modal (no backdrop)
    backpackModal.addEventListener('click', (e) => {
        if (e.target === backpackModal) {
            console.log('‚ùå Fechando mochila (clique fora)...');
            backpackModal.classList.remove('active');
        }
    });

    // Inicializar grid de invent√°rio
    initializeInventory();

    // Inicializar painel admin
    setupAdminPanel();
}

function initializeInventory() {
    const inventoryGrid = document.getElementById('inventory-grid');
    const totalSlots = 40;

    for (let i = 0; i < totalSlots; i++) {
        const slot = document.createElement('div');
        slot.className = 'inventory-slot empty';
        slot.dataset.slotIndex = i;
        inventoryGrid.appendChild(slot);
    }
}

function addItemToInventory(newItem) {
    // Verificar se o item j√° existe no invent√°rio (mesmo nome)
    const existingItem = gameState.inventory.find(item => item && item.name === newItem.name);

    if (existingItem) {
        // Se j√° existe, aumentar a contagem
        existingItem.count += newItem.count;
    } else {
        // Se n√£o existe, adicionar em um slot vazio
        const emptySlotIndex = gameState.inventory.findIndex(item => !item);

        if (emptySlotIndex !== -1) {
            // Tem slot vazio, adicionar l√°
            gameState.inventory[emptySlotIndex] = newItem;
        } else if (gameState.inventory.length < 40) {
            // N√£o tem slot vazio mas ainda tem espa√ßo
            gameState.inventory.push(newItem);
        } else {
            // Invent√°rio cheio
            console.warn('‚ö†Ô∏è Invent√°rio cheio! N√£o foi poss√≠vel adicionar o item.');
            return false;
        }
    }

    // Salvar o jogo ap√≥s adicionar item
    saveGame();
    return true;
}

function renderInventory() {
    const slots = document.querySelectorAll('.inventory-slot');

    slots.forEach((slot, index) => {
        const item = gameState.inventory[index];

        if (item) {
            slot.className = 'inventory-slot has-item';

            // Verificar se o √≠cone √© uma imagem ou emoji
            const iconHTML = item.isImage
                ? `<img src="${item.icon}" class="item-icon-img" alt="${item.name}">`
                : `<span class="item-icon">${item.icon}</span>`;

            slot.innerHTML = `
                ${iconHTML}
                ${item.count > 1 ? `<span class="item-count">x${item.count}</span>` : ''}
            `;
            slot.title = `${item.name}\n${item.description}`;
        } else {
            slot.className = 'inventory-slot empty';
            slot.innerHTML = '';
            slot.title = 'Slot vazio';
        }
    });
}

// ===== ADMIN PANEL =====
function setupAdminPanel() {
    const adminTrigger = document.getElementById('admin-trigger');
    const adminModal = document.getElementById('admin-modal');
    const closeAdminBtn = document.getElementById('close-admin');
    const addGoldBtn = document.getElementById('add-gold-btn');
    const goldInput = document.getElementById('gold-input');

    // Abrir modal admin
    adminTrigger.addEventListener('click', () => {
        adminModal.style.display = 'flex';
        goldInput.value = '';
        goldInput.focus();
    });

    // Fechar modal admin
    closeAdminBtn.addEventListener('click', () => {
        adminModal.style.display = 'none';
    });

    // Fechar ao clicar fora
    adminModal.addEventListener('click', (e) => {
        if (e.target === adminModal) {
            adminModal.style.display = 'none';
        }
    });

    // Adicionar ouro
    addGoldBtn.addEventListener('click', () => {
        const amount = parseFloat(goldInput.value);
        if (amount && amount > 0) {
            gameState.gold += amount;
            updateUI();
            saveGame();
            goldInput.value = '';
            console.log(`‚úÖ Admin: Adicionado ${formatNumber(amount)} de ouro`);
        }
    });

    // Enter para adicionar
    goldInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
            addGoldBtn.click();
        }
    });
}

window.onload = initGame;



----- FILE: templates/index.html  (sha1:afc12f036875, bytes:5857) -----
<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Naruto Clicker Heroes</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}?v=10">
    <link
        href="https://fonts.googleapis.com/css2?family=Bangers&family=Shojumaru&family=Roboto:wght@400;700&display=swap"
        rel="stylesheet">
</head>

<body>
    <div class="game-container">
        <!-- Coluna Esquerda: Her√≥is -->
        <div class="panel left-panel">
            <div class="currency-display-container">
                <div class="gold-display-left">
                    üí∞ <span id="player-gold">0</span>
                </div>
                <div class="diamonds-display-left">
                    üíé <span id="player-diamonds">0</span>
                </div>
            </div>
            <div class="header-panel">
                <h2>Equipe Ninja <span class="backpack-icon" id="open-backpack" title="Mochila">üéí</span></h2>
                <div class="stats-display-container">
                    <div class="dps-display">DPS: <span id="total-dps">0</span></div>
                    <div class="click-display">Click: <span id="click-damage-val">1</span></div>
                </div>
            </div>
            <div id="heroes-list" class="scroll-content">
                <!-- Her√≥is ser√£o inseridos aqui via JS -->
            </div>
        </div>

        <!-- Coluna Central: A√ß√£o -->
        <div class="panel center-panel">
            <img src="{{ url_for('static', filename='img/elemental_cycle.png') }}" class="elemental-cycle-guide"
                alt="Ciclo Elemental">


            <div class="arena-selector-container">
                <button id="prev-zone" class="nav-btn">‚óÄ</button>
                <div class="arenas-scroll">
                    <div id="arenas-display">
                        <!-- Arenas visuais -->
                    </div>
                </div>
                <button id="next-zone" class="nav-btn">‚ñ∂</button>
            </div>


            <div class="battle-arena">
                <div class="zone-progress-info">
                    <span id="monsters-killed">0</span>/10
                </div>
                <!-- Cron√¥metro de Boss -->
                <div id="boss-timer" class="boss-timer" style="display: none;">
                    ‚è±Ô∏è <span id="boss-timer-value">30</span>s
                </div>
                <div id="damage-numbers-container"></div>
                <div class="monster-container" id="click-target">
                    <div class="monster-hp-bar">
                        <div id="hp-fill" style="width: 100%;"></div>
                    </div>
                    <div class="monster-hp-text"><span id="current-hp">10</span> HP</div>
                    <div class="monster-visual">
                        <img id="monster-img" src="" alt="Monstro">
                    </div>
                    <div class="monster-info">
                        <div id="monster-name" class="monster-name">Inimigo</div>
                        <div id="monster-level" class="monster-level">N√≠vel 1</div>
                    </div>
                </div>

                <div class="player-controls">
                    <!-- Controls -->
                </div>
            </div>
        </div>

        <!-- Coluna Direita: Progresso e Status -->
        <div class="panel right-panel">
            <h3>Estat√≠sticas</h3>
            <ul id="stats-list">
                <li>Monstros Derrotados: <span id="stat-killed">0</span></li>
                <li>Cliques Realizados: <span id="stat-clicks">0</span></li>
                <li>Maior Zona: <span id="stat-max-zone">1</span></li>
            </ul>
            <div class="reset-container">
                <button id="reset-save-btn" class="reset-btn" onclick="resetGame()">RESETAR PROGRESSO</button>
            </div>
        </div>
    </div>

    <!-- Modal da Mochila -->
    <div id="backpack-modal" class="backpack-modal">
        <div class="backpack-container">
            <div class="backpack-header">
                <div class="backpack-title">
                    <span class="backpack-icon">üéí</span>
                    Invent√°rio
                </div>
                <button class="close-backpack" id="close-backpack">‚úñ</button>
            </div>
            <div class="backpack-body">
                <div id="inventory-grid" class="inventory-grid">
                    <!-- Slots ser√£o gerados via JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Admin (Cheat) -->
    <div id="admin-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content admin-modal">
            <div class="modal-header">
                <h2>‚öôÔ∏è Admin Panel</h2>
                <button class="modal-close" id="close-admin">‚úñ</button>
            </div>
            <div class="modal-body">
                <div class="admin-input-group">
                    <label for="gold-input">Adicionar Ouro:</label>
                    <input type="number" id="gold-input" placeholder="Digite a quantidade..." min="0" step="1000">
                    <button id="add-gold-btn" class="admin-btn">üí∞ Adicionar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bot√£o Admin (Discreto) -->
    <div id="admin-trigger" title="Admin Panel">‚öôÔ∏è</div>

    <script src="{{ url_for('static', filename='js/game_data_v3.js') }}?v=5"></script>
    <script src="{{ url_for('static', filename='js/game_v3.js') }}?v=10"></script>
</body>

</html>

----- FILE: static/css/style.css  (sha1:a31f98544313, bytes:50080) -----
:root {
    --bg-color: #2c2c2c;
    --panel-bg: #f5e6ca;
    /* Cor de pergaminho */
    --panel-border: #4a3b2a;
    --primary-orange: #ff6600;
    --text-color: #333;
    --gold-color: #ffd700;
    --dps-color: #ff4500;
}

body {
    margin: 0;
    padding: 0;
    font-family: 'Roboto', sans-serif;
    background-image: url('../img/battle_bg.png');
    background-size: cover;
    background-position: center;
    color: var(--text-color);
    height: 100vh;
    overflow: hidden;
    user-select: none;
    position: relative;
}



.game-container {
    display: flex;
    height: 100vh;
    width: 100%;
    max-width: 100%;
    padding: 20px;
    box-sizing: border-box;
    margin: 0;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.8);
}

.panel {
    background-color: var(--panel-bg);
    border: 5px solid var(--panel-border);
    border-radius: 8px;
    margin: 0 15px;
    /* Espa√ßo entre as faixas */
    padding: 15px;
    display: flex;
    flex-direction: column;
    position: relative;
    box-shadow: inset 0 0 50px rgba(0, 0, 0, 0.1);
}

.panel::before {
    content: "";
    /* Textura de papel */
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-image: url('https://www.transparenttextures.com/patterns/aged-paper.png');
    opacity: 0.4;
    pointer-events: none;
    z-index: 0;
}

.left-panel {
    flex: 2.5;
    /* Aumentado de 2.2 para 2.5 para dar mais espa√ßo */
    min-width: 480px;
    /* Aumentado de 450px para 480px */
    z-index: 1;
}

/* Mais larga */
.center-panel {
    flex: 6;
    /* Abre muito mais espa√ßo no meio */
    z-index: 1;
    background-color: rgba(255, 255, 255, 0.1);
    border: none;
    box-shadow: none;
    background: none;
}

/* Center panel is transparent to see bg */

.center-panel .battle-arena {
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
    /* Centraliza verticalmente o conjunto */
    align-items: center;
    position: relative;
    padding-top: 0;
}

.right-panel {
    flex: 1.2;
    min-width: 280px;
    z-index: 1;
    display: flex;
    flex-direction: column;
    padding: 20px;
    background-image: url('https://www.transparenttextures.com/patterns/aged-paper.png'),
        linear-gradient(to bottom, #f5e6ca 0%, #e8d5b5 100%);
    border-left: 5px solid #4a3b2a;
    box-shadow: -5px 0 15px rgba(0, 0, 0, 0.3);
    position: relative;
}

.right-panel h3 {
    text-align: center;
    font-size: 1.8em;
    color: #4e342e;
    border-bottom: 2px solid #8d6e63;
    padding-bottom: 10px;
    margin-bottom: 20px;
    text-transform: uppercase;
}

#stats-list {
    list-style: none;
    padding: 0;
    margin: 0;
    flex: 1;
}

#stats-list li {
    font-family: 'Roboto', sans-serif;
    font-size: 1.1em;
    padding: 12px 10px;
    border-bottom: 1px dashed #a1887f;
    color: #3e2723;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

#stats-list li span {
    font-family: 'Bangers', cursive;
    color: #bf360c;
    font-size: 1.2em;
}

/* Estiliza√ß√£o do Bot√£o de Reset */
.reset-container {
    margin-top: auto;
    padding-top: 20px;
    text-align: center;
}

.reset-btn {
    background: linear-gradient(to bottom, #d32f2f 0%, #b71c1c 100%);
    color: white;
    border: 2px solid #7f0000;
    padding: 12px 20px;
    font-family: 'Bangers', cursive;
    font-size: 1.2em;
    border-radius: 8px;
    cursor: pointer;
    box-shadow: 0 4px 0 #5f0000;
    transition: all 0.1s;
    width: 100%;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
}

.reset-btn:hover {
    background: linear-gradient(to bottom, #e53935 0%, #c62828 100%);
}

.reset-btn:active {
    transform: translateY(4px);
    box-shadow: none;
}

/* Scroll Lists */
.scroll-content {
    overflow-y: auto;
    overflow-x: hidden;
    /* Remove a barra horizontal */
    flex: 1;
    padding-right: 15px;
    /* Aumentado de 5px para 15px para afastar a barra dos cards */
}

.scroll-content::-webkit-scrollbar {
    width: 8px;
}

.scroll-content::-webkit-scrollbar-thumb {
    background: var(--primary-orange);
    border-radius: 4px;
}

/* Heroes List Expanded */

/* Container de Moedas */
.currency-display-container {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
}

.gold-display-left {
    font-family: 'Bangers', cursive;
    font-size: 2.5em;
    color: var(--gold-color);
    text-shadow: 2px 2px 0 #000;
    text-align: center;
    background: rgba(0, 0, 0, 0.6);
    padding: 10px;
    border-radius: 10px;
    border: 2px solid #8b4513;
    flex: 1;
}

.diamonds-display-left {
    font-family: 'Bangers', cursive;
    font-size: 2.5em;
    color: #00d4ff;
    text-shadow: 2px 2px 0 #000, 0 0 10px rgba(0, 212, 255, 0.5);
    text-align: center;
    background: rgba(0, 0, 0, 0.6);
    padding: 10px;
    border-radius: 10px;
    border: 2px solid #0088cc;
    flex: 1;
}

/* Header Panel (Equipe Ninja) */
.header-panel {
    border-bottom: 2px solid #8b4513;
    margin-bottom: 15px;
    padding-bottom: 10px;
}

.header-panel h2 {
    font-family: 'Shojumaru', cursive;
    margin: 0;
    color: #b33e00;
    font-size: 1.8em;
    text-align: center;
}

/* Stats Display (DPS/Click) */
.stats-display-container {
    display: flex;
    justify-content: space-around;
    gap: 10px;
    margin-top: 10px;
}

.dps-display,
.click-display {
    flex: 1;
    background: linear-gradient(135deg, #444, #222);
    border: 2px solid #ff9800;
    border-radius: 8px;
    padding: 8px 5px;
    color: #fff;
    font-family: 'Bangers', cursive;
    font-size: 1.4em;
    text-align: center;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
    text-shadow: 1px 1px 2px #000;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}

.dps-display span,
.click-display span {
    color: #ffd700;
    font-size: 1.1em;
}

.dps-display {
    border-color: #ff5722;
}

.click-display {
    border-color: #2196f3;
}

/* Heroes List Expanded */
.hero-item {
    background: rgba(255, 255, 255, 0.85);
    /* Mais opaco para leitura */
    border: 3px solid #8b4513;
    border-radius: 8px;
    margin-bottom: 12px;
    padding: 15px;
    /* Box maior */
    display: flex;
    align-items: center;
    transition: transform 0.1s;
    cursor: pointer;
    min-height: 80px;
    /* Garante altura */
}

.hero-item:hover {
    transform: scale(1.02);
    background: rgba(255, 255, 255, 0.95);
}

.hero-item.disabled {
    filter: grayscale(1);
    opacity: 0.7;
    cursor: not-allowed;
}

.hero-img {
    width: 80px;
    /* Imagem bem maior */
    height: 80px;
    border-radius: 10px;
    /* Quadrado arredondado em vez de circulo para mostrar mais arte */
    border: 3px solid var(--panel-border);
    margin-right: 15px;
    background: #ccc;
    flex-shrink: 0;
}

.hero-info {
    flex: 1;
}

.hero-name {
    font-weight: bold;
    font-family: 'Shojumaru', cursive;
    font-size: 1.4em;
    color: #b33e00;
    margin-bottom: 5px;
}

.hero-stats {
    font-size: 1.1em;
    color: #333;
    font-weight: bold;
}

.hero-cost {
    font-weight: bold;
    color: #d68910;
    font-size: 1.2em;
}

.hero-level {
    background: var(--panel-border);
    color: #fff;
    padding: 4px 10px;
    border-radius: 12px;
    font-size: 0.9em;
    float: right;
    margin-left: 10px;
}

/* Monster & Battle */
.monster-container {
    text-align: center;
    position: relative;
    cursor: url('../img/kunai_cursor.png') 0 0, crosshair;
}

.monster-visual {
    width: 440px;
    /* Aumentado para 440px */
    height: 440px;
    margin: 80px auto 0 auto;
    /* Aumenta espa√ßo superior para descer o ninja conforme pedido */
    transition: transform 0.05s;
    display: flex;
    align-items: center;
    justify-content: center;
}

.monster-visual img {
    max-width: 100%;
    max-height: 100%;
    filter: drop-shadow(0 10px 10px rgba(0, 0, 0, 0.5));
}

.monster-visual:active {
    transform: scale(0.95);
}

.shake {
    animation: shake 0.2s;
}

.hit-scale {
    animation: hitScale 0.1s ease-out;
}

@keyframes hitScale {
    0% {
        transform: scale(1);
    }

    50% {
        transform: scale(1.15);
    }

    /* Aumenta levemente */
    100% {
        transform: scale(1);
    }
}

@keyframes shake {
    0% {
        transform: translate(1px, 1px) rotate(0deg);
    }

    10% {
        transform: translate(-1px, -2px) rotate(-1deg);
    }

    20% {
        transform: translate(-3px, 0px) rotate(1deg);
    }

    30% {
        transform: translate(3px, 2px) rotate(0deg);
    }

    40% {
        transform: translate(1px, -1px) rotate(1deg);
    }

    50% {
        transform: translate(-1px, 2px) rotate(-1deg);
    }

    60% {
        transform: translate(-3px, 1px) rotate(0deg);
    }

    70% {
        transform: translate(3px, 1px) rotate(-1deg);
    }

    80% {
        transform: translate(-1px, -1px) rotate(1deg);
    }

    90% {
        transform: translate(1px, 2px) rotate(0deg);
    }

    100% {
        transform: translate(1px, -2px) rotate(-1deg);
    }
}

.monster-hp-bar {
    width: 380px;
    /* Aumentado para acompanhar o monstro */
    height: 22px;
    background: #555;
    border: 3px solid #000;
    border-radius: 12px;
    overflow: hidden;
    margin: 5px auto;
}

#hp-fill {
    height: 100%;
    background: linear-gradient(90deg, #ff0000, #ff6600);
    transition: width 0.1s linear;
}

.monster-hp-text {
    font-family: 'Bangers', cursive;
    font-size: 1.5em;
    color: #fff;
    text-shadow: 2px 2px 0 #000;
    margin-top: -22px;
    position: relative;
    z-index: 2;
}

/* Monster Name and Level Display */
.monster-info {
    text-align: center;
    margin-top: 15px;
    pointer-events: none;
}

.monster-name {
    font-family: 'Shojumaru', cursive;
    font-size: 2.2em;
    color: #ff6600;
    text-shadow: 3px 3px 0 #000, 0 0 10px rgba(255, 102, 0, 0.5);
    margin-bottom: 5px;
    font-weight: bold;
    letter-spacing: 2px;
}

.monster-level {
    font-family: 'Bangers', cursive;
    font-size: 1.6em;
    color: #ffd700;
    text-shadow: 2px 2px 0 #000;
    background: rgba(0, 0, 0, 0.6);
    display: inline-block;
    padding: 5px 15px;
    border-radius: 8px;
    border: 2px solid #8b4513;
}

#damage-numbers-container {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
}

.damage-number {
    position: absolute;
    font-family: 'Bangers', cursive;
    font-size: 2em;
    color: #fff;
    text-shadow: 2px 2px 0 #000;
    animation: floatUp 1s ease-out forwards;
}

.damage-crit {
    color: #ff0000;
    font-size: 3em;
}

@keyframes floatUp {
    0% {
        opacity: 1;
        transform: translateY(0) scale(1);
    }

    100% {
        opacity: 0;
        transform: translateY(-100px) scale(1.2);
    }
}

/* Anima√ß√£o de Moedas de Ouro */
.gold-coin {
    position: absolute;
    font-size: 2em;
    color: #ffd700;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8),
        0 0 10px rgba(255, 215, 0, 0.6);
    pointer-events: none;
    z-index: 100;
    animation: coinFall 0.8s ease-out forwards;
}

@keyframes coinFall {
    0% {
        opacity: 1;
        transform: translateY(0) rotate(0deg) scale(1);
    }

    60% {
        opacity: 1;
        transform: translateY(80px) rotate(180deg) scale(1.1);
    }

    100% {
        opacity: 0;
        transform: translateY(120px) rotate(360deg) scale(0.6);
    }
}

/* Headers & Fonts */
h2,
h3 {
    font-family: 'Shojumaru', cursive;
    letter-spacing: 1px;
    margin: 0 0 10px 0;
    color: #2c2c2c;
}

.gold-display {
    font-family: 'Bangers', cursive;
    font-size: 2em;
    color: var(--gold-color);
    text-shadow: 2px 2px 0 #000;
    background: rgba(0, 0, 0, 0.6);
    padding: 10px;
    border-radius: 10px;
    margin-bottom: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.gold-icon {
    height: 30px;
    margin-right: 10px;
}

/* Log Removido, adicionando estilos de Arena */
.arena-selector-container {
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 10px;
    background: rgba(0, 0, 0, 0.5);
    padding: 10px;
    border-radius: 15px;
    border: 2px solid #8b4513;
}

.nav-btn {
    background: #ff6600;
    border: 2px solid #4a0000;
    color: white;
    font-weight: bold;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    cursor: pointer;
    font-family: 'Bangers', cursive;
    font-size: 1.2em;
}

.nav-btn:hover {
    background: #ff8533;
}

.nav-btn:active {
    transform: scale(0.95);
}

.arenas-scroll {
    flex: 1;
    overflow: hidden;
    margin: 0 10px;
    height: 60px;
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
}

#arenas-display {
    display: flex;
    gap: 10px;
    transition: transform 0.3s ease;
}

.arena-box {
    width: 50px;
    height: 50px;
    background: #4a3b2a;
    border: 2px solid #8b4513;
    color: #ffd700;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: 'Bangers', cursive;
    font-size: 1.2em;
    border-radius: 5px;
    cursor: pointer;
    flex-shrink: 0;
    opacity: 0.6;
}

.arena-box.active {
    background: #ff6600;
    border-color: #ffff00;
    transform: scale(1.1);
    opacity: 1;
    box-shadow: 0 0 10px #ff6600;
}

.arena-box.locked {
    background: #222;
    color: #555;
    cursor: not-allowed;
    border-color: #333;
}

/* Upgrade Boxes Compact */
.upgrades-row {
    display: flex;
    gap: 5px;
    margin-top: 5px;
    width: 100%;
    padding-left: 95px;
    /* Alinhar com o nome do heroi (img width + margin) */
}

.upgrade-box {
    width: 30px;
    height: 30px;
    background-color: #4a3b2a;
    border: 2px solid #8b4513;
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 1.2em;
    position: relative;
    transition: all 0.2s;
}

.upgrade-box.locked {
    opacity: 0;
    /* Totalmente invis√≠vel se bloqueado (se n√£o tiver nivel 20, 40...) */
    pointer-events: none;
}

.upgrade-box.available {
    background-color: #5d4a35;
    border-color: #ffd700;
    /* Borda dourada para indicar disponivel */
    animation: pulseBorder 2s infinite;
}

.upgrade-box.bought {
    background-color: #228b22;
    /* Verde comprado */
    border-color: #00ff00;
    box-shadow: 0 0 5px #00ff00;
    cursor: default;
}

/* Tooltip (S√≥ no hover) */
.tooltip {
    visibility: hidden;
    background-color: rgba(0, 0, 0, 0.95);
    color: #fff;
    text-align: left;
    border-radius: 6px;
    padding: 8px;
    position: absolute;
    z-index: 1000;
    bottom: 125%;
    left: 50%;
    margin-left: -60px;
    width: 150px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
    border: 1px solid #ffd700;
    font-size: 0.8em;
    font-family: 'Roboto', sans-serif;
    pointer-events: none;
    opacity: 0;
    transition: opacity 0.2s;
}

.upgrade-box:hover .tooltip {
    visibility: visible;
    opacity: 1;
}

@keyframes pulseBorder {
    0% {
        border-color: #ffd700;
    }

    50% {
        border-color: #ffaa00;
    }

    100% {
        border-color: #ffd700;
    }
}

.zone-progress-info {
    text-align: center;
    font-family: 'Shojumaru', cursive;
    color: #ffd700;
    background: transparent;
    padding: 0;
    margin-bottom: 20px;
    /* Mais espa√ßo para a barra de vida abaixo */
    margin-top: -20px;
    /* Sobe um pouco mais */
    font-size: 2.8em;
    /* Aumentado levemente */
    text-shadow: 4px 4px 0 #000;
    z-index: 10;
}

/* Boss Timer */
.boss-timer {
    text-align: center;
    font-family: 'Bangers', cursive;
    color: #ff4444;
    background: rgba(0, 0, 0, 0.7);
    padding: 10px 20px;
    margin: -10px auto 20px auto;
    border-radius: 15px;
    font-size: 2.5em;
    text-shadow: 3px 3px 0 #000;
    border: 3px solid #ff0000;
    box-shadow: 0 0 20px rgba(255, 0, 0, 0.5);
    width: fit-content;
    animation: timerPulse 1s infinite;
}

.boss-timer.warning {
    animation: timerWarning 0.5s infinite;
    color: #ff0000;
    border-color: #ff0000;
}

@keyframes timerPulse {

    0%,
    100% {
        transform: scale(1);
    }

    50% {
        transform: scale(1.05);
    }
}

@keyframes timerWarning {

    0%,
    100% {
        transform: scale(1);
        box-shadow: 0 0 20px rgba(255, 0, 0, 0.8);
    }

    50% {
        transform: scale(1.1);
        box-shadow: 0 0 30px rgba(255, 0, 0, 1);
    }
}


/* HERO ITEM REDESIGN (Reference Style) */
.hero-item-new {
    background: #fdf5e6;
    /* Cor de papiro claro */
    border-radius: 12px;
    margin-bottom: 25px;
    padding: 10px;
    position: relative;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    border: 2px solid #dba669;
    min-height: 180px;
    /* Garante espa√ßo para imagem full */
}

/* Header: Nome e Nivel */
.hero-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-end;
    /* Alinha na base do texto */
    margin-bottom: 5px;
    border-bottom: 1px dashed #dba669;
    padding-bottom: 5px;
}

.hero-name-title {
    font-family: 'Shojumaru', cursive;
    font-size: 1.6em;
    color: #333;
    text-shadow: 1px 1px 0 #fff;
    margin-left: 5px;
}

.hero-level-badge {
    font-family: 'Bangers', cursive;
    font-size: 2em;
    color: #fff;
    text-shadow: 2px 2px 0 #000;
}

/* Body: Esquerda (Botao + Skills) | Direita (Imagem) */
.hero-body-row {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
}

.left-section {
    display: flex;
    flex-direction: row;
    /* Botao e Skills lado a lado */
    align-items: center;
    gap: 15px;
    margin-top: 10px;
}

/* Bot√£o de Compra (Azul/Dourado estilo fish game) */
.buy-box {
    background: linear-gradient(to bottom, #4facfe 0%, #00f2fe 100%);
    width: 130px;
    height: 70px;
    border-radius: 10px;
    border: 4px solid #ffd700;
    box-shadow: 0 4px 0 #0056b3, 0 5px 10px rgba(0, 0, 0, 0.3);
    cursor: pointer;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    transition: transform 0.1s;
}

.buy-box:active {
    transform: translateY(4px);
    box-shadow: 0 0 0 #0056b3;
}

.buy-box.locked {
    background: #555;
    border-color: #333;
    cursor: not-allowed;
    box-shadow: none;
}

.buy-action {
    font-family: 'Bangers', cursive;
    font-size: 1.5em;
    color: #fff;
    text-shadow: 1px 1px 0 #000;
    line-height: 1;
}

.buy-cost {
    font-family: 'Roboto', sans-serif;
    font-weight: bold;
    font-size: 1em;
    color: #fff4e6;
    text-shadow: 1px 1px 0 #000;
    margin-top: 2px;
}

/* Skills Container */
.upgrades-container {
    display: flex;
    gap: 8px;
}

.upgrade-box-new {
    width: 45px;
    height: 45px;
    background: #3e2723;
    border: 3px solid #5d4037;
    border-radius: 6px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5em;
    cursor: pointer;
    position: relative;
    box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.8);
}

.upgrade-box-new.locked {
    opacity: 0;
    pointer-events: none;
}

.upgrade-box-new.available {
    background: #5d4037;
    border-color: #ffd700;
    animation: pulseBorder 2s infinite;
}

.upgrade-box-new.bought {
    border-color: #00ff00;
}

.check-mark {
    position: absolute;
    top: -5px;
    right: -5px;
    color: #00ff00;
    font-size: 1em;
    text-shadow: 1px 1px 0 #000;
    font-weight: bold;
}

/* Imagem do Heroi (Full Body, Saindo pra fora se precisar) */
.hero-image-container {
    width: 200px;
    /* Largura fixa para imagem */
    height: 250px;
    margin-top: -60px;
    /* Puxa pra cima para sobrepor header se quiser, ou ajustar */
    margin-right: -10px;
    display: flex;
    align-items: flex-end;
    justify-content: center;
    pointer-events: none;
    /* Deixar clicar atrav√©s se precisar */
    overflow: hidden;
    /* Corta se for muito grande */
}

.hero-full-img {
    max-height: 100%;
    max-width: 100%;
    filter: drop-shadow(5px 5px 10px rgba(0, 0, 0, 0.4));
    transition: transform 0.2s;
}

.hero-item-new:hover .hero-full-img {
    transform: scale(1.05);
}

/* HERO CONTAINER (Holds Title + Card) */
.hero-card-split {
    background: transparent;
    border: none;
    box-shadow: none;
    margin-bottom: 30px;
    display: flex;
    flex-direction: column;
}

/* NAME HEADER OUTSIDE */
.hero-title-header {
    font-family: 'Shojumaru', cursive;
    font-size: 1.4em;
    /* Reduzido */
    color: #e65100;
    text-shadow: 2px 2px 0 #fff;
    text-align: left;
    /* Alinhado com a esquerda da caixa */
    margin-bottom: 2px;
    /* Espa√ßo positivo, sem sobrepor */
    z-index: 10;
    position: relative;
    width: 100%;
    /* Permitir largura total */
    padding-left: 20px;
    white-space: nowrap;
    /* For√ßar uma linha */
    display: flex;
    align-items: center;
    gap: 10px;
}

.hero-element-icon {
    height: 28px;
    width: auto;
    filter: drop-shadow(0 2px 2px rgba(0, 0, 0, 0.3));
}

/* THE ACTUAL CARD BOX */
.hero-card-inner-split {
    background: #fff;
    border: 3px solid #8b4513;
    border-radius: 12px;
    display: flex;
    flex-direction: row;
    height: 190px;
    /* Altura reduzida para quadrado aproximado */
    position: relative;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
    overflow: visible;
    /* Permitir que o overlay saia pra fora */
    z-index: 1;
    margin-top: 5px;
}

/* LEFT COLUMN (50%) */
.card-left-col {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    /* Imagem no topo */
    padding: 0;
    /* Sem padding para imagem encostar */
    background: #fff;
    border-right: none;
    /* Removida a linha pontilhada */
    position: relative;
    overflow: hidden;
    /* Cortar excesso */
}

.hero-image-wrapper {
    width: 100%;
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: flex-start;
    /* Alinhar topo */
    position: relative;
    padding: 0;
}

.hero-full-body-img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: top center;
    image-rendering: -webkit-optimize-contrast;
    image-rendering: crisp-edges;
    filter: drop-shadow(0 5px 5px rgba(0, 0, 0, 0.3));
    transition: transform 0.3s ease;
    /* Transi√ß√£o mais suave */
    margin: 0;
    cursor: pointer;
}

.hero-full-body-img:hover {
    transform: scale(1.1);
    z-index: 10;
}

/* RIGHT COLUMN (50%) */
.card-right-col {
    flex: 1;
    display: flex;
    flex-direction: column;
    padding: 10px 15px;
    background: rgba(255, 255, 255, 0.9);
    border-top-right-radius: 8px;
    border-bottom-right-radius: 8px;
    justify-content: flex-start;
    gap: 8px;
    /* Espa√ßo uniforme entre os elementos */
    position: relative;
}

.hero-level-display {
    font-family: 'Bangers', cursive;
    font-size: 2.2em;
    color: #333;
    border-bottom: 2px solid #ff6600;
    margin-bottom: 5px;
    text-align: right;
}

/* OVERLAY DETALHES (Preto com opacidade) Popup */
.hero-stats-overlay {
    position: absolute;
    top: -10px;
    /* Mais pra cima */
    right: -10px;
    /* Mais pra direita */
    width: 200px;
    height: auto;
    min-height: 60px;
    background: rgba(0, 0, 0, 0.9);
    color: #fff;
    padding: 15px;
    z-index: 100;
    opacity: 0;
    pointer-events: none;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    transform: translateY(10px);
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    border-radius: 8px;
    border: 1px solid #ff9800;
    font-family: 'Roboto', sans-serif;
    text-align: left;
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.5);
}

/* Abrir ao passar o mouse apenas na Imagem ou no Bot√£o de Upgrade */
.hero-card-inner-split:hover .hero-stats-overlay {
    opacity: 0;
}

.hero-card-inner-split:has(.card-left-col:hover) .hero-stats-overlay,
.hero-card-inner-split:has(.hero-buy-btn:hover) .hero-stats-overlay {
    opacity: 1;
    transform: translateY(0);
}

.overlay-title {
    font-family: 'Shojumaru', cursive;
    color: #ff9800;
    font-size: 1.1em;
    margin-bottom: 8px;
    border-bottom: 1px solid #444;
    padding-bottom: 4px;
}

.stat-line {
    font-size: 1em;
    margin: 3px 0;
}

.stat-line strong {
    color: #ffd700;
}

.dps-increment {
    color: #4caf50;
    font-weight: bold;
    margin-left: 5px;
    text-shadow: 0 0 5px rgba(76, 175, 80, 0.5);
}

.stat-line-desc {
    font-size: 0.85em;
    color: #bbb;
    margin-top: 5px;
    line-height: 1.2;
}

hr {
    border: 0;
    border-top: 1px solid #444;
    margin: 8px 0;
}

.hero-skills-row {
    display: flex;
    gap: 12px;
    /* Mais espa√ßo entre √≠cones */
    margin: 10px 0 10px 15px;
    /* Adicionado 15px na esquerda para chegar pra direita */
    min-height: 50px;
    align-items: center;
    justify-content: flex-start;
}

.skill-box {
    width: 45px;
    height: 45px;
    background: #1a1a1a;
    border-radius: 8px;
    border: 2px solid #5d4037;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    position: relative;
    overflow: hidden;
    /* Cortar imagem nos cantos arredondados */
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
    transition: transform 0.1s;
}

.skill-box:hover:not(.locked) {
    transform: scale(1.1);
    z-index: 10;
}

.skill-img-icon {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.skill-box.locked {
    opacity: 0.3;
    filter: grayscale(1);
    cursor: pointer;
}

.skill-box.locked.affordable {
    opacity: 0.6;
    filter: grayscale(0.5);
    border-color: #ffd700;
    box-shadow: 0 0 8px rgba(255, 215, 0, 0.4);
}

.skill-box.available {
    background: #5d4037;
    border-color: #ffd700;
    animation: pulseBorder 1.5s infinite;
}

.skill-box.bought {
    border-color: #00ff00;
}

.skill-check {
    position: absolute;
    top: -8px;
    right: -8px;
    color: #00ff00;
    font-size: 1.2em;
    font-weight: bold;
    text-shadow: 1px 1px 0 #000;
}

/* API Button at Bottom Right */
.hero-buy-btn {
    background: linear-gradient(to bottom, #ff9800 0%, #f57c00 100%);
    border: 2px solid #e65100;
    border-radius: 6px;
    padding: 5px 10px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    cursor: pointer;
    box-shadow: 0 3px 0 #bf360c;
    transition: active 0.1s;
    margin-top: 5px;
}

.hero-buy-btn:active {
    transform: translateY(3px);
    box-shadow: none;
}

.hero-buy-btn.locked {
    background: #777;
    border-color: #555;
    box-shadow: none;
    cursor: not-allowed;
    justify-content: center;
    color: #ccc;
}

.buy-label {
    font-family: 'Bangers', cursive;
    color: white;
    font-size: 1.2em;
}

.buy-value {
    font-weight: bold;
    color: #fff;
    font-size: 1em;
}

.hero-buy-btn.disabled {
    background: #9e9e9e;
    border-color: #757575;
    cursor: not-allowed;
    box-shadow: none;
    opacity: 0.8;
}

/* Mobile Adjust */
@media (max-width: 900px) {
    .hero-card-split {
        height: auto;
        flex-direction: column;
    }

    .card-left-col {
        border-right: none;
        border-bottom: 2px dashed #dba669;
    }

    .hero-image-wrapper {
        min-height: 200px;
    }

    .hero-full-body-img {
        height: auto;
        max-height: 250px;
    }
}

/* ===== BACKPACK ICON ===== */
.backpack-icon {
    font-size: 1.2em;
    cursor: pointer;
    margin-left: 20px;
    display: inline-block;
    transition: transform 0.2s ease, filter 0.2s ease;
    filter: drop-shadow(2px 2px 4px rgba(0, 0, 0, 0.5));
}

.backpack-icon:hover {
    transform: scale(1.15) rotate(-5deg);
    filter: drop-shadow(3px 3px 6px rgba(139, 69, 19, 0.8));
}

.backpack-icon:active {
    transform: scale(1.05);
}

/* ===== MODAL OVERLAY ===== */
.modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.85);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 9999;
    backdrop-filter: blur(5px);
    animation: fadeIn 0.3s ease;
}

@keyframes fadeIn {
    from {
        opacity: 0;
    }

    to {
        opacity: 1;
    }
}

/* ===== BACKPACK MODAL ===== */
.backpack-modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: rgba(0, 0, 0, 0.85);
    backdrop-filter: blur(5px);
    z-index: 10000;
    display: none;
    align-items: center;
    justify-content: center;
}

.backpack-modal.active {
    display: flex;
}

.backpack-container {
    background: linear-gradient(135deg, #d4a574 0%, #c89860 50%, #b8885a 100%);
    border: 6px solid #8b6f47;
    border-radius: 20px;
    box-shadow: 0 15px 50px rgba(0, 0, 0, 0.8),
        inset 0 2px 10px rgba(255, 255, 255, 0.2);
    width: 90%;
    max-width: 900px;
    max-height: 85vh;
    overflow: hidden;
    position: relative;
    animation: modalSlideIn 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

@keyframes modalSlideIn {
    from {
        transform: scale(0.7);
        opacity: 0;
    }

    to {
        transform: scale(1);
        opacity: 1;
    }
}

.modal-header {
    background: linear-gradient(to bottom, #8b6f47, #6d5638);
    padding: 20px 30px;
    border-bottom: 4px solid #5d4a2f;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.4);
}

.modal-header h2 {
    font-family: 'Shojumaru', cursive;
    font-size: 2.2em;
    color: #fff;
    text-shadow: 3px 3px 0 #000,
        -1px -1px 0 #000,
        1px -1px 0 #000,
        -1px 1px 0 #000,
        0 0 15px rgba(255, 215, 0, 0.5);
    margin: 0;
}

.modal-close {
    background: #d32f2f;
    border: 3px solid #8b0000;
    color: #fff;
    font-size: 1.8em;
    font-weight: bold;
    width: 45px;
    height: 45px;
    border-radius: 50%;
    cursor: pointer;
    transition: all 0.2s ease;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.4);
    display: flex;
    align-items: center;
    justify-content: center;
}

.modal-close:hover {
    background: #ff5252;
    transform: rotate(90deg) scale(1.1);
    box-shadow: 0 6px 12px rgba(255, 0, 0, 0.6);
}

.modal-close:active {
    transform: rotate(90deg) scale(0.95);
}

.modal-body {
    padding: 30px;
    overflow-y: auto;
    max-height: calc(85vh - 100px);
    background: linear-gradient(to bottom, rgba(255, 255, 255, 0.1), rgba(0, 0, 0, 0.1));
}

/* ===== INVENTORY GRID ===== */
.inventory-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(90px, 1fr));
    gap: 15px;
    padding: 10px;
}

.inventory-slot {
    width: 90px;
    height: 90px;
    background: linear-gradient(135deg, #8b0000, #a52a2a);
    border: 4px solid #5d0000;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.6),
        0 4px 10px rgba(0, 0, 0, 0.5);
}

.inventory-slot:hover {
    transform: translateY(-5px) scale(1.05);
    box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.6),
        0 8px 20px rgba(255, 215, 0, 0.4);
    border-color: #ffd700;
}

.inventory-slot.empty::before {
    content: 'üîí';
    font-size: 2.5em;
    opacity: 0.3;
    filter: grayscale(1);
}

.inventory-slot.has-item {
    background: linear-gradient(135deg, #1a472a, #2e7d32);
    border-color: #1b5e20;
}

.inventory-slot.has-item:hover {
    border-color: #4caf50;
}

.item-icon {
    font-size: 3em;
    filter: drop-shadow(2px 2px 4px rgba(0, 0, 0, 0.8));
}

.item-count {
    position: absolute;
    bottom: 5px;
    right: 8px;
    background: rgba(0, 0, 0, 0.85);
    color: #fff;
    font-size: 0.9em;
    font-weight: bold;
    padding: 2px 6px;
    border-radius: 8px;
    border: 2px solid #ffd700;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.6);
}

/* ===== ADMIN PANEL ===== */
#admin-trigger {
    position: fixed;
    bottom: 20px;
    right: 20px;
    width: 50px;
    height: 50px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border: 3px solid #4a5568;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.8em;
    cursor: pointer;
    z-index: 8888;
    transition: all 0.3s ease;
    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
}

#admin-trigger:hover {
    transform: scale(1.15) rotate(90deg);
    box-shadow: 0 6px 25px rgba(102, 126, 234, 0.7);
}

.admin-modal {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border: 6px solid #4a5568;
    border-radius: 20px;
    box-shadow: 0 15px 50px rgba(0, 0, 0, 0.8),
        inset 0 2px 10px rgba(255, 255, 255, 0.2);
    width: 90%;
    max-width: 500px;
    overflow: hidden;
    position: relative;
    animation: modalSlideIn 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

.admin-input-group {
    display: flex;
    flex-direction: column;
    gap: 15px;
    padding: 10px;
}

.admin-input-group label {
    font-family: 'Shojumaru', cursive;
    font-size: 1.3em;
    color: #fff;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
}

.admin-input-group input {
    padding: 12px 15px;
    font-size: 1.2em;
    border: 3px solid #4a5568;
    border-radius: 10px;
    background: rgba(255, 255, 255, 0.95);
    color: #333;
    font-weight: bold;
    transition: all 0.3s ease;
}

.admin-input-group input:focus {
    outline: none;
    border-color: #ffd700;
    box-shadow: 0 0 15px rgba(255, 215, 0, 0.5);
}

.admin-btn {
    padding: 15px 30px;
    font-size: 1.3em;
    font-weight: bold;
    background: linear-gradient(to bottom, #ffd700, #ffb700);
    border: 3px solid #8b6f00;
    border-radius: 12px;
    color: #000;
    cursor: pointer;
    transition: all 0.2s ease;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.4);
    text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.5);
}

.admin-btn:hover {
    background: linear-gradient(to bottom, #ffed4e, #ffd700);
    transform: translateY(-2px);
    box-shadow: 0 6px 15px rgba(255, 215, 0, 0.6);
}

.admin-btn:active {
    transform: translateY(0);
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.4);
}

/* Elemental Cycle Guide */
.elemental-cycle-guide {
    position: absolute;
    top: 100px;
    right: 20px;
    width: 250px;
    height: auto;
    z-index: 100;
    pointer-events: none;
    filter: drop-shadow(0 0 15px rgba(0, 0, 0, 0.6));
    opacity: 1;
    transition: opacity 0.3s ease;
}

.center-panel:hover .elemental-cycle-guide {
    opacity: 0.7;
}

/* Item Drop Notification - Redesenhada */
.item-drop-notification {
    position: fixed;
    bottom: 120px;
    right: 30px;
    background: linear-gradient(135deg, rgba(45, 27, 0, 0.95) 0%, rgba(93, 58, 26, 0.95) 100%);
    border: 3px solid #ffd700;
    border-radius: 10px;
    padding: 12px 18px;
    z-index: 10000;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.6), 0 0 20px rgba(255, 215, 0, 0.3);
    animation: dropSlideIn 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55), dropFadeOut 0.4s ease-in 2.6s forwards;
    pointer-events: none;
    display: flex;
    align-items: center;
    gap: 12px;
    max-width: 280px;
}

.item-drop-notification img {
    width: 45px;
    height: 45px;
    flex-shrink: 0;
    filter: drop-shadow(0 2px 6px rgba(255, 215, 0, 0.4));
}

.item-drop-notification .drop-content {
    display: flex;
    flex-direction: column;
    gap: 2px;
}

.item-drop-notification .drop-text {
    font-family: 'Bangers', cursive;
    font-size: 1.1em;
    color: #ffd700;
    text-shadow: 1px 1px 3px #000;
    letter-spacing: 0.5px;
    line-height: 1;
}

.item-drop-notification .item-name {
    font-family: 'Roboto', sans-serif;
    font-size: 0.95em;
    font-weight: 500;
    color: #f0e6d2;
    text-shadow: 1px 1px 2px #000;
    line-height: 1.2;
}

@keyframes dropSlideIn {
    0% {
        opacity: 0;
        transform: translateX(100px);
    }

    100% {
        opacity: 1;
        transform: translateX(0);
    }
}

@keyframes dropFadeOut {
    0% {
        opacity: 1;
        transform: translateX(0);
    }

    100% {
        opacity: 0;
        transform: translateX(50px);
    }
}

/* Item Icon Image in Inventory */
.item-icon-img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
}

/* ===== SISTEMA DE MOCHILA - DESIGN MODERNO E PROFISSIONAL ===== */

/* Modal Backdrop */
.backpack-modal {
    display: flex !important;
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
    width: 100vw !important;
    height: 100vh !important;
    background: rgba(0, 0, 0, 0.5);
    backdrop-filter: blur(4px);
    z-index: 99999 !important;
    justify-content: center !important;
    align-items: center !important;
    animation: fadeIn 0.2s ease-out;
    visibility: hidden;
    opacity: 0;
    transition: opacity 0.2s, visibility 0.2s;
}

.backpack-modal.active {
    visibility: visible;
    opacity: 1;
}

@keyframes fadeIn {
    from {
        opacity: 0;
    }

    to {
        opacity: 1;
    }
}

/* Container Principal */
.backpack-container {
    background: linear-gradient(145deg, #1a1a1a 0%, #2d2d2d 100%);
    border: 1px solid #404040;
    border-radius: 12px;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.8), 0 0 0 1px rgba(255, 255, 255, 0.05);
    max-width: 700px;
    width: 90%;
    max-height: 85vh;
    overflow: hidden;
    animation: slideUp 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    margin: auto;
}

@keyframes slideUp {
    from {
        opacity: 0;
        transform: translateY(30px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Header */
.backpack-header {
    background: linear-gradient(135deg, #2a2a2a 0%, #1f1f1f 100%);
    border-bottom: 1px solid #404040;
    padding: 20px 25px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.backpack-title {
    display: flex;
    align-items: center;
    gap: 12px;
    font-family: 'Roboto', sans-serif;
    font-size: 1.4em;
    font-weight: 600;
    color: #e0e0e0;
    letter-spacing: 0.5px;
}

.close-backpack {
    background: transparent;
    border: none;
    color: #999;
    font-size: 1.8em;
    cursor: pointer;
    width: 36px;
    height: 36px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 6px;
    transition: all 0.2s;
}

.close-backpack:hover {
    background: rgba(255, 255, 255, 0.05);
    color: #fff;
}

/* Body */
.backpack-body {
    padding: 25px;
    max-height: calc(85vh - 80px);
    overflow-y: auto;
}

.backpack-body::-webkit-scrollbar {
    width: 8px;
}

.backpack-body::-webkit-scrollbar-track {
    background: #1a1a1a;
    border-radius: 4px;
}

.backpack-body::-webkit-scrollbar-thumb {
    background: #404040;
    border-radius: 4px;
}

.backpack-body::-webkit-scrollbar-thumb:hover {
    background: #505050;
}

/* Grid de Invent√°rio */
.inventory-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(70px, 1fr));
    gap: 10px;
    padding: 5px;
}

/* Slots */
.inventory-slot {
    aspect-ratio: 1;
    background: linear-gradient(145deg, #242424 0%, #1a1a1a 100%);
    border: 1px solid #333;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    transition: all 0.2s;
    cursor: default;
    box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.5);
}

.inventory-slot.empty {
    opacity: 0.4;
}

.inventory-slot.empty:hover {
    background: linear-gradient(145deg, #2a2a2a 0%, #202020 100%);
    border-color: #3a3a3a;
}

.inventory-slot.has-item {
    background: linear-gradient(145deg, #2d2d2d 0%, #232323 100%);
    border-color: #4a4a4a;
    opacity: 1;
    cursor: pointer;
}

.inventory-slot.has-item:hover {
    background: linear-gradient(145deg, #353535 0%, #2a2a2a 100%);
    border-color: #5a5a5a;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.6), inset 0 1px 2px rgba(255, 255, 255, 0.05);
}

/* √çcone do Item */
.item-icon {
    font-size: 2.2em;
    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.5));
}

/* Contador de Itens */
.item-count {
    position: absolute;
    bottom: 4px;
    right: 4px;
    background: rgba(0, 0, 0, 0.85);
    color: #fff;
    font-family: 'Roboto', sans-serif;
    font-size: 0.75em;
    font-weight: 600;
    padding: 2px 6px;
    border-radius: 4px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
    line-height: 1;
}

/* √çcone da Mochila no Header */
.backpack-icon {
    cursor: pointer;
    font-size: 0.9em;
    transition: transform 0.2s;
    display: inline-block;
    margin-left: 8px;
}

.backpack-icon:hover {
    transform: scale(1.15);
}

/* ===== ANIMA√á√ÉO DE DIAMANTES ===== */
.diamond-drop {
    position: absolute;
    font-size: 2em;
    pointer-events: none;
    z-index: 100;
    animation: diamondFall 1s ease-out forwards;
    filter: drop-shadow(0 0 8px rgba(0, 212, 255, 0.8));
}

@keyframes diamondFall {
    0% {
        transform: translateY(0) scale(1);
        opacity: 1;
    }

    50% {
        transform: translateY(-30px) scale(1.2);
        opacity: 1;
    }

    100% {
        transform: translateY(60px) scale(0.5);
        opacity: 0;
    }
}

/* ===== MODAL DE MISS√ÉO ===== */
.mission-container {
    background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
    border: 4px solid #00d4ff;
    border-radius: 20px;
    box-shadow: 0 15px 50px rgba(0, 212, 255, 0.5),
        inset 0 2px 10px rgba(0, 212, 255, 0.2);
    width: 90%;
    max-width: 700px;
    max-height: 85vh;
    overflow-y: auto;
    position: relative;
    animation: modalSlideIn 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

.mission-header {
    background: linear-gradient(135deg, #00d4ff 0%, #0088cc 100%);
    padding: 15px 20px;
    border-radius: 16px 16px 0 0;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 3px solid #00ffff;
}

.mission-title {
    display: flex;
    align-items: center;
    gap: 10px;
    font-family: 'Bangers', cursive;
    font-size: 1.8em;
    color: #fff;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
}

.close-mission {
    background: rgba(255, 0, 0, 0.8);
    border: 2px solid #fff;
    border-radius: 50%;
    width: 35px;
    height: 35px;
    font-size: 1.2em;
    color: #fff;
    cursor: pointer;
    transition: all 0.2s;
}

.close-mission:hover {
    background: rgba(255, 0, 0, 1);
    transform: scale(1.1);
}

.mission-body {
    padding: 20px;
}

.mission-details {
    color: #fff;
}

.mission-icon {
    font-size: 4em;
    text-align: center;
    margin-bottom: 10px;
    filter: drop-shadow(0 0 10px rgba(0, 212, 255, 0.8));
}

.mission-details h3 {
    font-family: 'Bangers', cursive;
    font-size: 2em;
    text-align: center;
    color: #00d4ff;
    margin: 10px 0;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
}

.mission-subtitle {
    text-align: center;
    font-style: italic;
    color: #aaa;
    margin-bottom: 20px;
}

.mission-section {
    background: rgba(0, 0, 0, 0.3);
    padding: 12px;
    border-radius: 8px;
    margin-bottom: 12px;
    border-left: 4px solid #00d4ff;
}

.mission-section h4 {
    margin: 0 0 8px 0;
    color: #00d4ff;
    font-size: 1.1em;
}

.mission-section p {
    margin: 0;
    line-height: 1.6;
}

.mission-section.bonus {
    border-left-color: #6c9;
    background: rgba(102, 204, 153, 0.15);
}

.mission-section.bonus h4 {
    color: #6c9;
}

.mission-section.objective {
    border-left-color: #f9c74f;
    background: rgba(249, 199, 79, 0.15);
}

.mission-section.objective h4 {
    color: #f9c74f;
}

.mission-section.reward {
    border-left-color: #b565d8;
    background: rgba(181, 101, 216, 0.15);
}

.mission-section.reward h4 {
    color: #b565d8;
}

.mission-cost {
    background: linear-gradient(135deg, rgba(0, 212, 255, 0.2), rgba(0, 136, 204, 0.2));
    padding: 15px;
    border-radius: 10px;
    margin: 20px 0 10px 0;
    text-align: center;
    border: 2px solid #00d4ff;
}

.cost-label {
    display: block;
    font-size: 0.9em;
    color: #aaa;
    margin-bottom: 5px;
}

.cost-value {
    display: block;
    font-family: 'Bangers', cursive;
    font-size: 2em;
    color: #00d4ff;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
}

.player-diamonds {
    text-align: center;
    font-size: 1.1em;
    margin-bottom: 20px;
}

.player-diamonds .enough {
    color: #00ff00;
    font-weight: bold;
}

.player-diamonds .not-enough {
    color: #ff0000;
    font-weight: bold;
}

.mission-actions {
    display: flex;
    gap: 10px;
    margin-top: 20px;
}

.mission-btn {
    flex: 1;
    padding: 12px 20px;
    font-family: 'Bangers', cursive;
    font-size: 1.3em;
    border: none;
    border-radius: 10px;
    cursor: pointer;
    transition: all 0.2s;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
}

.mission-btn.purchase {
    background: linear-gradient(135deg, #00ff00, #00aa00);
    color: #fff;
    border: 2px solid #00ff00;
}

.mission-btn.purchase:hover:not(:disabled) {
    background: linear-gradient(135deg, #00ff00, #00cc00);
    transform: scale(1.05);
    box-shadow: 0 0 20px rgba(0, 255, 0, 0.6);
}

.mission-btn.purchase:disabled {
    background: #555;
    border-color: #777;
    color: #999;
    cursor: not-allowed;
    opacity: 0.5;
}

.mission-btn.cancel {
    background: linear-gradient(135deg, #ff4444, #cc0000);
    color: #fff;
    border: 2px solid #ff4444;
}

.mission-btn.cancel:hover {
    background: linear-gradient(135deg, #ff6666, #dd0000);
    transform: scale(1.05);
    box-shadow: 0 0 20px rgba(255, 68, 68, 0.6);
}
/* Estilos para Miss√£o Lend√°ria (Skill 4) */
.mission-part {
    background: rgba(0, 0, 0, 0.3);
    padding: 15px;
    border-radius: 8px;
    margin: 10px 0;
    border: 2px solid #8b4513;
}

.mission-part.completed {
    background: rgba(0, 150, 0, 0.2);
    border-color: #00ff00;
}

.mission-part h4 {
    margin: 0 0 10px 0;
    color: #ffd700;
    font-family: 'Bangers', cursive;
    font-size: 1.3em;
}

.mission-part p {
    margin: 5px 0;
    color: #fff;
}

.progress-bar {
    background: rgba(0, 0, 0, 0.5);
    border-radius: 10px;
    height: 30px;
    margin: 10px 0;
    position: relative;
    overflow: hidden;
    border: 2px solid #8b4513;
}

.progress-fill {
    background: linear-gradient(90deg, #00ff00, #00aa00);
    height: 100%;
    border-radius: 8px;
    transition: width 0.3s ease;
}

.progress-text {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-weight: bold;
    color: #fff;
    text-shadow: 1px 1px 2px #000;
    font-family: 'Bangers', cursive;
    font-size: 1.1em;
}

.complete-part-btn {
    background: linear-gradient(135deg, #00ff00, #00aa00);
    color: #000;
    border: 2px solid #00ff00;
    padding: 10px 20px;
    font-family: 'Bangers', cursive;
    font-size: 1.2em;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.2s;
    margin: 10px 0;
}

.complete-part-btn:hover:not(:disabled) {
    background: linear-gradient(135deg, #00ff44, #00cc00);
    transform: scale(1.05);
    box-shadow: 0 0 15px rgba(0, 255, 0, 0.5);
}

.complete-part-btn:disabled {
    background: #555;
    border-color: #777;
    color: #999;
    cursor: not-allowed;
    opacity: 0.5;
}

.mission-section.legendary {
    background: linear-gradient(135deg, rgba(255, 215, 0, 0.2), rgba(255, 140, 0, 0.2));
    border: 2px solid #ffd700;
    box-shadow: 0 0 15px rgba(255, 215, 0, 0.3);
}



----- FILE: static/js/game.js  (sha1:c383fffdb132, bytes:11091) -----
// Estado Global do Jogo
const gameState = {
    gold: 0,
    totalDps: 0,
    clickDamage: 1,
    currentZone: 1,
    monstersKilledInZone: 0,
    heroes: [], // { id, level, currentDps, cost }
    currentMonster: {
        hp: 10,
        maxHp: 10,
        name: "Bandido",
        img: ""
    },
    statistics: {
        totalClicks: 0,
        totalKills: 0,
        maxZone: 1
    }
};

// Configura√ß√µes
const TICKS_PER_SECOND = 10;
let autoSaveInterval;

// Inicializa√ß√£o
function initGame() {
    loadGame();
    setupHeroes();
    spawnMonster();
    updateUI();
    startGameLoop();
    setupEventListeners();

    // Auto-save a cada 30s
    autoSaveInterval = setInterval(saveGame, 30000);
}

// Configura lista de her√≥is baseada no game_data.js
function setupHeroes() {
    gameState.heroes = heroesData.map(heroData => {
        // Tenta carregar estado salvo ou inicia do zero
        const savedHero = gameState.savedHeroes ? gameState.savedHeroes.find(h => h.id === heroData.id) : null;
        return {
            ...heroData,
            level: savedHero ? savedHero.level : 0,
            currentCost: savedHero ? calculateCost(heroData.baseCost, savedHero.level) : heroData.baseCost,
            currentDps: savedHero ? heroData.baseDps * savedHero.level : 0
        };
    });
    recalculateTotalDps();
    renderHeroesList();
}

function calculateCost(baseCost, currentLevel) {
    return Math.floor(baseCost * Math.pow(1.07, currentLevel));
}

function recalculateTotalDps() {
    gameState.totalDps = gameState.heroes.reduce((sum, hero) => sum + hero.currentDps, 0);
    // Dano de clique √© 1 + 1% do DPS total (m√≠nimo 1)
    gameState.clickDamage = 1 + Math.ceil(gameState.totalDps * 0.01);
}

// Renderiza√ß√£o da Lista de Her√≥is
function renderHeroesList() {
    const listContainer = document.getElementById('heroes-list');
    listContainer.innerHTML = '';

    gameState.heroes.forEach(hero => {
        const item = document.createElement('div');
        item.className = 'hero-item';
        item.id = `hero-${hero.id}`;
        item.dataset.id = hero.id;
        item.onclick = () => buyHero(hero.id);

        item.innerHTML = `
            <div class="hero-img" style="background-image: url('static/img/${hero.img}'); background-size: cover;"></div>
            <div class="hero-info">
                <div class="hero-name">${hero.name} <span class="hero-level">Nv. ${hero.level}</span></div>
                <div class="hero-stats">DPS: ${formatNumber(hero.baseDps * (hero.level || 1))} | +${formatNumber(hero.baseDps)} DPS/Lv</div>
                <div class="hero-cost">Custo: ${formatNumber(hero.currentCost)} Ryo</div>
            </div>
        `;
        listContainer.appendChild(item);
    });
}

function updateHeroUI(heroId) {
    const hero = gameState.heroes.find(h => h.id === heroId);
    if (!hero) return;

    const item = document.getElementById(`hero-${heroId}`);
    if (item) {
        item.querySelector('.hero-level').textContent = `Nv. ${hero.level}`;
        item.querySelector('.hero-cost').textContent = `Custo: ${formatNumber(hero.currentCost)} Ryo`;

        // Verifica se pode comprar visualmente
        if (gameState.gold >= hero.currentCost) {
            item.classList.remove('disabled');
        } else {
            item.classList.add('disabled');
        }
    }
}

// Mec√¢nica de Compra
function buyHero(heroId) {
    const hero = gameState.heroes.find(h => h.id === heroId);
    if (hero && gameState.gold >= hero.currentCost) {
        gameState.gold -= hero.currentCost;
        hero.level++;
        hero.currentCost = calculateCost(hero.baseCost, hero.level);
        hero.currentDps = hero.baseDps * hero.level;

        recalculateTotalDps();
        updateUI();
        renderHeroesList(); // Re-render para atualizar tudo
        logMessage(`Voc√™ contratou/treinou ${hero.name}!`);
    }
}

// Spawning de Monstros
function spawnMonster() {
    const zoneMultiplier = Math.pow(zoneData.hpMultiplier, gameState.currentZone - 1);
    gameState.currentMonster.maxHp = Math.floor(zoneData.baseHp * zoneMultiplier);
    gameState.currentMonster.hp = gameState.currentMonster.maxHp;

    const randomName = monsterNames[Math.floor(Math.random() * monsterNames.length)];
    gameState.currentMonster.name = `${randomName} (Lv. ${gameState.currentZone})`;

    // Atualiza visual
    document.getElementById('monster-name').textContent = gameState.currentMonster.name;
    // URL placeholder aleat√≥ria para monstros, em um app real usaria assets locais
    const monsterId = Math.floor(Math.random() * 10) + 1;
    document.getElementById('monster-img').src = `https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/${monsterId}.png`; // Placeholder tempor√°rio

    updateMonsterUI();
}

function damageMonster(amount, isClick = false) {
    gameState.currentMonster.hp -= amount;
    if (gameState.currentMonster.hp < 0) gameState.currentMonster.hp = 0;

    if (isClick) {
        createDamageNumber(amount, true);
        animateMonsterShake();
        gameState.statistics.totalClicks++;
    }

    if (gameState.currentMonster.hp <= 0) {
        monterDeath();
    }

    updateMonsterUI();
}

function monterDeath() {
    // Recompensa
    const zoneMultiplier = Math.pow(zoneData.coinsMultiplier, gameState.currentZone - 1);
    const goldDrop = Math.ceil(Math.random() * 5 * zoneMultiplier); // Base 1-5 * multi

    gameState.gold += goldDrop;
    gameState.statistics.totalKills++;
    gameState.monstersKilledInZone++;

    logMessage(`Monstro derrotado! +${formatNumber(goldDrop)} Ryo`);

    // Progress√£o de Zona
    if (gameState.monstersKilledInZone >= zoneData.monstersPerZone) {
        gameState.currentZone++;
        gameState.monstersKilledInZone = 0;
        if (gameState.currentZone > gameState.statistics.maxZone) {
            gameState.statistics.maxZone = gameState.currentZone;
            logMessage(`AVAN√áOU PARA ZONA ${gameState.currentZone}!`);
        }
    }

    spawnMonster();
    updateUI();
}

// Loop Principal
function startGameLoop() {
    setInterval(() => {
        // Dano autom√°tico (DPS) aplicado a cada d√©cimo de segundo
        if (gameState.totalDps > 0) {
            const dpsTick = gameState.totalDps / TICKS_PER_SECOND;
            if (dpsTick > 0 && gameState.currentMonster.hp > 0) {
                damageMonster(dpsTick, false);
            }
        }

        // Verifica bot√µes habilitados
        checkBuyButtons();

    }, 1000 / TICKS_PER_SECOND);
}

function checkBuyButtons() {
    gameState.heroes.forEach(hero => {
        const item = document.getElementById(`hero-${hero.id}`);
        if (item) {
            if (gameState.gold >= hero.currentCost) {
                item.classList.remove('disabled');
            } else {
                item.classList.add('disabled');
            }
        }
    });
}

// Event Listeners
function setupEventListeners() {
    const clickTarget = document.getElementById('click-target');
    clickTarget.addEventListener('mousedown', () => {
        damageMonster(gameState.clickDamage, true);
        clickTarget.querySelector('.monster-visual').style.transform = "scale(0.9)";
    });

    clickTarget.addEventListener('mouseup', () => {
        clickTarget.querySelector('.monster-visual').style.transform = "scale(1)";
    });
}

// UI Helpers
function updateUI() {
    document.getElementById('player-gold').textContent = formatNumber(Math.floor(gameState.gold));
    document.getElementById('total-dps').textContent = formatNumber(Math.floor(gameState.totalDps));
    document.getElementById('click-damage').textContent = formatNumber(Math.floor(gameState.clickDamage));

    document.getElementById('current-zone').textContent = gameState.currentZone;
    document.getElementById('monsters-killed').textContent = gameState.monstersKilledInZone;

    document.getElementById('stat-killed').textContent = formatNumber(gameState.statistics.totalKills);
    document.getElementById('stat-clicks').textContent = formatNumber(gameState.statistics.totalClicks);
    document.getElementById('stat-max-zone').textContent = gameState.statistics.maxZone;
}

function updateMonsterUI() {
    const pct = (gameState.currentMonster.hp / gameState.currentMonster.maxHp) * 100;
    document.getElementById('hp-fill').style.width = `${pct}%`;
    document.getElementById('current-hp').textContent = formatNumber(Math.ceil(gameState.currentMonster.hp));
}

function createDamageNumber(amount, isCrit) {
    const container = document.getElementById('damage-numbers-container');
    const el = document.createElement('div');
    el.className = 'damage-number';
    if (isCrit && Math.random() < 0.05) { // 5% chance crit visual
        el.classList.add('damage-crit');
        amount *= 2; // Cr√≠tico visual simples
    }
    el.textContent = formatNumber(Math.floor(amount));

    // Posi√ß√£o aleat√≥ria perto do centro
    const x = 50 + (Math.random() * 20 - 10);
    const y = 50 + (Math.random() * 20 - 10);

    el.style.left = `${x}%`;
    el.style.top = `${y}%`;

    container.appendChild(el);

    setTimeout(() => el.remove(), 1000);
}

function animateMonsterShake() {
    const visual = document.querySelector('.monster-visual');
    visual.classList.remove('shake');
    void visual.offsetWidth; // Trigger reflow
    visual.classList.add('shake');
}

function logMessage(msg) {
    const log = document.getElementById('battle-log');
    const p = document.createElement('p');
    p.textContent = msg;
    log.prepend(p);
    if (log.children.length > 20) log.lastChild.remove();
}

function formatNumber(num) {
    if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';
    if (num >= 1000) return (num / 1000).toFixed(1) + 'k';
    return Math.floor(num).toString();
}

// Persistence
function saveGame() {
    const saveObj = {
        gold: gameState.gold,
        currentZone: gameState.currentZone,
        savedHeroes: gameState.heroes.map(h => ({ id: h.id, level: h.level })),
        statistics: gameState.statistics
    };
    localStorage.setItem('narutoClickerSave', JSON.stringify(saveObj));
    // console.log("Jogo Salvo");
}

function loadGame() {
    const saveStr = localStorage.getItem('narutoClickerSave');
    if (saveStr) {
        try {
            const saved = JSON.parse(saveStr);
            gameState.gold = saved.gold || 0;
            gameState.currentZone = saved.currentZone || 1;
            gameState.savedHeroes = saved.savedHeroes || [];
            gameState.statistics = { ...gameState.statistics, ...saved.statistics };
            logMessage("Progresso carregado!");
        } catch (e) {
            console.error("Erro ao carregar save", e);
        }
    }
}

// Start
window.onload = initGame;


----- FILE: static/js/game_data.js  (sha1:ee8ff0e04b9f, bytes:4368) -----
const heroesData = [
    { id: 1, name: "Iruka Umino", baseCost: 10, baseDps: 1, img: "iruka.png" },
    { id: 2, name: "Mizuki", baseCost: 100, baseDps: 5, img: "mizuki.png" },
    { id: 3, name: "Konohamaru Sarutobi", baseCost: 500, baseDps: 12, img: "konohamaru.png" },
    { id: 4, name: "Ebisu", baseCost: 1000, baseDps: 25, img: "ebisu.png" },
    { id: 5, name: "Tenten", baseCost: 2500, baseDps: 50, img: "tenten.png" },
    { id: 6, name: "Ino Yamanaka", baseCost: 5000, baseDps: 80, img: "ino.png" },
    { id: 7, name: "Kiba Inuzuka", baseCost: 12000, baseDps: 150, img: "kiba.png" },
    { id: 8, name: "Shino Aburame", baseCost: 25000, baseDps: 300, img: "shino.png" },
    { id: 9, name: "Hinata Hyuga (Genin)", baseCost: 60000, baseDps: 550, img: "hinata_genin.png" },
    { id: 10, name: "Choji Akimichi", baseCost: 150000, baseDps: 1000, img: "choji.png" },
    { id: 11, name: "Shikamaru Nara", baseCost: 400000, baseDps: 2200, img: "shikamaru.png" },
    { id: 12, name: "Sakura Haruno (Genin)", baseCost: 1000000, baseDps: 4500, img: "sakura_genin.png" },
    { id: 13, name: "Sasuke Uchiha (Genin)", baseCost: 2500000, baseDps: 9000, img: "sasuke_genin.png" },
    { id: 14, name: "Naruto Uzumaki (Genin)", baseCost: 6000000, baseDps: 18000, img: "naruto_genin.png" },
    { id: 15, name: "Haku", baseCost: 15000000, baseDps: 40000, img: "haku.png" },
    { id: 16, name: "Zabuza Momochi", baseCost: 40000000, baseDps: 90000, img: "zabuza.png" },
    { id: 17, name: "Rock Lee (Port√µes)", baseCost: 100000000, baseDps: 200000, img: "rocklee.png" },
    { id: 18, name: "Neji Hyuga", baseCost: 300000000, baseDps: 500000, img: "neji.png" },
    { id: 19, name: "Gaara do Deserto", baseCost: 800000000, baseDps: 1200000, img: "gaara.png" },
    { id: 20, name: "Kabuto Yakushi", baseCost: 2000000000, baseDps: 3000000, img: "kabuto.png" },
    { id: 21, name: "Kimimaro", baseCost: 5000000000, baseDps: 7000000, img: "kimimaro.png" },
    { id: 22, name: "Yamato", baseCost: 12000000000, baseDps: 15000000, img: "yamato.png" },
    { id: 23, name: "Sai", baseCost: 30000000000, baseDps: 35000000, img: "sai.png" },
    { id: 24, name: "Asuma Sarutobi", baseCost: 80000000000, baseDps: 85000000, img: "asuma.png" },
    { id: 25, name: "Kakashi Hatake", baseCost: 200000000000, baseDps: 200000000, img: "kakashi.png" },
    { id: 26, name: "Might Guy (7 Port√µes)", baseCost: 500000000000, baseDps: 500000000, img: "guy.png" },
    { id: 27, name: "Kisame Hoshigaki", baseCost: 1500000000000, baseDps: 1200000000, img: "kisame.png" },
    { id: 28, name: "Deidara", baseCost: 4000000000000, baseDps: 3000000000, img: "deidara.png" },
    { id: 29, name: "Sasori", baseCost: 10000000000000, baseDps: 7000000000, img: "sasori.png" },
    { id: 30, name: "Kakuzu", baseCost: 25000000000000, baseDps: 15000000000, img: "kakuzu.png" },
    { id: 31, name: "Hidan", baseCost: 70000000000000, baseDps: 40000000000, img: "hidan.png" },
    { id: 32, name: "Itachi Uchiha", baseCost: 200000000000000, baseDps: 100000000000, img: "itachi.png" },
    { id: 33, name: "Jiraiya", baseCost: 600000000000000, baseDps: 300000000000, img: "jiraiya.png" },
    { id: 34, name: "Orochimaru", baseCost: 2000000000000000, baseDps: 800000000000, img: "orochimaru.png" },
    { id: 35, name: "Tsunade Senju", baseCost: 7000000000000000, baseDps: 2500000000000, img: "tsunade.png" },
    { id: 36, name: "Pain (Nagato)", baseCost: 25000000000000000, baseDps: 8000000000000, img: "pain.png" },
    { id: 37, name: "Minato Namikaze", baseCost: 100000000000000000, baseDps: 30000000000000, img: "minato.png" },
    { id: 38, name: "Hashirama Senju", baseCost: 500000000000000000, baseDps: 150000000000000, img: "hashirama.png" },
    { id: 39, name: "Madara Uchiha (Rikudou)", baseCost: 2000000000000000000, baseDps: 800000000000000, img: "madara.png" },
    { id: 40, name: "Naruto (Modo Baryon)", baseCost: 10000000000000000000, baseDps: 5000000000000000, img: "naruto_baryon.png" }
];

const zoneData = {
    baseHp: 10,
    hpMultiplier: 1.55, // HP cresce 55% por level
    coinsMultiplier: 1.5,
    monstersPerZone: 10
};

const monsterNames = [
    "Bandido", "Ninja Renegado", "Zetsu Branco", "Clone das Sombras", "Marionete", 
    "Cobra Gigante", "Sapo Gigante", "Lesma Gigante", "Corvo", "Guerreiro Susanoo"
];


----- FILE: static/js/game_data_v3.js  (sha1:34fd2b215b2a, bytes:10771) -----
const heroesData = [
    { id: 1, name: "Naruto Uzumaki", baseCost: 10, baseDps: 1, img: "./static/img/heroes/icons/naruto_icon.png", focus: "center center", element: "wind" },
    { id: 2, name: "Sasuke Uchiha", baseCost: 100, baseDps: 5, img: "./static/img/heroes/icons/sasuke_icon.png", focus: "center center", element: "fire" },
    { id: 3, name: "Sakura Haruno", baseCost: 500, baseDps: 12, img: "./static/img/heroes/icons/sakura_icon.png", focus: "center center", element: "water" },
    { id: 4, name: "Kiba Inuzuka", baseCost: 1000, baseDps: 25, img: "./static/img/heroes/icons/kiba_icon.png", element: "wind" },
    { id: 5, name: "Shino Aburame", baseCost: 2500, baseDps: 50, img: "./static/img/heroes/icons/shino_icon.png", element: "water" },
    { id: 6, name: "Hinata Hyuga", baseCost: 5000, baseDps: 80, img: "./static/img/heroes/icons/hinata_icon.png", element: "water" },
    { id: 7, name: "Shikamaru Nara", baseCost: 12000, baseDps: 150, img: "./static/img/heroes/icons/shikamaru_icon.png", element: "earth" },
    { id: 8, name: "Choji Akimichi", baseCost: 25000, baseDps: 300, img: "./static/img/heroes/icons/choji_icon.png", element: "fire" },
    { id: 9, name: "Ino Yamanaka", baseCost: 60000, baseDps: 550, img: "./static/img/heroes/icons/ino_icon.png", element: "fire" },
    { id: 10, name: "Rock Lee", baseCost: 150000, baseDps: 1000, img: "./static/img/heroes/icons/lee_icon.png", element: null },
    { id: 11, name: "Tenten", baseCost: 400000, baseDps: 2200, img: "./static/img/heroes/icons/tenten_icon.png", element: "lightning" },
    { id: 12, name: "Neji", baseCost: 1000000, baseDps: 4500, img: "./static/img/heroes/icons/neji_icon.png", element: "lightning" },
    { id: 13, name: "Gaara", baseCost: 2500000, baseDps: 9000, img: "./static/img/heroes/icons/gaara_icon.png", element: "earth" },
    { id: 14, name: "Temari", baseCost: 6000000, baseDps: 18000, img: "./static/img/heroes/icons/temari_icon.png", element: "wind" },
    { id: 15, name: "Kankuro", baseCost: 15000000, baseDps: 40000, img: "./static/img/heroes/icons/kankuro_icon.png", element: "earth" },
    { id: 16, name: "Iruka Umino", baseCost: 40000000, baseDps: 90000, img: "https://placehold.co/100x100/4a3b2a/ffffff?text=Iruka" },
    { id: 17, name: "Mizuki", baseCost: 100000000, baseDps: 200000, img: "https://placehold.co/100x100/555555/ffffff?text=Mizuki" },
    { id: 18, name: "Konohamaru", baseCost: 300000000, baseDps: 500000, img: "https://placehold.co/100x100/ffd700/000000?text=Konohamaru" },
    { id: 19, name: "Haku", baseCost: 800000000, baseDps: 1200000, img: "https://placehold.co/100x100/add8e6/000000?text=Haku" },
    { id: 20, name: "Zabuza", baseCost: 2000000000, baseDps: 3000000, img: "https://placehold.co/100x100/2f4f4f/ffffff?text=Zabuza" },
    { id: 21, name: "Kabuto", baseCost: 5000000000, baseDps: 7000000, img: "https://placehold.co/100x100/4b0082/ffffff?text=Kabuto" },
    { id: 22, name: "Kimimaro", baseCost: 12000000000, baseDps: 15000000, img: "https://placehold.co/100x100/f5f5f5/000000?text=Kimimaro" },
    { id: 23, name: "Itachi", baseCost: 30000000000, baseDps: 35000000, img: "https://placehold.co/100x100/000000/ff0000?text=Itachi" },
    { id: 24, name: "Kisame", baseCost: 80000000000, baseDps: 85000000, img: "https://placehold.co/100x100/000080/ffffff?text=Kisame" },
    { id: 25, name: "Jiraiya", baseCost: 200000000000, baseDps: 200000000, img: "https://placehold.co/100x100/8b4513/ffffff?text=Jiraiya" },
    { id: 26, name: "Tsunade", baseCost: 500000000000, baseDps: 500000000, img: "https://placehold.co/100x100/98fb98/000000?text=Tsunade" },
    { id: 27, name: "Orochimaru", baseCost: 1500000000000, baseDps: 1200000000, img: "https://placehold.co/100x100/483d8b/ffffff?text=Orochimaru" },
    { id: 28, name: "Kakashi", baseCost: 4000000000000, baseDps: 3000000000, img: "https://placehold.co/100x100/778899/ffffff?text=Kakashi" },
    { id: 29, name: "Guy", baseCost: 10000000000000, baseDps: 7000000000, img: "https://placehold.co/100x100/006400/ffffff?text=Might+Guy" },
    { id: 30, name: "Asuma", baseCost: 25000000000000, baseDps: 15000000000, img: "https://placehold.co/100x100/2f4f4f/ffffff?text=Asuma" },
    { id: 31, name: "Yamato", baseCost: 70000000000000, baseDps: 40000000000, img: "https://placehold.co/100x100/8b4513/ffffff?text=Yamato" },
    { id: 32, name: "Sai", baseCost: 200000000000000, baseDps: 100000000000, img: "https://placehold.co/100x100/000000/ffffff?text=Sai" },
    { id: 33, name: "Deidara", baseCost: 600000000000000, baseDps: 300000000000, img: "https://placehold.co/100x100/ffd700/000000?text=Deidara" },
    { id: 34, name: "Sasori", baseCost: 2000000000000000, baseDps: 800000000000, img: "https://placehold.co/100x100/8b0000/ffffff?text=Sasori" },
    { id: 35, name: "Hidan", baseCost: 7000000000000000, baseDps: 2500000000000, img: "https://placehold.co/100x100/dc143c/ffffff?text=Hidan" },
    { id: 36, name: "Kakuzu", baseCost: 25000000000000000, baseDps: 8000000000000, img: "https://placehold.co/100x100/2f4f4f/ffffff?text=Kakuzu" },
    { id: 37, name: "Pain", baseCost: 100000000000000000, baseDps: 30000000000000, img: "https://placehold.co/100x100/ff4500/ffffff?text=Pain" },
    { id: 38, name: "Konan", baseCost: 500000000000000000, baseDps: 150000000000000, img: "https://placehold.co/100x100/4169e1/ffffff?text=Konan" },
    { id: 39, name: "Obito", baseCost: 2000000000000000000, baseDps: 800000000000000, img: "https://placehold.co/100x100/4b0082/ffffff?text=Obito" },
    { id: 40, name: "Madara", baseCost: 10000000000000000000, baseDps: 5000000000000000, img: "https://placehold.co/100x100/800000/ffffff?text=Madara" }
];

// Defini√ß√£o Manual de Skills para os Principais (Fiel ao Anime)
const specificUpgrades = {
    1: [ // Naruto
        { id: "h1_u1", reqLevel: 20, type: "SELF_DPS_MULT", value: 2, costMultiplier: 10, icon: "./static/img/skills/skill_1_1.png", name: "Kage Bunshin no Jutsu", desc: "Dano de Clique x2" },
        { id: "h1_u2", reqLevel: 40, type: "CLICK_MULT_PLUS_SELF_DPS", value: 2, selfDpsBonus: 1.2, costMultiplier: 50, icon: "./static/img/skills/skill_1_2.png", name: "Tajuu Kage Bunshin", desc: "Clique x2 (stack) + DPS pr√≥prio +20%" },
        { id: "h1_u3", reqLevel: 60, type: "GLOBAL_DPS_MULT", value: 1.1, costMultiplier: 200, icon: "./static/img/skills/skill_1_3.png", name: "Rasengan", desc: "DPS de Todos +10%" },
        { id: "h1_u4", reqLevel: 80, type: "CRIT_CHANCE", value: 0.01, costMultiplier: 1000, icon: "./static/img/skills/skill_1_4.png", name: "Chakra da Kyuubi", desc: "Chance Cr√≠tica +1%" }
    ],
    2: [ // Sasuke
        { id: "h2_u1", reqLevel: 20, type: "SELF_DPS_MULT", value: 2, costMultiplier: 10, icon: "./static/img/skills/skill_3_1.png", name: "Sharingan", desc: "DPS do Sasuke x2" },
        { id: "h2_u2", reqLevel: 40, type: "SELF_DPS_MULT", value: 2, costMultiplier: 50, icon: "./static/img/skills/skill_3_2.png", name: "Chidori", desc: "DPS do Sasuke x2" },
        { id: "h2_u3", reqLevel: 60, type: "GLOBAL_DPS_MULT", value: 1.1, costMultiplier: 200, icon: "./static/img/skills/skill_3_3.png", name: "Katon: Goukakyuu no Jutsu", desc: "DPS de Todos +10%" },
        { id: "h2_u4", reqLevel: 80, type: "CRIT_CHANCE", value: 0.01, costMultiplier: 1000, icon: "./static/img/skills/skill_3_4.png", name: "Shurikenjutsu Uchiha", desc: "Chance Cr√≠tica +1%" }
    ],
    3: [ // Sakura
        { id: "h3_u1", reqLevel: 20, type: "SELF_DPS_MULT", value: 2, costMultiplier: 10, icon: "./static/img/skills/skill_2_1.png", name: "Controle Preciso de Chakra", desc: "DPS da Sakura x2" },
        { id: "h3_u2", reqLevel: 40, type: "GLOBAL_DPS_MULT", value: 1.1, costMultiplier: 50, icon: "./static/img/skills/skill_2_2.png", name: "Golpe de F√¥r√ßa Concentrada", desc: "DPS de Todos +10%" },
        { id: "h3_u3", reqLevel: 60, type: "SELF_DPS_MULT", value: 2, costMultiplier: 200, icon: "./static/img/skills/skill_2_3.png", name: "An√°lise de Combate", desc: "DPS da Sakura x2" },
        { id: "h3_u4", reqLevel: 80, type: "GLOBAL_DPS_MULT", value: 1.2, costMultiplier: 1000, icon: "./static/img/skills/skill_2_4.png", name: "Resist√™ncia Mental", desc: "DPS de Todos +20%" }
    ]
};

const heroUpgrades = {}; // Map heroId -> Array of upgrades

heroesData.forEach(hero => {
    if (specificUpgrades[hero.id]) {
        heroUpgrades[hero.id] = specificUpgrades[hero.id].map(u => ({ ...u, heroId: hero.id }));
    } else {
        // Gerador Gen√©rico Tem√°tico
        heroUpgrades[hero.id] = [
            {
                id: `h${hero.id}_u1`,
                heroId: hero.id,
                reqLevel: 20,
                type: "SELF_DPS_MULT",
                value: 2,
                costMultiplier: 10,
                icon: "üó°Ô∏è",
                name: `T√©cnica Secreta I`,
                desc: "Dano deste her√≥i x2"
            },
            {
                id: `h${hero.id}_u2`,
                heroId: hero.id,
                reqLevel: 40,
                type: "GLOBAL_DPS_MULT",
                value: 1.1,
                costMultiplier: 50,
                icon: "üìú",
                name: "Estrat√©gia Ninja",
                desc: "DPS de todos +10%"
            },
            {
                id: `h${hero.id}_u3`,
                heroId: hero.id,
                reqLevel: 60,
                type: "SELF_DPS_MULT",
                value: 2,
                costMultiplier: 200,
                icon: "‚ú®",
                name: `T√©cnica Secreta II`,
                desc: "Dano deste her√≥i x2"
            },
            {
                id: `h${hero.id}_u4`,
                heroId: hero.id,
                reqLevel: 80,
                type: "GLOBAL_DPS_MULT",
                value: 1.2, // Buff global gen√©rico forte
                costMultiplier: 1000,
                icon: "üõ°Ô∏è",
                name: "Poder Oculto",
                desc: "DPS de todos +20%"
            }
        ];
    }
});

const zoneData = {
    baseHp: 10,
    hpMultiplier: 2.05,
    coinsMultiplier: 1.5,
    monstersPerZone: 10
};

// Cada sprite tem seu pr√≥prio nome √∫nico
const enemyData = [
    { name: "Akira", img: "./static/img/enemies/enemy_main.png" },
    { name: "Kenji", img: "./static/img/enemies/enemy_v4.png" },
    { name: "Ryu", img: "./static/img/enemies/enemy_v5.png" },
    { name: "Takeshi", img: "./static/img/enemies/enemy_v6.png" }
];

// Manter compatibilidade com c√≥digo antigo
const monsterNames = enemyData.map(e => e.name);
const monsterImages = enemyData.map(e => e.img);

// Imagem do Boss (aparece a cada 5 fases)
const bossImage = "./static/img/enemies/boss.png";


----- FILE: static/js/game_v3.js  (sha1:c9e93f5140da, bytes:58175) -----
console.log('üéÆ Game v3.js carregado - VERS√ÉO 5 - Boss Timer');
// Estado Global do Jogo
const gameState = {
    gold: 0,
    totalDps: 0,
    clickDamage: 1,
    critChance: 0, // Inicia em 0%
    clickCritMultiplier: 2,
    currentZone: 1,
    monstersKilledInZone: 0,
    heroes: [],
    upgrades: [], // IDs dos upgrades comprados
    currentMonster: {
        hp: 10,
        maxHp: 10,
        name: "Bandido",
        img: ""
    },
    statistics: {
        totalClicks: 0,
        totalKills: 0,
        maxZone: 1
    },
    lastEnemyIndex: -1, // Para evitar repeti√ß√£o consecutiva
    inventory: [], // Mochila de itens
    bossTimer: 30, // Cron√¥metro de boss (30 segundos)
    bossTimerInterval: null, // Refer√™ncia ao intervalo do cron√¥metro
    currentEnemyName: "", // Nome do inimigo atual para sistema de drop
    diamonds: 0, // Contador de diamantes
    missions: {
        naruto_skill1: {
            id: "naruto_skill1",
            purchased: false,
            completed: false,
            progress: 0,
            target: 150,
            cost: 5
        },
        naruto_skill2: {
            id: "naruto_skill2",
            purchased: false,
            completed: false,
            progress: 0,
            target: 30,
            cost: 15
        }
    }
};

// Configura√ß√µes
const TICKS_PER_SECOND = 10;
let autoSaveInterval;

// Inicializa√ß√£o
function initGame() {
    loadGame();
    setupHeroes();
    spawnMonster();
    renderArenas();
    updateUI();
    startGameLoop();
    setupEventListeners();

    // Auto-save a cada 30s
    autoSaveInterval = setInterval(saveGame, 30000);
}

// Configura lista de her√≥is baseada no game_data.js
function setupHeroes() {
    gameState.heroes = heroesData.map(heroData => {
        const savedHero = gameState.savedHeroes ? gameState.savedHeroes.find(h => h.id === heroData.id) : null;
        return {
            ...heroData,
            level: savedHero ? savedHero.level : 0,
            currentCost: savedHero ? calculateCost(heroData.baseCost, savedHero.level) : heroData.baseCost,
            currentDps: savedHero ? heroData.baseDps * savedHero.level : 0
        };
    });
    recalculateTotalDps();
    renderHeroesList();
}

function calculateCost(baseCost, currentLevel) {
    return Math.floor(baseCost * Math.pow(1.07, currentLevel));
}

function recalculateTotalDps() {
    let dps = 0;
    let clickCtx = 1;
    let globalMulti = 1;
    let critChanceAcc = 0;
    let clickMultiplier = 1; // Novo: multiplicador de clique separado

    // Processar Global Upgrades & Crit
    gameState.upgrades.forEach(uId => {
        // Encontrar info do upgrade
        for (const hid in heroUpgrades) {
            const upg = heroUpgrades[hid].find(u => u.id === uId);
            if (upg) {
                if (upg.type === 'GLOBAL_DPS_MULT') globalMulti *= upg.value;
                if (upg.type === 'CRIT_CHANCE') critChanceAcc += upg.value;
                // Novo: processar multiplicador de clique
                if (upg.type === 'CLICK_MULT_PLUS_SELF_DPS') {
                    clickMultiplier *= upg.value;
                }
            }
        }
    });

    // B√¥nus progressivo do Naruto: +1% DPS global a cada 10 n√≠veis
    const naruto = gameState.heroes.find(h => h.id === 1);
    if (naruto && gameState.upgrades.includes('h1_u2')) {
        const narutoLevelBonus = Math.floor(naruto.level / 10) * 0.01;
        globalMulti *= (1 + narutoLevelBonus);
    }

    gameState.critChance = critChanceAcc;

    // Calcular DPS Individual com Multiplicadores Self
    gameState.heroes.forEach(hero => {
        let heroDps = hero.baseDps * hero.level;

        // Self Multipliers
        const heroUps = heroUpgrades[hero.id];
        if (heroUps) {
            heroUps.forEach(upg => {
                if (gameState.upgrades.includes(upg.id)) {
                    if (upg.type === 'SELF_DPS_MULT') {
                        heroDps *= upg.value;
                    }
                    // Novo: aplicar b√¥nus de DPS pr√≥prio da skill 2
                    if (upg.type === 'CLICK_MULT_PLUS_SELF_DPS' && hero.id === 1) {
                        heroDps *= upg.selfDpsBonus;
                    }
                }
            });
        }

        hero.currentDps = heroDps;

        if (hero.id === 1) {
            clickCtx += hero.currentDps;
        } else {
            dps += hero.currentDps;
        }
    });

    gameState.totalDps = dps * globalMulti;
    gameState.clickDamage = (clickCtx * globalMulti) * clickMultiplier; // Aplicar multiplicador de clique
}

// Renderiza√ß√£o da Lista de Her√≥is (Split Layout: Left Name/Img, Right Info)
function renderHeroesList() {
    const listContainer = document.getElementById('heroes-list');
    listContainer.innerHTML = '';

    for (let i = 0; i < gameState.heroes.length; i++) {
        const hero = gameState.heroes[i];
        let status = 'hidden';

        if (i === 0) status = 'revealed';
        else {
            const prevHero = gameState.heroes[i - 1];
            if (prevHero.level > 0) status = 'revealed';
            else {
                if (i === 1) status = 'mystery';
                else {
                    const prevPrevHero = gameState.heroes[i - 2];
                    if (prevPrevHero && prevPrevHero.level > 0) status = 'mystery';
                }
            }
        }

        if (status === 'hidden') break;

        const item = document.createElement('div');
        item.className = 'hero-card-split'; // Usando nova classe de layout
        if (status === 'mystery') item.classList.add('mystery-hero');
        item.id = `hero-${hero.id}`;

        const isLocked = status === 'mystery';

        let displayName = isLocked ? "???" : hero.name;
        // Se estiver bloqueado mostra placeholder, se n√£o mostra a imagem definida (agora full body pro naruto)
        let displayImg = isLocked ? "https://placehold.co/100x100/000000/ffffff?text=?" : hero.img;
        let displayCost = formatNumber(hero.currentCost);
        let dpsVal = hero.currentDps;

        // HTML Structure

        // --- NAME OUTSIDE (Side-by-Side) ---
        // Se estiver bloqueado mostra ???
        // Se disponivel, mostra Nome + Sobrenome (ou apenas nome completo estilizado)
        // O usuario pediu "nome e sobrenome um ao lado do outro".
        // displayName j√° √© "Naruto Uzumaki".

        let elementImg = "";
        if (!isLocked && hero.element) {
            elementImg = `<img src="./static/img/elements/${hero.element}.png" class="hero-element-icon" title="Elemento: ${hero.element}">`;
        }

        let nameTitleHTML = `
            <div class="hero-title-header">
                ${displayName} ${elementImg}
            </div>
        `;

        // --- COLUNA ESQUERDA: APENAS IMAGEM ---
        // Remover nome daqui de dentro
        // Aplicando foco din√¢mico (inteligente) se definido, sen√£o padr√£o topo
        let focusStyle = hero.focus ? `style="object-position: ${hero.focus}"` : '';

        let leftColHTML = `
            <div class="card-left-col">
                <div class="hero-image-wrapper">
                    <img src="${displayImg}" class="hero-full-body-img" alt="${displayName}" ${focusStyle}>
                </div>
            </div>
        `;

        // --- COLUNA DIREITA: NIVEL -> STATUS -> SKILLS -> BOTAO ---

        // 1. N√≠vel
        let levelHTML = isLocked ? `<div class="hero-level-display">???</div>` : `<div class="hero-level-display" id="hero-level-text-${hero.id}">N√≠vel ${hero.level}</div>`;

        // 2. Status (Dano/DPS) agora vai para o OVERLAY
        let statsHTML = "";
        if (isLocked) {
            statsHTML = `<div class="hero-stats-text">???</div>`;
        } else {
            // Calcular o incremento de DPS do pr√≥ximo n√≠vel
            const nextLevelDps = hero.baseDps * Math.pow(1.07, hero.level + 1);
            const dpsIncrement = Math.abs(nextLevelDps - dpsVal);

            if (hero.id === 1) {
                statsHTML = `<div class="stat-line"><strong>Dano de Clique:</strong> <span id="hero-stat-val-${hero.id}">${formatNumber(dpsVal)}</span> <span class="dps-increment">+${formatNumber(dpsIncrement)}</span></div>`;
            } else {
                statsHTML = `<div class="stat-line"><strong>Dano por Segundo:</strong> <span id="hero-stat-val-${hero.id}">${formatNumber(dpsVal)}</span> <span class="dps-increment">+${formatNumber(dpsIncrement)}</span></div>`;
            }
        }

        // 4. Bot√£o de Compra
        let buyButtonHTML = "";
        if (!isLocked) {
            buyButtonHTML = `
                <div class="hero-buy-btn" onclick="buyHero(${hero.id})">
                    <span class="buy-label">UPGRADE</span>
                    <span class="buy-value">üí∞ <span id="hero-cost-text-${hero.id}">${displayCost}</span></span>
                </div>
            `;
        } else {
            buyButtonHTML = `
                <div class="hero-buy-btn locked">
                    <span>BLOQUEADO</span>
                </div>
            `;
        }

        // 3. Skills (NOW BELOW UPGRADE)
        let skillsHTML = '<div class="hero-skills-row">';
        if (!isLocked) {
            const upgrades = heroUpgrades[hero.id];
            if (upgrades) {
                upgrades.forEach(upg => {
                    const isBought = gameState.upgrades.includes(upg.id);

                    // L√≥gica especial para Kage Bunshin (h1_u1) - Sistema de Miss√£o
                    let isUnlocked;
                    let tooltipExtra = '';
                    let clickHandler = `buyUpgrade('${upg.id}', ${hero.baseCost * upg.costMultiplier}, ${hero.id})`;

                    if (upg.id === 'h1_u1') {
                        const mission = gameState.missions.naruto_skill1;
                        isUnlocked = mission.completed;

                        if (!mission.purchased && !mission.completed) {
                            // Miss√£o n√£o comprada - mostrar custo em diamantes
                            clickHandler = `openMissionModal('naruto_skill1')`;
                            tooltipExtra = `<br><br><div style="background: rgba(0,100,200,0.2); padding: 8px; border-radius: 5px; margin-top: 5px;">
                                <strong>üéØ Miss√£o: "Treino dos Clones na Floresta"</strong><br>
                                <span style="color: #00d4ff;">üíé Custo: ${mission.cost} Diamantes</span><br><br>
                                <strong>üìã Objetivo:</strong><br>
                                Derrotar 150 inimigos normais<br>
                                nas fases 1-10 usando apenas clique<br><br>
                                <strong>üí• B√¥nus Elemental (Vento):</strong><br>
                                +15% de dano adicional
                            </div>`;
                        } else if (mission.purchased && !mission.completed) {
                            // Miss√£o comprada mas n√£o completada - mostrar progresso
                            clickHandler = ``;
                            const progressPercent = Math.floor((mission.progress / mission.target) * 100);
                            tooltipExtra = `<br><br><div style="background: rgba(0,150,0,0.2); padding: 8px; border-radius: 5px; margin-top: 5px;">
                                <strong>üéØ Miss√£o em Andamento</strong><br>
                                <div style="background: rgba(0,0,0,0.3); border-radius: 5px; height: 20px; margin: 5px 0; position: relative;">
                                    <div style="background: linear-gradient(90deg, #00ff00, #00aa00); width: ${progressPercent}%; height: 100%; border-radius: 5px;"></div>
                                    <span style="position: absolute; top: 2px; left: 50%; transform: translateX(-50%); font-weight: bold; text-shadow: 1px 1px 2px #000;">
                                        ${mission.progress}/${mission.target}
                                    </span>
                                </div>
                                <small>Derrote inimigos nas fases 1-10 usando apenas clique!</small>
                            </div>`;
                        } else if (mission.completed) {
                            // Miss√£o completada - pode comprar normalmente
                            tooltipExtra = `<br><br><span style="color: #00ff00;">‚úÖ Miss√£o Completada!</span>`;
                        }
                    } else if (upg.id === 'h1_u2') {
                        // L√≥gica especial para Tajuu Kage Bunshin (h1_u2) - Sistema de Miss√£o
                        const mission = gameState.missions.naruto_skill2;
                        isUnlocked = mission.completed;

                        if (!mission.purchased && !mission.completed) {
                            // Miss√£o n√£o comprada - mostrar custo em diamantes
                            clickHandler = `openMissionModal('naruto_skill2')`;
                            tooltipExtra = `<br><br><div style="background: rgba(0,100,200,0.2); padding: 8px; border-radius: 5px; margin-top: 5px;">
                                <strong>üéØ Miss√£o: "Ex√©rcito de Clones"</strong><br>
                                <span style="color: #00d4ff;">üíé Custo: ${mission.cost} Diamantes</span><br><br>
                                <strong>üìã Objetivo:</strong><br>
                                Coletar 30 Pergaminhos Rasgados de Clone<br>
                                (Drop 8% nas fases 20-40)<br><br>
                                <strong>üí• Efeito:</strong><br>
                                Clique x2 (stack com Skill 1 = x4 total)<br>
                                DPS do Naruto +20%<br>
                                +1% DPS global a cada 10 n√≠veis do Naruto
                            </div>`;
                        } else if (mission.purchased && !mission.completed) {
                            // Miss√£o comprada mas n√£o completada - mostrar progresso
                            clickHandler = ``;
                            const progressPercent = Math.floor((mission.progress / mission.target) * 100);
                            tooltipExtra = `<br><br><div style="background: rgba(0,150,0,0.2); padding: 8px; border-radius: 5px; margin-top: 5px;">
                                <strong>üéØ Miss√£o em Andamento</strong><br>
                                <div style="background: rgba(0,0,0,0.3); border-radius: 5px; height: 20px; margin: 5px 0; position: relative;">
                                    <div style="background: linear-gradient(90deg, #00ff00, #00aa00); width: ${progressPercent}%; height: 100%; border-radius: 5px;"></div>
                                    <span style="position: absolute; top: 2px; left: 50%; transform: translateX(-50%); font-weight: bold; text-shadow: 1px 1px 2px #000;">
                                        ${mission.progress}/${mission.target}
                                    </span>
                                </div>
                                <small>Colete Pergaminhos Rasgados de Clone nas fases 20-40!</small>
                            </div>`;
                        } else if (mission.completed) {
                            // Miss√£o completada - pode comprar normalmente
                            tooltipExtra = `<br><br><span style="color: #00ff00;">‚úÖ Miss√£o Completada!</span>`;
                        }
                    } else {
                        isUnlocked = hero.level >= upg.reqLevel;
                    }

                    let upgClass = 'skill-box';
                    if (isBought) upgClass += ' bought';
                    else if (isUnlocked) upgClass += ' available';
                    else {
                        upgClass += ' locked';
                        // Se for a skill 1 ou 2 do Naruto e tiver diamantes suficientes, adicionar classe affordable
                        if (upg.id === 'h1_u1') {
                            const mission = gameState.missions.naruto_skill1;
                            if (!mission.purchased && !mission.completed && gameState.diamonds >= mission.cost) {
                                upgClass += ' affordable';
                            }
                        } else if (upg.id === 'h1_u2') {
                            const mission = gameState.missions.naruto_skill2;
                            if (!mission.purchased && !mission.completed && gameState.diamonds >= mission.cost) {
                                upgClass += ' affordable';
                            }
                        }
                    }

                    const upgCost = hero.baseCost * upg.costMultiplier;

                    // Handle Image Icons
                    const isImageIcon = upg.icon.startsWith('./') || upg.icon.startsWith('http');
                    const iconContent = isImageIcon ? `<img src="${upg.icon}" class="skill-img-icon">` : upg.icon;

                    skillsHTML += `
                        <div class="${upgClass}" 
                             id="upg-${upg.id}"
                             onclick="${clickHandler}">
                             <div class="skill-icon">${iconContent}</div>
                             ${isBought ? '<div class="skill-check">‚úî</div>' : ''}
                             <div class="tooltip">
                                <strong>${upg.name}</strong><br>
                                ${upg.desc}<br>
                                ${isUnlocked && !isBought ? 'Custo: ' + formatNumber(upgCost) : ''}${tooltipExtra}
                             </div>
                        </div>
                    `;
                });
            }
        }
        skillsHTML += '</div>';

        let rightColHTML = `
            <div class="card-right-col">
                ${levelHTML}
                ${skillsHTML}
                ${buyButtonHTML}
            </div>
        `;

        let overlayHTML = `
            <div class="hero-stats-overlay">
                ${statsHTML}
            </div>
        `;

        item.innerHTML = nameTitleHTML + `
            <div class="hero-card-inner-split">
                ${leftColHTML}
                ${rightColHTML}
                ${overlayHTML}
            </div>
        `;

        if (isLocked) {
            item.classList.add('locked-mystery');
        }

        listContainer.appendChild(item);
    }
}

function updateHeroUI(heroId) {
    const hero = gameState.heroes.find(h => h.id === heroId);
    if (!hero) return;

    // Atualizar N√≠vel
    const levelEl = document.getElementById(`hero-level-text-${hero.id}`);
    if (levelEl) levelEl.textContent = `N√≠vel ${hero.level}`;

    // Atualizar Custo
    const costEl = document.getElementById(`hero-cost-text-${hero.id}`);
    if (costEl) costEl.textContent = formatNumber(hero.currentCost);

    // Atualizar Valor de Dano no Overlay
    const statEl = document.getElementById(`hero-stat-val-${hero.id}`);
    if (statEl) statEl.textContent = formatNumber(hero.currentDps);

    // Verificar se desbloqueou algum slot de upgrade (20, 40, 60, 80)
    // Se sim, precisamos re-renderizar para mostrar o quadradinho
    const upgradeThresholds = [20, 40, 60, 80];
    if (upgradeThresholds.includes(hero.level)) {
        renderHeroesList();
    }
}

// Mec√¢nica de Compra de Heroi
function buyHero(heroId) {
    // Note: click event is handled via HTML onclick, arguments passed directly
    const hero = gameState.heroes.find(h => h.id === heroId);

    if (hero && gameState.gold >= hero.currentCost) {
        gameState.gold -= hero.currentCost;
        const oldLevel = hero.level;
        hero.level++;
        hero.currentCost = calculateCost(hero.baseCost, hero.level);
        hero.currentDps = hero.baseDps * hero.level;

        recalculateTotalDps();
        updateUI();

        if (oldLevel === 0) {
            renderHeroesList(); // Desbloqueia pr√≥ximo
        } else {
            updateHeroUI(heroId);
        }
    }
}

// Mec√¢nica de Compra de Upgrade
function buyUpgrade(upgId, cost, heroId) {
    event.stopPropagation(); // Impede borbulhar para compra de heroi
    if (gameState.upgrades.includes(upgId)) return;

    const hero = gameState.heroes.find(h => h.id === heroId);
    if (!hero) return;

    // Verificar requisitos
    const upg = heroUpgrades[heroId].find(u => u.id === upgId);
    if (!upg || hero.level < upg.reqLevel) return;

    if (gameState.gold >= cost) {
        gameState.gold -= cost;
        gameState.upgrades.push(upgId);
        recalculateTotalDps();
        updateUI();
        renderHeroesList();
    }
}

// Arena / Zoning Logic
function changeZone(direction) {
    if (direction === 'next') {
        if (gameState.currentZone < gameState.statistics.maxZone) {
            gameState.currentZone++;
            gameState.monstersKilledInZone = 0;
            spawnMonster();
            renderArenas();
            updateUI();
        }
    } else if (direction === 'prev') {
        if (gameState.currentZone > 1) {
            gameState.currentZone--;
            gameState.monstersKilledInZone = 0;
            spawnMonster();
            renderArenas();
            updateUI();
        }
    }
}

function renderArenas() {
    const container = document.getElementById('arenas-display');
    if (!container) return; // Safety
    container.innerHTML = '';

    let startZone = Math.max(1, gameState.currentZone - 2);
    let endZone = Math.max(gameState.currentZone + 2, gameState.statistics.maxZone + 1);

    if (endZone - startZone < 4) {
        endZone = startZone + 4;
    }

    for (let z = startZone; z <= endZone; z++) {
        if (z > gameState.statistics.maxZone + 1 && z > 1) continue;

        const box = document.createElement('div');
        box.className = 'arena-box';
        box.textContent = z;

        if (z === gameState.currentZone) {
            box.classList.add('active');
        }

        if (z > gameState.statistics.maxZone) {
            box.classList.add('locked');
        } else {
            box.onclick = () => {
                if (z !== gameState.currentZone) {
                    gameState.currentZone = z;
                    gameState.monstersKilledInZone = 0;
                    spawnMonster();
                    renderArenas();
                    updateUI();
                }
            };
        }
        container.appendChild(box);
    }
}


// Spawning de Monstros
function spawnMonster() {
    if (!gameState.currentMonster) return;

    // Verifica se √© uma fase de boss (m√∫ltiplo de 5)
    const isBossZone = gameState.currentZone % 5 === 0;

    // Calcular HP baseado na progress√£o SEM contar fases de boss
    // Fases de boss n√£o contam para a progress√£o
    // Exemplo: Fase 1, 2, 3, 4, 6, 7, 8, 9, 11, 12...
    // A fase 5 (boss) n√£o conta, ent√£o fase 6 = progress√£o 5
    // A fase 10 (boss) n√£o conta, ent√£o fase 11 = progress√£o 9

    let effectiveZone;
    if (isBossZone) {
        // Boss: usar a zona anterior (que n√£o √© boss)
        effectiveZone = gameState.currentZone - 1;
    } else {
        // Inimigo normal: calcular quantas fases de boss j√° passaram
        const bossPhasesPassed = Math.floor((gameState.currentZone - 1) / 5);
        effectiveZone = gameState.currentZone - bossPhasesPassed;
    }

    // Calcular HP do inimigo normal baseado na zona efetiva
    const zoneMultiplier = Math.pow(zoneData.hpMultiplier, effectiveZone - 1);
    const normalEnemyHp = Math.floor(zoneData.baseHp * zoneMultiplier);

    if (isBossZone) {
        // Boss tem multiplicador progressivo baseado na f√≥rmula:
        // BossMultiplier(n) = 8 + (n √ó 0.1)
        // Com limite m√°ximo de 20x
        let bossMultiplier = 8 + (gameState.currentZone * 0.1);
        bossMultiplier = Math.min(bossMultiplier, 20); // Limitar a 20x

        gameState.currentMonster.maxHp = Math.floor(normalEnemyHp * bossMultiplier);
    } else {
        // Inimigo normal
        gameState.currentMonster.maxHp = normalEnemyHp;
    }

    gameState.currentMonster.hp = gameState.currentMonster.maxHp;

    // Para boss, usar nome gen√©rico
    let enemyName = "Boss";
    let enemyIndex = -1;

    const nameEl = document.getElementById('monster-name');
    const levelEl = document.getElementById('monster-level');

    const imgEl = document.getElementById('monster-img');
    if (imgEl) {
        if (isBossZone) {
            // Boss: usa imagem especial
            imgEl.src = bossImage;
            enemyName = "Boss";

            // Iniciar cron√¥metro de boss
            startBossTimer();

            // Esconder contador de monstros e mostrar cron√¥metro
            const monstersKilledEl = document.querySelector('.zone-progress-info');
            if (monstersKilledEl) monstersKilledEl.style.display = 'none';

            const bossTimerEl = document.getElementById('boss-timer');
            if (bossTimerEl) bossTimerEl.style.display = 'block';
        } else {
            // Inimigo normal: l√≥gica para evitar repetir o mesmo monstro em seguida
            let newIdx;
            do {
                newIdx = Math.floor(Math.random() * enemyData.length);
            } while (newIdx === gameState.lastEnemyIndex && enemyData.length > 1);

            gameState.lastEnemyIndex = newIdx;
            enemyIndex = newIdx;
            imgEl.src = enemyData[newIdx].img;
            enemyName = enemyData[newIdx].name;

            // Parar cron√¥metro se estiver rodando
            stopBossTimer();

            // Mostrar contador de monstros e esconder cron√¥metro
            const monstersKilledEl = document.querySelector('.zone-progress-info');
            if (monstersKilledEl) monstersKilledEl.style.display = 'block';

            const bossTimerEl = document.getElementById('boss-timer');
            if (bossTimerEl) bossTimerEl.style.display = 'none';
        }

        // Escalamento: a cada 5 fases aumenta 2% (1.02) para inimigos normais
        // Boss √© sempre 120% do tamanho do inimigo anterior
        let sizeMultiplier;
        if (isBossZone) {
            // Boss = tamanho base da zona anterior * 1.2
            const previousZoneMultiplier = Math.pow(1.02, Math.floor((gameState.currentZone - 1) / 5));
            sizeMultiplier = previousZoneMultiplier * 1.2;
        } else {
            sizeMultiplier = Math.pow(1.02, Math.floor(gameState.currentZone / 5));
        }

        imgEl.style.transform = `scale(${sizeMultiplier})`;
    }

    // Atualizar nome e n√≠vel do monstro
    gameState.currentMonster.name = enemyName;
    gameState.currentEnemyName = enemyName; // Salvar para sistema de drop
    if (nameEl) nameEl.textContent = enemyName;
    if (levelEl) levelEl.textContent = `N√≠vel ${gameState.currentZone}`;

    updateMonsterUI();
}

function damageMonster(amount, isClick = false) {
    let finalDmg = amount;
    let isCrit = false;

    if (isClick && gameState.critChance > 0) {
        if (Math.random() < gameState.critChance) {
            finalDmg *= gameState.clickCritMultiplier;
            isCrit = true;
        }
    }

    gameState.currentMonster.hp -= finalDmg;
    if (gameState.currentMonster.hp < 0) gameState.currentMonster.hp = 0;

    if (isClick) {
        createDamageNumber(finalDmg, isCrit);
        animateMonsterShake();
        animateMonsterHitScale(); // Nova anima√ß√£o de aumento
        gameState.statistics.totalClicks++;
    }

    if (gameState.currentMonster.hp <= 0) {
        monterDeath();
    }

    updateMonsterUI();
}

function monterDeath() {
    // Recompensa
    const zoneMultiplier = Math.pow(zoneData.coinsMultiplier, gameState.currentZone - 1);
    const goldDrop = Math.ceil(Math.random() * 3 * zoneMultiplier);

    gameState.gold += goldDrop;
    gameState.statistics.totalKills++;

    // Anima√ß√£o de moedas caindo
    createGoldCoins(goldDrop);

    // Verificar se √© boss
    const isBoss = gameState.currentZone % 5 === 0;

    if (isBoss) {
        // Boss morto: parar cron√¥metro e avan√ßar para pr√≥xima zona
        stopBossTimer();

        // Desbloquear pr√≥xima zona se for a zona m√°xima
        if (gameState.currentZone === gameState.statistics.maxZone) {
            gameState.statistics.maxZone++;
            renderArenas();
        }

        // Resetar contador de monstros mortos
        gameState.monstersKilledInZone = 0;
    } else {
        // Inimigo normal: incrementar contador
        gameState.monstersKilledInZone++;


        // Sistema de Drop de Itens (Veneno)
        // Apenas inimigos comuns (n√£o bosses) nas arenas 10-15 com 2% de chance
        const isInDropZone = gameState.currentZone >= 10 && gameState.currentZone <= 15;
        const dropChance = 0.02; // 2%

        if (isInDropZone && Math.random() < dropChance) {
            // Item dropado: Veneno
            const droppedItem = {
                icon: './static/img/items/poison.png',
                name: 'Frasco de Veneno',
                description: 'Um veneno mortal usado por ninjas',
                count: 1,
                isImage: true
            };

            // Adicionar ao invent√°rio
            if (addItemToInventory(droppedItem)) {
                // Mostrar notifica√ß√£o visual
                showItemDropNotification(droppedItem);
            }
        }

        // Sistema de Drop de Diamantes (1% de chance para qualquer inimigo)
        if (Math.random() < 0.01) {
            const diamondsAmount = Math.floor(Math.random() * 3) + 1; // 1 a 3 diamantes
            gameState.diamonds += diamondsAmount;
            console.log(`üíé ${diamondsAmount} diamante(s) coletado(s)! Total: ${gameState.diamonds}`);

            // Criar anima√ß√£o de diamantes caindo
            createDiamondAnimation(diamondsAmount);
            updateUI();
        }

        // Sistema de Drop de Pergaminhos Rasgados de Clone (Miss√£o Skill 2 do Naruto)
        // Apenas se a miss√£o foi comprada e n√£o foi completada
        const mission2 = gameState.missions.naruto_skill2;
        if (mission2.purchased && !mission2.completed) {
            const isInScrollDropZone = gameState.currentZone >= 20 && gameState.currentZone <= 40;
            const scrollDropChance = 0.08; // 8%

            if (isInScrollDropZone && Math.random() < scrollDropChance) {
                // Incrementar progresso da miss√£o
                mission2.progress++;
                console.log(`üåÄ Pergaminho Rasgado de Clone coletado! Progresso: ${mission2.progress}/${mission2.target}`);

                // Item dropado: Pergaminho Rasgado de Clone
                const droppedItem = {
                    icon: 'üåÄ',
                    name: 'Pergaminho Rasgado de Clone',
                    description: 'Um pergaminho antigo com t√©cnicas de clonagem',
                    count: 1,
                    isImage: false
                };

                // Adicionar ao invent√°rio
                if (addItemToInventory(droppedItem)) {
                    // Mostrar notifica√ß√£o visual
                    showItemDropNotification(droppedItem);
                }

                // Verificar se completou a miss√£o
                if (mission2.progress >= mission2.target) {
                    mission2.completed = true;
                    console.log('üéâ Miss√£o "Ex√©rcito de Clones" completada! Voc√™ pode comprar o Tajuu Kage Bunshin agora!');
                    alert('üéâ Miss√£o Completada!\n\nVoc√™ coletou todos os Pergaminhos Rasgados de Clone!\nAgora voc√™ pode comprar o Tajuu Kage Bunshin!');
                    renderHeroesList();
                }

                saveGame();
            }
        }

        // Desbloqueia pr√≥xima zona se matar o necess√°rio na zona MAXIMA atual
        if (gameState.monstersKilledInZone >= zoneData.monstersPerZone) {
            if (gameState.currentZone === gameState.statistics.maxZone) {
                gameState.statistics.maxZone++;
                renderArenas();
                gameState.monstersKilledInZone = 0;
            } else {
                gameState.monstersKilledInZone = 0;
            }
        }
    }

    spawnMonster();
    updateUI();
}

// ===== SISTEMA DE CRON√îMETRO DE BOSS =====
function startBossTimer() {
    // Parar qualquer cron√¥metro anterior
    stopBossTimer();

    // Resetar para 30 segundos
    gameState.bossTimer = 30;
    updateBossTimerDisplay();

    // Iniciar intervalo de 1 segundo
    gameState.bossTimerInterval = setInterval(() => {
        gameState.bossTimer--;
        updateBossTimerDisplay();

        // Adicionar classe de aviso quando restarem 10 segundos ou menos
        const bossTimerEl = document.getElementById('boss-timer');
        if (gameState.bossTimer <= 10) {
            if (bossTimerEl) bossTimerEl.classList.add('warning');
        } else {
            if (bossTimerEl) bossTimerEl.classList.remove('warning');
        }

        // Quando chegar a 0, resetar vida do boss
        if (gameState.bossTimer <= 0) {
            resetBossHealth();
        }
    }, 1000);
}

function stopBossTimer() {
    if (gameState.bossTimerInterval) {
        clearInterval(gameState.bossTimerInterval);
        gameState.bossTimerInterval = null;
    }

    // Remover classe de aviso
    const bossTimerEl = document.getElementById('boss-timer');
    if (bossTimerEl) bossTimerEl.classList.remove('warning');
}

function updateBossTimerDisplay() {
    const bossTimerValueEl = document.getElementById('boss-timer-value');
    if (bossTimerValueEl) {
        bossTimerValueEl.textContent = gameState.bossTimer;
    }
}

function resetBossHealth() {
    // Resetar vida do boss para o m√°ximo
    gameState.currentMonster.hp = gameState.currentMonster.maxHp;
    updateMonsterUI();

    // Reiniciar cron√¥metro
    startBossTimer();

    console.log('‚è±Ô∏è Tempo esgotado! Vida do boss resetada.');
}

// Loop Principal
function startGameLoop() {
    setInterval(() => {
        if (gameState.totalDps > 0) {
            const dpsTick = gameState.totalDps / TICKS_PER_SECOND;
            if (dpsTick > 0 && gameState.currentMonster.hp > 0) {
                damageMonster(dpsTick, false);
            }
        }
        checkBuyButtons();
    }, 1000 / TICKS_PER_SECOND);
}

function checkBuyButtons() {
    // Apenas verifica se tem dinheiro para remover classe disabled nos herois?
    // Visualmente apenas. A logica √© checada no clique.
    // Como agora usamos renderHeroesList com frequencia, pode ser redundante se nao otimizado.
    // Mas vamos manter simples:
    gameState.heroes.forEach(hero => {
        const item = document.getElementById(`hero-${hero.id}`);
        if (item) {
            const btn = item.querySelector('.hero-buy-btn');
            if (btn && !btn.classList.contains('locked')) { // locked class is for mystery
                if (gameState.gold >= hero.currentCost) {
                    btn.classList.remove('disabled');
                } else {
                    btn.classList.add('disabled');
                }
            }
        }
    });

    // Upgrades
    gameState.heroes.forEach(hero => {
        const ups = heroUpgrades[hero.id];
        if (ups) {
            ups.forEach(u => {
                const el = document.getElementById(`upg-${u.id}`);
                const cost = hero.baseCost * u.costMultiplier;
                if (el) {
                    if (gameState.gold >= cost) {
                        el.style.borderColor = "#00ff00"; // Highlight available?
                        // ou usar classe .available se level permitir.
                        // renderHeroesList ja define .available baseado em level.
                    } else {
                        // el.style.borderColor = "";
                    }
                }
            });
        }
    });
}

// Event Listeners
function setupEventListeners() {
    const clickTarget = document.getElementById('click-target');
    if (clickTarget) {
        clickTarget.addEventListener('mousedown', (e) => {
            e.preventDefault();
            damageMonster(gameState.clickDamage, true);
            const vis = clickTarget.querySelector('.monster-visual');
            if (vis) vis.style.transform = "scale(0.9)";
        });

        clickTarget.addEventListener('mouseup', () => {
            const vis = clickTarget.querySelector('.monster-visual');
            if (vis) vis.style.transform = "scale(1)";
        });
    }

    const prevBtn = document.getElementById('prev-zone');
    if (prevBtn) prevBtn.onclick = () => changeZone('prev');
    const nextBtn = document.getElementById('next-zone');
    if (nextBtn) nextBtn.onclick = () => changeZone('next');

    // Configurar eventos da mochila
    setupBackpackEventListeners();

    // Configurar eventos de miss√µes
    setupMissionEventListeners();
}

// UI Helpers
function updateUI() {
    const goldEl = document.getElementById('player-gold');
    if (goldEl) goldEl.textContent = formatNumber(Math.floor(gameState.gold));

    const diamondsEl = document.getElementById('player-diamonds');
    if (diamondsEl) diamondsEl.textContent = formatNumber(gameState.diamonds);

    const dpsEl = document.getElementById('total-dps');
    if (dpsEl) dpsEl.textContent = formatNumber(Math.floor(gameState.totalDps));

    const clickValEl = document.getElementById('click-damage-val');
    if (clickValEl) clickValEl.textContent = formatNumber(Math.floor(gameState.clickDamage));

    const mkEl = document.getElementById('monsters-killed');
    if (mkEl) mkEl.textContent = gameState.monstersKilledInZone;

    // Stats footer/header
    const skEl = document.getElementById('stat-killed');
    if (skEl) skEl.textContent = formatNumber(gameState.statistics.totalKills);
    const scEl = document.getElementById('stat-clicks');
    if (scEl) scEl.textContent = formatNumber(gameState.statistics.totalClicks);
    const smzEl = document.getElementById('stat-max-zone');
    if (smzEl) smzEl.textContent = gameState.statistics.maxZone;
}

function updateMonsterUI() {
    if (!gameState.currentMonster) return;
    const pct = (gameState.currentMonster.hp / gameState.currentMonster.maxHp) * 100;
    const fill = document.getElementById('hp-fill');
    if (fill) fill.style.width = `${pct}%`;

    const curHp = document.getElementById('current-hp');
    if (curHp) curHp.textContent = formatNumber(Math.ceil(gameState.currentMonster.hp));
}

function createDamageNumber(amount, isCrit) {
    const container = document.getElementById('damage-numbers-container');
    if (!container) return;

    const el = document.createElement('div');
    el.className = 'damage-number';
    if (isCrit) {
        el.classList.add('damage-crit');
    }
    el.textContent = formatNumber(Math.floor(amount));

    const x = 50 + (Math.random() * 20 - 10);
    const y = 50 + (Math.random() * 20 - 10);

    el.style.left = `${x}%`;
    el.style.top = `${y}%`;

    container.appendChild(el);

    setTimeout(() => el.remove(), 1000);
}

function animateMonsterShake() {
    const visual = document.querySelector('.monster-visual');
    if (visual) {
        visual.classList.remove('shake');
        void visual.offsetWidth;
        visual.classList.add('shake');
    }
}

function animateMonsterHitScale() {
    const visual = document.querySelector('.monster-visual');
    if (visual) {
        visual.classList.remove('hit-scale');
        void visual.offsetWidth; // Reflow
        visual.classList.add('hit-scale');
    }
}

function createGoldCoins(amount) {
    const container = document.getElementById('damage-numbers-container');
    if (!container) return;

    // Criar entre 3 e 8 moedas dependendo da quantidade de ouro
    const numCoins = Math.min(Math.max(3, Math.floor(amount / 10)), 8);

    for (let i = 0; i < numCoins; i++) {
        const coin = document.createElement('div');
        coin.className = 'gold-coin';
        coin.textContent = 'üí∞';

        // Posi√ß√£o inicial aleat√≥ria ao redor do meio do monstro (mais para baixo)
        const x = 45 + (Math.random() * 10 - 5); // 40-50%
        const y = 50 + (Math.random() * 15 - 7.5); // 42.5-57.5% (meio do personagem)

        coin.style.left = `${x}%`;
        coin.style.top = `${y}%`;

        // Pequeno delay para cada moeda criar efeito cascata
        coin.style.animationDelay = `${i * 0.08}s`;

        container.appendChild(coin);

        // Remover ap√≥s a anima√ß√£o (mais curto agora)
        setTimeout(() => coin.remove(), 800 + (i * 80));
    }
}

function createDiamondAnimation(amount) {
    const container = document.getElementById('damage-numbers-container');
    if (!container) return;

    // Criar diamantes baseado na quantidade dropada
    const numDiamonds = Math.min(amount, 5);

    for (let i = 0; i < numDiamonds; i++) {
        const diamond = document.createElement('div');
        diamond.className = 'diamond-drop';
        diamond.textContent = 'üíé';

        // Posi√ß√£o inicial aleat√≥ria ao redor do meio do monstro
        const x = 45 + (Math.random() * 10 - 5);
        const y = 50 + (Math.random() * 15 - 7.5);

        diamond.style.left = `${x}%`;
        diamond.style.top = `${y}%`;

        // Delay para efeito cascata
        diamond.style.animationDelay = `${i * 0.1}s`;

        container.appendChild(diamond);

        // Remover ap√≥s a anima√ß√£o
        setTimeout(() => diamond.remove(), 1000 + (i * 100));
    }
}

function showItemDropNotification(item) {
    // Criar elemento de notifica√ß√£o
    const notification = document.createElement('div');
    notification.className = 'item-drop-notification';

    // Criar conte√∫do
    const iconHTML = item.isImage
        ? `<img src="${item.icon}" alt="${item.name}">`
        : `<div style="font-size: 2.5em;">${item.icon}</div>`;

    notification.innerHTML = `
        ${iconHTML}
        <div class="drop-content">
            <div class="drop-text">ITEM ENCONTRADO!</div>
            <div class="item-name">${item.name}</div>
        </div>
    `;

    // Adicionar ao body
    document.body.appendChild(notification);

    // Remover ap√≥s 3 segundos
    setTimeout(() => {
        notification.remove();
    }, 3000);
}

// Fun√ß√£o para desbloquear o Rasengan do Naruto
function unlockNarutoRasengan() {
    console.log('üåÄ Desbloqueando Rasengan!');

    // Adicionar a skill aos upgrades
    if (!gameState.upgrades.includes('h1_u3')) {
        gameState.upgrades.push('h1_u3');

        // Recalcular DPS com a nova skill
        recalculateTotalDps();
        updateUI();
        renderHeroesList();

        // Mostrar notifica√ß√£o especial
        const notification = document.createElement('div');
        notification.className = 'item-drop-notification rasengan-unlock';
        notification.innerHTML = `
            <div style="font-size: 3em;">üåÄ</div>
            <div class="drop-content">
                <div class="drop-text">SKILL DESBLOQUEADA!</div>
                <div class="item-name">Rasengan</div>
                <div style="font-size: 0.9em; margin-top: 5px;">DPS de Todos +10%</div>
            </div>
        `;
        document.body.appendChild(notification);
        setTimeout(() => notification.remove(), 5000);

        console.log('‚úÖ Rasengan desbloqueado com sucesso!');
    }
}

function formatNumber(num) {
    if (num >= 1000000000000) return (num / 1000000000000).toFixed(2) + 'T';
    if (num >= 1000000000) return (num / 1000000000).toFixed(2) + 'B';
    if (num >= 1000000) return (num / 1000000).toFixed(2) + 'M';
    if (num >= 1000) return (num / 1000).toFixed(1) + 'k';
    return Math.floor(num).toString();
}

// Persistence
function saveGame() {
    const saveObj = {
        gold: gameState.gold,
        currentZone: gameState.currentZone,
        savedHeroes: gameState.heroes.map(h => ({ id: h.id, level: h.level })),
        upgrades: gameState.upgrades,
        statistics: gameState.statistics,
        inventory: gameState.inventory,
        diamonds: gameState.diamonds, // Salvar diamantes
        missions: gameState.missions // Salvar miss√µes
    };
    localStorage.setItem('narutoClickerSave', JSON.stringify(saveObj));
}

function loadGame() {
    const saveStr = localStorage.getItem('narutoClickerSave');
    if (saveStr) {
        try {
            const saved = JSON.parse(saveStr);
            gameState.gold = saved.gold || 0;
            gameState.currentZone = saved.currentZone || 1;
            gameState.savedHeroes = saved.savedHeroes || [];
            gameState.upgrades = saved.upgrades || [];
            gameState.statistics = { ...gameState.statistics, ...saved.statistics };
            gameState.inventory = saved.inventory || [];
            gameState.diamonds = saved.diamonds || 0; // Carregar diamantes
            gameState.missions = saved.missions || gameState.missions; // Carregar miss√µes
            if (!gameState.statistics.maxZone) gameState.statistics.maxZone = 1;
        } catch (e) {
            console.error("Erro save", e);
        }
    }
}

function resetGame() {
    if (confirm("TEM CERTEZA? Isso apagar√° todo o seu progresso para sempre!")) {
        localStorage.removeItem('narutoClickerSave');
        location.reload();
    }
}

// ===== SISTEMA DE MOCHILA =====
function setupBackpackEventListeners() {
    console.log('üéí Configurando eventos da mochila...');
    const openBackpackBtn = document.getElementById('open-backpack');
    const closeBackpackBtn = document.getElementById('close-backpack');
    const backpackModal = document.getElementById('backpack-modal');

    if (!openBackpackBtn || !closeBackpackBtn || !backpackModal) {
        console.warn('‚ö†Ô∏è Elementos da mochila n√£o encontrados');
        return;
    }
    console.log('‚úÖ Elementos da mochila encontrados, configurando listeners...');

    // Abrir modal
    openBackpackBtn.addEventListener('click', () => {
        console.log('üéí Abrindo mochila...');
        backpackModal.classList.add('active');
        console.log('Classes do modal:', backpackModal.className);
        renderInventory();
    });

    // Fechar modal
    closeBackpackBtn.addEventListener('click', () => {
        console.log('‚ùå Fechando mochila (bot√£o X)...');
        backpackModal.classList.remove('active');
    });

    // Fechar ao clicar fora do modal (no backdrop)
    backpackModal.addEventListener('click', (e) => {
        if (e.target === backpackModal) {
            console.log('‚ùå Fechando mochila (clique fora)...');
            backpackModal.classList.remove('active');
        }
    });

    // Inicializar grid de invent√°rio
    initializeInventory();

    // Inicializar painel admin
    setupAdminPanel();
}

function initializeInventory() {
    const inventoryGrid = document.getElementById('inventory-grid');
    const totalSlots = 40;

    for (let i = 0; i < totalSlots; i++) {
        const slot = document.createElement('div');
        slot.className = 'inventory-slot empty';
        slot.dataset.slotIndex = i;
        inventoryGrid.appendChild(slot);
    }
}

function addItemToInventory(newItem) {
    // Verificar se o item j√° existe no invent√°rio (mesmo nome)
    const existingItem = gameState.inventory.find(item => item && item.name === newItem.name);

    if (existingItem) {
        // Se j√° existe, aumentar a contagem
        existingItem.count += newItem.count;
    } else {
        // Se n√£o existe, adicionar em um slot vazio
        const emptySlotIndex = gameState.inventory.findIndex(item => !item);

        if (emptySlotIndex !== -1) {
            // Tem slot vazio, adicionar l√°
            gameState.inventory[emptySlotIndex] = newItem;
        } else if (gameState.inventory.length < 40) {
            // N√£o tem slot vazio mas ainda tem espa√ßo
            gameState.inventory.push(newItem);
        } else {
            // Invent√°rio cheio
            console.warn('‚ö†Ô∏è Invent√°rio cheio! N√£o foi poss√≠vel adicionar o item.');
            return false;
        }
    }

    // Salvar o jogo ap√≥s adicionar item
    saveGame();
    return true;
}

function renderInventory() {
    const slots = document.querySelectorAll('.inventory-slot');

    slots.forEach((slot, index) => {
        const item = gameState.inventory[index];

        if (item) {
            slot.className = 'inventory-slot has-item';

            // Verificar se o √≠cone √© uma imagem ou emoji
            const iconHTML = item.isImage
                ? `<img src="${item.icon}" class="item-icon-img" alt="${item.name}">`
                : `<span class="item-icon">${item.icon}</span>`;

            slot.innerHTML = `
                ${iconHTML}
                ${item.count > 1 ? `<span class="item-count">x${item.count}</span>` : ''}
            `;
            slot.title = `${item.name}\n${item.description}`;
        } else {
            slot.className = 'inventory-slot empty';
            slot.innerHTML = '';
            slot.title = 'Slot vazio';
        }
    });
}

// ===== ADMIN PANEL =====
function setupAdminPanel() {
    const adminTrigger = document.getElementById('admin-trigger');
    const adminModal = document.getElementById('admin-modal');
    const closeAdminBtn = document.getElementById('close-admin');
    const addGoldBtn = document.getElementById('add-gold-btn');
    const goldInput = document.getElementById('gold-input');

    // Abrir modal admin
    adminTrigger.addEventListener('click', () => {
        adminModal.style.display = 'flex';
        goldInput.value = '';
        goldInput.focus();
    });

    // Fechar modal admin
    closeAdminBtn.addEventListener('click', () => {
        adminModal.style.display = 'none';
    });

    // Fechar ao clicar fora
    adminModal.addEventListener('click', (e) => {
        if (e.target === adminModal) {
            adminModal.style.display = 'none';
        }
    });

    // Adicionar ouro
    addGoldBtn.addEventListener('click', () => {
        const amount = parseFloat(goldInput.value);
        if (amount && amount > 0) {
            gameState.gold += amount;
            updateUI();
            saveGame();
            goldInput.value = '';
            console.log(`‚úÖ Admin: Adicionado ${formatNumber(amount)} de ouro`);
        }
    });

    // Enter para adicionar
    goldInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
            addGoldBtn.click();
        }
    });
}

window.onload = initGame;


// ===== SISTEMA DE MISS√ïES =====
function openMissionModal(missionId) {
    const modal = document.getElementById('mission-modal');
    const content = document.getElementById('mission-content');
    const titleText = document.getElementById('mission-title-text');
    const purchaseBtn = document.getElementById('purchase-mission-btn');

    if (missionId === 'naruto_skill1') {
        const mission = gameState.missions.naruto_skill1;

        titleText.textContent = 'Treino dos Clones na Floresta';

        content.innerHTML = `
            <div class="mission-details">
                <div class="mission-icon">üåÄ</div>
                <h3>Kage Bunshin no Jutsu</h3><div class="mission-section">
                    <h4>üìå Efeito</h4>
                    <p><strong>Dano de Clique do Naruto x2</strong></p>
                </div>
                
                <div class="mission-section bonus">
                    <h4>üí• B√¥nus Elemental (Vento)</h4>
                    <p><strong>Clique recebe +15% adicional</strong></p>
                </div>
                
                <div class="mission-section objective">
                    <h4>üìã Objetivo da Miss√£o</h4>
                    <p>Derrotar <strong>150 inimigos normais</strong><br>
                    entre as <strong>fases 1-10</strong><br>
                    usando <strong>apenas clique</strong> (sem DPS)</p>
                </div>
                
                <div class="mission-cost">
                    <span class="cost-label">Custo da Miss√£o:</span>
                    <span class="cost-value">üíé ${mission.cost} Diamantes</span>
                </div>
                
                <div class="player-diamonds">
                    Seus Diamantes: <span class="${gameState.diamonds >= mission.cost ? 'enough' : 'not-enough'}">
                        üíé ${gameState.diamonds}
                    </span>
                </div>
            </div>
        `;

        // Configurar bot√£o de compra
        purchaseBtn.onclick = () => purchaseMission(missionId);
        purchaseBtn.disabled = gameState.diamonds < mission.cost;
    } else if (missionId === 'naruto_skill2') {
        const mission = gameState.missions.naruto_skill2;

        titleText.textContent = 'Ex√©rcito de Clones';

        content.innerHTML = `
            <div class="mission-details">
                <div class="mission-icon">üåÄ</div>
                <h3>Tajuu Kage Bunshin</h3>
                <div class="mission-section">
                    <h4>üìå Efeito</h4>
                    <p><strong>Clique x2 (stack com Skill 1 = x4 total)</strong></p>
                    <p><strong>DPS do Naruto +20%</strong></p>
                </div>
                
                <div class="mission-section bonus">
                    <h4>üí• B√¥nus Progressivo</h4>
                    <p><strong>+1% DPS global a cada 10 n√≠veis do Naruto</strong></p>
                </div>
                
                <div class="mission-section objective">
                    <h4>üìã Objetivo da Miss√£o</h4>
                    <p>Coletar <strong>30 Pergaminhos Rasgados de Clone</strong><br>
                    <strong>Drop: 8% de chance</strong><br>
                    nas <strong>fases 20-40</strong></p>
                </div>
                
                <div class="mission-cost">
                    <span class="cost-label">Custo da Miss√£o:</span>
                    <span class="cost-value">üíé ${mission.cost} Diamantes</span>
                </div>
                
                <div class="player-diamonds">
                    Seus Diamantes: <span class="${gameState.diamonds >= mission.cost ? 'enough' : 'not-enough'}">
                        üíé ${gameState.diamonds}
                    </span>
                </div>
            </div>
        `;

        // Configurar bot√£o de compra
        purchaseBtn.onclick = () => purchaseMission(missionId);
        purchaseBtn.disabled = gameState.diamonds < mission.cost;
    }

    modal.classList.add('active');
}

function purchaseMission(missionId) {
    if (missionId === 'naruto_skill1') {
        const mission = gameState.missions.naruto_skill1;

        if (gameState.diamonds >= mission.cost) {
            gameState.diamonds -= mission.cost;
            mission.purchased = true;

            console.log('‚úÖ Miss√£o comprada! Comece a derrotar inimigos nas fases 1-10 usando apenas clique!');

            updateUI();
            saveGame();
            renderHeroesList();
            closeMissionModal();

            // Mostrar notifica√ß√£o
            alert('üéØ Miss√£o Ativada!\n\nDerrote 150 inimigos normais nas fases 1-10 usando apenas clique para desbloquear o Kage Bunshin no Jutsu!');
        }
    } else if (missionId === 'naruto_skill2') {
        const mission = gameState.missions.naruto_skill2;

        if (gameState.diamonds >= mission.cost) {
            gameState.diamonds -= mission.cost;
            mission.purchased = true;

            console.log('‚úÖ Miss√£o comprada! Comece a coletar Pergaminhos Rasgados de Clone nas fases 20-40!');

            updateUI();
            saveGame();
            renderHeroesList();
            closeMissionModal();

            // Mostrar notifica√ß√£o
            alert('üéØ Miss√£o Ativada!\n\nColete 30 Pergaminhos Rasgados de Clone nas fases 20-40 para desbloquear o Tajuu Kage Bunshin!');
        }
    }
}

function closeMissionModal() {
    const modal = document.getElementById('mission-modal');
    modal.classList.remove('active');
}

function setupMissionEventListeners() {
    const closeBtn = document.getElementById('close-mission');
    const cancelBtn = document.getElementById('cancel-mission-btn');
    const modal = document.getElementById('mission-modal');

    if (closeBtn) {
        closeBtn.addEventListener('click', closeMissionModal);
    }

    if (cancelBtn) {
        cancelBtn.addEventListener('click', closeMissionModal);
    }

    if (modal) {
        modal.addEventListener('click', (e) => {
            if (e.target === modal) {
                closeMissionModal();
            }
        });
    }
}


----- FILE: templates/index.html  (sha1:b2ec791a72b7, bytes:6807) -----
<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Naruto Clicker Heroes</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}?v=10">
    <link
        href="https://fonts.googleapis.com/css2?family=Bangers&family=Shojumaru&family=Roboto:wght@400;700&display=swap"
        rel="stylesheet">
</head>

<body>
    <div class="game-container">
        <!-- Coluna Esquerda: Her√≥is -->
        <div class="panel left-panel">
            <div class="currency-display-container">
                <div class="gold-display-left">
                    üí∞ <span id="player-gold">0</span>
                </div>
                <div class="diamonds-display-left">
                    üíé <span id="player-diamonds">0</span>
                </div>
            </div>
            <div class="header-panel">
                <h2>Equipe Ninja <span class="backpack-icon" id="open-backpack" title="Mochila">üéí</span></h2>
                <div class="stats-display-container">
                    <div class="dps-display">DPS: <span id="total-dps">0</span></div>
                    <div class="click-display">Click: <span id="click-damage-val">1</span></div>
                </div>
            </div>
            <div id="heroes-list" class="scroll-content">
                <!-- Her√≥is ser√£o inseridos aqui via JS -->
            </div>
        </div>

        <!-- Coluna Central: A√ß√£o -->
        <div class="panel center-panel">
            <img src="{{ url_for('static', filename='img/elemental_cycle.png') }}" class="elemental-cycle-guide"
                alt="Ciclo Elemental">


            <div class="arena-selector-container">
                <button id="prev-zone" class="nav-btn">‚óÄ</button>
                <div class="arenas-scroll">
                    <div id="arenas-display">
                        <!-- Arenas visuais -->
                    </div>
                </div>
                <button id="next-zone" class="nav-btn">‚ñ∂</button>
            </div>


            <div class="battle-arena">
                <div class="zone-progress-info">
                    <span id="monsters-killed">0</span>/10
                </div>
                <!-- Cron√¥metro de Boss -->
                <div id="boss-timer" class="boss-timer" style="display: none;">
                    ‚è±Ô∏è <span id="boss-timer-value">30</span>s
                </div>
                <div id="damage-numbers-container"></div>
                <div class="monster-container" id="click-target">
                    <div class="monster-hp-bar">
                        <div id="hp-fill" style="width: 100%;"></div>
                    </div>
                    <div class="monster-hp-text"><span id="current-hp">10</span> HP</div>
                    <div class="monster-visual">
                        <img id="monster-img" src="" alt="Monstro">
                    </div>
                    <div class="monster-info">
                        <div id="monster-name" class="monster-name">Inimigo</div>
                        <div id="monster-level" class="monster-level">N√≠vel 1</div>
                    </div>
                </div>

                <div class="player-controls">
                    <!-- Controls -->
                </div>
            </div>
        </div>

        <!-- Coluna Direita: Progresso e Status -->
        <div class="panel right-panel">
            <h3>Estat√≠sticas</h3>
            <ul id="stats-list">
                <li>Monstros Derrotados: <span id="stat-killed">0</span></li>
                <li>Cliques Realizados: <span id="stat-clicks">0</span></li>
                <li>Maior Zona: <span id="stat-max-zone">1</span></li>
            </ul>
            <div class="reset-container">
                <button id="reset-save-btn" class="reset-btn" onclick="resetGame()">RESETAR PROGRESSO</button>
            </div>
        </div>
    </div>

    <!-- Modal da Mochila -->
    <div id="backpack-modal" class="backpack-modal">
        <div class="backpack-container">
            <div class="backpack-header">
                <div class="backpack-title">
                    <span class="backpack-icon">üéí</span>
                    Invent√°rio
                </div>
                <button class="close-backpack" id="close-backpack">‚úñ</button>
            </div>
            <div class="backpack-body">
                <div id="inventory-grid" class="inventory-grid">
                    <!-- Slots ser√£o gerados via JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Miss√£o -->
    <div id="mission-modal" class="backpack-modal">
        <div class="mission-container">
            <div class="mission-header">
                <div class="mission-title">
                    <span>üéØ</span>
                    <span id="mission-title-text">Miss√£o</span>
                </div>
                <button class="close-mission" id="close-mission">‚úñ</button>
            </div>
            <div class="mission-body">
                <div id="mission-content">
                    <!-- Conte√∫do ser√° preenchido via JavaScript -->
                </div>
                <div class="mission-actions">
                    <button id="cancel-mission-btn" class="mission-btn cancel">Cancelar</button>
                    <button id="purchase-mission-btn" class="mission-btn purchase">Comprar Miss√£o</button>
                </div>
            </div>
        </div>
    </div>


    <!-- Modal Admin (Cheat) -->
    <div id="admin-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content admin-modal">
            <div class="modal-header">
                <h2>‚öôÔ∏è Admin Panel</h2>
                <button class="modal-close" id="close-admin">‚úñ</button>
            </div>
            <div class="modal-body">
                <div class="admin-input-group">
                    <label for="gold-input">Adicionar Ouro:</label>
                    <input type="number" id="gold-input" placeholder="Digite a quantidade..." min="0" step="1000">
                    <button id="add-gold-btn" class="admin-btn">üí∞ Adicionar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bot√£o Admin (Discreto) -->
    <div id="admin-trigger" title="Admin Panel">‚öôÔ∏è</div>

    <script src="{{ url_for('static', filename='js/game_data_v3.js') }}?v=5"></script>
    <script src="{{ url_for('static', filename='js/game_v3.js') }}?v=10"></script>
</body>

</html>

----- FILE: static/css/admin_panel.css  (sha1:e8b91dbee88a, bytes:6511) -----
/* ========================================
   ADMIN PANEL STYLES
   ======================================== */

/* Admin Trigger Button */
#admin-trigger {
    position: fixed;
    bottom: 20px;
    right: 20px;
    width: 50px;
    height: 50px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    cursor: pointer;
    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
    transition: transform 0.2s, box-shadow 0.2s;
    z-index: 9999;
}

#admin-trigger:hover {
    transform: scale(1.1);
    box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
}

/* Admin Modal */
.admin-modal {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border: 3px solid #ffd700;
    max-width: 600px;
    max-height: 80vh;
    overflow-y: auto;
}

.admin-modal .modal-header {
    background: rgba(0, 0, 0, 0.3);
    padding: 15px 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 2px solid #ffd700;
}

.admin-modal .modal-header h2 {
    margin: 0;
    color: #fff;
    font-family: 'Bangers', cursive;
    font-size: 2em;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
}

.admin-modal .modal-close {
    background: #ff4444;
    color: white;
    border: none;
    border-radius: 50%;
    width: 35px;
    height: 35px;
    font-size: 20px;
    cursor: pointer;
    transition: transform 0.2s;
}

.admin-modal .modal-close:hover {
    transform: scale(1.1);
    background: #ff0000;
}

.admin-modal .modal-body {
    padding: 20px;
}

/* Admin Sections */
.admin-section {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 10px;
    padding: 15px;
    margin-bottom: 20px;
    border: 2px solid rgba(255, 255, 255, 0.2);
}

.admin-section h3 {
    margin: 0 0 15px 0;
    color: #ffd700;
    font-family: 'Bangers', cursive;
    font-size: 1.5em;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
}

/* Input Groups */
.admin-input-group {
    display: flex;
    gap: 10px;
    align-items: center;
    margin-bottom: 10px;
}

.admin-input-group label {
    color: #fff;
    font-weight: bold;
    min-width: 150px;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
}

.admin-input-group input {
    flex: 1;
    padding: 10px;
    border: 2px solid #ffd700;
    border-radius: 5px;
    background: rgba(255, 255, 255, 0.9);
    font-size: 1em;
    font-family: 'Roboto', sans-serif;
}

.admin-input-group input:focus {
    outline: none;
    border-color: #00ff00;
    box-shadow: 0 0 10px rgba(0, 255, 0, 0.5);
}

/* Admin Buttons */
.admin-btn {
    background: linear-gradient(to bottom, #ffd700 0%, #ffb700 100%);
    border: 2px solid #ff9800;
    border-radius: 8px;
    padding: 10px 20px;
    color: #000;
    font-weight: bold;
    font-family: 'Bangers', cursive;
    font-size: 1.1em;
    cursor: pointer;
    transition: transform 0.1s, box-shadow 0.1s;
    box-shadow: 0 4px 0 #d4a000;
    text-shadow: 1px 1px 0 rgba(255, 255, 255, 0.5);
}

.admin-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 0 #d4a000;
}

.admin-btn:active {
    transform: translateY(2px);
    box-shadow: 0 2px 0 #d4a000;
}

.admin-btn.full-width {
    width: 100%;
    margin-top: 10px;
}

/* Skill Rows */
.admin-skill-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
    padding: 10px;
    background: rgba(0, 0, 0, 0.2);
    border-radius: 8px;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.skill-label {
    color: #fff;
    font-weight: bold;
    font-family: 'Roboto', sans-serif;
    font-size: 1.1em;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
}

.skill-actions {
    display: flex;
    gap: 10px;
}

.admin-skill-btn {
    background: linear-gradient(to bottom, #4CAF50 0%, #45a049 100%);
    border: 2px solid #2e7d32;
    border-radius: 8px;
    padding: 8px 16px;
    color: white;
    font-weight: bold;
    font-family: 'Roboto', sans-serif;
    font-size: 0.9em;
    cursor: pointer;
    transition: transform 0.1s, box-shadow 0.1s;
    box-shadow: 0 3px 0 #2e7d32;
    white-space: nowrap;
}

.admin-skill-btn.unlock {
    background: linear-gradient(to bottom, #4CAF50 0%, #45a049 100%);
    border-color: #2e7d32;
    box-shadow: 0 3px 0 #2e7d32;
}

.admin-skill-btn.lock {
    background: linear-gradient(to bottom, #f44336 0%, #d32f2f 100%);
    border-color: #b71c1c;
    box-shadow: 0 3px 0 #b71c1c;
}

.admin-skill-btn:hover {
    transform: translateY(-2px);
}

.admin-skill-btn.unlock:hover {
    box-shadow: 0 5px 0 #2e7d32;
}

.admin-skill-btn.lock:hover {
    box-shadow: 0 5px 0 #b71c1c;
}

.admin-skill-btn:active {
    transform: translateY(2px);
}

.admin-skill-btn.unlock:active {
    box-shadow: 0 1px 0 #2e7d32;
}

.admin-skill-btn.lock:active {
    box-shadow: 0 1px 0 #b71c1c;
}

.admin-btn.lock-all {
    background: linear-gradient(to bottom, #f44336 0%, #d32f2f 100%);
    border-color: #b71c1c;
    box-shadow: 0 4px 0 #b71c1c;
}

.admin-btn.lock-all:hover {
    box-shadow: 0 6px 0 #b71c1c;
}

.admin-btn.lock-all:active {
    box-shadow: 0 2px 0 #b71c1c;
}

/* Quick Zones */
.admin-quick-zones {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 10px;
    margin-top: 10px;
}

.admin-quick-btn {
    background: linear-gradient(to bottom, #2196F3 0%, #1976D2 100%);
    border: 2px solid #0d47a1;
    border-radius: 8px;
    padding: 10px;
    color: white;
    font-weight: bold;
    font-family: 'Roboto', sans-serif;
    cursor: pointer;
    transition: transform 0.1s, box-shadow 0.1s;
    box-shadow: 0 3px 0 #0d47a1;
}

.admin-quick-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 0 #0d47a1;
}

.admin-quick-btn:active {
    transform: translateY(2px);
    box-shadow: 0 1px 0 #0d47a1;
}

/* Scrollbar Customization */
.admin-modal::-webkit-scrollbar {
    width: 10px;
}

.admin-modal::-webkit-scrollbar-track {
    background: rgba(0, 0, 0, 0.2);
    border-radius: 10px;
}

.admin-modal::-webkit-scrollbar-thumb {
    background: #ffd700;
    border-radius: 10px;
}

.admin-modal::-webkit-scrollbar-thumb:hover {
    background: #ffed4e;
}

----- FILE: static/css/hero_details.css  (sha1:104d9a6c7336, bytes:4794) -----
/* ===== HERO DETAILS MODAL ===== */
.hero-details-modal {
    max-width: 600px;
    background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
    border: 3px solid #ffd700;
    border-radius: 15px;
}

.hero-details-modal .modal-body {
    padding: 20px;
    max-height: 70vh;
    overflow-y: auto;
}

#hero-details-content {
    color: #fff;
}

.hero-details-header {
    display: flex;
    align-items: center;
    gap: 20px;
    margin-bottom: 25px;
    padding: 15px;
    background: rgba(255, 215, 0, 0.1);
    border-radius: 10px;
    border: 2px solid rgba(255, 215, 0, 0.3);
}

.hero-details-portrait {
    width: 100px;
    height: 100px;
    border-radius: 50%;
    border: 3px solid #ffd700;
    object-fit: cover;
    object-position: center 30%;
    transform: scale(0.75);

    /* Alta qualidade de renderiza√ß√£o */
    image-rendering: auto;
    image-rendering: -webkit-optimize-contrast;
    -ms-interpolation-mode: bicubic;
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
    transform-origin: center;
    will-change: transform;
}

.hero-details-name {
    flex: 1;
}

.hero-details-name h3 {
    margin: 0;
    font-size: 1.8em;
    color: #ffd700;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
}

.hero-details-name p {
    margin: 5px 0 0 0;
    color: #aaa;
    font-size: 0.9em;
}

.hero-details-section {
    margin-bottom: 20px;
    padding: 15px;
    background: rgba(0, 0, 0, 0.3);
    border-radius: 8px;
    border-left: 4px solid #ffd700;
}

.hero-details-section h4 {
    margin: 0 0 12px 0;
    color: #ffd700;
    font-size: 1.2em;
    display: flex;
    align-items: center;
    gap: 8px;
}

.hero-details-stat {
    display: flex;
    justify-content: space-between;
    padding: 8px 0;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.hero-details-stat:last-child {
    border-bottom: none;
}

.hero-details-stat-label {
    color: #ccc;
    font-weight: 500;
}

.hero-details-stat-value {
    color: #fff;
    font-weight: bold;
}

.hero-details-stat-value.elemental-wind {
    color: #00ff00;
}

.hero-details-stat-value.elemental-lightning {
    color: #00d4ff;
}

.hero-details-stat-value.elemental-medical {
    color: #ff69b4;
}

.hero-details-buff {
    padding: 10px;
    margin: 8px 0;
    border-radius: 5px;
}

/* Buffs Pessoais - Verde */
.hero-details-buff.personal {
    background: rgba(0, 255, 0, 0.1);
    border-left: 3px solid #00ff00;
}

.hero-details-buff.personal .hero-details-buff-name {
    color: #00ff00;
}

/* Buffs Globais - Dourado */
.hero-details-buff.global {
    background: rgba(255, 215, 0, 0.1);
    border-left: 3px solid #ffd700;
}

.hero-details-buff.global .hero-details-buff-name {
    color: #ffd700;
}

/* Outros Buffs - Azul */
.hero-details-buff.other {
    background: rgba(0, 212, 255, 0.1);
    border-left: 3px solid #00d4ff;
}

.hero-details-buff.other .hero-details-buff-name {
    color: #00d4ff;
}

.hero-details-buff-name {
    font-weight: bold;
    margin-bottom: 4px;
}

.hero-details-buff-desc {
    color: #ddd;
    font-size: 0.9em;
}

/* Estilo para itens de buff (sem nome, apenas efeito) */
.hero-details-buff-item {
    padding: 8px 10px;
    margin: 6px 0;
    font-size: 0.95em;
    line-height: 1.5;
    border-radius: 4px;
}

.hero-details-buff-item.personal {
    color: #00ff00;
    background: rgba(0, 255, 0, 0.05);
}

.hero-details-buff-item.global {
    color: #ffd700;
    background: rgba(255, 215, 0, 0.05);
}

.hero-details-buff-item.other {
    color: #00d4ff;
    background: rgba(0, 212, 255, 0.05);
}

.hero-details-condition {
    padding: 10px;
    margin: 8px 0;
    background: rgba(255, 165, 0, 0.1);
    border-left: 3px solid #ffa500;
    border-radius: 5px;
}

.hero-details-condition-name {
    font-weight: bold;
    color: #ffa500;
    margin-bottom: 4px;
}

.hero-details-condition-desc {
    color: #ddd;
    font-size: 0.9em;
    line-height: 1.6;
}

.hero-details-condition-item {
    padding: 8px 10px;
    margin: 6px 0;
    color: #ffa500;
    font-size: 0.95em;
    line-height: 1.5;
    background: rgba(255, 165, 0, 0.05);
    border-radius: 4px;
}

/* Scrollbar customizado */
.hero-details-modal .modal-body::-webkit-scrollbar {
    width: 8px;
}

.hero-details-modal .modal-body::-webkit-scrollbar-track {
    background: rgba(0, 0, 0, 0.3);
    border-radius: 10px;
}

.hero-details-modal .modal-body::-webkit-scrollbar-thumb {
    background: #ffd700;
    border-radius: 10px;
}

.hero-details-modal .modal-body::-webkit-scrollbar-thumb:hover {
    background: #ffed4e;
}

----- FILE: static/css/mission_complete.css  (sha1:d62fe365668a, bytes:3064) -----
/* ===== MODAL DE CONCLUS√ÉO DE MISS√ÉO ===== */
.mission-complete-container {
    background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
    border: 4px solid #00ff00;
    border-radius: 20px;
    box-shadow: 0 20px 60px rgba(0, 255, 0, 0.5),
        inset 0 2px 10px rgba(0, 255, 0, 0.2);
    width: 90%;
    max-width: 500px;
    position: relative;
    animation: missionCompleteSlideIn 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    overflow: hidden;
}

@keyframes missionCompleteSlideIn {
    from {
        opacity: 0;
        transform: scale(0.5) translateY(-50px);
    }

    to {
        opacity: 1;
        transform: scale(1) translateY(0);
    }
}

.mission-complete-header {
    background: linear-gradient(135deg, #00ff00 0%, #00aa00 100%);
    padding: 20px;
    text-align: center;
    border-radius: 16px 16px 0 0;
    border-bottom: 3px solid #00ff00;
    position: relative;
}

.mission-complete-icon {
    font-size: 4em;
    animation: celebrationBounce 0.6s ease-in-out infinite alternate;
}

@keyframes celebrationBounce {
    0% {
        transform: scale(1) rotate(0deg);
    }

    100% {
        transform: scale(1.2) rotate(10deg);
    }
}

.mission-complete-header h2 {
    font-family: 'Bangers', cursive;
    font-size: 2em;
    color: #fff;
    margin: 10px 0 0 0;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
}

.mission-complete-body {
    padding: 30px 20px;
    text-align: center;
    color: #fff;
}

.skill-icon-large {
    font-size: 6em;
    margin-bottom: 20px;
    filter: drop-shadow(0 0 20px rgba(0, 212, 255, 0.8));
    animation: skillIconPulse 1.5s ease-in-out infinite;
}

@keyframes skillIconPulse {

    0%,
    100% {
        transform: scale(1);
        filter: drop-shadow(0 0 20px rgba(0, 212, 255, 0.8));
    }

    50% {
        transform: scale(1.1);
        filter: drop-shadow(0 0 30px rgba(0, 212, 255, 1));
    }
}

.mission-complete-body h3 {
    font-family: 'Bangers', cursive;
    font-size: 1.8em;
    color: #00d4ff;
    margin: 0 0 15px 0;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
}

.mission-complete-body p {
    font-size: 1.1em;
    color: #ccc;
    margin: 0;
    line-height: 1.6;
}

.mission-complete-footer {
    padding: 20px;
    text-align: center;
    border-top: 1px solid rgba(255, 255, 255, 0.1);
}

.mission-complete-btn {
    background: linear-gradient(135deg, #00ff00, #00aa00);
    color: #fff;
    border: 2px solid #00ff00;
    padding: 15px 40px;
    font-family: 'Bangers', cursive;
    font-size: 1.5em;
    border-radius: 10px;
    cursor: pointer;
    transition: all 0.3s;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
    box-shadow: 0 4px 15px rgba(0, 255, 0, 0.4);
}

.mission-complete-btn:hover {
    background: linear-gradient(135deg, #00ff44, #00cc00);
    transform: scale(1.05);
    box-shadow: 0 6px 20px rgba(0, 255, 0, 0.6);
}

.mission-complete-btn:active {
    transform: scale(0.98);
}

----- FILE: static/css/mission_notification.css  (sha1:a01a60bbedbc, bytes:1438) -----
/* Notifica√ß√£o de Miss√£o */
.mission-notification {
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: 10000;
    background: linear-gradient(135deg, rgba(139, 0, 0, 0.95), rgba(220, 20, 60, 0.95));
    border: 3px solid #ff0000;
    border-radius: 10px;
    padding: 20px;
    min-width: 300px;
    max-width: 400px;
    box-shadow: 0 10px 30px rgba(255, 0, 0, 0.5), 0 0 20px rgba(255, 0, 0, 0.3);
    animation: slideInRight 0.5s ease-out, glow 2s ease-in-out infinite;
    opacity: 1;
    transition: opacity 0.5s ease-out;
}

.mission-notification-content {
    color: #fff;
    text-align: center;
}

.mission-notification-title {
    font-family: 'Bangers', cursive;
    font-size: 1.5em;
    color: #ffd700;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
    margin-bottom: 10px;
}

.mission-notification-message {
    font-family: 'Roboto', sans-serif;
    font-size: 1.1em;
    color: #fff;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
}

@keyframes slideInRight {
    from {
        transform: translateX(400px);
        opacity: 0;
    }

    to {
        transform: translateX(0);
        opacity: 1;
    }
}

@keyframes glow {

    0%,
    100% {
        box-shadow: 0 10px 30px rgba(255, 0, 0, 0.5), 0 0 20px rgba(255, 0, 0, 0.3);
    }

    50% {
        box-shadow: 0 10px 40px rgba(255, 0, 0, 0.7), 0 0 30px rgba(255, 0, 0, 0.5);
    }
}

----- FILE: static/css/style.css  (sha1:e8a9936384a7, bytes:56811) -----
:root {
    --bg-color: #2c2c2c;
    --panel-bg: #f5e6ca;
    /* Cor de pergaminho */
    --panel-border: #4a3b2a;
    --primary-orange: #ff6600;
    --text-color: #333;
    --gold-color: #ffd700;
    --dps-color: #ff4500;
}

/* For√ßar renderiza√ß√£o de alta qualidade para todas as imagens */
img {
    image-rendering: auto;
    image-rendering: -webkit-optimize-contrast;
    -ms-interpolation-mode: bicubic;
    transform: translateZ(0);
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
    will-change: transform;
}

/* For√ßar acelera√ß√£o de hardware para melhor qualidade */
canvas,
img,
video {
    transform: translate3d(0, 0, 0);
    -webkit-transform: translate3d(0, 0, 0);
}

body {
    margin: 0;
    padding: 0;
    font-family: 'Roboto', sans-serif;
    background: #1a1a1a;
    color: var(--text-color);
    overflow: hidden;
    user-select: none;
    height: 100vh;
    width: 100vw;
}

/* Background fixo do jogo - n√£o afetado por zoom */
body::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-image: url('../img/battle_bg.png');
    background-size: cover;
    background-position: center;
    z-index: -1;
    pointer-events: none;
    zoom: 1;
}



.game-container {
    display: flex;
    /* Tamanho base - ser√° ajustado pelo anti_zoom.js */
    width: 117.65vw;
    height: 117.65vh;
    max-width: none;
    max-height: none;
    padding: 20px;
    box-sizing: border-box;
    margin: 0;
    position: relative;
    /* Zoom base de 85% - anti_zoom.js compensa mudan√ßas do navegador */
    zoom: 0.85;
}

.panel {
    background-color: var(--panel-bg);
    border: 5px solid var(--panel-border);
    border-radius: 8px;
    margin: 0 15px;
    /* Espa√ßo entre as faixas */
    padding: 15px;
    display: flex;
    flex-direction: column;
    position: relative;
    box-shadow: inset 0 0 50px rgba(0, 0, 0, 0.1);
}

.panel::before {
    content: "";
    /* Textura de papel */
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-image: url('https://www.transparenttextures.com/patterns/aged-paper.png');
    opacity: 0.4;
    pointer-events: none;
    z-index: 0;
}

.left-panel {
    flex: 2.5;
    /* Aumentado de 2.2 para 2.5 para dar mais espa√ßo */
    min-width: 480px;
    /* Aumentado de 450px para 480px */
    z-index: 1;
}

/* Mais larga */
.center-panel {
    flex: 6;
    /* Abre muito mais espa√ßo no meio */
    z-index: 1;
    background-color: rgba(255, 255, 255, 0.1);
    border: none;
    box-shadow: none;
    background: none;
}

/* Center panel is transparent to see bg */

.center-panel .battle-arena {
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
    /* Centraliza verticalmente o conjunto */
    align-items: center;
    position: relative;
    padding-top: 0;
}

.right-panel {
    flex: 1.2;
    min-width: 280px;
    z-index: 1;
    display: flex;
    flex-direction: column;
    padding: 20px;
    background-image: url('https://www.transparenttextures.com/patterns/aged-paper.png'),
        linear-gradient(to bottom, #f5e6ca 0%, #e8d5b5 100%);
    border-left: 5px solid #4a3b2a;
    box-shadow: -5px 0 15px rgba(0, 0, 0, 0.3);
    position: relative;
}

.right-panel h3 {
    text-align: center;
    font-size: 1.8em;
    color: #4e342e;
    border-bottom: 2px solid #8d6e63;
    padding-bottom: 10px;
    margin-bottom: 20px;
    text-transform: uppercase;
}

#stats-list {
    list-style: none;
    padding: 0;
    margin: 0;
    flex: 1;
}

#stats-list li {
    font-family: 'Roboto', sans-serif;
    font-size: 1.1em;
    padding: 12px 10px;
    border-bottom: 1px dashed #a1887f;
    color: #3e2723;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

#stats-list li span {
    font-family: 'Bangers', cursive;
    color: #bf360c;
    font-size: 1.2em;
}

/* Estiliza√ß√£o do Bot√£o de Reset */
.reset-container {
    margin-top: auto;
    padding-top: 20px;
    text-align: center;
}

.reset-btn {
    background: linear-gradient(to bottom, #d32f2f 0%, #b71c1c 100%);
    color: white;
    border: 2px solid #7f0000;
    padding: 12px 20px;
    font-family: 'Bangers', cursive;
    font-size: 1.2em;
    border-radius: 8px;
    cursor: pointer;
    box-shadow: 0 4px 0 #5f0000;
    transition: all 0.1s;
    width: 100%;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
}

.reset-btn:hover {
    background: linear-gradient(to bottom, #e53935 0%, #c62828 100%);
}

.reset-btn:active {
    transform: translateY(4px);
    box-shadow: none;
}

/* Scroll Lists */
.scroll-content {
    overflow-y: auto;
    overflow-x: hidden;
    /* Remove a barra horizontal */
    flex: 1;
    padding-right: 15px;
    /* Aumentado de 5px para 15px para afastar a barra dos cards */
}

.scroll-content::-webkit-scrollbar {
    width: 8px;
}

.scroll-content::-webkit-scrollbar-thumb {
    background: var(--primary-orange);
    border-radius: 4px;
}

/* Heroes List Expanded */

/* Container de Moedas */
.currency-display-container {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
}

.gold-display-left {
    font-family: 'Bangers', cursive;
    font-size: 2.5em;
    color: var(--gold-color);
    text-shadow: 2px 2px 0 #000;
    text-align: center;
    background: rgba(0, 0, 0, 0.6);
    padding: 10px;
    border-radius: 10px;
    border: 2px solid #8b4513;
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
}

.diamonds-display-left {
    font-family: 'Bangers', cursive;
    font-size: 2.5em;
    color: #00d4ff;
    text-shadow: 2px 2px 0 #000, 0 0 10px rgba(0, 212, 255, 0.5);
    text-align: center;
    background: rgba(0, 0, 0, 0.6);
    padding: 10px;
    border-radius: 10px;
    border: 2px solid #0088cc;
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
}

/* Header Panel (Equipe Ninja) */
.header-panel {
    border-bottom: 2px solid #8b4513;
    margin-bottom: 15px;
    padding-bottom: 10px;
}

.header-panel h2 {
    font-family: 'Shojumaru', cursive;
    margin: 0;
    color: #b33e00;
    font-size: 1.8em;
    text-align: center;
}

/* Stats Display (DPS/Click) */
.stats-display-container {
    display: flex;
    justify-content: space-around;
    gap: 10px;
    margin-top: 10px;
}

.dps-display,
.click-display {
    flex: 1;
    background: linear-gradient(135deg, #444, #222);
    border: 2px solid #ff9800;
    border-radius: 8px;
    padding: 8px 5px;
    color: #fff;
    font-family: 'Bangers', cursive;
    font-size: 1.4em;
    text-align: center;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
    text-shadow: 1px 1px 2px #000;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}

.dps-display span,
.click-display span {
    color: #ffd700;
    font-size: 1.1em;
}

.dps-display {
    border-color: #ff5722;
}

.click-display {
    border-color: #2196f3;
}

/* Heroes List Expanded */
.hero-item {
    background: rgba(255, 255, 255, 0.85);
    /* Mais opaco para leitura */
    border: 3px solid #8b4513;
    border-radius: 8px;
    margin-bottom: 12px;
    padding: 15px;
    /* Box maior */
    display: flex;
    align-items: center;
    transition: transform 0.1s;
    cursor: pointer;
    min-height: 80px;
    /* Garante altura */
}

.hero-item:hover {
    transform: scale(1.02);
    background: rgba(255, 255, 255, 0.95);
}

.hero-item.disabled {
    filter: grayscale(1);
    opacity: 0.7;
    cursor: not-allowed;
}

.hero-img {
    width: 80px;
    /* Imagem bem maior */
    height: 80px;
    border-radius: 10px;
    /* Quadrado arredondado em vez de circulo para mostrar mais arte */
    border: 3px solid var(--panel-border);
    margin-right: 15px;
    background: #ccc;
    flex-shrink: 0;
}

.hero-info {
    flex: 1;
}

.hero-name {
    font-weight: bold;
    font-family: 'Shojumaru', cursive;
    font-size: 1.4em;
    color: #b33e00;
    margin-bottom: 5px;
}

.hero-stats {
    font-size: 1.1em;
    color: #333;
    font-weight: bold;
}

.hero-cost {
    font-weight: bold;
    color: #d68910;
    font-size: 1.2em;
}

.hero-level {
    background: var(--panel-border);
    color: #fff;
    padding: 4px 10px;
    border-radius: 12px;
    font-size: 0.9em;
    float: right;
    margin-left: 10px;
}

/* Monster & Battle */
.monster-container {
    text-align: center;
    position: relative;
    cursor: url('../img/kunai_cursor.png') 0 0, crosshair;
}

.monster-visual {
    width: 310px;
    /* Reduzido em 30% (440px √ó 0.7 = 308px, arredondado para 310px) */
    height: 310px;
    margin: 80px auto 0 auto;
    /* Aumenta espa√ßo superior para descer o ninja conforme pedido */
    transition: transform 0.05s;
    display: flex;
    align-items: center;
    justify-content: center;
}

.monster-visual img {
    max-width: 100%;
    max-height: 100%;
    filter: drop-shadow(0 10px 10px rgba(0, 0, 0, 0.5));
}

.monster-visual:active {
    transform: scale(0.95);
}

.shake {
    animation: shake 0.2s;
}

.hit-scale {
    animation: hitScale 0.1s ease-out;
}

@keyframes hitScale {
    0% {
        transform: scale(1);
    }

    50% {
        transform: scale(1.15);
    }

    /* Aumenta levemente */
    100% {
        transform: scale(1);
    }
}

@keyframes shake {
    0% {
        transform: translate(1px, 1px) rotate(0deg);
    }

    10% {
        transform: translate(-1px, -2px) rotate(-1deg);
    }

    20% {
        transform: translate(-3px, 0px) rotate(1deg);
    }

    30% {
        transform: translate(3px, 2px) rotate(0deg);
    }

    40% {
        transform: translate(1px, -1px) rotate(1deg);
    }

    50% {
        transform: translate(-1px, 2px) rotate(-1deg);
    }

    60% {
        transform: translate(-3px, 1px) rotate(0deg);
    }

    70% {
        transform: translate(3px, 1px) rotate(-1deg);
    }

    80% {
        transform: translate(-1px, -1px) rotate(1deg);
    }

    90% {
        transform: translate(1px, 2px) rotate(0deg);
    }

    100% {
        transform: translate(1px, -2px) rotate(-1deg);
    }
}

.monster-hp-bar {
    width: 265px;
    /* Reduzido em 30% para acompanhar o monstro (380px √ó 0.7 = 266px, arredondado para 265px) */
    height: 22px;
    background: #555;
    border: 3px solid #000;
    border-radius: 12px;
    overflow: hidden;
    margin: 5px auto;
}

#hp-fill {
    height: 100%;
    background: linear-gradient(90deg, #ff0000, #ff6600);
    transition: width 0.1s linear;
}

.monster-hp-text {
    font-family: 'Bangers', cursive;
    font-size: 1.5em;
    color: #fff;
    text-shadow: 2px 2px 0 #000;
    margin-top: -22px;
    position: relative;
    z-index: 2;
}

/* Monster Name and Level Display */
.monster-info {
    text-align: center;
    margin-top: 15px;
    pointer-events: none;
}

.monster-name {
    font-family: 'Shojumaru', cursive;
    font-size: 2.2em;
    color: #ff6600;
    text-shadow: 3px 3px 0 #000, 0 0 10px rgba(255, 102, 0, 0.5);
    margin-bottom: 5px;
    font-weight: bold;
    letter-spacing: 2px;
}

.monster-level {
    font-family: 'Bangers', cursive;
    font-size: 1.6em;
    color: #ffd700;
    text-shadow: 2px 2px 0 #000;
    background: rgba(0, 0, 0, 0.6);
    display: inline-block;
    padding: 5px 15px;
    border-radius: 8px;
    border: 2px solid #8b4513;
}

#damage-numbers-container {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 999;
    /* Container acima do inimigo */
}

.damage-number {
    position: absolute;
    font-family: 'Bangers', cursive;
    font-size: 2em;
    color: #fff;
    text-shadow: 2px 2px 0 #000;
    animation: floatUp 1s ease-out forwards;
    z-index: 1000;
    /* Sempre na frente do inimigo */
}

.damage-crit {
    color: #ff0000;
    font-size: 3em;
}

/* Dano Elemental - Cores por Elemento */
.damage-vento {
    color: #00ff00;
    text-shadow: 2px 2px 0 #000, 0 0 10px #00ff00;
}

.damage-trovao,
.damage-raio {
    color: #ffff00;
    text-shadow: 2px 2px 0 #000, 0 0 10px #ffff00;
}

.damage-fogo {
    color: #ff4500;
    text-shadow: 2px 2px 0 #000, 0 0 10px #ff4500;
}

.damage-agua {
    color: #00bfff;
    text-shadow: 2px 2px 0 #000, 0 0 10px #00bfff;
}

.damage-terra {
    color: #8b4513;
    text-shadow: 2px 2px 0 #000, 0 0 10px #ffa500;
}

@keyframes floatUp {
    0% {
        opacity: 1;
        transform: translateY(0) scale(1);
    }

    100% {
        opacity: 0;
        transform: translateY(-100px) scale(1.2);
    }
}

/* Anima√ß√£o de Moedas de Ouro */
.gold-coin {
    position: absolute;
    font-size: 2em;
    color: #ffd700;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8),
        0 0 10px rgba(255, 215, 0, 0.6);
    pointer-events: none;
    z-index: 100;
    animation: coinFall 0.8s ease-out forwards;
}

@keyframes coinFall {
    0% {
        opacity: 1;
        transform: translateY(0) rotate(0deg) scale(1);
    }

    60% {
        opacity: 1;
        transform: translateY(80px) rotate(180deg) scale(1.1);
    }

    100% {
        opacity: 0;
        transform: translateY(120px) rotate(360deg) scale(0.6);
    }
}

/* Headers & Fonts */
h2,
h3 {
    font-family: 'Shojumaru', cursive;
    letter-spacing: 1px;
    margin: 0 0 10px 0;
    color: #2c2c2c;
}

.gold-display {
    font-family: 'Bangers', cursive;
    font-size: 2em;
    color: var(--gold-color);
    text-shadow: 2px 2px 0 #000;
    background: rgba(0, 0, 0, 0.6);
    padding: 10px;
    border-radius: 10px;
    margin-bottom: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.gold-icon {
    height: 30px;
    margin-right: 10px;
}

/* Log Removido, adicionando estilos de Arena */
.arena-selector-container {
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 10px;
    background: rgba(0, 0, 0, 0.5);
    padding: 10px;
    border-radius: 15px;
    border: 2px solid #8b4513;
}

.nav-btn {
    background: #ff6600;
    border: 2px solid #4a0000;
    color: white;
    font-weight: bold;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    cursor: pointer;
    font-family: 'Bangers', cursive;
    font-size: 1.2em;
}

.nav-btn:hover {
    background: #ff8533;
}

.nav-btn:active {
    transform: scale(0.95);
}

.arenas-scroll {
    flex: 1;
    overflow: hidden;
    margin: 0 10px;
    height: 60px;
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
}

#arenas-display {
    display: flex;
    gap: 10px;
    transition: transform 0.3s ease;
}

.arena-box {
    width: 50px;
    height: 50px;
    background: #4a3b2a;
    border: 2px solid #8b4513;
    color: #ffd700;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: 'Bangers', cursive;
    font-size: 1.2em;
    border-radius: 5px;
    cursor: pointer;
    flex-shrink: 0;
    opacity: 0.6;
}

.arena-box.active {
    background: #ff6600;
    border-color: #ffff00;
    transform: scale(1.1);
    opacity: 1;
    box-shadow: 0 0 10px #ff6600;
}

.arena-box.locked {
    background: #222;
    color: #555;
    cursor: not-allowed;
    border-color: #333;
}

/* Upgrade Boxes Compact */
.upgrades-row {
    display: flex;
    gap: 5px;
    margin-top: 5px;
    width: 100%;
    padding-left: 95px;
    /* Alinhar com o nome do heroi (img width + margin) */
}

.upgrade-box {
    width: 30px;
    height: 30px;
    background-color: #4a3b2a;
    border: 2px solid #8b4513;
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 1.2em;
    position: relative;
    transition: all 0.2s;
}

.upgrade-box.locked {
    opacity: 0;
    /* Totalmente invis√≠vel se bloqueado (se n√£o tiver nivel 20, 40...) */
    pointer-events: none;
}

.upgrade-box.available {
    background-color: #5d4a35;
    border-color: #ffd700;
    /* Borda dourada para indicar disponivel */
    animation: pulseBorder 2s infinite;
}

.upgrade-box.bought {
    background-color: #228b22;
    /* Verde comprado */
    border-color: #00ff00;
    box-shadow: 0 0 5px #00ff00;
    cursor: default;
}

/* Tooltip (S√≥ no hover) */
.tooltip {
    visibility: hidden;
    background-color: rgba(0, 0, 0, 0.95);
    color: #fff;
    text-align: left;
    border-radius: 6px;
    padding: 8px;
    position: absolute;
    z-index: 1000;
    bottom: 125%;
    left: 50%;
    margin-left: -60px;
    width: 150px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
    border: 1px solid #ffd700;
    font-size: 0.8em;
    font-family: 'Roboto', sans-serif;
    pointer-events: none;
    opacity: 0;
    transition: opacity 0.2s;
}

.upgrade-box:hover .tooltip {
    visibility: visible;
    opacity: 1;
}

@keyframes pulseBorder {
    0% {
        border-color: #ffd700;
    }

    50% {
        border-color: #ffaa00;
    }

    100% {
        border-color: #ffd700;
    }
}

.zone-progress-info {
    text-align: center;
    font-family: 'Shojumaru', cursive;
    color: #ffd700;
    background: transparent;
    padding: 0;
    margin-bottom: 20px;
    /* Mais espa√ßo para a barra de vida abaixo */
    margin-top: -20px;
    /* Sobe um pouco mais */
    font-size: 2.8em;
    /* Aumentado levemente */
    text-shadow: 4px 4px 0 #000;
    z-index: 10;
}

/* Boss Timer */
.boss-timer {
    text-align: center;
    font-family: 'Bangers', cursive;
    color: #ff4444;
    background: rgba(0, 0, 0, 0.7);
    padding: 10px 20px;
    margin: -10px auto 20px auto;
    border-radius: 15px;
    font-size: 2.5em;
    text-shadow: 3px 3px 0 #000;
    border: 3px solid #ff0000;
    box-shadow: 0 0 20px rgba(255, 0, 0, 0.5);
    width: fit-content;
    animation: timerPulse 1s infinite;
}

.boss-timer.warning {
    animation: timerWarning 0.5s infinite;
    color: #ff0000;
    border-color: #ff0000;
}

@keyframes timerPulse {

    0%,
    100% {
        transform: scale(1);
    }

    50% {
        transform: scale(1.05);
    }
}

@keyframes timerWarning {

    0%,
    100% {
        transform: scale(1);
        box-shadow: 0 0 20px rgba(255, 0, 0, 0.8);
    }

    50% {
        transform: scale(1.1);
        box-shadow: 0 0 30px rgba(255, 0, 0, 1);
    }
}


/* HERO ITEM REDESIGN (Reference Style) */
.hero-item-new {
    background: #fdf5e6;
    /* Cor de papiro claro */
    border-radius: 12px;
    margin-bottom: 25px;
    padding: 10px;
    position: relative;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    border: 2px solid #dba669;
    min-height: 180px;
    /* Garante espa√ßo para imagem full */
}

/* Header: Nome e Nivel */
.hero-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-end;
    /* Alinha na base do texto */
    margin-bottom: 5px;
    border-bottom: 1px dashed #dba669;
    padding-bottom: 5px;
}

.hero-name-title {
    font-family: 'Shojumaru', cursive;
    font-size: 1.6em;
    color: #333;
    text-shadow: 1px 1px 0 #fff;
    margin-left: 5px;
}

.hero-level-badge {
    font-family: 'Bangers', cursive;
    font-size: 2em;
    color: #fff;
    text-shadow: 2px 2px 0 #000;
}

/* Body: Esquerda (Botao + Skills) | Direita (Imagem) */
.hero-body-row {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
}

.left-section {
    display: flex;
    flex-direction: row;
    /* Botao e Skills lado a lado */
    align-items: center;
    gap: 15px;
    margin-top: 10px;
}

/* Bot√£o de Compra (Azul/Dourado estilo fish game) */
.buy-box {
    background: linear-gradient(to bottom, #4facfe 0%, #00f2fe 100%);
    width: 130px;
    height: 70px;
    border-radius: 10px;
    border: 4px solid #ffd700;
    box-shadow: 0 4px 0 #0056b3, 0 5px 10px rgba(0, 0, 0, 0.3);
    cursor: pointer;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    transition: transform 0.1s;
}

.buy-box:active {
    transform: translateY(4px);
    box-shadow: 0 0 0 #0056b3;
}

.buy-box.locked {
    background: #555;
    border-color: #333;
    cursor: not-allowed;
    box-shadow: none;
}

.buy-action {
    font-family: 'Bangers', cursive;
    font-size: 1.5em;
    color: #fff;
    text-shadow: 1px 1px 0 #000;
    line-height: 1;
}

.buy-cost {
    font-family: 'Roboto', sans-serif;
    font-weight: bold;
    font-size: 1em;
    color: #fff4e6;
    text-shadow: 1px 1px 0 #000;
    margin-top: 2px;
}

/* Skills Container */
.upgrades-container {
    display: flex;
    gap: 8px;
}

.upgrade-box-new {
    width: 45px;
    height: 45px;
    background: #3e2723;
    border: 3px solid #5d4037;
    border-radius: 6px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5em;
    cursor: pointer;
    position: relative;
    box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.8);
}

.upgrade-box-new.locked {
    opacity: 0;
    pointer-events: none;
}

.upgrade-box-new.available {
    background: #5d4037;
    border-color: #ffd700;
    animation: pulseBorder 2s infinite;
}

.upgrade-box-new.bought {
    border-color: #00ff00;
}

.check-mark {
    position: absolute;
    top: -5px;
    right: -5px;
    color: #00ff00;
    font-size: 1em;
    text-shadow: 1px 1px 0 #000;
    font-weight: bold;
}

/* Imagem do Heroi (Full Body, Saindo pra fora se precisar) */
.hero-image-container {
    width: 200px;
    /* Largura fixa para imagem */
    height: 250px;
    margin-top: -60px;
    /* Puxa pra cima para sobrepor header se quiser, ou ajustar */
    margin-right: -10px;
    display: flex;
    align-items: flex-end;
    justify-content: center;
    pointer-events: none;
    /* Deixar clicar atrav√©s se precisar */
    overflow: hidden;
    /* Corta se for muito grande */
}

.hero-full-img {
    max-height: 100%;
    max-width: 100%;
    filter: drop-shadow(5px 5px 10px rgba(0, 0, 0, 0.4));
    transition: transform 0.2s;
}

.hero-item-new:hover .hero-full-img {
    transform: scale(1.05);
}

/* HERO CONTAINER (Holds Title + Card) */
.hero-card-split {
    background: transparent;
    border: none;
    box-shadow: none;
    margin-bottom: 30px;
    display: flex;
    flex-direction: column;
}

/* NAME HEADER OUTSIDE */
.hero-title-header {
    font-family: 'Shojumaru', cursive;
    font-size: 1.4em;
    /* Reduzido */
    color: #e65100;
    text-shadow: 2px 2px 0 #fff;
    text-align: left;
    /* Alinhado com a esquerda da caixa */
    margin-bottom: 2px;
    /* Espa√ßo positivo, sem sobrepor */
    z-index: 10;
    position: relative;
    width: 100%;
    /* Permitir largura total */
    padding-left: 20px;
    white-space: nowrap;
    /* For√ßar uma linha */
    display: flex;
    align-items: center;
    gap: 10px;
}

.hero-element-icon {
    height: 28px;
    width: auto;
    filter: drop-shadow(0 2px 2px rgba(0, 0, 0, 0.3));
}

/* THE ACTUAL CARD BOX */
.hero-card-inner-split {
    background: #fff;
    border: 3px solid #8b4513;
    border-radius: 12px;
    display: flex;
    flex-direction: row;
    height: 190px;
    /* Altura reduzida para quadrado aproximado */
    position: relative;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
    overflow: visible;
    /* Permitir que o overlay saia pra fora */
    z-index: 1;
    margin-top: 5px;
}

/* LEFT COLUMN (50%) */
.card-left-col {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    /* Imagem no topo */
    padding: 0;
    /* Sem padding para imagem encostar */
    background: #fff;
    border-right: none;
    /* Removida a linha pontilhada */
    position: relative;
    overflow: hidden;
    /* Cortar excesso */
}

.hero-image-wrapper {
    width: 100%;
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: flex-start;
    /* Alinhar topo */
    position: relative;
    padding: 0;
}

.hero-full-body-img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: top center;
    image-rendering: -webkit-optimize-contrast;
    image-rendering: crisp-edges;
    filter: drop-shadow(0 5px 5px rgba(0, 0, 0, 0.3));
    transition: transform 0.3s ease;
    /* Transi√ß√£o mais suave */
    margin: 0;
    cursor: pointer;
}

.hero-full-body-img:hover {
    transform: scale(1.1);
    z-index: 10;
}

/* RIGHT COLUMN (50%) */
.card-right-col {
    flex: 1;
    display: flex;
    flex-direction: column;
    padding: 10px 15px;
    background: rgba(255, 255, 255, 0.9);
    border-top-right-radius: 8px;
    border-bottom-right-radius: 8px;
    justify-content: flex-start;
    gap: 8px;
    /* Espa√ßo uniforme entre os elementos */
    position: relative;
}

.hero-level-display {
    font-family: 'Bangers', cursive;
    font-size: 2.2em;
    color: #333;
    border-bottom: 2px solid #ff6600;
    margin-bottom: 5px;
    text-align: right;
}

/* OVERLAY DETALHES (Preto com opacidade) Popup */
.hero-stats-overlay {
    position: absolute;
    top: -10px;
    /* Mais pra cima */
    right: -10px;
    /* Mais pra direita */
    width: 200px;
    height: auto;
    min-height: 60px;
    background: rgba(0, 0, 0, 0.9);
    color: #fff;
    padding: 15px;
    z-index: 100;
    opacity: 0;
    pointer-events: none;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    transform: translateY(10px);
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    border-radius: 8px;
    border: 1px solid #ff9800;
    font-family: 'Roboto', sans-serif;
    text-align: left;
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.5);
}

/* Abrir ao passar o mouse apenas na Imagem ou no Bot√£o de Upgrade */
.hero-card-inner-split:hover .hero-stats-overlay {
    opacity: 0;
}

.hero-card-inner-split:has(.card-left-col:hover) .hero-stats-overlay,
.hero-card-inner-split:has(.hero-buy-btn:hover) .hero-stats-overlay {
    opacity: 1;
    transform: translateY(0);
}

.overlay-title {
    font-family: 'Shojumaru', cursive;
    color: #ff9800;
    font-size: 1.1em;
    margin-bottom: 8px;
    border-bottom: 1px solid #444;
    padding-bottom: 4px;
}

.stat-line {
    font-size: 1em;
    margin: 3px 0;
}

.stat-line strong {
    color: #ffd700;
}

.dps-increment {
    color: #4caf50;
    font-weight: bold;
    margin-left: 5px;
    text-shadow: 0 0 5px rgba(76, 175, 80, 0.5);
}

.stat-line-desc {
    font-size: 0.85em;
    color: #bbb;
    margin-top: 5px;
    line-height: 1.2;
}

hr {
    border: 0;
    border-top: 1px solid #444;
    margin: 8px 0;
}

.hero-skills-row {
    display: flex;
    gap: 12px;
    /* Mais espa√ßo entre √≠cones */
    margin: 10px 0 10px 15px;
    /* Adicionado 15px na esquerda para chegar pra direita */
    min-height: 50px;
    align-items: center;
    justify-content: flex-start;
}

.skill-box {
    width: 45px;
    height: 45px;
    background: #1a1a1a;
    border-radius: 8px;
    border: 2px solid #5d4037;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    position: relative;
    overflow: visible;
    /* Permitir que o pergaminho ultrapasse */
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
    transition: transform 0.1s;
    user-select: none;
    /* N√£o selecion√°vel */
    outline: none;
    /* Sem outline */
}

.skill-box:hover:not(.locked) {
    transform: scale(1.1);
    z-index: 10;
}

.skill-img-icon {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 6px;
    /* Arredondar cantos da imagem */
    overflow: hidden;
    /* Cortar imagem nos cantos */
}

.skill-icon {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 6px;
    overflow: hidden;
    /* Cortar conte√∫do nos cantos arredondados */
}

.skill-box.locked {
    opacity: 0.3;
    filter: grayscale(1);
    cursor: pointer;
}

.skill-box.locked.affordable {
    opacity: 0.6;
    filter: grayscale(0.5);
    border-color: #ffd700;
    box-shadow: 0 0 8px rgba(255, 215, 0, 0.4);
}

.skill-box.available {
    background: #5d4037;
    border-color: #ffd700;
    animation: pulseBorder 1.5s infinite;
}

/* Miss√£o em andamento - opacidade intermedi√°ria */
.skill-box.available.in-progress {
    opacity: 0.7;
    filter: brightness(0.8) saturate(0.8);
}

.skill-box.bought {
    border-color: #00ff00;
    cursor: pointer;
    /* Clic√°vel para ver buffs no modal */
    user-select: none;
    /* N√£o selecion√°vel */
    outline: none;
    /* Sem outline */
}

.skill-check {
    position: absolute;
    top: -8px;
    right: -8px;
    color: #00ff00;
    font-size: 1.2em;
    font-weight: bold;
    text-shadow: 1px 1px 0 #000;
}

/* √çcone de miss√£o em andamento */
.skill-mission-active {
    position: absolute;
    top: -12px;
    /* Mais para cima para ultrapassar */
    right: -12px;
    /* Mais para direita para ultrapassar */
    font-size: 1.8em;
    /* Maior para ser mais vis√≠vel */
    animation: scrollPulse 2s infinite;
    filter: drop-shadow(0 0 5px rgba(255, 215, 0, 1)) drop-shadow(0 0 10px rgba(255, 215, 0, 0.8));
    z-index: 100;
    /* Z-index muito alto para ficar acima de tudo */
    opacity: 1 !important;
    pointer-events: none;
    /* N√£o interferir com cliques */
}

/* Garantir que o pergaminho n√£o seja afetado pelo filtro da skill pai */
.skill-box.in-progress .skill-mission-active {
    opacity: 1 !important;
    filter: drop-shadow(0 0 5px rgba(255, 215, 0, 1)) drop-shadow(0 0 10px rgba(255, 215, 0, 0.8)) !important;
}

@keyframes scrollPulse {

    0%,
    100% {
        transform: scale(1) rotate(0deg);
    }

    50% {
        transform: scale(1.15) rotate(5deg);
    }
}

/* Tooltip das habilidades */
.skill-box .tooltip {
    visibility: hidden;
    opacity: 0;
    position: absolute;
    bottom: 120%;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0, 0, 0, 0.95);
    color: #fff;
    padding: 12px 16px;
    border-radius: 8px;
    border: 2px solid #ffd700;
    font-size: 0.9em;
    white-space: normal;
    /* Permitir quebras de linha */
    z-index: 1000;
    pointer-events: none;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.8);
    min-width: 200px;
    max-width: 300px;
    /* Largura m√°xima */
    text-align: left;
    line-height: 1.4;
    /* Espa√ßamento entre linhas */
    transition: opacity 0.2s, visibility 0.2s;
}

/* Seta do tooltip */
.skill-box .tooltip::after {
    content: '';
    position: absolute;
    top: 100%;
    left: 50%;
    transform: translateX(-50%);
    border: 8px solid transparent;
    border-top-color: #ffd700;
}


/* Mostrar tooltip APENAS para skills completadas */
.skill-box.bought:hover .tooltip {
    visibility: visible !important;
    opacity: 1 !important;
}

/* Garantir que skills locked, available e in-progress N√ÉO mostrem tooltip */
.skill-box.locked:hover .tooltip,
.skill-box.available:hover .tooltip,
.skill-box.in-progress:hover .tooltip {
    visibility: hidden !important;
    opacity: 0 !important;
}

/* API Button at Bottom Right */
.hero-buy-btn {
    background: linear-gradient(to bottom, #ff9800 0%, #f57c00 100%);
    border: 2px solid #e65100;
    border-radius: 6px;
    padding: 5px 10px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    cursor: pointer;
    box-shadow: 0 3px 0 #bf360c;
    transition: active 0.1s;
    margin-top: 5px;
}

.hero-buy-btn:active {
    transform: translateY(3px);
    box-shadow: none;
}

.hero-buy-btn.locked {
    background: #777;
    border-color: #555;
    box-shadow: none;
    cursor: not-allowed;
    justify-content: center;
    color: #ccc;
}

.buy-label {
    font-family: 'Bangers', cursive;
    color: white;
    font-size: 1.2em;
}

.buy-value {
    font-weight: bold;
    color: #fff;
    font-size: 1em;
}

.hero-buy-btn.disabled {
    background: #9e9e9e;
    border-color: #757575;
    cursor: not-allowed;
    box-shadow: none;
    opacity: 0.8;
}

/* Mobile Adjust */
@media (max-width: 900px) {
    .hero-card-split {
        height: auto;
        flex-direction: column;
    }

    .card-left-col {
        border-right: none;
        border-bottom: 2px dashed #dba669;
    }

    .hero-image-wrapper {
        min-height: 200px;
    }

    .hero-full-body-img {
        height: auto;
        max-height: 250px;
    }
}

/* ===== BACKPACK ICON ===== */
.backpack-icon {
    font-size: 1.2em;
    cursor: pointer;
    margin-left: 20px;
    display: inline-block;
    transition: transform 0.2s ease, filter 0.2s ease;
    filter: drop-shadow(2px 2px 4px rgba(0, 0, 0, 0.5));
}

.backpack-icon:hover {
    transform: scale(1.15) rotate(-5deg);
    filter: drop-shadow(3px 3px 6px rgba(139, 69, 19, 0.8));
}

.backpack-icon:active {
    transform: scale(1.05);
}

/* ===== MODAL OVERLAY ===== */
.modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.85);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 9999;
    backdrop-filter: blur(5px);
    animation: fadeIn 0.3s ease;
}

@keyframes fadeIn {
    from {
        opacity: 0;
    }

    to {
        opacity: 1;
    }
}

/* ===== BACKPACK MODAL ===== */
.backpack-modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: rgba(0, 0, 0, 0.85);
    backdrop-filter: blur(5px);
    z-index: 10000;
    display: none;
    align-items: center;
    justify-content: center;
}

.backpack-modal.active {
    display: flex;
}

.backpack-container {
    background: linear-gradient(135deg, #d4a574 0%, #c89860 50%, #b8885a 100%);
    border: 6px solid #8b6f47;
    border-radius: 20px;
    box-shadow: 0 15px 50px rgba(0, 0, 0, 0.8),
        inset 0 2px 10px rgba(255, 255, 255, 0.2);
    width: 90%;
    max-width: 900px;
    max-height: 85vh;
    overflow: hidden;
    position: relative;
    animation: modalSlideIn 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

@keyframes modalSlideIn {
    from {
        transform: scale(0.7);
        opacity: 0;
    }

    to {
        transform: scale(1);
        opacity: 1;
    }
}

.modal-header {
    background: linear-gradient(to bottom, #8b6f47, #6d5638);
    padding: 20px 30px;
    border-bottom: 4px solid #5d4a2f;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.4);
}

.modal-header h2 {
    font-family: 'Shojumaru', cursive;
    font-size: 2.2em;
    color: #fff;
    text-shadow: 3px 3px 0 #000,
        -1px -1px 0 #000,
        1px -1px 0 #000,
        -1px 1px 0 #000,
        0 0 15px rgba(255, 215, 0, 0.5);
    margin: 0;
}

.modal-close {
    background: #d32f2f;
    border: 3px solid #8b0000;
    color: #fff;
    font-size: 1.8em;
    font-weight: bold;
    width: 45px;
    height: 45px;
    border-radius: 50%;
    cursor: pointer;
    transition: all 0.2s ease;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.4);
    display: flex;
    align-items: center;
    justify-content: center;
}

.modal-close:hover {
    background: #ff5252;
    transform: rotate(90deg) scale(1.1);
    box-shadow: 0 6px 12px rgba(255, 0, 0, 0.6);
}

.modal-close:active {
    transform: rotate(90deg) scale(0.95);
}

.modal-body {
    padding: 30px;
    overflow-y: auto;
    max-height: calc(85vh - 100px);
    background: linear-gradient(to bottom, rgba(255, 255, 255, 0.1), rgba(0, 0, 0, 0.1));
}

/* ===== INVENTORY GRID ===== */
.inventory-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(90px, 1fr));
    gap: 15px;
    padding: 10px;
}

.inventory-slot {
    width: 90px;
    height: 90px;
    background: linear-gradient(135deg, #8b0000, #a52a2a);
    border: 4px solid #5d0000;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.6),
        0 4px 10px rgba(0, 0, 0, 0.5);
}

.inventory-slot:hover {
    transform: translateY(-5px) scale(1.05);
    box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.6),
        0 8px 20px rgba(255, 215, 0, 0.4);
    border-color: #ffd700;
}

.inventory-slot.empty::before {
    content: 'üîí';
    font-size: 2.5em;
    opacity: 0.3;
    filter: grayscale(1);
}

.inventory-slot.has-item {
    background: linear-gradient(135deg, #1a472a, #2e7d32);
    border-color: #1b5e20;
}

.inventory-slot.has-item:hover {
    border-color: #4caf50;
}

.item-icon {
    font-size: 3em;
    filter: drop-shadow(2px 2px 4px rgba(0, 0, 0, 0.8));
}

.item-count {
    position: absolute;
    bottom: 5px;
    right: 8px;
    background: rgba(0, 0, 0, 0.85);
    color: #fff;
    font-size: 0.9em;
    font-weight: bold;
    padding: 2px 6px;
    border-radius: 8px;
    border: 2px solid #ffd700;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.6);
}

/* ===== ADMIN PANEL ===== */
#admin-trigger {
    position: fixed;
    bottom: 20px;
    right: 20px;
    width: 50px;
    height: 50px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border: 3px solid #4a5568;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.8em;
    cursor: pointer;
    z-index: 8888;
    transition: all 0.3s ease;
    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
}

#admin-trigger:hover {
    transform: scale(1.15) rotate(90deg);
    box-shadow: 0 6px 25px rgba(102, 126, 234, 0.7);
}

.admin-modal {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border: 6px solid #4a5568;
    border-radius: 20px;
    box-shadow: 0 15px 50px rgba(0, 0, 0, 0.8),
        inset 0 2px 10px rgba(255, 255, 255, 0.2);
    width: 90%;
    max-width: 500px;
    overflow: hidden;
    position: relative;
    animation: modalSlideIn 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

.admin-input-group {
    display: flex;
    flex-direction: column;
    gap: 15px;
    padding: 10px;
}

.admin-input-group label {
    font-family: 'Shojumaru', cursive;
    font-size: 1.3em;
    color: #fff;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
}

.admin-input-group input {
    padding: 12px 15px;
    font-size: 1.2em;
    border: 3px solid #4a5568;
    border-radius: 10px;
    background: rgba(255, 255, 255, 0.95);
    color: #333;
    font-weight: bold;
    transition: all 0.3s ease;
}

.admin-input-group input:focus {
    outline: none;
    border-color: #ffd700;
    box-shadow: 0 0 15px rgba(255, 215, 0, 0.5);
}

.admin-btn {
    padding: 15px 30px;
    font-size: 1.3em;
    font-weight: bold;
    background: linear-gradient(to bottom, #ffd700, #ffb700);
    border: 3px solid #8b6f00;
    border-radius: 12px;
    color: #000;
    cursor: pointer;
    transition: all 0.2s ease;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.4);
    text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.5);
}

.admin-btn:hover {
    background: linear-gradient(to bottom, #ffed4e, #ffd700);
    transform: translateY(-2px);
    box-shadow: 0 6px 15px rgba(255, 215, 0, 0.6);
}

.admin-btn:active {
    transform: translateY(0);
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.4);
}

/* Elemental Cycle Guide */
.elemental-cycle-guide {
    position: absolute;
    top: 100px;
    right: 20px;
    width: 250px;
    height: auto;
    z-index: 100;
    pointer-events: none;
    filter: drop-shadow(0 0 15px rgba(0, 0, 0, 0.6));
    opacity: 1;
    transition: opacity 0.3s ease;
}

.center-panel:hover .elemental-cycle-guide {
    opacity: 0.7;
}

/* Item Drop Notification - Redesenhada */
.item-drop-notification {
    position: fixed;
    bottom: 120px;
    right: 30px;
    background: linear-gradient(135deg, rgba(45, 27, 0, 0.95) 0%, rgba(93, 58, 26, 0.95) 100%);
    border: 3px solid #ffd700;
    border-radius: 10px;
    padding: 12px 18px;
    z-index: 10000;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.6), 0 0 20px rgba(255, 215, 0, 0.3);
    animation: dropSlideIn 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55), dropFadeOut 0.4s ease-in 2.6s forwards;
    pointer-events: none;
    display: flex;
    align-items: center;
    gap: 12px;
    max-width: 280px;
}

.item-drop-notification img {
    width: 45px;
    height: 45px;
    flex-shrink: 0;
    filter: drop-shadow(0 2px 6px rgba(255, 215, 0, 0.4));
}

.item-drop-notification .drop-content {
    display: flex;
    flex-direction: column;
    gap: 2px;
}

.item-drop-notification .drop-text {
    font-family: 'Bangers', cursive;
    font-size: 1.1em;
    color: #ffd700;
    text-shadow: 1px 1px 3px #000;
    letter-spacing: 0.5px;
    line-height: 1;
}

.item-drop-notification .item-name {
    font-family: 'Roboto', sans-serif;
    font-size: 0.95em;
    font-weight: 500;
    color: #f0e6d2;
    text-shadow: 1px 1px 2px #000;
    line-height: 1.2;
}

@keyframes dropSlideIn {
    0% {
        opacity: 0;
        transform: translateX(100px);
    }

    100% {
        opacity: 1;
        transform: translateX(0);
    }
}

@keyframes dropFadeOut {
    0% {
        opacity: 1;
        transform: translateX(0);
    }

    100% {
        opacity: 0;
        transform: translateX(50px);
    }
}

/* Item Icon Image in Inventory */
.item-icon-img {
    max-width: 50px;
    max-height: 50px;
    width: auto;
    height: auto;
    object-fit: contain;
    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
}

/* ===== SISTEMA DE MOCHILA - DESIGN MODERNO E PROFISSIONAL ===== */

/* Modal Backdrop */
.backpack-modal {
    display: flex !important;
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
    width: 100vw !important;
    height: 100vh !important;
    background: rgba(0, 0, 0, 0.5);
    backdrop-filter: blur(4px);
    z-index: 99999 !important;
    justify-content: center !important;
    align-items: center !important;
    animation: fadeIn 0.2s ease-out;
    visibility: hidden;
    opacity: 0;
    transition: opacity 0.2s, visibility 0.2s;
}

.backpack-modal.active {
    visibility: visible;
    opacity: 1;
}

@keyframes fadeIn {
    from {
        opacity: 0;
    }

    to {
        opacity: 1;
    }
}

/* Container Principal */
.backpack-container {
    background: linear-gradient(145deg, #1a1a1a 0%, #2d2d2d 100%);
    border: 1px solid #404040;
    border-radius: 12px;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.8), 0 0 0 1px rgba(255, 255, 255, 0.05);
    max-width: 700px;
    width: 90%;
    max-height: 85vh;
    overflow: hidden;
    animation: slideUp 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    margin: auto;
}

@keyframes slideUp {
    from {
        opacity: 0;
        transform: translateY(30px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Header */
.backpack-header {
    background: linear-gradient(135deg, #2a2a2a 0%, #1f1f1f 100%);
    border-bottom: 1px solid #404040;
    padding: 20px 25px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.backpack-title {
    display: flex;
    align-items: center;
    gap: 12px;
    font-family: 'Roboto', sans-serif;
    font-size: 1.4em;
    font-weight: 600;
    color: #e0e0e0;
    letter-spacing: 0.5px;
}

.close-backpack {
    background: transparent;
    border: none;
    color: #999;
    font-size: 1.8em;
    cursor: pointer;
    width: 36px;
    height: 36px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 6px;
    transition: all 0.2s;
}

.close-backpack:hover {
    background: rgba(255, 255, 255, 0.05);
    color: #fff;
}

/* Body */
.backpack-body {
    padding: 25px;
    max-height: calc(85vh - 80px);
    overflow-y: auto;
}

.backpack-body::-webkit-scrollbar {
    width: 8px;
}

.backpack-body::-webkit-scrollbar-track {
    background: #1a1a1a;
    border-radius: 4px;
}

.backpack-body::-webkit-scrollbar-thumb {
    background: #404040;
    border-radius: 4px;
}

.backpack-body::-webkit-scrollbar-thumb:hover {
    background: #505050;
}

/* Grid de Invent√°rio */
.inventory-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, 70px);
    gap: 10px;
    padding: 5px;
}

/* Slots */
.inventory-slot {
    width: 70px;
    height: 70px;
    background: linear-gradient(145deg, #242424 0%, #1a1a1a 100%);
    border: 1px solid #333;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    transition: all 0.2s;
    cursor: default;
    box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.5);
    overflow: hidden;
}

.inventory-slot.empty {
    opacity: 0.4;
}

.inventory-slot.empty:hover {
    background: linear-gradient(145deg, #2a2a2a 0%, #202020 100%);
    border-color: #3a3a3a;
}

.inventory-slot.has-item {
    background: linear-gradient(145deg, #2d2d2d 0%, #232323 100%);
    border-color: #4a4a4a;
    opacity: 1;
    cursor: pointer;
}

.inventory-slot.has-item:hover {
    background: linear-gradient(145deg, #353535 0%, #2a2a2a 100%);
    border-color: #5a5a5a;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.6), inset 0 1px 2px rgba(255, 255, 255, 0.05);
}

/* √çcone do Item */
.item-icon {
    font-size: 2em;
    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.5));
    max-width: 90%;
    max-height: 90%;
    line-height: 1;
}

/* Contador de Itens */
.item-count {
    position: absolute;
    bottom: 4px;
    right: 4px;
    background: rgba(0, 0, 0, 0.85);
    color: #fff;
    font-family: 'Roboto', sans-serif;
    font-size: 0.75em;
    font-weight: 600;
    padding: 2px 6px;
    border-radius: 4px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
    line-height: 1;
}

/* √çcone da Mochila no Header */
.backpack-icon {
    cursor: pointer;
    font-size: 0.9em;
    transition: transform 0.2s;
    display: inline-block;
    margin-left: 8px;
}

.backpack-icon:hover {
    transform: scale(1.15);
}

/* ===== ANIMA√á√ÉO DE DIAMANTES ===== */
.diamond-drop {
    position: absolute;
    font-size: 2em;
    pointer-events: none;
    z-index: 100;
    animation: diamondFall 1s ease-out forwards;
    filter: drop-shadow(0 0 8px rgba(0, 212, 255, 0.8));
}

@keyframes diamondFall {
    0% {
        transform: translateY(0) scale(1);
        opacity: 1;
    }

    50% {
        transform: translateY(-30px) scale(1.2);
        opacity: 1;
    }

    100% {
        transform: translateY(60px) scale(0.5);
        opacity: 0;
    }
}

/* ===== MODAL DE MISS√ÉO ===== */
.mission-container {
    background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
    border: 4px solid #00d4ff;
    border-radius: 20px;
    box-shadow: 0 15px 50px rgba(0, 212, 255, 0.5),
        inset 0 2px 10px rgba(0, 212, 255, 0.2);
    width: 90%;
    max-width: 700px;
    max-height: 85vh;
    overflow-y: auto;
    position: relative;
    animation: modalSlideIn 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

.mission-header {
    background: linear-gradient(135deg, #00d4ff 0%, #0088cc 100%);
    padding: 15px 20px;
    border-radius: 16px 16px 0 0;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 3px solid #00ffff;
}

.mission-title {
    display: flex;
    align-items: center;
    gap: 10px;
    font-family: 'Bangers', cursive;
    font-size: 1.8em;
    color: #fff;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
}

.close-mission {
    background: rgba(255, 0, 0, 0.8);
    border: 2px solid #fff;
    border-radius: 50%;
    width: 35px;
    height: 35px;
    font-size: 1.2em;
    color: #fff;
    cursor: pointer;
    transition: all 0.2s;
}

.close-mission:hover {
    background: rgba(255, 0, 0, 1);
    transform: scale(1.1);
}

.mission-body {
    padding: 20px;
}

.mission-details {
    color: #fff;
}

.mission-icon {
    font-size: 4em;
    text-align: center;
    margin-bottom: 10px;
    filter: drop-shadow(0 0 10px rgba(0, 212, 255, 0.8));
}

.mission-details h3 {
    font-family: 'Bangers', cursive;
    font-size: 2em;
    text-align: center;
    color: #00d4ff;
    margin: 10px 0;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
}

.mission-subtitle {
    text-align: center;
    font-style: italic;
    color: #aaa;
    margin-bottom: 20px;
}

.mission-section {
    background: rgba(0, 0, 0, 0.3);
    padding: 12px;
    border-radius: 8px;
    margin-bottom: 12px;
    border-left: 4px solid #00d4ff;
    border-top: 4px solid #00d4ff;
}

.mission-section h4 {
    margin: 0 0 8px 0;
    color: #00d4ff;
    font-size: 1.1em;
}

.mission-section p {
    margin: 0;
    line-height: 1.6;
}

/* Se√ß√£o de Efeitos - Tem√°tica Vermelha */
.mission-section-effect {
    background: rgba(0, 0, 0, 0.3);
    padding: 12px;
    border-radius: 8px;
    margin-bottom: 12px;
    border-left: 4px solid #ff4444;
    border-top: 4px solid #ff4444;
}

.mission-section-effect h4 {
    margin: 0 0 8px 0;
    color: #ff4444;
    font-size: 1.1em;
}

.mission-section-effect p {
    margin: 0;
    line-height: 1.6;
}

.mission-section.bonus {
    border-left-color: #6c9;
    border-top-color: #6c9;
    background: rgba(102, 204, 153, 0.15);
}

.mission-section.bonus h4 {
    color: #6c9;
}

.mission-section.objective {
    border-left-color: #f9c74f;
    border-top-color: #f9c74f;
    background: rgba(249, 199, 79, 0.15);
}

.mission-section.objective h4 {
    color: #f9c74f;
}

.mission-section.reward {
    border-left-color: #b565d8;
    border-top-color: #b565d8;
    background: rgba(181, 101, 216, 0.15);
}

.mission-section.reward h4 {
    color: #b565d8;
}

.mission-cost {
    background: linear-gradient(135deg, rgba(0, 212, 255, 0.2), rgba(0, 136, 204, 0.2));
    padding: 15px;
    border-radius: 10px;
    margin: 20px 0 10px 0;
    text-align: center;
    border: 2px solid #00d4ff;
}

.cost-label {
    display: block;
    font-size: 0.9em;
    color: #aaa;
    margin-bottom: 5px;
}

.cost-value {
    display: block;
    font-family: 'Bangers', cursive;
    font-size: 2em;
    color: #00d4ff;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
}

.player-diamonds {
    text-align: center;
    font-size: 1.1em;
    margin-bottom: 20px;
}

.player-diamonds .enough {
    color: #00ff00;
    font-weight: bold;
}

.player-diamonds .not-enough {
    color: #ff0000;
    font-weight: bold;
}

.mission-actions {
    display: flex;
    justify-content: center;
    margin-top: 20px;
}

.mission-btn {
    padding: 12px 40px;
    font-family: 'Bangers', cursive;
    font-size: 1.3em;
    border: none;
    border-radius: 10px;
    cursor: pointer;
    transition: all 0.2s;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
}

.mission-btn.purchase {
    background: linear-gradient(135deg, #00ff00, #00aa00);
    color: #fff;
    border: 2px solid #00ff00;
}

.mission-btn.purchase:hover:not(:disabled) {
    background: linear-gradient(135deg, #00ff00, #00cc00);
    transform: scale(1.05);
    box-shadow: 0 0 20px rgba(0, 255, 0, 0.6);
}

.mission-btn.purchase:disabled {
    background: #555;
    border-color: #777;
    color: #999;
    cursor: not-allowed;
    opacity: 0.5;
}

/* Estilos para Miss√£o Lend√°ria (Skill 4) */
.mission-part {
    background: rgba(0, 0, 0, 0.3);
    padding: 15px;
    border-radius: 8px;
    margin: 10px 0;
    border: 2px solid #8b4513;
}

.mission-part.completed {
    background: rgba(0, 150, 0, 0.2);
    border-color: #00ff00;
}

.mission-part h4 {
    margin: 0 0 10px 0;
    color: #ffd700;
    font-family: 'Bangers', cursive;
    font-size: 1.3em;
}

.mission-part p {
    margin: 5px 0;
    color: #fff;
}

.progress-bar {
    background: rgba(0, 0, 0, 0.5);
    border-radius: 10px;
    height: 30px;
    margin: 10px 0;
    position: relative;
    overflow: hidden;
    border: 2px solid #8b4513;
}

.progress-fill {
    background: linear-gradient(90deg, #00ff00, #00aa00);
    height: 100%;
    border-radius: 8px;
    transition: width 0.3s ease;
}

.progress-text {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-weight: bold;
    color: #fff;
    text-shadow: 1px 1px 2px #000;
    font-family: 'Bangers', cursive;
    font-size: 1.1em;
}

.complete-part-btn {
    background: linear-gradient(135deg, #00ff00, #00aa00);
    color: #000;
    border: 2px solid #00ff00;
    padding: 10px 20px;
    font-family: 'Bangers', cursive;
    font-size: 1.2em;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.2s;
    margin: 10px 0;
}

.complete-part-btn:hover:not(:disabled) {
    background: linear-gradient(135deg, #00ff44, #00cc00);
    transform: scale(1.05);
    box-shadow: 0 0 15px rgba(0, 255, 0, 0.5);
}

.complete-part-btn:disabled {
    background: #555;
    border-color: #777;
    color: #999;
    cursor: not-allowed;
    opacity: 0.5;
}

.mission-section.legendary {
    background: linear-gradient(135deg, rgba(255, 215, 0, 0.2), rgba(255, 140, 0, 0.2));
    border: 2px solid #ffd700;
    box-shadow: 0 0 15px rgba(255, 215, 0, 0.3);
}

/* ========================================
   SKILL BOX AFFORDABLE (DIAMANTES DISPON√çVEIS)
   ======================================== */

.skill-box.affordable {
    background: linear-gradient(135deg, rgba(255, 220, 0, 0.4), rgba(255, 200, 0, 0.35)) !important;
    border: 2px solid rgba(255, 200, 0, 0.8) !important;
    box-shadow: 0 0 15px rgba(255, 200, 0, 0.5), inset 0 0 20px rgba(255, 220, 0, 0.3) !important;
    animation: pulseGlow 2s ease-in-out infinite;
}

.skill-box.affordable:hover {
    background: linear-gradient(135deg, rgba(255, 220, 0, 0.5), rgba(255, 200, 0, 0.45)) !important;
    box-shadow: 0 0 20px rgba(255, 200, 0, 0.7), inset 0 0 25px rgba(255, 220, 0, 0.4) !important;
    transform: scale(1.05);
}

@keyframes pulseGlow {

    0%,
    100% {
        box-shadow: 0 0 15px rgba(255, 200, 0, 0.5), inset 0 0 20px rgba(255, 220, 0, 0.3);
    }

    50% {
        box-shadow: 0 0 25px rgba(255, 200, 0, 0.7), inset 0 0 30px rgba(255, 220, 0, 0.4);
    }
}

/* Hero Stats Overlay - Mostrar apenas no hover do bot√£o UPGRADE */
.hero-stats-overlay {
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.2s;
}

.hero-buy-btn:hover~.hero-stats-overlay,
.hero-stats-overlay:hover {
    opacity: 1;
    pointer-events: auto;
}

----- FILE: static/css/tabs_missions.css  (sha1:3020e49fa7f4, bytes:3363) -----
/* ========================================
   SISTEMA DE ABAS DO PAINEL DIREITO
   ======================================== */

.right-panel-tabs {
    display: flex;
    justify-content: space-around;
    background: rgba(74, 59, 42, 0.3);
    border-radius: 8px;
    padding: 8px;
    margin-bottom: 15px;
    gap: 10px;
    position: relative;
    z-index: 2;
}

.tab-icon {
    flex: 1;
    text-align: center;
    font-size: 2em;
    padding: 10px;
    cursor: pointer;
    border-radius: 5px;
    transition: all 0.3s ease;
    background: rgba(255, 255, 255, 0.1);
    border: 2px solid transparent;
}

.tab-icon:hover {
    background: rgba(255, 255, 255, 0.2);
    transform: scale(1.1);
}

.tab-icon.active {
    background: rgba(255, 102, 0, 0.3);
    border: 2px solid #ff6600;
    box-shadow: 0 0 10px rgba(255, 102, 0, 0.5);
}

.tab-content {
    display: none;
    position: relative;
    z-index: 2;
}

.tab-content.active {
    display: block;
    animation: fadeIn 0.3s ease;
}

@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(-10px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* ========================================
   LISTA DE MISS√ïES ATIVAS
   ======================================== */

.active-missions-list {
    max-height: calc(100vh - 200px);
    overflow-y: auto;
    padding-right: 5px;
}

.mission-item {
    background: rgba(0, 0, 0, 0.2);
    border: 2px solid #4a3b2a;
    border-radius: 8px;
    padding: 12px;
    margin-bottom: 12px;
    position: relative;
    z-index: 2;
    transition: all 0.3s ease;
}

.mission-item:hover {
    background: rgba(0, 0, 0, 0.3);
    border-color: #ff6600;
    transform: translateX(5px);
}

.mission-item-header {
    display: flex;
    align-items: center;
    margin-bottom: 8px;
    gap: 8px;
}

.mission-item-icon {
    font-size: 1.5em;
}

.mission-item-title {
    font-weight: bold;
    color: #333;
    font-size: 1em;
}

.mission-item-hero {
    font-size: 0.85em;
    color: #666;
    font-style: italic;
}

.mission-progress-bar {
    background: rgba(0, 0, 0, 0.3);
    border-radius: 5px;
    height: 20px;
    margin: 8px 0;
    position: relative;
    overflow: hidden;
}

.mission-progress-fill {
    height: 100%;
    border-radius: 5px;
    transition: width 0.3s ease;
    background: linear-gradient(90deg, #00ff00, #00aa00);
}

.mission-progress-text {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-weight: bold;
    font-size: 0.85em;
    text-shadow: 1px 1px 2px #000;
    color: white;
}

.mission-item-status {
    font-size: 0.85em;
    color: #666;
    margin-top: 5px;
}

.mission-item.completed {
    border-color: #00ff00;
    background: rgba(0, 255, 0, 0.1);
}

.mission-item.completed .mission-item-title {
    color: #00aa00;
    text-decoration: line-through;
}

.no-missions-message {
    text-align: center;
    padding: 40px 20px;
    color: #666;
    font-style: italic;
    position: relative;
    z-index: 2;
}

.no-missions-message::before {
    content: "üéØ";
    display: block;
    font-size: 3em;
    margin-bottom: 10px;
    opacity: 0.3;
}

----- FILE: static/js/anti_zoom.js  (sha1:d736af7d6c26, bytes:2035) -----
// ===== ANTI-ZOOM SYSTEM =====
// For√ßa o jogo a manter sempre o mesmo tamanho visual independente do zoom do navegador

(function () {
    'use strict';

    // Detectar zoom do navegador
    function getZoomLevel() {
        return window.devicePixelRatio || 1;
    }

    // Compensar zoom aplicando scale inverso
    function compensateZoom() {
        const browserZoom = getZoomLevel();
        const gameContainer = document.querySelector('.game-container');

        if (!gameContainer) return;

        // Zoom base desejado do jogo (85% = 0.85)
        const gameZoom = 0.85;

        // Calcular scale inverso para compensar o zoom do navegador
        const inverseScale = 1 / browserZoom;

        // Aplicar transform para compensar zoom do navegador
        gameContainer.style.transform = `scale(${inverseScale})`;
        gameContainer.style.transformOrigin = 'top left';

        // Ajustar tamanho do container para compensar
        // Container precisa ser maior proporcionalmente ao zoom do navegador
        const containerWidth = 117.65 * browserZoom;
        const containerHeight = 117.65 * browserZoom;

        gameContainer.style.width = `${containerWidth}vw`;
        gameContainer.style.height = `${containerHeight}vh`;

        console.log(`üéÆ Zoom compensado - Navegador: ${Math.round(browserZoom * 100)}%, Scale: ${inverseScale.toFixed(3)}, Container: ${containerWidth.toFixed(2)}vw x ${containerHeight.toFixed(2)}vh`);
    }

    // Executar ao carregar
    window.addEventListener('load', () => {
        setTimeout(compensateZoom, 100);
    });

    // Executar quando zoom mudar
    window.addEventListener('resize', compensateZoom);

    // Monitorar mudan√ßas de zoom (fallback)
    let lastZoom = getZoomLevel();
    setInterval(() => {
        const currentZoom = getZoomLevel();
        if (Math.abs(currentZoom - lastZoom) > 0.01) {
            lastZoom = currentZoom;
            compensateZoom();
        }
    }, 500);

})();


----- FILE: static/js/game.js  (sha1:3afde925b23d, bytes:13331) -----
// Estado Global do Jogo
const gameState = {
    gold: 0,
    totalDps: 0,
    clickDamage: 1,
    currentZone: 1,
    monstersKilledInZone: 0,
    heroes: [], // { id, level, currentDps, cost }
    currentMonster: {
        hp: 10,
        maxHp: 10,
        name: "Bandido",
        img: ""
    },
    statistics: {
        totalClicks: 0,
        totalKills: 0,
        maxZone: 1
    }
};

// Configura√ß√µes
const TICKS_PER_SECOND = 10;
let autoSaveInterval;

// Inicializa√ß√£o
function initGame() {
    loadGame();
    setupHeroes();
    spawnMonster();
    updateUI();
    startGameLoop();
    setupEventListeners();

    // Auto-save a cada 30s
    autoSaveInterval = setInterval(saveGame, 30000);
}

// Configura lista de her√≥is baseada no game_data.js
function setupHeroes() {
    gameState.heroes = heroesData.map(heroData => {
        // Tenta carregar estado salvo ou inicia do zero
        const savedHero = gameState.savedHeroes ? gameState.savedHeroes.find(h => h.id === heroData.id) : null;
        return {
            ...heroData,
            level: savedHero ? savedHero.level : 0,
            currentCost: savedHero ? calculateCost(heroData.baseCost, savedHero.level) : heroData.baseCost,
            currentDps: savedHero ? heroData.baseDps * savedHero.level : 0
        };
    });
    recalculateTotalDps();
    renderHeroesList();
}

function calculateCost(baseCost, currentLevel) {
    return Math.floor(baseCost * Math.pow(1.07, currentLevel));
}

function recalculateTotalDps() {
    gameState.totalDps = gameState.heroes.reduce((sum, hero) => sum + hero.currentDps, 0);
    // Dano de clique √© 1 + 1% do DPS total (m√≠nimo 1)
    gameState.clickDamage = 1 + Math.ceil(gameState.totalDps * 0.01);
}

// Renderiza√ß√£o da Lista de Her√≥is
function renderHeroesList() {
    const listContainer = document.getElementById('heroes-list');
    listContainer.innerHTML = '';

    gameState.heroes.forEach(hero => {
        const item = document.createElement('div');
        item.className = 'hero-item';
        item.id = `hero-${hero.id}`;
        item.dataset.id = hero.id;
        item.onclick = () => buyHero(hero.id);

        item.innerHTML = `
            <div class="hero-img" style="background-image: url('static/img/${hero.img}'); background-size: cover;"></div>
            <div class="hero-info">
                <div class="hero-name">${hero.name} <span class="hero-level">Nv. ${hero.level}</span></div>
                <div class="hero-stats">DPS: ${formatNumber(hero.baseDps * (hero.level || 1))} | +${formatNumber(hero.baseDps)} DPS/Lv</div>
                <div class="hero-cost">Custo: ${formatNumber(hero.currentCost)} Ryo</div>
            </div>
        `;
        listContainer.appendChild(item);
    });
}

function updateHeroUI(heroId) {
    const hero = gameState.heroes.find(h => h.id === heroId);
    if (!hero) return;

    const item = document.getElementById(`hero-${heroId}`);
    if (item) {
        item.querySelector('.hero-level').textContent = `Nv. ${hero.level}`;
        item.querySelector('.hero-cost').textContent = `Custo: ${formatNumber(hero.currentCost)} Ryo`;

        // Verifica se pode comprar visualmente
        if (gameState.gold >= hero.currentCost) {
            item.classList.remove('disabled');
        } else {
            item.classList.add('disabled');
        }
    }
}

// Mec√¢nica de Compra
function buyHero(heroId) {
    const hero = gameState.heroes.find(h => h.id === heroId);
    if (hero && gameState.gold >= hero.currentCost) {
        gameState.gold -= hero.currentCost;
        hero.level++;
        hero.currentCost = calculateCost(hero.baseCost, hero.level);
        hero.currentDps = hero.baseDps * hero.level;

        recalculateTotalDps();
        updateUI();
        renderHeroesList(); // Re-render para atualizar tudo
        logMessage(`Voc√™ contratou/treinou ${hero.name}!`);
    }
}

// Spawning de Monstros
function spawnMonster() {
    const zoneMultiplier = Math.pow(zoneData.hpMultiplier, gameState.currentZone - 1);
    gameState.currentMonster.maxHp = Math.floor(zoneData.baseHp * zoneMultiplier);
    gameState.currentMonster.hp = gameState.currentMonster.maxHp;

    const randomName = monsterNames[Math.floor(Math.random() * monsterNames.length)];
    gameState.currentMonster.name = `${randomName} (Lv. ${gameState.currentZone})`;

    // Atualiza visual
    document.getElementById('monster-name').textContent = gameState.currentMonster.name;
    // URL placeholder aleat√≥ria para monstros, em um app real usaria assets locais
    const monsterId = Math.floor(Math.random() * 10) + 1;
    document.getElementById('monster-img').src = `https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/${monsterId}.png`; // Placeholder tempor√°rio

    updateMonsterUI();
}

function damageMonster(amount, isClick = false) {
    gameState.currentMonster.hp -= amount;
    if (gameState.currentMonster.hp < 0) gameState.currentMonster.hp = 0;

    if (isClick) {
        createDamageNumber(amount, true);
        animateMonsterShake();
        gameState.statistics.totalClicks++;
    }

    if (gameState.currentMonster.hp <= 0) {
        monterDeath();
    }

    updateMonsterUI();
}

function monterDeath() {
    // Recompensa
    const zoneMultiplier = Math.pow(zoneData.coinsMultiplier, gameState.currentZone - 1);
    const goldDrop = Math.ceil(Math.random() * 5 * zoneMultiplier); // Base 1-5 * multi

    gameState.gold += goldDrop;
    gameState.statistics.totalKills++;
    gameState.monstersKilledInZone++;

    logMessage(`Monstro derrotado! +${formatNumber(goldDrop)} Ryo`);

    // === DROPS DA MISS√ÉO CHAKRA DA KYUUBI (SKILL 4) ===
    const mission = gameState.missions?.naruto_skill4;
    if (mission && mission.purchased && !mission.completed) {

        // PARTE 1: Fragmentos de Selo Enfraquecido (10% de chance)
        if (!mission.part1.completed && Math.random() < 0.10) {
            mission.part1.progress++;
            logMessage(`üî¥ +1 Fragmento de Selo Enfraquecido (${mission.part1.progress}/${mission.part1.target})`);

            if (mission.part1.progress >= mission.part1.target) {
                mission.part1.completed = true;
                logMessage(`‚úÖ Parte 1 Completa: Selos Quebrados!`);
                showMissionNotification('Chakra da Kyuubi', 'Parte 1 Completa: Selos Quebrados!');
            }
        }

        // PARTE 2: Res√≠duos de Chakra da Ky≈´bi (apenas em bosses - zona m√∫ltipla de 5)
        const isBoss = (gameState.currentZone % 5 === 0);
        if (!mission.part2.completed && mission.part1.completed && isBoss && Math.random() < 0.30) {
            mission.part2.progress++;
            logMessage(`üî¥ +1 Res√≠duo de Chakra da Ky≈´bi (${mission.part2.progress}/${mission.part2.target})`);

            if (mission.part2.progress >= mission.part2.target) {
                mission.part2.completed = true;
                logMessage(`‚úÖ Parte 2 Completa: O Chakra Vermelho Responde ao √ìdio!`);
                showMissionNotification('Chakra da Kyuubi', 'Parte 2 Completa: Chakra Vermelho Liberado!');
            }
        }
    }

    // Progress√£o de Zona
    if (gameState.monstersKilledInZone >= zoneData.monstersPerZone) {
        gameState.currentZone++;
        gameState.monstersKilledInZone = 0;
        if (gameState.currentZone > gameState.statistics.maxZone) {
            gameState.statistics.maxZone = gameState.currentZone;
            logMessage(`AVAN√áOU PARA ZONA ${gameState.currentZone}!`);
        }
    }

    spawnMonster();
    updateUI();
}

// Loop Principal
function startGameLoop() {
    setInterval(() => {
        // Dano autom√°tico (DPS) aplicado a cada d√©cimo de segundo
        if (gameState.totalDps > 0) {
            const dpsTick = gameState.totalDps / TICKS_PER_SECOND;
            if (dpsTick > 0 && gameState.currentMonster.hp > 0) {
                damageMonster(dpsTick, false);
            }
        }

        // Verifica bot√µes habilitados
        checkBuyButtons();

    }, 1000 / TICKS_PER_SECOND);
}

function checkBuyButtons() {
    gameState.heroes.forEach(hero => {
        const item = document.getElementById(`hero-${hero.id}`);
        if (item) {
            if (gameState.gold >= hero.currentCost) {
                item.classList.remove('disabled');
            } else {
                item.classList.add('disabled');
            }
        }
    });
}

// Event Listeners
function setupEventListeners() {
    const clickTarget = document.getElementById('click-target');
    clickTarget.addEventListener('mousedown', () => {
        damageMonster(gameState.clickDamage, true);
        clickTarget.querySelector('.monster-visual').style.transform = "scale(0.9)";
    });

    clickTarget.addEventListener('mouseup', () => {
        clickTarget.querySelector('.monster-visual').style.transform = "scale(1)";
    });
}

// UI Helpers
function updateUI() {
    document.getElementById('player-gold').textContent = formatNumber(Math.floor(gameState.gold));
    document.getElementById('total-dps').textContent = formatNumber(Math.floor(gameState.totalDps));
    document.getElementById('click-damage').textContent = formatNumber(Math.floor(gameState.clickDamage));

    document.getElementById('current-zone').textContent = gameState.currentZone;
    document.getElementById('monsters-killed').textContent = gameState.monstersKilledInZone;

    document.getElementById('stat-killed').textContent = formatNumber(gameState.statistics.totalKills);
    document.getElementById('stat-clicks').textContent = formatNumber(gameState.statistics.totalClicks);
    document.getElementById('stat-max-zone').textContent = gameState.statistics.maxZone;
}

function updateMonsterUI() {
    const pct = (gameState.currentMonster.hp / gameState.currentMonster.maxHp) * 100;
    document.getElementById('hp-fill').style.width = `${pct}%`;
    document.getElementById('current-hp').textContent = formatNumber(Math.ceil(gameState.currentMonster.hp));
}

function createDamageNumber(amount, isCrit) {
    const container = document.getElementById('damage-numbers-container');
    const el = document.createElement('div');
    el.className = 'damage-number';
    if (isCrit && Math.random() < 0.05) { // 5% chance crit visual
        el.classList.add('damage-crit');
        amount *= 2; // Cr√≠tico visual simples
    }
    el.textContent = formatNumber(Math.floor(amount));

    // Posi√ß√£o aleat√≥ria perto do centro
    const x = 50 + (Math.random() * 20 - 10);
    const y = 50 + (Math.random() * 20 - 10);

    el.style.left = `${x}%`;
    el.style.top = `${y}%`;

    container.appendChild(el);

    setTimeout(() => el.remove(), 1000);
}

function animateMonsterShake() {
    const visual = document.querySelector('.monster-visual');
    visual.classList.remove('shake');
    void visual.offsetWidth; // Trigger reflow
    visual.classList.add('shake');
}

function showMissionNotification(missionName, message) {
    // Criar notifica√ß√£o visual
    const notification = document.createElement('div');
    notification.className = 'mission-notification';
    notification.innerHTML = `
        <div class="mission-notification-content">
            <div class="mission-notification-title">üî¥ ${missionName}</div>
            <div class="mission-notification-message">${message}</div>
        </div>
    `;

    document.body.appendChild(notification);

    // Remover ap√≥s 4 segundos
    setTimeout(() => {
        notification.style.opacity = '0';
        setTimeout(() => notification.remove(), 500);
    }, 4000);
}

function logMessage(msg) {
    const log = document.getElementById('battle-log');
    const p = document.createElement('p');
    p.textContent = msg;
    log.prepend(p);
    if (log.children.length > 20) log.lastChild.remove();
}

function formatNumber(num) {
    if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';
    if (num >= 1000) return (num / 1000).toFixed(1) + 'k';
    return Math.floor(num).toString();
}

// Persistence
function saveGame() {
    const saveObj = {
        gold: gameState.gold,
        currentZone: gameState.currentZone,
        savedHeroes: gameState.heroes.map(h => ({ id: h.id, level: h.level })),
        statistics: gameState.statistics
    };
    localStorage.setItem('narutoClickerSave', JSON.stringify(saveObj));
    // console.log("Jogo Salvo");
}

function loadGame() {
    const saveStr = localStorage.getItem('narutoClickerSave');
    if (saveStr) {
        try {
            const saved = JSON.parse(saveStr);
            gameState.gold = saved.gold || 0;
            gameState.currentZone = saved.currentZone || 1;
            gameState.savedHeroes = saved.savedHeroes || [];
            gameState.statistics = { ...gameState.statistics, ...saved.statistics };
            logMessage("Progresso carregado!");
        } catch (e) {
            console.error("Erro ao carregar save", e);
        }
    }
}

// Start
window.onload = initGame;


----- FILE: static/js/game_data.js  (sha1:ee8ff0e04b9f, bytes:4368) -----
const heroesData = [
    { id: 1, name: "Iruka Umino", baseCost: 10, baseDps: 1, img: "iruka.png" },
    { id: 2, name: "Mizuki", baseCost: 100, baseDps: 5, img: "mizuki.png" },
    { id: 3, name: "Konohamaru Sarutobi", baseCost: 500, baseDps: 12, img: "konohamaru.png" },
    { id: 4, name: "Ebisu", baseCost: 1000, baseDps: 25, img: "ebisu.png" },
    { id: 5, name: "Tenten", baseCost: 2500, baseDps: 50, img: "tenten.png" },
    { id: 6, name: "Ino Yamanaka", baseCost: 5000, baseDps: 80, img: "ino.png" },
    { id: 7, name: "Kiba Inuzuka", baseCost: 12000, baseDps: 150, img: "kiba.png" },
    { id: 8, name: "Shino Aburame", baseCost: 25000, baseDps: 300, img: "shino.png" },
    { id: 9, name: "Hinata Hyuga (Genin)", baseCost: 60000, baseDps: 550, img: "hinata_genin.png" },
    { id: 10, name: "Choji Akimichi", baseCost: 150000, baseDps: 1000, img: "choji.png" },
    { id: 11, name: "Shikamaru Nara", baseCost: 400000, baseDps: 2200, img: "shikamaru.png" },
    { id: 12, name: "Sakura Haruno (Genin)", baseCost: 1000000, baseDps: 4500, img: "sakura_genin.png" },
    { id: 13, name: "Sasuke Uchiha (Genin)", baseCost: 2500000, baseDps: 9000, img: "sasuke_genin.png" },
    { id: 14, name: "Naruto Uzumaki (Genin)", baseCost: 6000000, baseDps: 18000, img: "naruto_genin.png" },
    { id: 15, name: "Haku", baseCost: 15000000, baseDps: 40000, img: "haku.png" },
    { id: 16, name: "Zabuza Momochi", baseCost: 40000000, baseDps: 90000, img: "zabuza.png" },
    { id: 17, name: "Rock Lee (Port√µes)", baseCost: 100000000, baseDps: 200000, img: "rocklee.png" },
    { id: 18, name: "Neji Hyuga", baseCost: 300000000, baseDps: 500000, img: "neji.png" },
    { id: 19, name: "Gaara do Deserto", baseCost: 800000000, baseDps: 1200000, img: "gaara.png" },
    { id: 20, name: "Kabuto Yakushi", baseCost: 2000000000, baseDps: 3000000, img: "kabuto.png" },
    { id: 21, name: "Kimimaro", baseCost: 5000000000, baseDps: 7000000, img: "kimimaro.png" },
    { id: 22, name: "Yamato", baseCost: 12000000000, baseDps: 15000000, img: "yamato.png" },
    { id: 23, name: "Sai", baseCost: 30000000000, baseDps: 35000000, img: "sai.png" },
    { id: 24, name: "Asuma Sarutobi", baseCost: 80000000000, baseDps: 85000000, img: "asuma.png" },
    { id: 25, name: "Kakashi Hatake", baseCost: 200000000000, baseDps: 200000000, img: "kakashi.png" },
    { id: 26, name: "Might Guy (7 Port√µes)", baseCost: 500000000000, baseDps: 500000000, img: "guy.png" },
    { id: 27, name: "Kisame Hoshigaki", baseCost: 1500000000000, baseDps: 1200000000, img: "kisame.png" },
    { id: 28, name: "Deidara", baseCost: 4000000000000, baseDps: 3000000000, img: "deidara.png" },
    { id: 29, name: "Sasori", baseCost: 10000000000000, baseDps: 7000000000, img: "sasori.png" },
    { id: 30, name: "Kakuzu", baseCost: 25000000000000, baseDps: 15000000000, img: "kakuzu.png" },
    { id: 31, name: "Hidan", baseCost: 70000000000000, baseDps: 40000000000, img: "hidan.png" },
    { id: 32, name: "Itachi Uchiha", baseCost: 200000000000000, baseDps: 100000000000, img: "itachi.png" },
    { id: 33, name: "Jiraiya", baseCost: 600000000000000, baseDps: 300000000000, img: "jiraiya.png" },
    { id: 34, name: "Orochimaru", baseCost: 2000000000000000, baseDps: 800000000000, img: "orochimaru.png" },
    { id: 35, name: "Tsunade Senju", baseCost: 7000000000000000, baseDps: 2500000000000, img: "tsunade.png" },
    { id: 36, name: "Pain (Nagato)", baseCost: 25000000000000000, baseDps: 8000000000000, img: "pain.png" },
    { id: 37, name: "Minato Namikaze", baseCost: 100000000000000000, baseDps: 30000000000000, img: "minato.png" },
    { id: 38, name: "Hashirama Senju", baseCost: 500000000000000000, baseDps: 150000000000000, img: "hashirama.png" },
    { id: 39, name: "Madara Uchiha (Rikudou)", baseCost: 2000000000000000000, baseDps: 800000000000000, img: "madara.png" },
    { id: 40, name: "Naruto (Modo Baryon)", baseCost: 10000000000000000000, baseDps: 5000000000000000, img: "naruto_baryon.png" }
];

const zoneData = {
    baseHp: 10,
    hpMultiplier: 1.55, // HP cresce 55% por level
    coinsMultiplier: 1.5,
    monstersPerZone: 10
};

const monsterNames = [
    "Bandido", "Ninja Renegado", "Zetsu Branco", "Clone das Sombras", "Marionete", 
    "Cobra Gigante", "Sapo Gigante", "Lesma Gigante", "Corvo", "Guerreiro Susanoo"
];


----- FILE: static/js/game_data_v3.js  (sha1:ee21ae7e6f51, bytes:10777) -----
const heroesData = [
    { id: 1, name: "Naruto Uzumaki", baseCost: 10, baseDps: 1, img: "./static/img/heroes/icons/naruto_icon.png", focus: "center center", element: "wind" },
    { id: 2, name: "Sasuke Uchiha", baseCost: 100, baseDps: 5, img: "./static/img/heroes/icons/sasuke_icon.png", focus: "center center", element: "fire" },
    { id: 3, name: "Sakura Haruno", baseCost: 500, baseDps: 12, img: "./static/img/heroes/icons/sakura_icon.png", focus: "center center", element: "water" },
    { id: 4, name: "Kiba Inuzuka", baseCost: 1000, baseDps: 25, img: "./static/img/heroes/icons/kiba_icon.png", element: "wind" },
    { id: 5, name: "Shino Aburame", baseCost: 2500, baseDps: 50, img: "./static/img/heroes/icons/shino_icon.png", element: "water" },
    { id: 6, name: "Hinata Hyuga", baseCost: 5000, baseDps: 80, img: "./static/img/heroes/icons/hinata_icon.png", element: "water" },
    { id: 7, name: "Shikamaru Nara", baseCost: 12000, baseDps: 150, img: "./static/img/heroes/icons/shikamaru_icon.png", element: "earth" },
    { id: 8, name: "Choji Akimichi", baseCost: 25000, baseDps: 300, img: "./static/img/heroes/icons/choji_icon.png", element: "fire" },
    { id: 9, name: "Ino Yamanaka", baseCost: 60000, baseDps: 550, img: "./static/img/heroes/icons/ino_icon.png", element: "fire" },
    { id: 10, name: "Rock Lee", baseCost: 150000, baseDps: 1000, img: "./static/img/heroes/icons/lee_icon.png", element: null },
    { id: 11, name: "Tenten", baseCost: 400000, baseDps: 2200, img: "./static/img/heroes/icons/tenten_icon.png", element: "lightning" },
    { id: 12, name: "Neji", baseCost: 1000000, baseDps: 4500, img: "./static/img/heroes/icons/neji_icon.png", element: "lightning" },
    { id: 13, name: "Gaara", baseCost: 2500000, baseDps: 9000, img: "./static/img/heroes/icons/gaara_icon.png", element: "earth" },
    { id: 14, name: "Temari", baseCost: 6000000, baseDps: 18000, img: "./static/img/heroes/icons/temari_icon.png", element: "wind" },
    { id: 15, name: "Kankuro", baseCost: 15000000, baseDps: 40000, img: "./static/img/heroes/icons/kankuro_icon.png", element: "earth" },
    { id: 16, name: "Iruka Umino", baseCost: 40000000, baseDps: 90000, img: "https://placehold.co/100x100/4a3b2a/ffffff?text=Iruka" },
    { id: 17, name: "Mizuki", baseCost: 100000000, baseDps: 200000, img: "https://placehold.co/100x100/555555/ffffff?text=Mizuki" },
    { id: 18, name: "Konohamaru", baseCost: 300000000, baseDps: 500000, img: "https://placehold.co/100x100/ffd700/000000?text=Konohamaru" },
    { id: 19, name: "Haku", baseCost: 800000000, baseDps: 1200000, img: "https://placehold.co/100x100/add8e6/000000?text=Haku" },
    { id: 20, name: "Zabuza", baseCost: 2000000000, baseDps: 3000000, img: "https://placehold.co/100x100/2f4f4f/ffffff?text=Zabuza" },
    { id: 21, name: "Kabuto", baseCost: 5000000000, baseDps: 7000000, img: "https://placehold.co/100x100/4b0082/ffffff?text=Kabuto" },
    { id: 22, name: "Kimimaro", baseCost: 12000000000, baseDps: 15000000, img: "https://placehold.co/100x100/f5f5f5/000000?text=Kimimaro" },
    { id: 23, name: "Itachi", baseCost: 30000000000, baseDps: 35000000, img: "https://placehold.co/100x100/000000/ff0000?text=Itachi" },
    { id: 24, name: "Kisame", baseCost: 80000000000, baseDps: 85000000, img: "https://placehold.co/100x100/000080/ffffff?text=Kisame" },
    { id: 25, name: "Jiraiya", baseCost: 200000000000, baseDps: 200000000, img: "https://placehold.co/100x100/8b4513/ffffff?text=Jiraiya" },
    { id: 26, name: "Tsunade", baseCost: 500000000000, baseDps: 500000000, img: "https://placehold.co/100x100/98fb98/000000?text=Tsunade" },
    { id: 27, name: "Orochimaru", baseCost: 1500000000000, baseDps: 1200000000, img: "https://placehold.co/100x100/483d8b/ffffff?text=Orochimaru" },
    { id: 28, name: "Kakashi", baseCost: 4000000000000, baseDps: 3000000000, img: "https://placehold.co/100x100/778899/ffffff?text=Kakashi" },
    { id: 29, name: "Guy", baseCost: 10000000000000, baseDps: 7000000000, img: "https://placehold.co/100x100/006400/ffffff?text=Might+Guy" },
    { id: 30, name: "Asuma", baseCost: 25000000000000, baseDps: 15000000000, img: "https://placehold.co/100x100/2f4f4f/ffffff?text=Asuma" },
    { id: 31, name: "Yamato", baseCost: 70000000000000, baseDps: 40000000000, img: "https://placehold.co/100x100/8b4513/ffffff?text=Yamato" },
    { id: 32, name: "Sai", baseCost: 200000000000000, baseDps: 100000000000, img: "https://placehold.co/100x100/000000/ffffff?text=Sai" },
    { id: 33, name: "Deidara", baseCost: 600000000000000, baseDps: 300000000000, img: "https://placehold.co/100x100/ffd700/000000?text=Deidara" },
    { id: 34, name: "Sasori", baseCost: 2000000000000000, baseDps: 800000000000, img: "https://placehold.co/100x100/8b0000/ffffff?text=Sasori" },
    { id: 35, name: "Hidan", baseCost: 7000000000000000, baseDps: 2500000000000, img: "https://placehold.co/100x100/dc143c/ffffff?text=Hidan" },
    { id: 36, name: "Kakuzu", baseCost: 25000000000000000, baseDps: 8000000000000, img: "https://placehold.co/100x100/2f4f4f/ffffff?text=Kakuzu" },
    { id: 37, name: "Pain", baseCost: 100000000000000000, baseDps: 30000000000000, img: "https://placehold.co/100x100/ff4500/ffffff?text=Pain" },
    { id: 38, name: "Konan", baseCost: 500000000000000000, baseDps: 150000000000000, img: "https://placehold.co/100x100/4169e1/ffffff?text=Konan" },
    { id: 39, name: "Obito", baseCost: 2000000000000000000, baseDps: 800000000000000, img: "https://placehold.co/100x100/4b0082/ffffff?text=Obito" },
    { id: 40, name: "Madara", baseCost: 10000000000000000000, baseDps: 5000000000000000, img: "https://placehold.co/100x100/800000/ffffff?text=Madara" }
];

// Defini√ß√£o Manual de Skills para os Principais (Fiel ao Anime)
const specificUpgrades = {
    1: [ // Naruto
        { id: "h1_u1", reqLevel: 20, type: "CLICK_DAMAGE", value: 2, costMultiplier: 10, icon: "./static/img/skills/skill_1_1.png", name: "Kage Bunshin no Jutsu", desc: "Dano de Clique x2" },
        { id: "h1_u2", reqLevel: 40, type: "CLICK_DAMAGE", value: 2, costMultiplier: 50, icon: "./static/img/skills/skill_1_2.png", name: "Tajuu Kage Bunshin", desc: "Dano de Clique x2" },
        { id: "h1_u3", reqLevel: 60, type: "GLOBAL_DPS_MULT", value: 1.15, costMultiplier: 200, icon: "./static/img/skills/skill_1_3.png", name: "Rasengan", desc: "DPS de Todos +15%" },
        { id: "h1_u4", reqLevel: 80, type: "MISSION", value: 0, costMultiplier: 1000, icon: "./static/img/skills/skill_1_4.png", name: "Chakra da Kyuubi", desc: "Miss√£o: Liberar o Chakra da Ky≈´bi" }
    ],
    2: [ // Sasuke
        { id: "h2_u1", reqLevel: 20, type: "SELF_DPS_MULT", value: 2, costMultiplier: 10, icon: "./static/img/skills/skill_3_1.png", name: "Sharingan", desc: "DPS do Sasuke x2" },
        { id: "h2_u2", reqLevel: 40, type: "SELF_DPS_MULT", value: 2, costMultiplier: 50, icon: "./static/img/skills/skill_3_2.png", name: "Chidori", desc: "DPS do Sasuke x2" },
        { id: "h2_u3", reqLevel: 60, type: "GLOBAL_DPS_MULT", value: 1.1, costMultiplier: 200, icon: "./static/img/skills/skill_3_3.png", name: "Katon: Goukakyuu no Jutsu", desc: "DPS de Todos +10%" },
        { id: "h2_u4", reqLevel: 80, type: "CRIT_CHANCE", value: 0.01, costMultiplier: 1000, icon: "./static/img/skills/skill_3_4.png", name: "Shurikenjutsu Uchiha", desc: "Chance Cr√≠tica +1%" }
    ],
    3: [ // Sakura
        { id: "h3_u1", reqLevel: 20, type: "SELF_DPS_MULT", value: 2, costMultiplier: 10, icon: "./static/img/skills/skill_2_1.png", name: "Controle Preciso de Chakra", desc: "DPS da Sakura x2" },
        { id: "h3_u2", reqLevel: 40, type: "GLOBAL_DPS_MULT", value: 1.1, costMultiplier: 50, icon: "./static/img/skills/skill_2_2.png", name: "Golpe de F√¥r√ßa Concentrada", desc: "DPS de Todos +10%" },
        { id: "h3_u3", reqLevel: 60, type: "SELF_DPS_MULT", value: 2, costMultiplier: 200, icon: "./static/img/skills/skill_2_3.png", name: "An√°lise de Combate", desc: "DPS da Sakura x2" },
        { id: "h3_u4", reqLevel: 80, type: "GLOBAL_DPS_MULT", value: 1.2, costMultiplier: 1000, icon: "./static/img/skills/skill_2_4.png", name: "Resist√™ncia Mental", desc: "DPS de Todos +20%" }
    ]
};

const heroUpgrades = {}; // Map heroId -> Array of upgrades

heroesData.forEach(hero => {
    if (specificUpgrades[hero.id]) {
        heroUpgrades[hero.id] = specificUpgrades[hero.id].map(u => ({ ...u, heroId: hero.id }));
    } else {
        // Gerador Gen√©rico Tem√°tico
        heroUpgrades[hero.id] = [
            {
                id: `h${hero.id}_u1`,
                heroId: hero.id,
                reqLevel: 20,
                type: "SELF_DPS_MULT",
                value: 2,
                costMultiplier: 10,
                icon: "üó°Ô∏è",
                name: `T√©cnica Secreta I`,
                desc: "Dano deste her√≥i x2"
            },
            {
                id: `h${hero.id}_u2`,
                heroId: hero.id,
                reqLevel: 40,
                type: "GLOBAL_DPS_MULT",
                value: 1.1,
                costMultiplier: 50,
                icon: "üìú",
                name: "Estrat√©gia Ninja",
                desc: "DPS de todos +10%"
            },
            {
                id: `h${hero.id}_u3`,
                heroId: hero.id,
                reqLevel: 60,
                type: "SELF_DPS_MULT",
                value: 2,
                costMultiplier: 200,
                icon: "‚ú®",
                name: `T√©cnica Secreta II`,
                desc: "Dano deste her√≥i x2"
            },
            {
                id: `h${hero.id}_u4`,
                heroId: hero.id,
                reqLevel: 80,
                type: "GLOBAL_DPS_MULT",
                value: 1.2, // Buff global gen√©rico forte
                costMultiplier: 1000,
                icon: "üõ°Ô∏è",
                name: "Poder Oculto",
                desc: "DPS de todos +20%"
            }
        ];
    }
});

const zoneData = {
    baseHp: 10,
    hpMultiplier: 1.15, // Reduzido de 2.05 para progress√£o mais suave
    coinsMultiplier: 1.5,
    monstersPerZone: 10
};

// Cada sprite tem seu pr√≥prio nome √∫nico
const enemyData = [
    { name: "Akira", img: "./static/img/enemies/enemy_main.png" },
    { name: "Kenji", img: "./static/img/enemies/enemy_v4.png" },
    { name: "Ryu", img: "./static/img/enemies/enemy_v5.png" },
    { name: "Takeshi", img: "./static/img/enemies/enemy_v6.png" }
];

// Manter compatibilidade com c√≥digo antigo
const monsterNames = enemyData.map(e => e.name);
const monsterImages = enemyData.map(e => e.img);

// Imagem do Boss (aparece a cada 5 fases)
const bossImage = "./static/img/enemies/boss.png";


----- FILE: static/js/game_v3.js  (sha1:a66544593a29, bytes:126344) -----
console.log('üéÆ Game v3.js carregado - VERS√ÉO 5 - Boss Timer');
// Estado Global do Jogo
const gameState = {
    gold: 0,
    totalDps: 0,
    clickDamage: 1,
    critChance: 0, // Inicia em 0%
    clickCritMultiplier: 2,
    currentZone: 1,
    monstersKilledInZone: 0,
    heroes: [],
    upgrades: [], // IDs dos upgrades comprados
    currentMonster: {
        hp: 10,
        maxHp: 10,
        name: "Bandido",
        img: ""
    },
    statistics: {
        totalClicks: 0,
        totalKills: 0,
        maxZone: 1
    },
    lastEnemyIndex: -1, // Para evitar repeti√ß√£o consecutiva
    inventory: [], // Mochila de itens
    bossTimer: 30, // Cron√¥metro de boss (30 segundos)
    bossTimerInterval: null, // Refer√™ncia ao intervalo do cron√¥metro
    currentEnemyName: "", // Nome do inimigo atual para sistema de drop
    diamonds: 0, // Contador de diamantes
    zoneProgress: {}, // Rastreia quantos monstros foram mortos em cada zona (ex: {1: 10, 2: 5, 3: 10})
    missions: {
        naruto_skill1: {
            id: "naruto_skill1",
            purchased: false,
            completed: false,
            progress: 0,
            target: 150,
            cost: 5
        },
        naruto_skill2: {
            id: "naruto_skill2",
            purchased: false,
            completed: false,
            progress: 0,
            target: 30,
            cost: 15
        },
        naruto_skill3: {
            id: "naruto_skill3",
            purchased: false,
            completed: false,
            progress: 0,
            target: 80,
            cost: 40
        },
        naruto_skill4: {
            id: "naruto_skill4",
            purchased: false,
            completed: false,
            cost: 120,
            // Parte 1: Selos Quebrados
            part1: {
                completed: false,
                progress: 0,
                target: 100 // 100 Fragmentos de Selo Enfraquecido
            },
            // Parte 2: O Chakra Vermelho Responde ao √ìdio
            part2: {
                completed: false,
                progress: 0,
                target: 8 // 8 Res√≠duos de Chakra da Ky≈´bi
            },
            // Parte 3: Controle Inst√°vel
            part3: {
                completed: false,
                goldOffered: false // 15.000.000 Gold entregue
            }
        }
    }
};

// Configura√ß√µes
const TICKS_PER_SECOND = 10;
let autoSaveInterval;
let lastUpdateTime = Date.now(); // Rastrear √∫ltima atualiza√ß√£o para progresso offline

// Inicializa√ß√£o
function initGame() {
    loadGame();
    setupHeroes();
    spawnMonster();
    renderArenas();
    updateUI();
    startGameLoop();
    setupEventListeners();

    // Auto-save a cada 30s
    autoSaveInterval = setInterval(saveGame, 30000);
}

// Configura lista de her√≥is baseada no game_data.js
function setupHeroes() {
    gameState.heroes = heroesData.map(heroData => {
        const savedHero = gameState.savedHeroes ? gameState.savedHeroes.find(h => h.id === heroData.id) : null;
        return {
            ...heroData,
            level: savedHero ? savedHero.level : 0,
            currentCost: savedHero ? calculateCost(heroData.baseCost, savedHero.level) : heroData.baseCost,
            currentDps: savedHero ? heroData.baseDps * savedHero.level : 0
        };
    });
    recalculateTotalDps();
    renderHeroesList();
}

function calculateCost(baseCost, currentLevel) {
    return Math.floor(baseCost * Math.pow(1.07, currentLevel));
}

function recalculateTotalDps() {
    let dps = 0;
    let clickCtx = 1;
    let globalMulti = 1;
    let critChanceAcc = 0;

    // Processar Global Upgrades & Crit
    gameState.upgrades.forEach(uId => {
        // Encontrar info do upgrade
        for (const hid in heroUpgrades) {
            const upg = heroUpgrades[hid].find(u => u.id === uId);
            if (upg) {
                if (upg.type === 'GLOBAL_DPS_MULT') globalMulti *= upg.value;
                if (upg.type === 'CRIT_CHANCE') critChanceAcc += upg.value;
            }
        }
    });

    gameState.critChance = critChanceAcc;

    // Calcular DPS Individual com Multiplicadores Self
    gameState.heroes.forEach(hero => {
        let heroDps = hero.baseDps * hero.level;

        // Self Multipliers
        const heroUps = heroUpgrades[hero.id];
        if (heroUps) {
            heroUps.forEach(upg => {
                if (gameState.upgrades.includes(upg.id) && upg.type === 'SELF_DPS_MULT') {
                    heroDps *= upg.value;
                }
            });
        }

        hero.currentDps = heroDps;

        if (hero.id === 1) {
            clickCtx += hero.currentDps;
        } else {
            dps += hero.currentDps;
        }
    });

    gameState.totalDps = dps * globalMulti;
    gameState.clickDamage = clickCtx * globalMulti;
}

// Renderiza√ß√£o da Lista de Her√≥is (Split Layout: Left Name/Img, Right Info)
function renderHeroesList() {
    const listContainer = document.getElementById('heroes-list');
    listContainer.innerHTML = '';

    for (let i = 0; i < gameState.heroes.length; i++) {
        const hero = gameState.heroes[i];
        let status = 'hidden';

        if (i === 0) status = 'revealed';
        else {
            const prevHero = gameState.heroes[i - 1];
            if (prevHero.level > 0) status = 'revealed';
            else {
                if (i === 1) status = 'mystery';
                else {
                    const prevPrevHero = gameState.heroes[i - 2];
                    if (prevPrevHero && prevPrevHero.level > 0) status = 'mystery';
                }
            }
        }

        if (status === 'hidden') break;

        const item = document.createElement('div');
        item.className = 'hero-card-split'; // Usando nova classe de layout
        if (status === 'mystery') item.classList.add('mystery-hero');
        item.id = `hero-${hero.id}`;

        const isLocked = status === 'mystery';

        let displayName = isLocked ? "???" : hero.name;
        // Se estiver bloqueado mostra placeholder, se n√£o mostra a imagem definida (agora full body pro naruto)
        let displayImg = isLocked ? "https://placehold.co/100x100/000000/ffffff?text=?" : hero.img;
        let displayCost = formatNumber(hero.currentCost);
        let dpsVal = hero.currentDps;

        // HTML Structure

        // --- NAME OUTSIDE (Side-by-Side) ---
        // Se estiver bloqueado mostra ???
        // Se disponivel, mostra Nome + Sobrenome (ou apenas nome completo estilizado)
        // O usuario pediu "nome e sobrenome um ao lado do outro".
        // displayName j√° √© "Naruto Uzumaki".

        let elementImg = "";
        if (!isLocked && hero.element) {
            elementImg = `<img src="./static/img/elements/${hero.element}.png" class="hero-element-icon" title="Elemento: ${hero.element}">`;
        }

        let nameTitleHTML = `
            <div class="hero-title-header">
                ${displayName} ${elementImg}
            </div>
        `;

        // --- COLUNA ESQUERDA: APENAS IMAGEM ---
        // Remover nome daqui de dentro
        // Aplicando foco din√¢mico (inteligente) se definido, sen√£o padr√£o topo
        let focusStyle = hero.focus ? `style="object-position: ${hero.focus}"` : '';

        let leftColHTML = `
            <div class="card-left-col">
                <div class="hero-image-wrapper" ${!isLocked ? `onclick="openHeroDetailsModal(${hero.id})" style="cursor: pointer;"` : ''}>
                    <img src="${displayImg}" class="hero-full-body-img" alt="${displayName}" ${focusStyle}>
                </div>
            </div>
        `;

        // --- COLUNA DIREITA: NIVEL -> STATUS -> SKILLS -> BOTAO ---

        // 1. N√≠vel
        let levelHTML = isLocked ? `<div class="hero-level-display">???</div>` : `<div class="hero-level-display" id="hero-level-text-${hero.id}">N√≠vel ${hero.level}</div>`;

        // 2. Status (Dano/DPS) agora vai para o OVERLAY
        let statsHTML = "";
        if (isLocked) {
            statsHTML = `<div class="hero-stats-text">???</div>`;
        } else {
            // Calcular o incremento de DPS do pr√≥ximo n√≠vel
            const nextLevelDps = hero.baseDps * Math.pow(1.07, hero.level + 1);
            const dpsIncrement = Math.abs(nextLevelDps - dpsVal);

            if (hero.id === 1) {
                // Calcular dano bruto com buffs das skills
                let clickDamageWithBuffs = dpsVal;
                const heroUps = heroUpgrades[hero.id];
                if (heroUps) {
                    heroUps.forEach(upg => {
                        if (gameState.upgrades.includes(upg.id) && upg.type === 'SELF_DPS_MULT') {
                            clickDamageWithBuffs *= upg.value;
                        }
                    });
                }

                // Calcular dano elemental (Vento = +15% por skill completada)
                let elementalDamage = 0;
                let elementalCount = 0;
                if (gameState.missions.naruto_skill1?.completed) elementalCount++;
                if (gameState.missions.naruto_skill2?.completed) elementalCount++;
                if (gameState.missions.naruto_skill3?.completed) elementalCount++;
                if (gameState.missions.naruto_skill4?.completed) elementalCount++;

                if (elementalCount > 0) {
                    elementalDamage = clickDamageWithBuffs * (0.15 * elementalCount);
                }

                // Naruto: cada n√≠vel d√° +1 de dano de clique
                const clickIncrement = 1;

                statsHTML = `
                    <div class="stat-line">
                        <strong>Dano de Clique:</strong> 
                        <span id="hero-stat-val-${hero.id}">${formatNumber(clickDamageWithBuffs)}</span> 
                        <span class="dps-increment">+${formatNumber(clickIncrement)}</span>
                    </div>
                    ${elementalDamage > 0 ? `<div class="stat-line elemental-wind">
                        <strong>üí® Dano Elemental (Vento):</strong> 
                        <span style="color: #00ff00;">${formatNumber(elementalDamage)}</span>
                    </div>` : ''}
                `;
            } else {
                statsHTML = `<div class="stat-line"><strong>Dano por Segundo:</strong> <span id="hero-stat-val-${hero.id}">${formatNumber(dpsVal)}</span> <span class="dps-increment">+${formatNumber(dpsIncrement)}</span></div>`;
            }
        }

        // 4. Bot√£o de Compra
        let buyButtonHTML = "";
        if (!isLocked) {
            buyButtonHTML = `
                <div class="hero-buy-btn" onclick="buyHero(${hero.id})">
                    <span class="buy-label">UPGRADE</span>
                    <span class="buy-value">üí∞ <span id="hero-cost-text-${hero.id}">${displayCost}</span></span>
                </div>
            `;
        } else {
            buyButtonHTML = `
                <div class="hero-buy-btn locked">
                    <span>BLOQUEADO</span>
                </div>
            `;
        }

        // 3. Skills (NOW BELOW UPGRADE)
        let skillsHTML = '<div class="hero-skills-row">';
        if (!isLocked) {
            const upgrades = heroUpgrades[hero.id];
            if (upgrades) {
                upgrades.forEach(upg => {
                    const isBought = gameState.upgrades.includes(upg.id);

                    // L√≥gica especial para Kage Bunshin (h1_u1) - Sistema de Miss√£o
                    let isUnlocked;
                    let tooltipExtra = '';
                    let clickHandler = `buyUpgrade('${upg.id}', ${hero.baseCost * upg.costMultiplier}, ${hero.id})`;

                    if (upg.id === 'h1_u1') {
                        const mission = gameState.missions.naruto_skill1;
                        isUnlocked = mission.completed;

                        if (!mission.purchased && !mission.completed) {
                            // Miss√£o n√£o comprada - mostrar custo em diamantes
                            clickHandler = `openMissionModal('naruto_skill1')`;
                            tooltipExtra = `<br><br><div style="background: rgba(0,100,200,0.2); padding: 8px; border-radius: 5px; margin-top: 5px;">
                                <strong>üéØ Miss√£o: "Treino dos Clones na Floresta"</strong><br>
                                <span style="color: #00d4ff;">üíé Custo: ${mission.cost} Diamantes</span><br><br>
                                <strong>üìã Objetivo:</strong><br>
                                Derrotar 150 inimigos normais<br>
                                nas fases 1-10 usando apenas clique<br><br>
                                <strong>üí• B√¥nus Elemental (Vento):</strong><br>
                                +15% de dano adicional
                            </div>`;
                        } else if (mission.purchased && !mission.completed) {
                            // Miss√£o comprada mas n√£o completada - mostrar progresso
                            clickHandler = `openMissionModal('naruto_skill1')`;
                            const progressPercent = Math.floor((mission.progress / mission.target) * 100);
                            tooltipExtra = `<br><br><div style="background: rgba(0,150,0,0.2); padding: 8px; border-radius: 5px; margin-top: 5px;">
                                <strong>üéØ Miss√£o em Andamento</strong><br>
                                <div style="background: rgba(0,0,0,0.3); border-radius: 5px; height: 20px; margin: 5px 0; position: relative;">
                                    <div style="background: linear-gradient(90deg, #00ff00, #00aa00); width: ${progressPercent}%; height: 100%; border-radius: 5px;"></div>
                                    <span style="position: absolute; top: 2px; left: 50%; transform: translateX(-50%); font-weight: bold; text-shadow: 1px 1px 2px #000;">
                                        ${mission.progress}/${mission.target}
                                    </span>
                                </div>
                                <small>Derrote inimigos nas fases 1-10 usando apenas clique!</small>
                            </div>`;
                        } else if (mission.completed) {
                            // Miss√£o completada - pode comprar normalmente
                            clickHandler = `openMissionModal('naruto_skill1')`;
                            tooltipExtra = `<br><br><span style="color: #00ff00;">‚úÖ Miss√£o Completada!</span>`;
                        }
                    } else if (upg.id === 'h1_u2') {
                        // L√≥gica especial para Tajuu Kage Bunshin (h1_u2) - Sistema de Miss√£o
                        const mission = gameState.missions.naruto_skill2;
                        isUnlocked = mission.completed;

                        if (!mission.purchased && !mission.completed) {
                            // Miss√£o n√£o comprada - mostrar custo em diamantes
                            clickHandler = `openMissionModal('naruto_skill2')`;
                            tooltipExtra = `<br><br><div style="background: rgba(0,100,200,0.2); padding: 8px; border-radius: 5px; margin-top: 5px;">
                                <strong>üéØ Miss√£o: "Ex√©rcito de Clones"</strong><br>
                                <span style="color: #00d4ff;">üíé Custo: ${mission.cost} Diamantes</span><br><br>
                                <strong>üìã Objetivo:</strong><br>
                                Coletar 30 Pergaminhos Rasgados de Clone<br>
                                nas fases 20-40 (8% de chance)<br><br>
                                <strong>üí• B√¥nus Elemental (Vento):</strong><br>
                                +15% de dano adicional
                            </div>`;
                        } else if (mission.purchased && !mission.completed) {
                            // Miss√£o comprada mas n√£o completada - mostrar progresso
                            clickHandler = `openMissionModal('naruto_skill2')`;
                            const progressPercent = Math.floor((mission.progress / mission.target) * 100);
                            tooltipExtra = `<br><br><div style="background: rgba(0,150,0,0.2); padding: 8px; border-radius: 5px; margin-top: 5px;">
                                <strong>üéØ Miss√£o em Andamento</strong><br>
                                <div style="background: rgba(0,0,0,0.3); border-radius: 5px; height: 20px; margin: 5px 0; position: relative;">
                                    <div style="background: linear-gradient(90deg, #00ff00, #00aa00); width: ${progressPercent}%; height: 100%; border-radius: 5px;"></div>
                                    <span style="position: absolute; top: 2px; left: 50%; transform: translateX(-50%); font-weight: bold; text-shadow: 1px 1px 2px #000;">
                                        ${mission.progress}/${mission.target}
                                    </span>
                                </div>
                                <small>Colete Pergaminhos nas fases 20-40!</small>
                            </div>`;
                        } else if (mission.completed) {
                            // Miss√£o completada - pode comprar normalmente
                            clickHandler = `openMissionModal('naruto_skill2')`;
                            tooltipExtra = `<br><br><span style="color: #00ff00;">‚úÖ Miss√£o Completada!</span>`;
                        }
                    } else if (upg.id === 'h1_u3') {
                        // L√≥gica especial para Rasengan (h1_u3) - Sistema de Miss√£o
                        let mission = gameState.missions.naruto_skill3;

                        // Verifica√ß√£o de seguran√ßa: se a miss√£o n√£o existe no save, criar
                        if (!mission) {
                            gameState.missions.naruto_skill3 = {
                                id: "naruto_skill3",
                                purchased: false,
                                completed: false,
                                progress: 0,
                                target: 80,
                                cost: 40
                            };
                            mission = gameState.missions.naruto_skill3; // Reatribuir ap√≥s criar
                        }

                        isUnlocked = mission.completed;

                        if (!mission.purchased && !mission.completed) {
                            // Miss√£o n√£o comprada - mostrar custo em diamantes
                            clickHandler = `openMissionModal('naruto_skill3')`;
                            tooltipExtra = `<br><br><div style="background: rgba(0,100,200,0.2); padding: 8px; border-radius: 5px; margin-top: 5px;">
                                <strong>üéØ Miss√£o: "Dominar a Rota√ß√£o do Chakra"</strong><br>
                                <span style="color: #00d4ff;">üíé Custo: ${mission.cost} Diamantes</span><br><br>
                                <strong>üìã Objetivo:</strong><br>
                                Coletar 80 N√∫cleos de Chakra Espiral<br>
                                nas fases 50-80 (6% de chance)<br><br>
                                <strong>üí• Efeito:</strong><br>
                                DPS de todos os her√≥is +15%<br>
                                Bosses recebem +35% dano de Vento<br>
                                Naruto ganha +10% dano adicional contra inimigos de Raio
                            </div>`;
                        } else if (mission.purchased && !mission.completed) {
                            // Miss√£o comprada mas n√£o completada - mostrar progresso
                            clickHandler = `openMissionModal('naruto_skill3')`;
                            const progressPercent = Math.floor((mission.progress / mission.target) * 100);
                            tooltipExtra = `<br><br><div style="background: rgba(0,150,0,0.2); padding: 8px; border-radius: 5px; margin-top: 5px;">
                                <strong>üéØ Miss√£o em Andamento</strong><br>
                                <div style="background: rgba(0,0,0,0.3); border-radius: 5px; height: 20px; margin: 5px 0; position: relative;">
                                    <div style="background: linear-gradient(90deg, #00ff00, #00aa00); width: ${progressPercent}%; height: 100%; border-radius: 5px;"></div>
                                    <span style="position: absolute; top: 2px; left: 50%; transform: translateX(-50%); font-weight: bold; text-shadow: 1px 1px 2px #000;">
                                        ${mission.progress}/${mission.target}
                                    </span>
                                </div>
                                <small>Colete N√∫cleos de Chakra Espiral nas fases 50-80!</small>
                            </div>`;
                        } else if (mission.completed) {
                            // Miss√£o completada - pode comprar normalmente
                            clickHandler = `openMissionModal('naruto_skill3')`;
                            tooltipExtra = `<br><br><span style="color: #00ff00;">‚úÖ Miss√£o Completada!</span>`;
                        }
                    } else if (upg.id === 'h1_u4') {
                        // L√≥gica especial para Modo S√°bio (h1_u4) - Miss√£o Lend√°ria com 3 Partes
                        let mission = gameState.missions.naruto_skill4;

                        // Verifica√ß√£o de seguran√ßa: se a miss√£o n√£o existe no save, criar
                        if (!mission) {
                            gameState.missions.naruto_skill4 = {
                                id: "naruto_skill4",
                                purchased: false,
                                completed: false,
                                cost: 120,
                                part1: { completed: false, progress: 0, target: 100 },
                                part2: { completed: false, bossDefeated: false },
                                part3: { completed: false, goldOffered: false }
                            };
                            mission = gameState.missions.naruto_skill4;
                        }

                        isUnlocked = mission.completed;

                        if (!mission.purchased && !mission.completed) {
                            // Miss√£o n√£o comprada - mostrar custo em diamantes
                            clickHandler = `openMissionModal('naruto_skill4')`;
                            tooltipExtra = `<br><br><div style="background: rgba(200,0,0,0.2); padding: 8px; border-radius: 5px; margin-top: 5px;">
                                <strong>üéØ Miss√£o Lend√°ria: "O Chakra Vermelho Come√ßa a Vazar‚Ä¶"</strong><br>
                                <span style="color: #ff4444;">üíé Custo: ${mission.cost} Diamantes</span><br><br>
                                <strong>üìã Miss√£o em 3 Partes:</strong><br>
                                Parte 1: Selos Quebrados<br>
                                Parte 2: O Chakra Vermelho Responde ao √ìdio<br>
                                Parte 3: Controle Inst√°vel<br><br>
                                <strong>üí• Recompensa Final:</strong><br>
                                Chakra da Ky≈´bi ( 1 Cauda )
                            </div>`;
                        } else if (mission.purchased && !mission.completed) {
                            // Miss√£o comprada mas n√£o completada - mostrar progresso das partes
                            clickHandler = `openMissionModal('naruto_skill4')`;

                            let partsCompleted = 0;
                            if (mission.part1.completed) partsCompleted++;
                            if (mission.part2.completed) partsCompleted++;
                            if (mission.part3.completed) partsCompleted++;

                            tooltipExtra = `<br><br><div style="background: rgba(200,0,0,0.2); padding: 8px; border-radius: 5px; margin-top: 5px;">
                                <strong>üéØ Miss√£o Lend√°ria em Andamento</strong><br>
                                <strong>Progresso: ${partsCompleted}/3 Partes Completas</strong><br><br>
                                <small>Clique para ver detalhes</small>
                            </div>`;
                        } else if (mission.completed) {
                            // Miss√£o completada - pode comprar normalmente
                            clickHandler = `openMissionModal('naruto_skill4')`;
                            tooltipExtra = `<br><br><span style="color: #ff4444;">‚úÖ Miss√£o Lend√°ria Completada!</span>`;
                        }
                    } else {
                        isUnlocked = hero.level >= upg.reqLevel;
                    }

                    let upgClass = 'skill-box';

                    // Verifica√ß√£o especial para miss√µes completadas
                    let missionCompleted = false;
                    if (upg.id === 'h1_u1' && gameState.missions.naruto_skill1?.completed) missionCompleted = true;
                    if (upg.id === 'h1_u2' && gameState.missions.naruto_skill2?.completed) missionCompleted = true;
                    if (upg.id === 'h1_u3' && gameState.missions.naruto_skill3?.completed) missionCompleted = true;
                    if (upg.id === 'h1_u4' && gameState.missions.naruto_skill4?.completed) missionCompleted = true;

                    // Verifica√ß√£o para miss√µes compradas (em andamento)
                    let missionPurchased = false;
                    if (upg.id === 'h1_u1' && gameState.missions.naruto_skill1?.purchased && !gameState.missions.naruto_skill1?.completed) missionPurchased = true;
                    if (upg.id === 'h1_u2' && gameState.missions.naruto_skill2?.purchased && !gameState.missions.naruto_skill2?.completed) missionPurchased = true;
                    if (upg.id === 'h1_u3' && gameState.missions.naruto_skill3?.purchased && !gameState.missions.naruto_skill3?.completed) missionPurchased = true;
                    if (upg.id === 'h1_u4' && gameState.missions.naruto_skill4?.purchased && !gameState.missions.naruto_skill4?.completed) missionPurchased = true;

                    if (isBought || missionCompleted) upgClass += ' bought';
                    else if (missionPurchased) upgClass += ' available in-progress';
                    else if (isUnlocked) upgClass += ' available';
                    else {
                        upgClass += ' locked';
                        // Se for a skill 1 do Naruto e tiver diamantes suficientes, adicionar classe affordable
                        if (upg.id === 'h1_u1') {
                            const mission = gameState.missions.naruto_skill1;
                            if (!mission.purchased && !mission.completed && gameState.diamonds >= mission.cost) {
                                upgClass += ' affordable';
                            }
                        }
                        // Se for a skill 2 do Naruto e tiver diamantes suficientes, adicionar classe affordable
                        if (upg.id === 'h1_u2') {
                            const mission = gameState.missions.naruto_skill2;
                            if (!mission.purchased && !mission.completed && gameState.diamonds >= mission.cost) {
                                upgClass += ' affordable';
                            }
                        }
                        // Se for a skill 3 do Naruto e tiver diamantes suficientes, adicionar classe affordable
                        if (upg.id === 'h1_u3') {
                            const mission = gameState.missions.naruto_skill3;
                            if (mission && !mission.purchased && !mission.completed && gameState.diamonds >= mission.cost) {
                                upgClass += ' affordable';
                            }
                        }
                        // Se for a skill 4 do Naruto e tiver diamantes suficientes, adicionar classe affordable
                        if (upg.id === 'h1_u4') {
                            const mission = gameState.missions.naruto_skill4;
                            if (mission && !mission.purchased && !mission.completed && gameState.diamonds >= mission.cost) {
                                upgClass += ' affordable';
                            }
                        }
                    }

                    const upgCost = hero.baseCost * upg.costMultiplier;

                    // Handle Image Icons
                    const isImageIcon = upg.icon.startsWith('./') || upg.icon.startsWith('http');
                    const iconContent = isImageIcon ? `<img src="${upg.icon}" class="skill-img-icon">` : upg.icon;

                    // Todas as habilidades s√£o clic√°veis para abrir modal
                    const onclickAttr = `onclick="${clickHandler}"`;


                    // Adicionar atributos data para hover em miss√µes completadas
                    let missionId = '';
                    let isCompleted = false;
                    if (upg.id === 'h1_u1') { missionId = 'naruto_skill1'; isCompleted = gameState.missions.naruto_skill1?.completed; }
                    if (upg.id === 'h1_u2') { missionId = 'naruto_skill2'; isCompleted = gameState.missions.naruto_skill2?.completed; }
                    if (upg.id === 'h1_u3') { missionId = 'naruto_skill3'; isCompleted = gameState.missions.naruto_skill3?.completed; }
                    if (upg.id === 'h1_u4') { missionId = 'naruto_skill4'; isCompleted = gameState.missions.naruto_skill4?.completed; }

                    const dataAttrs = missionId ? `data-mission-id="${missionId}" data-completed="${isCompleted}"` : '';

                    skillsHTML += `
                        <div class="${upgClass}" 
                             id="upg-${upg.id}"
                             ${onclickAttr}
                             ${dataAttrs}>
                             <div class="skill-icon">${iconContent}</div>
                             ${missionPurchased ? '<div class="skill-mission-active">üìú</div>' : ''}
                             ${!isCompleted ? `<div class="tooltip">
                                <strong>${upg.name}</strong><br>
                                ${upg.desc}<br>
                                ${isUnlocked && !isBought ? 'Custo: ' + formatNumber(upgCost) : ''}${tooltipExtra}
                             </div>` : ''}
                        </div>
                    `;
                });
            }
        }
        skillsHTML += '</div>';

        let rightColHTML = `
            <div class="card-right-col">
                ${levelHTML}
                ${skillsHTML}
                ${buyButtonHTML}
            </div>
        `;

        let overlayHTML = `
            <div class="hero-stats-overlay">
                ${statsHTML}
            </div>
        `;

        item.innerHTML = nameTitleHTML + `
            <div class="hero-card-inner-split">
                ${leftColHTML}
                ${rightColHTML}
                ${overlayHTML}
            </div>
        `;

        if (isLocked) {
            item.classList.add('locked-mystery');
        }

        listContainer.appendChild(item);
    }
}

function updateHeroUI(heroId) {
    const hero = gameState.heroes.find(h => h.id === heroId);
    if (!hero) return;

    // Atualizar N√≠vel
    const levelEl = document.getElementById(`hero-level-text-${hero.id}`);
    if (levelEl) levelEl.textContent = `N√≠vel ${hero.level}`;

    // Atualizar Custo
    const costEl = document.getElementById(`hero-cost-text-${hero.id}`);
    if (costEl) costEl.textContent = formatNumber(hero.currentCost);

    // Atualizar Valor de Dano no Overlay
    const statEl = document.getElementById(`hero-stat-val-${hero.id}`);
    if (statEl) statEl.textContent = formatNumber(hero.currentDps);

    // Verificar se desbloqueou algum slot de upgrade (20, 40, 60, 80)
    // Se sim, precisamos re-renderizar para mostrar o quadradinho
    const upgradeThresholds = [20, 40, 60, 80];
    if (upgradeThresholds.includes(hero.level)) {
        renderHeroesList();
    }
}

// Mec√¢nica de Compra de Heroi
function buyHero(heroId) {
    // Note: click event is handled via HTML onclick, arguments passed directly
    const hero = gameState.heroes.find(h => h.id === heroId);

    if (hero && gameState.gold >= hero.currentCost) {
        gameState.gold -= hero.currentCost;
        const oldLevel = hero.level;
        hero.level++;
        hero.currentCost = calculateCost(hero.baseCost, hero.level);
        hero.currentDps = hero.baseDps * hero.level;

        recalculateTotalDps();
        updateUI();

        if (oldLevel === 0) {
            renderHeroesList(); // Desbloqueia pr√≥ximo
        } else {
            updateHeroUI(heroId);
        }
    }
}

// Mec√¢nica de Compra de Upgrade
function buyUpgrade(upgId, cost, heroId) {
    event.stopPropagation(); // Impede borbulhar para compra de heroi
    if (gameState.upgrades.includes(upgId)) return;

    const hero = gameState.heroes.find(h => h.id === heroId);
    if (!hero) return;

    // Verificar requisitos
    const upg = heroUpgrades[heroId].find(u => u.id === upgId);
    if (!upg || hero.level < upg.reqLevel) return;

    if (gameState.gold >= cost) {
        gameState.gold -= cost;
        gameState.upgrades.push(upgId);
        recalculateTotalDps();
        updateUI();
        renderHeroesList();
    }
}

// Arena / Zoning Logic
function changeZone(direction) {
    if (direction === 'next') {
        if (gameState.currentZone < gameState.statistics.maxZone) {
            gameState.currentZone++;
            // Carregar progresso da zona ou iniciar em 0
            gameState.monstersKilledInZone = gameState.zoneProgress[gameState.currentZone] || 0;
            spawnMonster();
            renderArenas();
            updateUI();
        }
    } else if (direction === 'prev') {
        if (gameState.currentZone > 1) {
            gameState.currentZone--;
            // Carregar progresso da zona ou iniciar em 0
            gameState.monstersKilledInZone = gameState.zoneProgress[gameState.currentZone] || 0;
            spawnMonster();
            renderArenas();
            updateUI();
        }
    }
}

function renderArenas() {
    const container = document.getElementById('arenas-display');
    if (!container) return; // Safety
    container.innerHTML = '';

    // Sempre mostrar 5 zonas: 2 antes, atual, 2 depois
    // Ajustar para as primeiras zonas (1 e 2)
    let startZone = Math.max(1, gameState.currentZone - 2);
    let endZone = startZone + 4; // Sempre 5 zonas no total

    // Se estamos nas primeiras zonas, ajustar para sempre ter 5 zonas
    if (startZone === 1) {
        endZone = 5;
    } else if (startZone === 2) {
        endZone = 6;
    }

    for (let z = startZone; z <= endZone; z++) {
        const box = document.createElement('div');
        box.className = 'arena-box';
        box.textContent = z;

        if (z === gameState.currentZone) {
            box.classList.add('active');
        }

        if (z > gameState.statistics.maxZone) {
            box.classList.add('locked');
        } else {
            box.onclick = () => {
                if (z !== gameState.currentZone) {
                    gameState.currentZone = z;
                    gameState.monstersKilledInZone = 0;
                    spawnMonster();
                    renderArenas();
                    updateUI();
                }
            };
        }
        container.appendChild(box);
    }
}


// Spawning de Monstros
function spawnMonster() {
    if (!gameState.currentMonster) return;

    // Verifica se √© uma fase de boss (m√∫ltiplo de 5)
    const isBossZone = gameState.currentZone % 5 === 0;

    // Calcular HP baseado na progress√£o SEM contar fases de boss
    // Fases de boss n√£o contam para a progress√£o
    // Exemplo: Fase 1, 2, 3, 4, 6, 7, 8, 9, 11, 12...
    // A fase 5 (boss) n√£o conta, ent√£o fase 6 = progress√£o 5
    // A fase 10 (boss) n√£o conta, ent√£o fase 11 = progress√£o 9


    let effectiveZone;
    if (isBossZone) {
        // Boss: calcular HP baseado na zona anterior (√∫ltimo inimigo normal)
        // Zona anterior considerando bosses j√° passados
        const previousZone = gameState.currentZone - 1;
        const bossPhasesPassed = Math.floor((previousZone - 1) / 5);
        effectiveZone = previousZone - bossPhasesPassed;
    } else {
        // Inimigo normal: calcular quantas fases de boss j√° passaram
        const bossPhasesPassed = Math.floor((gameState.currentZone - 1) / 5);
        effectiveZone = gameState.currentZone - bossPhasesPassed;
    }

    // Calcular HP do inimigo normal baseado na zona efetiva
    const zoneMultiplier = Math.pow(zoneData.hpMultiplier, effectiveZone - 1);
    const normalEnemyHp = Math.floor(zoneData.baseHp * zoneMultiplier);

    if (isBossZone) {
        // Boss tem multiplicador progressivo baseado na f√≥rmula:
        // BossMultiplier(n) = 8 + (n √ó 0.1)
        // Com limite m√°ximo de 20x
        let bossMultiplier = 8 + (gameState.currentZone * 0.1);
        bossMultiplier = Math.min(bossMultiplier, 20); // Limitar a 20x

        gameState.currentMonster.maxHp = Math.floor(normalEnemyHp * bossMultiplier);
    } else {
        // Inimigo normal
        gameState.currentMonster.maxHp = normalEnemyHp;
    }

    gameState.currentMonster.hp = gameState.currentMonster.maxHp;

    // Para boss, usar nome gen√©rico
    let enemyName = "Boss";
    let enemyIndex = -1;

    const nameEl = document.getElementById('monster-name');
    const levelEl = document.getElementById('monster-level');

    const imgEl = document.getElementById('monster-img');
    if (imgEl) {
        if (isBossZone) {
            // Boss: usa imagem especial
            imgEl.src = bossImage;
            enemyName = "Boss";

            // Iniciar cron√¥metro de boss
            startBossTimer();

            // Esconder contador de monstros e mostrar cron√¥metro
            const monstersKilledEl = document.querySelector('.zone-progress-info');
            if (monstersKilledEl) monstersKilledEl.style.display = 'none';

            const bossTimerEl = document.getElementById('boss-timer');
            if (bossTimerEl) bossTimerEl.style.display = 'block';
        } else {
            // Inimigo normal: l√≥gica para evitar repetir o mesmo monstro em seguida
            let newIdx;
            do {
                newIdx = Math.floor(Math.random() * enemyData.length);
            } while (newIdx === gameState.lastEnemyIndex && enemyData.length > 1);

            gameState.lastEnemyIndex = newIdx;
            enemyIndex = newIdx;
            imgEl.src = enemyData[newIdx].img;
            enemyName = enemyData[newIdx].name;

            // Parar cron√¥metro se estiver rodando
            stopBossTimer();

            // Mostrar contador de monstros e esconder cron√¥metro
            const monstersKilledEl = document.querySelector('.zone-progress-info');
            if (monstersKilledEl) monstersKilledEl.style.display = 'block';

            const bossTimerEl = document.getElementById('boss-timer');
            if (bossTimerEl) bossTimerEl.style.display = 'none';
        }

        // Escalamento: a cada 5 fases aumenta 2% (1.02) para inimigos normais
        // Boss √© sempre 120% do tamanho do inimigo anterior
        let sizeMultiplier;
        if (isBossZone) {
            // Boss = tamanho base da zona anterior * 1.2
            const previousZoneMultiplier = Math.pow(1.02, Math.floor((gameState.currentZone - 1) / 5));
            sizeMultiplier = previousZoneMultiplier * 1.2;
        } else {
            sizeMultiplier = Math.pow(1.02, Math.floor(gameState.currentZone / 5));
        }

        imgEl.style.transform = `scale(${sizeMultiplier})`;
    }

    // Atualizar nome e n√≠vel do monstro
    gameState.currentMonster.name = enemyName;
    gameState.currentEnemyName = enemyName; // Salvar para sistema de drop
    if (nameEl) nameEl.textContent = enemyName;
    if (levelEl) levelEl.textContent = `N√≠vel ${gameState.currentZone}`;

    updateMonsterUI();
}

// Calcular dano elemental baseado nos buffs dos her√≥is
function calculateElementalDamage() {
    let elementalDmg = 0;
    let elementType = null;
    let windBonus = 0;

    // Verificar buffs do Naruto (elemento Vento)
    const naruto = gameState.heroes.find(h => h.id === 1);
    if (naruto && naruto.level > 0) {
        // Skill 1: Kage Bunshin (+15% dano de Vento)
        if (gameState.missions.naruto_skill1?.completed) {
            windBonus += 0.15;
        }

        // +10% adicional de dano contra inimigos de Raio (vantagem elemental)
        if (gameState.currentMonster && gameState.currentMonster.element === 'Raio') {
            windBonus += 0.10;
        }

        // Buffs de Vento contra bosses
        const isBoss = gameState.currentZone % 5 === 0;
        if (isBoss) {
            // Skill 3: Rasengan (+35% dano de Vento contra bosses)
            if (gameState.missions.naruto_skill3?.completed) {
                windBonus += 0.35;
            }

            // Skill 4: Chakra da Kyuubi (+40% dano de Vento contra bosses)
            if (gameState.missions.naruto_skill4?.completed) {
                windBonus += 0.40;
            }
        }

        // Calcular dano elemental de Vento (s√≥ se houver algum buff)
        if (windBonus > 0) {
            elementalDmg = gameState.clickDamage * windBonus;
            elementType = 'Vento';
        }
    }

    console.log('calculateElementalDamage - Resultado:', { damage: elementalDmg, type: elementType, windBonus: windBonus });
    return { damage: elementalDmg, type: elementType };
}

function damageMonster(amount, isClick = false, elementalDamage = 0, elementType = null) {
    // amount j√° √© o dano base puro (gameState.clickDamage)
    // elementalDamage √© calculado separadamente
    let finalBaseDmg = amount;
    let finalElementalDmg = elementalDamage;
    let isCrit = false;

    if (isClick && gameState.critChance > 0) {
        if (Math.random() < gameState.critChance) {
            finalBaseDmg *= gameState.clickCritMultiplier;
            finalElementalDmg *= gameState.clickCritMultiplier;
            isCrit = true;
        }
    }

    // Aplicar dano total (base + elemental)
    const totalDamage = finalBaseDmg + finalElementalDmg;
    gameState.currentMonster.hp -= totalDamage;
    if (gameState.currentMonster.hp < 0) gameState.currentMonster.hp = 0;

    if (isClick) {
        // Debug
        console.log('Dano Base:', finalBaseDmg, 'Dano Elemental:', finalElementalDmg, 'Tipo:', elementType);

        // Criar n√∫mero de dano base (branco)
        createDamageNumber(finalBaseDmg, isCrit, null);

        // Criar n√∫mero de dano elemental (colorido) se houver
        if (finalElementalDmg > 0 && elementType) {
            createDamageNumber(finalElementalDmg, isCrit, elementType);
        }

        animateMonsterShake();
        animateMonsterHitScale(); // Nova anima√ß√£o de aumento
        gameState.statistics.totalClicks++;
    }

    if (gameState.currentMonster.hp <= 0) {
        monterDeath();
    }

    updateMonsterUI();
}

function monterDeath() {
    // Recompensa
    const zoneMultiplier = Math.pow(zoneData.coinsMultiplier, gameState.currentZone - 1);
    const goldDrop = Math.ceil(Math.random() * 3 * zoneMultiplier);

    gameState.gold += goldDrop;
    gameState.statistics.totalKills++;

    // ========================================
    // PROGRESSO DA SKILL 1 - KAGE BUNSHIN NO JUTSU
    // ========================================
    // Contar qualquer morte de inimigo (n√£o precisa ser por clique)
    const skill1Mission = gameState.missions.naruto_skill1;
    if (skill1Mission && skill1Mission.purchased && !skill1Mission.completed) {
        skill1Mission.progress++;

        // Verificar se completou a miss√£o
        if (skill1Mission.progress >= skill1Mission.target) {
            skill1Mission.progress = skill1Mission.target;
            skill1Mission.completed = true;

            console.log('üéâ Miss√£o Kage Bunshin no Jutsu completada!');

            // Desbloquear a habilidade automaticamente
            const upgradeId = 'h1_u1';
            if (!gameState.upgrades.includes(upgradeId)) {
                gameState.upgrades.push(upgradeId);
                console.log(`‚úÖ Habilidade ${upgradeId} desbloqueada automaticamente!`);
            }

            // Mostrar modal de conclus√£o
            showMissionCompleteModal(
                'Kage Bunshin no Jutsu',
                'üåÄ',
                'Voc√™ completou a miss√£o e desbloqueou o Kage Bunshin no Jutsu! A habilidade j√° est√° dispon√≠vel para uso.'
            );

            renderHeroesList();
            saveGame();
        }
    }

    // Anima√ß√£o de moedas caindo
    createGoldCoins(goldDrop);

    // Verificar se √© boss
    const isBoss = gameState.currentZone % 5 === 0;

    if (isBoss) {
        // Boss morto: parar cron√¥metro e avan√ßar para pr√≥xima zona
        stopBossTimer();

        // Desbloquear pr√≥xima zona se for a zona m√°xima
        if (gameState.currentZone === gameState.statistics.maxZone) {
            gameState.statistics.maxZone++;
            renderArenas();
        }

        // Resetar contador de monstros mortos
        gameState.monstersKilledInZone = 0;
    } else {
        // Inimigo normal: incrementar contador
        gameState.monstersKilledInZone++;

        // Salvar progresso da zona
        gameState.zoneProgress[gameState.currentZone] = gameState.monstersKilledInZone;

        // Sistema de Drop de Itens (Veneno)
        // Apenas inimigos comuns (n√£o bosses) nas arenas 10-15 com 2% de chance
        const isInDropZone = gameState.currentZone >= 10 && gameState.currentZone <= 15;
        const dropChance = 0.02; // 2%

        if (isInDropZone && Math.random() < dropChance) {
            // Item dropado: Veneno
            const droppedItem = {
                icon: './static/img/items/poison.png',
                name: 'Frasco de Veneno',
                description: 'Um veneno mortal usado por ninjas',
                count: 1,
                isImage: true
            };

            // Adicionar ao invent√°rio
            if (addItemToInventory(droppedItem)) {
                // Mostrar notifica√ß√£o visual
                showItemDropNotification(droppedItem);
            }
        }

        // ========================================
        // SISTEMA DE DROP - PERGAMINHO RASGADO DE CLONE (SKILL 2 NARUTO)
        // ========================================
        // Apenas inimigos normais nas fases 20-40 com 8% de chance
        const mission2 = gameState.missions.naruto_skill2;
        if (mission2 && mission2.purchased && !mission2.completed) {
            const isInScrollDropZone = gameState.currentZone >= 20 && gameState.currentZone <= 40;
            const scrollDropChance = 0.08; // 8%

            if (isInScrollDropZone && Math.random() < scrollDropChance) {
                // Incrementar progresso da miss√£o
                mission2.progress++;
                console.log(`üåÄ Pergaminho Rasgado de Clone coletado! Progresso: ${mission2.progress}/${mission2.target}`);

                // Mostrar notifica√ß√£o visual
                const droppedItem = {
                    icon: 'üåÄ',
                    name: 'Pergaminho Rasgado de Clone',
                    description: 'Um pergaminho antigo com t√©cnicas de clones',
                    count: 1,
                    isImage: false
                };
                showItemDropNotification(droppedItem);

                // Verificar se completou a miss√£o
                if (mission2.progress >= mission2.target) {
                    mission2.progress = mission2.target;
                    mission2.completed = true;
                    console.log('üéâ Miss√£o Tajuu Kage Bunshin completada!');

                    // Desbloquear a habilidade automaticamente (comprar o upgrade)
                    const upgradeId = 'h1_u2'; // ID do upgrade Tajuu Kage Bunshin
                    if (!gameState.upgrades.includes(upgradeId)) {
                        gameState.upgrades.push(upgradeId);
                        console.log(`‚úÖ Habilidade ${upgradeId} desbloqueada automaticamente!`);
                    }

                    // Mostrar modal de conclus√£o
                    showMissionCompleteModal(
                        'Tajuu Kage Bunshin',
                        'üåÄ',
                        'Voc√™ completou a miss√£o e desbloqueou a habilidade Tajuu Kage Bunshin! A habilidade j√° est√° dispon√≠vel para uso.'
                    );

                    renderHeroesList();
                    saveGame();
                }

                // Atualizar painel de miss√µes se estiver vis√≠vel
                renderActiveMissions();
            }
        }

        // ========================================
        // SISTEMA DE DROP - N√öCLEO DE CHAKRA ESPIRAL (SKILL 3 NARUTO - RASENGAN)
        // ========================================
        // Apenas inimigos normais nas fases 50-80 com 6% de chance
        const mission3 = gameState.missions.naruto_skill3;
        if (mission3 && mission3.purchased && !mission3.completed) {
            const isInCoreDropZone = gameState.currentZone >= 50 && gameState.currentZone <= 80;
            const coreDropChance = 0.06; // 6%

            if (isInCoreDropZone && Math.random() < coreDropChance) {
                // Incrementar progresso da miss√£o
                mission3.progress++;
                console.log(`‚ö° N√∫cleo de Chakra Espiral coletado! Progresso: ${mission3.progress}/${mission3.target}`);

                // Mostrar notifica√ß√£o visual
                const droppedItem = {
                    icon: '‚ö°',
                    name: 'N√∫cleo de Chakra Espiral',
                    description: 'Um n√∫cleo pulsante de chakra em rota√ß√£o',
                    count: 1,
                    isImage: false
                };
                showItemDropNotification(droppedItem);

                // Verificar se completou a miss√£o
                if (mission3.progress >= mission3.target) {
                    mission3.progress = mission3.target;
                    mission3.completed = true;
                    console.log('üéâ Miss√£o Rasengan completada!');

                    // Desbloquear a habilidade automaticamente (comprar o upgrade)
                    const upgradeId = 'h1_u3'; // ID do upgrade Rasengan
                    if (!gameState.upgrades.includes(upgradeId)) {
                        gameState.upgrades.push(upgradeId);
                        console.log(`‚úÖ Habilidade ${upgradeId} desbloqueada automaticamente!`);
                    }

                    // Mostrar modal de conclus√£o
                    showMissionCompleteModal(
                        'Rasengan',
                        '‚ö°',
                        'Voc√™ completou a miss√£o e desbloqueou o Rasengan! A habilidade j√° est√° dispon√≠vel para uso.'
                    );

                    renderHeroesList();
                    saveGame();
                }

                // Atualizar painel de miss√µes se estiver vis√≠vel
                renderActiveMissions();
            }
        }

        // ========================================
        // SISTEMA DE DROP - SKILL 4 NARUTO (CHAKRA DA KYUUBI) - PARTE 1
        // ========================================
        const mission4 = gameState.missions.naruto_skill4;
        if (mission4 && mission4.purchased && !mission4.completed) {

            // PARTE 1: Fragmentos de Selo Enfraquecido (10% de chance em qualquer inimigo normal)
            // Apenas nas zonas 100-130
            const isInSealDropZone = gameState.currentZone >= 100 && gameState.currentZone <= 130;
            if (!mission4.part1.completed && isInSealDropZone && Math.random() < 0.10) {
                mission4.part1.progress++;
                console.log(`ü©∏ Fragmento de Selo Enfraquecido coletado! Progresso: ${mission4.part1.progress}/${mission4.part1.target}`);

                // Mostrar notifica√ß√£o visual
                const droppedItem = {
                    icon: 'ü©∏',
                    name: 'Fragmento de Selo Enfraquecido',
                    description: 'Um fragmento do selo que cont√©m a Kyuubi',
                    count: 1,
                    isImage: false
                };
                showItemDropNotification(droppedItem);

                // Verificar se completou a Parte 1
                if (mission4.part1.progress >= mission4.part1.target) {
                    mission4.part1.progress = mission4.part1.target;
                    mission4.part1.completed = true;
                    console.log('‚úÖ Parte 1 Completa: Selos Quebrados!');

                    // Notifica√ß√£o de conclus√£o da parte
                    showMissionNotification('Chakra da Kyuubi', 'Parte 1 Completa: Selos Quebrados!');

                    renderHeroesList();
                    saveGame();
                }

                // Atualizar painel de miss√µes
                renderActiveMissions();
            }
        }

        // Sistema de Drop de Diamantes (1% de chance para qualquer inimigo)
        if (Math.random() < 0.01) {
            const diamondsAmount = Math.floor(Math.random() * 3) + 1; // 1 a 3 diamantes
            gameState.diamonds += diamondsAmount;
            console.log(`üíé ${diamondsAmount} diamante(s) coletado(s)! Total: ${gameState.diamonds}`);

            // Criar anima√ß√£o de diamantes caindo
            createDiamondAnimation(diamondsAmount);
            updateUI();
        }

        // Desbloqueia pr√≥xima zona se matar o necess√°rio na zona MAXIMA atual
        if (gameState.monstersKilledInZone >= zoneData.monstersPerZone) {
            // Limitar a 10 para n√£o passar
            gameState.monstersKilledInZone = zoneData.monstersPerZone;
            gameState.zoneProgress[gameState.currentZone] = gameState.monstersKilledInZone;

            if (gameState.currentZone === gameState.statistics.maxZone) {
                gameState.statistics.maxZone++;
                renderArenas();
            }
        }
    }

    // ========================================
    // SISTEMA DE DROP - SKILL 4 NARUTO (CHAKRA DA KYUUBI) - PARTE 2
    // ========================================
    // PARTE 2: Res√≠duos de Chakra da Ky≈´bi (15% apenas em BOSSES nas zonas 100-200)
    // Esta l√≥gica est√° FORA do if/else para que execute quando bosses forem derrotados
    const mission4 = gameState.missions.naruto_skill4;
    if (mission4 && mission4.purchased && !mission4.completed) {
        const isInKyuubiDropZone = gameState.currentZone >= 100 && gameState.currentZone <= 200;

        // S√≥ pode progredir se a Parte 1 estiver completa E for um boss
        if (mission4.part1.completed && !mission4.part2.completed && isBoss && isInKyuubiDropZone) {
            console.log('üîç DEBUG Skill 4 Parte 2:');
            console.log('  - Parte 1 completa?', mission4.part1.completed);
            console.log('  - Parte 2 completa?', mission4.part2.completed);
            console.log('  - Zona atual:', gameState.currentZone);
            console.log('  - √â boss?', isBoss);
            console.log('  - Na zona de drop?', isInKyuubiDropZone);
            console.log('  - Part2 structure:', mission4.part2);

            // 15% de chance de drop
            if (Math.random() < 0.15) {
                mission4.part2.progress++;
                console.log(`üî¥ Res√≠duo de Chakra da Ky≈´bi coletado! Progresso: ${mission4.part2.progress}/${mission4.part2.target}`);

                // Mostrar notifica√ß√£o visual
                const droppedItem = {
                    icon: 'üî¥',
                    name: 'Res√≠duo de Chakra da Ky≈´bi',
                    description: 'Chakra vermelho e denso da Raposa de Nove Caudas',
                    count: 1,
                    isImage: false
                };
                showItemDropNotification(droppedItem);

                // Verificar se completou a Parte 2
                if (mission4.part2.progress >= mission4.part2.target) {
                    mission4.part2.progress = mission4.part2.target;
                    mission4.part2.completed = true;
                    console.log('‚úÖ Parte 2 Completa: O Chakra Vermelho Responde ao √ìdio!');

                    // Notifica√ß√£o de conclus√£o da parte
                    showMissionNotification('Chakra da Kyuubi', 'Parte 2 Completa: Chakra Vermelho Liberado!');

                    renderHeroesList();
                    saveGame();
                }

                // Atualizar painel de miss√µes
                renderActiveMissions();
            }
        }
    }

    spawnMonster();
    updateUI();
}

// ===== SISTEMA DE CRON√îMETRO DE BOSS =====
function startBossTimer() {
    // Parar qualquer cron√¥metro anterior
    stopBossTimer();

    // Resetar para 30 segundos
    gameState.bossTimer = 30;
    updateBossTimerDisplay();

    // Iniciar intervalo de 1 segundo
    gameState.bossTimerInterval = setInterval(() => {
        gameState.bossTimer--;
        updateBossTimerDisplay();

        // Adicionar classe de aviso quando restarem 10 segundos ou menos
        const bossTimerEl = document.getElementById('boss-timer');
        if (gameState.bossTimer <= 10) {
            if (bossTimerEl) bossTimerEl.classList.add('warning');
        } else {
            if (bossTimerEl) bossTimerEl.classList.remove('warning');
        }

        // Quando chegar a 0, resetar vida do boss
        if (gameState.bossTimer <= 0) {
            resetBossHealth();
        }
    }, 1000);
}

function stopBossTimer() {
    if (gameState.bossTimerInterval) {
        clearInterval(gameState.bossTimerInterval);
        gameState.bossTimerInterval = null;
    }

    // Remover classe de aviso
    const bossTimerEl = document.getElementById('boss-timer');
    if (bossTimerEl) bossTimerEl.classList.remove('warning');
}

function updateBossTimerDisplay() {
    const bossTimerValueEl = document.getElementById('boss-timer-value');
    if (bossTimerValueEl) {
        bossTimerValueEl.textContent = gameState.bossTimer;
    }
}

function resetBossHealth() {
    // Resetar vida do boss para o m√°ximo
    gameState.currentMonster.hp = gameState.currentMonster.maxHp;
    updateMonsterUI();

    // Reiniciar cron√¥metro
    startBossTimer();

    console.log('‚è±Ô∏è Tempo esgotado! Vida do boss resetada.');
}

// Loop Principal
function startGameLoop() {
    setInterval(() => {
        const now = Date.now();
        const deltaTime = now - lastUpdateTime;
        lastUpdateTime = now;

        // Se passou mais de 200ms desde a √∫ltima atualiza√ß√£o, processar tempo offline
        // (navegador throttle quando aba est√° inativa)
        if (deltaTime > 200 && gameState.totalDps > 0) {
            // Calcular quantos ticks aconteceram durante o tempo offline
            const offlineTicks = Math.floor(deltaTime / (1000 / TICKS_PER_SECOND));
            const ticksToProcess = Math.min(offlineTicks, 600); // Limitar a 60 segundos de progresso offline

            // Processar cada tick offline
            for (let i = 0; i < ticksToProcess; i++) {
                const dpsTick = gameState.totalDps / TICKS_PER_SECOND;
                if (dpsTick > 0 && gameState.currentMonster.hp > 0) {
                    damageMonster(dpsTick, false);
                }
            }
        } else {
            // Processamento normal
            if (gameState.totalDps > 0) {
                const dpsTick = gameState.totalDps / TICKS_PER_SECOND;
                if (dpsTick > 0 && gameState.currentMonster.hp > 0) {
                    damageMonster(dpsTick, false);
                }
            }
        }

        checkBuyButtons();
    }, 1000 / TICKS_PER_SECOND);
}

function checkBuyButtons() {
    // Apenas verifica se tem dinheiro para remover classe disabled nos herois?
    // Visualmente apenas. A logica √© checada no clique.
    // Como agora usamos renderHeroesList com frequencia, pode ser redundante se nao otimizado.
    // Mas vamos manter simples:
    gameState.heroes.forEach(hero => {
        const item = document.getElementById(`hero-${hero.id}`);
        if (item) {
            const btn = item.querySelector('.hero-buy-btn');
            if (btn && !btn.classList.contains('locked')) { // locked class is for mystery
                if (gameState.gold >= hero.currentCost) {
                    btn.classList.remove('disabled');
                } else {
                    btn.classList.add('disabled');
                }
            }
        }
    });

    // Upgrades
    gameState.heroes.forEach(hero => {
        const ups = heroUpgrades[hero.id];
        if (ups) {
            ups.forEach(u => {
                const el = document.getElementById(`upg-${u.id}`);
                const cost = hero.baseCost * u.costMultiplier;
                if (el) {
                    if (gameState.gold >= cost) {
                        el.style.borderColor = "#00ff00"; // Highlight available?
                        // ou usar classe .available se level permitir.
                        // renderHeroesList ja define .available baseado em level.
                    } else {
                        // el.style.borderColor = "";
                    }
                }
            });
        }
    });
}

// Event Listeners
function setupEventListeners() {
    const clickTarget = document.getElementById('click-target');
    if (clickTarget) {
        clickTarget.addEventListener('mousedown', (e) => {
            e.preventDefault();

            // Calcular dano elemental
            const elemental = calculateElementalDamage();

            // Aplicar dano base + dano elemental
            damageMonster(gameState.clickDamage, true, elemental.damage, elemental.type);

            const vis = clickTarget.querySelector('.monster-visual');
            if (vis) vis.style.transform = "scale(0.9)";
        });

        clickTarget.addEventListener('mouseup', () => {
            const vis = clickTarget.querySelector('.monster-visual');
            if (vis) vis.style.transform = "scale(1)";
        });
    }

    const prevBtn = document.getElementById('prev-zone');
    if (prevBtn) prevBtn.onclick = () => changeZone('prev');
    const nextBtn = document.getElementById('next-zone');
    if (nextBtn) nextBtn.onclick = () => changeZone('next');

    // Configurar eventos da mochila
    setupBackpackEventListeners();

    // Configurar eventos de miss√µes
    setupMissionEventListeners();

    // Configurar eventos do modal de conclus√£o de miss√£o
    setupMissionCompleteEventListeners();

    // Configurar eventos do painel admin
    setupAdminEventListeners();
}

// UI Helpers
function updateUI() {
    const goldEl = document.getElementById('player-gold');
    if (goldEl) goldEl.textContent = formatNumber(Math.floor(gameState.gold));

    const diamondsEl = document.getElementById('player-diamonds');
    if (diamondsEl) diamondsEl.textContent = formatNumber(gameState.diamonds);

    const dpsEl = document.getElementById('total-dps');
    if (dpsEl) dpsEl.textContent = formatNumber(Math.floor(gameState.totalDps));

    const clickValEl = document.getElementById('click-damage-val');
    if (clickValEl) clickValEl.textContent = formatNumber(Math.floor(gameState.clickDamage));

    const mkEl = document.getElementById('monsters-killed');
    if (mkEl) mkEl.textContent = gameState.monstersKilledInZone;

    // Stats footer/header
    const skEl = document.getElementById('stat-killed');
    if (skEl) skEl.textContent = formatNumber(gameState.statistics.totalKills);
    const scEl = document.getElementById('stat-clicks');
    if (scEl) scEl.textContent = formatNumber(gameState.statistics.totalClicks);
    const smzEl = document.getElementById('stat-max-zone');
    if (smzEl) smzEl.textContent = gameState.statistics.maxZone;
}

function updateMonsterUI() {
    if (!gameState.currentMonster) return;
    const pct = (gameState.currentMonster.hp / gameState.currentMonster.maxHp) * 100;
    const fill = document.getElementById('hp-fill');
    if (fill) fill.style.width = `${pct}%`;

    const curHp = document.getElementById('current-hp');
    if (curHp) curHp.textContent = formatNumber(Math.ceil(gameState.currentMonster.hp));
}

function createDamageNumber(amount, isCrit, elementType = null) {
    const container = document.getElementById('damage-numbers-container');
    if (!container) return;

    const el = document.createElement('div');
    el.className = 'damage-number';
    if (isCrit) {
        el.classList.add('damage-crit');
    }

    // Aplicar classe de elemento se houver
    if (elementType) {
        el.classList.add(`damage-${elementType.toLowerCase()}`);
    }

    el.textContent = formatNumber(Math.floor(amount));

    // Posi√ß√£o aleat√≥ria com offset para dano elemental
    const baseX = 50 + (Math.random() * 20 - 10);
    const baseY = 50 + (Math.random() * 20 - 10);

    // Se for dano elemental, deslocar um pouco para o lado
    const x = elementType ? baseX + 15 : baseX;
    const y = baseY;

    el.style.left = `${x}%`;
    el.style.top = `${y}%`;

    container.appendChild(el);

    setTimeout(() => el.remove(), 1000);
}

function animateMonsterShake() {
    const visual = document.querySelector('.monster-visual');
    if (visual) {
        visual.classList.remove('shake');
        void visual.offsetWidth;
        visual.classList.add('shake');
    }
}

function animateMonsterHitScale() {
    const visual = document.querySelector('.monster-visual');
    if (visual) {
        visual.classList.remove('hit-scale');
        void visual.offsetWidth; // Reflow
        visual.classList.add('hit-scale');
    }
}

function createGoldCoins(amount) {
    const container = document.getElementById('damage-numbers-container');
    if (!container) return;

    // Criar entre 1 e 3 moedas dependendo da quantidade de ouro
    const numCoins = Math.min(Math.max(1, Math.floor(amount / 30)), 3);

    for (let i = 0; i < numCoins; i++) {
        const coin = document.createElement('div');
        coin.className = 'gold-coin';
        coin.textContent = 'üí∞';

        // Posi√ß√£o inicial aleat√≥ria ao redor do meio do monstro (mais para baixo)
        const x = 45 + (Math.random() * 10 - 5); // 40-50%
        const y = 50 + (Math.random() * 15 - 7.5); // 42.5-57.5% (meio do personagem)

        coin.style.left = `${x}%`;
        coin.style.top = `${y}%`;

        // Pequeno delay para cada moeda criar efeito cascata
        coin.style.animationDelay = `${i * 0.08}s`;

        container.appendChild(coin);

        // Remover ap√≥s a anima√ß√£o (mais curto agora)
        setTimeout(() => coin.remove(), 800 + (i * 80));
    }
}

function createDiamondAnimation(amount) {
    const container = document.getElementById('damage-numbers-container');
    if (!container) return;

    // Criar diamantes baseado na quantidade dropada
    const numDiamonds = Math.min(amount, 5);

    for (let i = 0; i < numDiamonds; i++) {
        const diamond = document.createElement('div');
        diamond.className = 'diamond-drop';
        diamond.textContent = 'üíé';

        // Posi√ß√£o inicial aleat√≥ria ao redor do meio do monstro
        const x = 45 + (Math.random() * 10 - 5);
        const y = 50 + (Math.random() * 15 - 7.5);

        diamond.style.left = `${x}%`;
        diamond.style.top = `${y}%`;

        // Delay para efeito cascata
        diamond.style.animationDelay = `${i * 0.1}s`;

        container.appendChild(diamond);

        // Remover ap√≥s a anima√ß√£o
        setTimeout(() => diamond.remove(), 1000 + (i * 100));
    }
}

function showItemDropNotification(item) {
    // Criar elemento de notifica√ß√£o
    const notification = document.createElement('div');
    notification.className = 'item-drop-notification';

    // Criar conte√∫do
    const iconHTML = item.isImage
        ? `<img src="${item.icon}" alt="${item.name}">`
        : `<div style="font-size: 2.5em;">${item.icon}</div>`;

    notification.innerHTML = `
        ${iconHTML}
        <div class="drop-content">
            <div class="drop-text">ITEM ENCONTRADO!</div>
            <div class="item-name">${item.name}</div>
        </div>
    `;

    // Adicionar ao body
    document.body.appendChild(notification);

    // Remover ap√≥s 3 segundos
    setTimeout(() => {
        notification.remove();
    }, 3000);
}

// Fun√ß√£o para mostrar notifica√ß√£o de progresso de miss√£o
function showMissionNotification(missionName, message) {
    const notification = document.createElement('div');
    notification.className = 'mission-notification';
    notification.innerHTML = `
        <div class="mission-notification-content">
            <div class="mission-notification-title">üî¥ ${missionName}</div>
            <div class="mission-notification-message">${message}</div>
        </div>
    `;

    document.body.appendChild(notification);

    // Remover ap√≥s 4 segundos
    setTimeout(() => {
        notification.style.opacity = '0';
        setTimeout(() => notification.remove(), 500);
    }, 4000);
}


// Fun√ß√£o para desbloquear o Rasengan do Naruto
function unlockNarutoRasengan() {
    console.log('üåÄ Desbloqueando Rasengan!');

    // Adicionar a skill aos upgrades
    if (!gameState.upgrades.includes('h1_u3')) {
        gameState.upgrades.push('h1_u3');

        // Recalcular DPS com a nova skill
        recalculateTotalDps();
        updateUI();
        renderHeroesList();

        // Mostrar notifica√ß√£o especial
        const notification = document.createElement('div');
        notification.className = 'item-drop-notification rasengan-unlock';
        notification.innerHTML = `
            <div style="font-size: 3em;">üåÄ</div>
            <div class="drop-content">
                <div class="drop-text">SKILL DESBLOQUEADA!</div>
                <div class="item-name">Rasengan</div>
                <div style="font-size: 0.9em; margin-top: 5px;">DPS de Todos +15%</div>
            </div>
        `;
        document.body.appendChild(notification);
        setTimeout(() => notification.remove(), 5000);

        console.log('‚úÖ Rasengan desbloqueado com sucesso!');
    }
}

function formatNumber(num) {
    // N√∫meros maiores que 1 trilh√£o usam nota√ß√£o cient√≠fica
    if (num >= 1e15) {
        const exponent = Math.floor(Math.log10(num));
        const mantissa = num / Math.pow(10, exponent);
        return mantissa.toFixed(2) + '^' + exponent;
    }

    // Formata√ß√£o padr√£o: k, M, B, T
    if (num >= 1000000000000) return (num / 1000000000000).toFixed(2) + 'T';
    if (num >= 1000000000) return (num / 1000000000).toFixed(2) + 'B';
    if (num >= 1000000) return (num / 1000000).toFixed(2) + 'M';
    if (num >= 1000) return (num / 1000).toFixed(1) + 'k';
    return Math.floor(num).toString();
}

// Persistence
function saveGame() {
    const saveObj = {
        gold: gameState.gold,
        currentZone: gameState.currentZone,
        savedHeroes: gameState.heroes.map(h => ({ id: h.id, level: h.level })),
        upgrades: gameState.upgrades,
        statistics: gameState.statistics,
        inventory: gameState.inventory,
        diamonds: gameState.diamonds, // Salvar diamantes
        missions: gameState.missions // Salvar miss√µes
    };
    localStorage.setItem('narutoClickerSave', JSON.stringify(saveObj));
}

function loadGame() {
    const saveStr = localStorage.getItem('narutoClickerSave');
    if (saveStr) {
        try {
            const saved = JSON.parse(saveStr);
            gameState.gold = saved.gold || 0;
            gameState.currentZone = saved.currentZone || 1;
            gameState.savedHeroes = saved.savedHeroes || [];
            gameState.upgrades = saved.upgrades || [];
            gameState.statistics = { ...gameState.statistics, ...saved.statistics };
            gameState.inventory = saved.inventory || [];
            gameState.diamonds = saved.diamonds || 0; // Carregar diamantes
            gameState.missions = saved.missions || gameState.missions; // Carregar miss√µes

            // CORRE√á√ÉO AUTOM√ÅTICA: Garantir estrutura correta da Skill 4
            if (gameState.missions.naruto_skill4) {
                // Corrigir part1
                if (!gameState.missions.naruto_skill4.part1) {
                    gameState.missions.naruto_skill4.part1 = { completed: false, progress: 0, target: 100 };
                }
                if (typeof gameState.missions.naruto_skill4.part1.progress === 'undefined') {
                    gameState.missions.naruto_skill4.part1.progress = 0;
                }
                if (typeof gameState.missions.naruto_skill4.part1.target === 'undefined') {
                    gameState.missions.naruto_skill4.part1.target = 100;
                }

                // Corrigir part2
                if (!gameState.missions.naruto_skill4.part2) {
                    gameState.missions.naruto_skill4.part2 = { completed: false, progress: 0, target: 8 };
                }
                if (typeof gameState.missions.naruto_skill4.part2.progress === 'undefined') {
                    console.log('üîß [LOAD] Adicionando progress √† part2');
                    gameState.missions.naruto_skill4.part2.progress = 0;
                }
                if (typeof gameState.missions.naruto_skill4.part2.target === 'undefined') {
                    console.log('üîß [LOAD] Adicionando target √† part2');
                    gameState.missions.naruto_skill4.part2.target = 8;
                }

                // Corrigir part3
                if (!gameState.missions.naruto_skill4.part3) {
                    gameState.missions.naruto_skill4.part3 = { completed: false, goldOffered: false };
                }
            }

            if (!gameState.statistics.maxZone) gameState.statistics.maxZone = 1;
        } catch (e) {
            console.error("Erro save", e);
        }
    }
}

function resetGame() {
    // Resetar sem confirma√ß√£o
    localStorage.removeItem('narutoClickerSave');
    location.reload();
}

// ===== SISTEMA DE MOCHILA =====
function setupBackpackEventListeners() {
    console.log('üéí Configurando eventos da mochila...');
    const openBackpackBtn = document.getElementById('open-backpack');
    const closeBackpackBtn = document.getElementById('close-backpack');
    const backpackModal = document.getElementById('backpack-modal');

    if (!openBackpackBtn || !closeBackpackBtn || !backpackModal) {
        console.warn('‚ö†Ô∏è Elementos da mochila n√£o encontrados');
        return;
    }
    console.log('‚úÖ Elementos da mochila encontrados, configurando listeners...');

    // Abrir modal
    openBackpackBtn.addEventListener('click', () => {
        console.log('üéí Abrindo mochila...');
        backpackModal.classList.add('active');
        console.log('Classes do modal:', backpackModal.className);
        renderInventory();
    });

    // Fechar modal
    closeBackpackBtn.addEventListener('click', () => {
        console.log('‚ùå Fechando mochila (bot√£o X)...');
        backpackModal.classList.remove('active');
    });

    // Fechar ao clicar fora do modal (no backdrop)
    backpackModal.addEventListener('click', (e) => {
        if (e.target === backpackModal) {
            console.log('‚ùå Fechando mochila (clique fora)...');
            backpackModal.classList.remove('active');
        }
    });

    // Inicializar grid de invent√°rio
    initializeInventory();

    // Inicializar painel admin
    setupAdminPanel();
}

function initializeInventory() {
    const inventoryGrid = document.getElementById('inventory-grid');
    const totalSlots = 40;

    for (let i = 0; i < totalSlots; i++) {
        const slot = document.createElement('div');
        slot.className = 'inventory-slot empty';
        slot.dataset.slotIndex = i;
        inventoryGrid.appendChild(slot);
    }
}

function addItemToInventory(newItem) {
    // Verificar se o item j√° existe no invent√°rio (mesmo nome)
    const existingItem = gameState.inventory.find(item => item && item.name === newItem.name);

    if (existingItem) {
        // Se j√° existe, aumentar a contagem
        existingItem.count += newItem.count;
    } else {
        // Se n√£o existe, adicionar em um slot vazio
        const emptySlotIndex = gameState.inventory.findIndex(item => !item);

        if (emptySlotIndex !== -1) {
            // Tem slot vazio, adicionar l√°
            gameState.inventory[emptySlotIndex] = newItem;
        } else if (gameState.inventory.length < 40) {
            // N√£o tem slot vazio mas ainda tem espa√ßo
            gameState.inventory.push(newItem);
        } else {
            // Invent√°rio cheio
            console.warn('‚ö†Ô∏è Invent√°rio cheio! N√£o foi poss√≠vel adicionar o item.');
            return false;
        }
    }

    // Salvar o jogo ap√≥s adicionar item
    saveGame();
    return true;
}

function renderInventory() {
    const slots = document.querySelectorAll('.inventory-slot');

    slots.forEach((slot, index) => {
        const item = gameState.inventory[index];

        if (item) {
            slot.className = 'inventory-slot has-item';

            // Verificar se o √≠cone √© uma imagem ou emoji
            const iconHTML = item.isImage
                ? `<img src="${item.icon}" class="item-icon-img" alt="${item.name}">`
                : `<span class="item-icon">${item.icon}</span>`;

            slot.innerHTML = `
                ${iconHTML}
                ${item.count > 1 ? `<span class="item-count">x${item.count}</span>` : ''}
            `;
            slot.title = `${item.name}\n${item.description}`;
        } else {
            slot.className = 'inventory-slot empty';
            slot.innerHTML = '';
            slot.title = 'Slot vazio';
        }
    });
}

// ===== ADMIN PANEL =====
function setupAdminPanel() {
    const adminTrigger = document.getElementById('admin-trigger');
    const adminModal = document.getElementById('admin-modal');
    const closeAdminBtn = document.getElementById('close-admin');
    const addGoldBtn = document.getElementById('add-gold-btn');
    const goldInput = document.getElementById('gold-input');

    // Abrir modal admin
    adminTrigger.addEventListener('click', () => {
        adminModal.style.display = 'flex';
        goldInput.value = '';
        goldInput.focus();
    });

    // Fechar modal admin
    closeAdminBtn.addEventListener('click', () => {
        adminModal.style.display = 'none';
    });

    // Fechar ao clicar fora
    adminModal.addEventListener('click', (e) => {
        if (e.target === adminModal) {
            adminModal.style.display = 'none';
        }
    });

    // Adicionar ouro
    addGoldBtn.addEventListener('click', () => {
        const amount = parseFloat(goldInput.value);
        if (amount && amount > 0) {
            gameState.gold += amount;
            updateUI();
            saveGame();
            goldInput.value = '';
            console.log(`‚úÖ Admin: Adicionado ${formatNumber(amount)} de ouro`);
        }
    });

    // Enter para adicionar
    goldInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
            addGoldBtn.click();
        }
    });
}

window.onload = initGame;


// ===== SISTEMA DE MISS√ïES =====
function openMissionModal(missionId) {
    const modal = document.getElementById('mission-modal');
    const content = document.getElementById('mission-content');
    const titleText = document.getElementById('mission-title-text');
    const purchaseBtn = document.getElementById('purchase-mission-btn');

    if (missionId === 'naruto_skill1') {
        const mission = gameState.missions.naruto_skill1;

        titleText.textContent = '';

        // Se a miss√£o estiver completada, mostrar apenas os buffs
        if (mission.completed) {
            content.innerHTML = `
                <div class="mission-details">
                    <h3>Kage Bunshin no Jutsu</h3>
                    <div style="text-align: center; color: #00ff00; margin-bottom: 15px;">
                        <strong>‚úÖ Habilidade Desbloqueada!</strong>
                    </div>
                    
                    <div class="mission-section-effect">
                        <h4>üìå Efeito</h4>
                        <p><strong>Dano de Clique do Naruto x2</strong></p>
                    </div>
                    
                    <div class="mission-section bonus">
                        <h4>üí• B√¥nus Elemental (Vento)</h4>
                        <p><strong>Clique recebe +15% adicional</strong></p>
                    </div>
                </div>
            `;
            purchaseBtn.style.display = 'none';
        } else {
            // Miss√£o n√£o completada - mostrar requisitos e objetivos
            content.innerHTML = `
                <div class="mission-details">
                    <h3>Kage Bunshin no Jutsu</h3>
                    <div class="mission-section-effect">
                        <h4>üìå Efeito</h4>
                        <p><strong>Dano de Clique do Naruto x2</strong></p>
                    </div>
                    
                    <div class="mission-section bonus">
                        <h4>üí• B√¥nus Elemental (Vento)</h4>
                        <p><strong>Clique recebe +15% adicional</strong></p>
                    </div>
                    
                    <div class="mission-section objective">
                        <h4>üìã Objetivo da Miss√£o</h4>
                        <p>Derrotar <strong>150 inimigos normais</strong><br>
                        entre as <strong>fases 1-10</strong><br>
                        usando <strong>apenas clique</strong> (sem DPS)</p>
                        ${mission.purchased ? `<br><div style="background: rgba(0,0,0,0.3); border-radius: 5px; height: 20px; margin: 5px 0; position: relative;">
                            <div style="background: linear-gradient(90deg, #00ff00, #00aa00); width: ${Math.floor((mission.progress / mission.target) * 100)}%; height: 100%; border-radius: 5px;"></div>
                            <span style="position: absolute; top: 2px; left: 50%; transform: translateX(-50%); font-weight: bold; text-shadow: 1px 1px 2px #000;">
                                ${mission.progress}/${mission.target}
                            </span>
                        </div>` : ''}
                    </div>
                    
                    ${!mission.purchased ? `
                    <div class="mission-cost">
                        <span class="cost-label">Custo da Miss√£o:</span>
                        <span class="cost-value">üíé ${mission.cost} Diamantes</span>
                    </div>
                    
                    <div class="player-diamonds">
                        Seus Diamantes: <span class="${gameState.diamonds >= mission.cost ? 'enough' : 'not-enough'}">
                            üíé ${gameState.diamonds}
                        </span>
                    </div>
                    ` : ''}
                </div>
            `;

            // Configurar bot√£o de compra
            if (!mission.purchased) {
                purchaseBtn.onclick = () => purchaseMission(missionId);
                purchaseBtn.disabled = gameState.diamonds < mission.cost;
                purchaseBtn.style.display = 'block';
            } else {
                purchaseBtn.style.display = 'none';
            }
        }
    } else if (missionId === 'naruto_skill2') {
        const mission = gameState.missions.naruto_skill2;

        titleText.textContent = '';

        // Se a miss√£o estiver completada, mostrar apenas os buffs
        if (mission.completed) {
            content.innerHTML = `
                <div class="mission-details">
                    <h3>Tajuu Kage Bunshin</h3>
                    <div style="text-align: center; color: #00ff00; margin-bottom: 15px;">
                        <strong>‚úÖ Habilidade Desbloqueada!</strong>
                    </div>
                    
                    <div class="mission-section-effect">
                        <h4>üìå Efeito</h4>
                        <p><strong>Dano de Clique x2</strong><br>
                        (stack com Skill 1 ‚Üí total x4)<br><br>
                        Naruto ganha:<br>
                        <strong>+20% DPS pr√≥prio adicional</strong><br><br>
                        Cada 10 n√≠veis do Naruto:<br>
                        <strong>+1% DPS global</strong></p>
                    </div>
                    
                    <div class="mission-section bonus">
                        <h4>üí• B√¥nus Elemental (Vento)</h4>
                        <p><strong>Clique recebe +15% adicional</strong></p>
                    </div>
                </div>
            `;
            purchaseBtn.style.display = 'none';
        } else {
            // Miss√£o n√£o completada - mostrar requisitos e objetivos
            content.innerHTML = `
                <div class="mission-details">
                    <h3>Tajuu Kage Bunshin</h3>
                    
                    <div class="mission-section-effect">
                        <h4>üìå Efeito</h4>
                        <p><strong>Dano de Clique x2 novamente</strong><br>
                        (stack com Skill 1 ‚Üí total x4)<br><br>
                        Naruto ganha:<br>
                        <strong>+20% DPS pr√≥prio adicional</strong><br><br>
                        Cada 10 n√≠veis do Naruto:<br>
                        <strong>+1% DPS global</strong></p>
                    </div>
                    
                    <div class="mission-section bonus">
                        <h4>üí• B√¥nus Elemental (Vento)</h4>
                        <p><strong>Clique recebe +15% adicional</strong></p>
                    </div>
                    
                    <div class="mission-section objective">
                        <h4>üìã Objetivo da Miss√£o</h4>
                        <p>Dropar item de miss√£o:<br>
                        <strong>üåÄ Pergaminho Rasgado de Clone</strong><br><br>
                        Dropa apenas em <strong>fases 20‚Äì40</strong><br>
                        Chance: <strong>8% por inimigo morto</strong><br>
                        Precisa de: <strong>30 Pergaminhos</strong></p>
                        ${mission.purchased ? `<br><div style="background: rgba(0,0,0,0.3); border-radius: 5px; height: 20px; margin: 5px 0; position: relative;">
                            <div style="background: linear-gradient(90deg, #00ff00, #00aa00); width: ${Math.floor((mission.progress / mission.target) * 100)}%; height: 100%; border-radius: 5px;"></div>
                            <span style="position: absolute; top: 2px; left: 50%; transform: translateX(-50%); font-weight: bold; text-shadow: 1px 1px 2px #000;">
                                ${mission.progress}/${mission.target}
                            </span>
                        </div>` : ''}
                    </div>
                    
                    ${!mission.purchased ? `
                    <div class="mission-cost">
                        <span class="cost-label">Custo da Miss√£o:</span>
                        <span class="cost-value">üíé ${mission.cost} Diamantes</span>
                    </div>
                    
                    <div class="player-diamonds">
                        Seus Diamantes: <span class="${gameState.diamonds >= mission.cost ? 'enough' : 'not-enough'}">
                            üíé ${gameState.diamonds}
                        </span>
                    </div>
                    ` : ''}
                </div>
            `;

            // Configurar bot√£o de compra
            if (!mission.purchased) {
                purchaseBtn.onclick = () => purchaseMission(missionId);
                purchaseBtn.disabled = gameState.diamonds < mission.cost;
                purchaseBtn.style.display = 'block';
            } else {
                purchaseBtn.style.display = 'none';
            }
        }
    } else if (missionId === 'naruto_skill3') {
        // Verifica√ß√£o de seguran√ßa: se a miss√£o n√£o existe no save, criar
        if (!gameState.missions.naruto_skill3) {
            gameState.missions.naruto_skill3 = {
                id: "naruto_skill3",
                purchased: false,
                completed: false,
                progress: 0,
                target: 80,
                cost: 40
            };
        }

        const mission = gameState.missions.naruto_skill3;

        titleText.textContent = '';

        // Se a miss√£o estiver completada, mostrar apenas os buffs
        if (mission.completed) {
            content.innerHTML = `
                <div class="mission-details">
                    <h3>Rasengan</h3>
                    <div style="text-align: center; color: #00ff00; margin-bottom: 15px;">
                        <strong>‚úÖ Habilidade Desbloqueada!</strong>
                    </div>
                    
                    <div class="mission-section-effect">
                        <h4>üìå Efeito</h4>
                        <p><strong>Buff Global + Dano Elemental</strong><br><br>
                        DPS de todos os her√≥is: <strong>+15%</strong><br>
                        Bosses recebem: <strong>+35% dano de Vento</strong><br>
                        Naruto ganha: <strong>+10% dano adicional contra inimigos de Raio</strong></p>
                    </div>
                </div>
            `;
            purchaseBtn.style.display = 'none';
        } else {
            // Miss√£o n√£o completada - mostrar requisitos e objetivos
            content.innerHTML = `
                <div class="mission-details">
                    <h3>Rasengan</h3>
                    
                    <div class="mission-section-effect">
                        <h4>üìå Efeito</h4>
                        <p><strong>Buff Global + Dano Elemental</strong><br><br>
                        DPS de todos os her√≥is: <strong>+15%</strong><br>
                        Bosses recebem: <strong>+35% dano de Vento</strong><br>
                        Naruto ganha: <strong>+10% dano adicional contra inimigos de Raio</strong></p>
                    </div>
                    
                    <div class="mission-section objective">
                        <h4>üìã Objetivo da Miss√£o</h4>
                        <p>Coletar item de miss√£o:<br>
                        <strong>üåÄ N√∫cleo de Chakra Espiral</strong><br><br>
                        Dropa apenas entre as <strong>fases 50‚Äì80</strong><br>
                        Chance: <strong>6% por inimigo</strong><br>
                        Precisa de: <strong>80 N√∫cleos</strong></p>
                        ${mission.purchased ? `<br><div style="background: rgba(0,0,0,0.3); border-radius: 5px; height: 20px; margin: 5px 0; position: relative;">
                            <div style="background: linear-gradient(90deg, #00ff00, #00aa00); width: ${Math.floor((mission.progress / mission.target) * 100)}%; height: 100%; border-radius: 5px;"></div>
                            <span style="position: absolute; top: 2px; left: 50%; transform: translateX(-50%); font-weight: bold; text-shadow: 1px 1px 2px #000;">
                                ${mission.progress}/${mission.target}
                            </span>
                        </div>` : ''}
                    </div>
                    
                    ${!mission.purchased ? `
                    <div class="mission-cost">
                        <span class="cost-label">Custo da Miss√£o:</span>
                        <span class="cost-value">üíé ${mission.cost} Diamantes</span>
                    </div>
                    
                    <div class="player-diamonds">
                        Seus Diamantes: <span class="${gameState.diamonds >= mission.cost ? 'enough' : 'not-enough'}">
                            üíé ${gameState.diamonds}
                        </span>
                    </div>
                    ` : ''}
                </div>
            `;

            // Configurar bot√£o de compra
            if (!mission.purchased) {
                purchaseBtn.onclick = () => purchaseMission(missionId);
                purchaseBtn.disabled = gameState.diamonds < mission.cost;
                purchaseBtn.style.display = 'block';
            } else {
                purchaseBtn.style.display = 'none';
            }
        }
    } else if (missionId === 'naruto_skill4') {
        // Verifica√ß√£o de seguran√ßa
        if (!gameState.missions.naruto_skill4) {
            gameState.missions.naruto_skill4 = {
                id: "naruto_skill4",
                purchased: false,
                completed: false,
                cost: 120,
                part1: { completed: false, progress: 0, target: 100 },
                part2: { completed: false, progress: 0, target: 8 },
                part3: { completed: false, goldOffered: false }
            };
        }

        // CORRE√á√ÉO AUTOM√ÅTICA: Atualizar target da parte 1 de 12 para 100
        if (gameState.missions.naruto_skill4.part1 && gameState.missions.naruto_skill4.part1.target === 12) {
            console.log('üîß Corrigindo target da skill 4 parte 1: 12 ‚Üí 100');
            gameState.missions.naruto_skill4.part1.target = 100;
            saveGame();
        }

        // CORRE√á√ÉO AUTOM√ÅTICA: Garantir que part2 tenha progress e target
        if (gameState.missions.naruto_skill4.part2) {
            if (typeof gameState.missions.naruto_skill4.part2.progress === 'undefined') {
                console.log('üîß Adicionando progress √† part2');
                gameState.missions.naruto_skill4.part2.progress = 0;
            }
            if (typeof gameState.missions.naruto_skill4.part2.target === 'undefined') {
                console.log('üîß Adicionando target √† part2');
                gameState.missions.naruto_skill4.part2.target = 8;
            }
            saveGame();
        }

        const mission = gameState.missions.naruto_skill4;
        titleText.textContent = '';

        // Se a miss√£o estiver completada, mostrar apenas os buffs
        if (mission.completed) {
            content.innerHTML = `
                <div class="mission-details">
                    <h3 style="color: #ff4444;">üî¥ Chakra da Ky≈´bi ( 1 Cauda )</h3>
                    <p style="text-align: center; color: #ff4444; font-style: italic;">Miss√£o Lend√°ria ‚Äî Ultimate Skill</p>
                    <div style="text-align: center; color: #00ff00; margin-bottom: 15px;">
                        <strong>‚úÖ Habilidade Desbloqueada!</strong>
                    </div>
                    
                    <div class="mission-section-effect">
                        <h4>üìå Efeito</h4>
                        <p><strong>Ultimate Skill ‚Äî Burst de Emerg√™ncia (Genin)</strong><br><br>
                        <strong>Durante Boss Fight:</strong><br>
                        Clique do Naruto: <strong>+150% dano (x2.5)</strong><br>
                        DPS global do time: <strong>+15%</strong><br>
                        Bosses recebem: <strong>+40% dano de Vento</strong><br>
                        Dano Cr√≠tico: <strong>+5% a cada 20 n√≠veis do Naruto</strong><br><br>
                        <strong>üî• Quando o boss est√° abaixo de 30% HP:</strong><br>
                        Naruto entra em "surto"<br>
                        Clique do Naruto recebe mais <strong>+50% dano</strong></p>
                    </div>
                </div>
            `;
            purchaseBtn.style.display = 'none';
        } else {
            // Miss√£o n√£o completada - mostrar requisitos e objetivos
            // Determinar quantas partes mostrar
            let showPart2 = mission.part1.completed;
            let showPart3 = mission.part1.completed && mission.part2.completed;

            // Estilos para partes completadas
            const completedStyle = 'text-decoration: line-through; color: #00ff00;';
            const completedClass = mission.part1.completed ? completedStyle : '';
            const completed2Class = mission.part2.completed ? completedStyle : '';
            const completed3Class = mission.part3.completed ? completedStyle : '';

            content.innerHTML = `
                <div class="mission-details">
                    <h3 style="color: #ff4444;">üî¥ Chakra da Ky≈´bi ( 1 Cauda )</h3>
                    <p style="text-align: center; color: #ff4444; font-style: italic;">Miss√£o Lend√°ria ‚Äî Ultimate Skill</p>
                    
                    <div class="mission-section-effect">
                        <h4>üìå Efeito</h4>
                        <p><strong>Ultimate Skill ‚Äî Burst de Emerg√™ncia (Genin)</strong><br><br>
                        <strong>Durante Boss Fight:</strong><br>
                        Clique do Naruto: <strong>+150% dano (x2.5)</strong><br>
                        DPS global do time: <strong>+15%</strong><br>
                        Bosses recebem: <strong>+40% dano de Vento</strong><br>
                        Dano Cr√≠tico: <strong>+5% a cada 20 n√≠veis do Naruto</strong><br><br>
                        <strong>üî• Quando o boss est√° abaixo de 30% HP:</strong><br>
                        Naruto entra em "surto"<br>
                        Clique do Naruto recebe mais <strong>+50% dano</strong></p>
                    </div>
                    
                    <div class="mission-section objective">
                        <h4>üìã Miss√£o: "O Chakra Vermelho Come√ßa a Vazar‚Ä¶"</h4>
                        
                        <!-- Parte 1 -->
                        <div style="margin-bottom: 15px;">
                            <p style="${completedClass}"><strong>Parte 1/3 ‚Äî Selos Quebrados</strong></p>
                            ${mission.purchased && !mission.part1.completed ? `
                                <div style="background: rgba(0,0,0,0.3); border-radius: 5px; height: 20px; margin: 5px 0; position: relative;">
                                    <div style="background: linear-gradient(90deg, #ff4444, #cc0000); width: ${Math.floor(((mission.part1.progress || 0) / (mission.part1.target || 100)) * 100)}%; height: 100%; border-radius: 5px;"></div>
                                    <span style="position: absolute; top: 2px; left: 50%; transform: translateX(-50%); font-weight: bold; text-shadow: 1px 1px 2px #000; font-size: 0.9em;">
                                        ${mission.part1.progress || 0}/${mission.part1.target || 100}
                                    </span>
                                </div>
                            ` : ''}
                            <p style="${completedClass}; font-size: 0.9em;">
                            ${mission.purchased ? `<strong>${mission.part1.progress || 0}/${mission.part1.target || 100}</strong><br>` : ''}
                            Dropar: <strong>ü©∏ Fragmento de Selo Enfraquecido</strong><br>
                            Chance de drop: <strong style="color: #ffd700;">10% ao derrotar inimigos</strong><br>
                            Meta: <strong>100 Fragmentos</strong></p>
                        </div>
                        
                        ${showPart2 ? `
                        <!-- Parte 2 -->
                        <div style="margin-bottom: 15px;">
                            <p style="${completed2Class}"><strong>Parte 2/3 ‚Äî O Chakra Vermelho Responde ao √ìdio</strong></p>
                            ${mission.purchased && !mission.part2.completed ? `
                                <div style="background: rgba(0,0,0,0.3); border-radius: 5px; height: 20px; margin: 5px 0; position: relative;">
                                    <div style="background: linear-gradient(90deg, #ff4444, #cc0000); width: ${Math.floor(((mission.part2.progress || 0) / (mission.part2.target || 8)) * 100)}%; height: 100%; border-radius: 5px;"></div>
                                    <span style="position: absolute; top: 2px; left: 50%; transform: translateX(-50%); font-weight: bold; text-shadow: 1px 1px 2px #000; font-size: 0.9em;">
                                        ${mission.part2.progress || 0}/${mission.part2.target || 8}
                                    </span>
                                </div>
                            ` : ''}
                            <p style="${completed2Class}; font-size: 0.9em;">
                            ${mission.purchased && showPart2 ? `<strong>${mission.part2.progress || 0}/${mission.part2.target || 8}</strong><br>` : ''}
                            Dropar: <strong>üî¥ Res√≠duo de Chakra da Ky≈´bi</strong><br>
                            <strong style="color: #ffd700;">15% de chance</strong> ao derrotar bosses<br>
                            <strong>Apenas nas zonas 100-200</strong><br>
                            Meta: <strong>8 Res√≠duos</strong></p>
                        </div>
                        ` : ''}
                        
                        ${showPart3 ? `
                        <!-- Parte 3 -->
                        <div style="margin-bottom: 15px;">
                            <p style="${completed3Class}"><strong>Parte 3/3 ‚Äî Controle Inst√°vel</strong></p>
                            <p style="${completed3Class}; font-size: 0.9em;">
                            Entregar: <strong>üí∞ 15.000.000 Gold</strong><br>
                            ${!mission.part3.completed && mission.purchased ? `
                                <button onclick="offerGoldForKyuubi()" 
                                        style="background: linear-gradient(135deg, #ff4444, #cc0000); 
                                               color: white; border: 2px solid #990000; 
                                               padding: 8px 16px; border-radius: 5px; 
                                               cursor: pointer; font-weight: bold; margin-top: 5px;"
                                        ${gameState.gold < 15000000 ? 'disabled' : ''}>
                                    ${gameState.gold >= 15000000 ? '‚úÖ Entregar Gold' : '‚ùå Gold Insuficiente'}
                                </button>
                            ` : ''}</p>
                        </div>
                        ` : ''}
                    </div>
                    
                    ${!mission.purchased ? `
                    <div class="mission-cost">
                        <span class="cost-label">Custo da Miss√£o:</span>
                        <span class="cost-value">üíé ${mission.cost} Diamantes</span>
                    </div>
                    
                    <div class="player-diamonds">
                        Seus Diamantes: <span class="${gameState.diamonds >= mission.cost ? 'enough' : 'not-enough'}">
                            üíé ${gameState.diamonds}
                        </span>
                    </div>
                    ` : ''}
                </div>
            `;

            // Configurar bot√£o de compra
            if (!mission.purchased) {
                purchaseBtn.onclick = () => purchaseMission(missionId);
                purchaseBtn.disabled = gameState.diamonds < mission.cost;
                purchaseBtn.style.display = 'block';
            } else {
                purchaseBtn.style.display = 'none';
            }
        }
    }

    modal.classList.add('active');
}

function purchaseMission(missionId) {
    if (missionId === 'naruto_skill1') {
        const mission = gameState.missions.naruto_skill1;

        if (gameState.diamonds >= mission.cost) {
            gameState.diamonds -= mission.cost;
            mission.purchased = true;

            console.log('‚úÖ Miss√£o comprada! Comece a derrotar inimigos nas fases 1-10 usando apenas clique!');

            updateUI();
            saveGame();
            renderHeroesList();
            closeMissionModal();


        }
    } else if (missionId === 'naruto_skill2') {
        const mission = gameState.missions.naruto_skill2;

        if (gameState.diamonds >= mission.cost) {
            gameState.diamonds -= mission.cost;
            mission.purchased = true;

            console.log('‚úÖ Miss√£o Skill 2 comprada! Comece a coletar Pergaminhos Rasgados de Clone nas fases 20-40!');

            updateUI();
            saveGame();
            renderHeroesList();
            closeMissionModal();


        }
    } else if (missionId === 'naruto_skill3') {
        // Verifica√ß√£o de seguran√ßa: se a miss√£o n√£o existe no save, criar
        if (!gameState.missions.naruto_skill3) {
            gameState.missions.naruto_skill3 = {
                id: "naruto_skill3",
                purchased: false,
                completed: false,
                progress: 0,
                target: 80,
                cost: 40
            };
        }

        const mission = gameState.missions.naruto_skill3;

        if (gameState.diamonds >= mission.cost) {
            gameState.diamonds -= mission.cost;
            mission.purchased = true;

            console.log('‚úÖ Miss√£o Rasengan comprada! Comece a coletar N√∫cleos de Chakra Espiral nas fases 80-120!');

            updateUI();
            saveGame();
            renderHeroesList();
            closeMissionModal();


        }
    } else if (missionId === 'naruto_skill4') {
        // Verifica√ß√£o de seguran√ßa
        if (!gameState.missions.naruto_skill4) {
            gameState.missions.naruto_skill4 = {
                id: "naruto_skill4",
                purchased: false,
                completed: false,
                cost: 120,
                part1: { completed: false, progress: 0, target: 100 },
                part2: { completed: false, progress: 0, target: 8 },
                part3: { completed: false, goldOffered: false }
            };
        }

        const mission = gameState.missions.naruto_skill4;

        if (gameState.diamonds >= mission.cost) {
            gameState.diamonds -= mission.cost;
            mission.purchased = true;

            console.log('‚úÖ Miss√£o Lend√°ria Chakra da Ky≈´bi comprada! Comece a coletar Fragmentos de Selo Enfraquecido nas fases 100-130!');

            updateUI();
            saveGame();
            renderHeroesList();
            closeMissionModal();


        }
    }
}

// Fun√ß√£o para entregar gold na Parte 3 da Skill 4
function offerGoldForKyuubi() {
    const mission = gameState.missions.naruto_skill4;

    if (!mission || !mission.purchased) {
        console.log('‚ùå Erro: Miss√£o n√£o est√° ativa!');
        return;
    }

    if (!mission.part1.completed || !mission.part2.completed) {
        console.log('‚ùå Voc√™ precisa completar as Partes 1 e 2 primeiro!');
        return;
    }

    if (gameState.gold < 15000000) {
        console.log('‚ùå Gold insuficiente! Voc√™ precisa de 15.000.000 Gold.');
        return;
    }

    if (mission.part3.completed) {
        console.log('‚úÖ Voc√™ j√° completou esta parte!');
        return;
    }

    // Entregar gold automaticamente
    gameState.gold -= 15000000;
    mission.part3.completed = true;
    mission.part3.goldOffered = true;

    // Verificar se todas as partes est√£o completas
    if (mission.part1.completed && mission.part2.completed && mission.part3.completed) {
        mission.completed = true;

        // Desbloquear a habilidade automaticamente
        const upgradeId = 'h1_u4';
        if (!gameState.upgrades.includes(upgradeId)) {
            gameState.upgrades.push(upgradeId);
            console.log(`‚úÖ Habilidade ${upgradeId} desbloqueada automaticamente!`);
        }

        // Mostrar modal de conclus√£o
        showMissionCompleteModal(
            'Chakra da Ky≈´bi (1 Cauda)',
            'üî¥',
            'Voc√™ completou a miss√£o lend√°ria e desbloqueou o Chakra da Ky≈´bi! A habilidade definitiva j√° est√° dispon√≠vel para uso.'
        );
    }

    updateUI();
    saveGame();
    renderHeroesList();
    openMissionModal('naruto_skill4'); // Reabrir modal para atualizar
}

function closeMissionModal() {
    const modal = document.getElementById('mission-modal');
    modal.classList.remove('active');
}

function setupMissionEventListeners() {
    const closeBtn = document.getElementById('close-mission');
    const modal = document.getElementById('mission-modal');

    if (closeBtn) {
        closeBtn.addEventListener('click', closeMissionModal);
    }

    if (modal) {
        modal.addEventListener('click', (e) => {
            if (e.target === modal) {
                closeMissionModal();
            }
        });
    }
}

// ===== MODAL DE CONCLUS√ÉO DE MISS√ÉO =====
function showMissionCompleteModal(skillName, skillIcon, description) {
    const modal = document.getElementById('mission-complete-modal');
    const skillNameEl = document.getElementById('mission-complete-skill-name');
    const skillIconEl = document.getElementById('mission-complete-skill-icon');
    const descriptionEl = document.getElementById('mission-complete-description');

    if (skillNameEl) skillNameEl.textContent = skillName;
    if (skillIconEl) skillIconEl.textContent = skillIcon;
    if (descriptionEl) descriptionEl.textContent = description;

    if (modal) {
        modal.style.display = 'flex';
    }
}

function closeMissionCompleteModal() {
    const modal = document.getElementById('mission-complete-modal');
    if (modal) {
        modal.style.display = 'none';
    }
}

function setupMissionCompleteEventListeners() {
    const closeBtn = document.getElementById('close-mission-complete');
    const modal = document.getElementById('mission-complete-modal');

    if (closeBtn) {
        closeBtn.addEventListener('click', closeMissionCompleteModal);
    }

    if (modal) {
        modal.addEventListener('click', (e) => {
            if (e.target === modal) {
                closeMissionCompleteModal();
            }
        });
    }
}

// ========================================
// ADMIN PANEL - Event Listeners
// ========================================

function setupAdminEventListeners() {
    // Abrir/Fechar modal
    const adminTrigger = document.getElementById('admin-trigger');
    const adminModal = document.getElementById('admin-modal');
    const closeAdmin = document.getElementById('close-admin');

    if (adminTrigger) {
        adminTrigger.addEventListener('click', () => {
            adminModal.style.display = 'flex';
        });
    }

    if (closeAdmin) {
        closeAdmin.addEventListener('click', () => {
            adminModal.style.display = 'none';
        });
    }

    if (adminModal) {
        adminModal.addEventListener('click', (e) => {
            if (e.target === adminModal) {
                adminModal.style.display = 'none';
            }
        });
    }

    // Adicionar Gold
    const addGoldBtn = document.getElementById('add-gold-btn');
    const goldInput = document.getElementById('gold-input');
    if (addGoldBtn && goldInput) {
        addGoldBtn.addEventListener('click', () => {
            const amount = parseInt(goldInput.value) || 0;
            if (amount > 0) {
                addGold(amount);
                goldInput.value = '';
            }
        });
    }

    // Adicionar Diamantes
    const addDiamondsBtn = document.getElementById('add-diamonds-btn');
    const diamondsInput = document.getElementById('diamonds-input');
    if (addDiamondsBtn && diamondsInput) {
        addDiamondsBtn.addEventListener('click', () => {
            const amount = parseInt(diamondsInput.value) || 0;
            if (amount > 0) {
                addDiamonds(amount);
                diamondsInput.value = '';
            }
        });
    }

    // Definir DPS
    const setDpsBtn = document.getElementById('set-dps-btn');
    const dpsInput = document.getElementById('dps-input');
    if (setDpsBtn && dpsInput) {
        setDpsBtn.addEventListener('click', () => {
            const amount = parseInt(dpsInput.value) || 0;
            if (amount >= 0) {
                setDPS(amount);
                dpsInput.value = '';
            }
        });
    }

    // Definir Dano de Clique
    const setClickDamageBtn = document.getElementById('set-click-damage-btn');
    const clickDamageInput = document.getElementById('click-damage-input');
    if (setClickDamageBtn && clickDamageInput) {
        setClickDamageBtn.addEventListener('click', () => {
            const amount = parseInt(clickDamageInput.value) || 0;
            if (amount >= 0) {
                setClickDamage(amount);
                clickDamageInput.value = '';
            }
        });
    }

    // Desbloquear Skills Individuais
    const unlockSkill1 = document.getElementById('unlock-skill-1');
    const unlockSkill2 = document.getElementById('unlock-skill-2');
    const unlockSkill3 = document.getElementById('unlock-skill-3');
    const unlockSkill4 = document.getElementById('unlock-skill-4');

    if (unlockSkill1) unlockSkill1.addEventListener('click', () => unlockSkill('h1_u1'));
    if (unlockSkill2) unlockSkill2.addEventListener('click', () => unlockSkill('h1_u2'));
    if (unlockSkill3) unlockSkill3.addEventListener('click', () => unlockSkill('h1_u3'));
    if (unlockSkill4) unlockSkill4.addEventListener('click', () => unlockSkill('h1_u4'));

    // Desbloquear Todas do Naruto
    const unlockAllNaruto = document.getElementById('unlock-all-naruto');
    if (unlockAllNaruto) {
        unlockAllNaruto.addEventListener('click', () => unlockAllSkills('h1'));
    }

    // Bloquear Skills Individuais
    const lockSkill1 = document.getElementById('lock-skill-1');
    const lockSkill2 = document.getElementById('lock-skill-2');
    const lockSkill3 = document.getElementById('lock-skill-3');
    const lockSkill4 = document.getElementById('lock-skill-4');

    if (lockSkill1) lockSkill1.addEventListener('click', () => lockSkill('h1_u1', 'naruto_skill1'));
    if (lockSkill2) lockSkill2.addEventListener('click', () => lockSkill('h1_u2', 'naruto_skill2'));
    if (lockSkill3) lockSkill3.addEventListener('click', () => lockSkill('h1_u3', 'naruto_skill3'));
    if (lockSkill4) lockSkill4.addEventListener('click', () => lockSkill('h1_u4', 'naruto_skill4'));

    // Bloquear Todas do Naruto
    const lockAllNaruto = document.getElementById('lock-all-naruto');
    if (lockAllNaruto) {
        lockAllNaruto.addEventListener('click', () => lockAllSkills('h1'));
    }

    // Ir para Zona
    const goToZoneBtn = document.getElementById('go-to-zone-btn');
    const zoneInput = document.getElementById('zone-input');
    if (goToZoneBtn && zoneInput) {
        goToZoneBtn.addEventListener('click', () => {
            const zone = parseInt(zoneInput.value) || 0;
            if (zone >= 1) {
                goToZone(zone);
                zoneInput.value = '';
            }
        });
    }
}

// ========================================
// MODO ADMIN - Fun√ß√µes de Desenvolvimento
// ========================================

// Adicionar Gold
window.addGold = function (amount) {
    gameState.gold += amount;
    updateUI();
    saveGame();
    console.log(`üí∞ ${formatNumber(amount)} gold adicionado! Total: ${formatNumber(gameState.gold)}`);
};

// Adicionar Diamantes
window.addDiamonds = function (amount) {
    gameState.diamonds += amount;
    updateUI();
    saveGame();
    console.log(`üíé ${amount} diamantes adicionados! Total: ${gameState.diamonds}`);
};

// Definir DPS customizado
window.setDPS = function (amount) {
    gameState.totalDps = amount;
    updateUI();
    saveGame();
    console.log(`‚ö° DPS definido para: ${formatNumber(amount)}`);
};

// Definir Dano de Clique customizado
window.setClickDamage = function (amount) {
    gameState.clickDamage = amount;
    updateUI();
    saveGame();
    console.log(`üëÜ Dano de clique definido para: ${formatNumber(amount)}`);
};

// Desbloquear habilidade espec√≠fica
window.unlockSkill = function (skillId) {
    if (!gameState.upgrades.includes(skillId)) {
        gameState.upgrades.push(skillId);
        renderHeroesList();
        updateUI();
        saveGame();
        console.log(`‚úÖ Habilidade ${skillId} desbloqueada!`);
    } else {
        console.log(`‚ö†Ô∏è Habilidade ${skillId} j√° est√° desbloqueada!`);
    }
};

// Desbloquear todas as habilidades de um her√≥i
window.unlockAllSkills = function (heroId) {
    const upgrades = heroUpgrades[heroId];
    if (upgrades) {
        upgrades.forEach(upg => {
            if (!gameState.upgrades.includes(upg.id)) {
                gameState.upgrades.push(upg.id);
            }
        });
        renderHeroesList();
        updateUI();
        saveGame();
        console.log(`‚úÖ Todas as habilidades do her√≥i ${heroId} desbloqueadas!`);
    } else {
        console.log(`‚ö†Ô∏è Her√≥i ${heroId} n√£o encontrado!`);
    }
};

// Bloquear habilidade espec√≠fica e resetar miss√£o
window.lockSkill = function (skillId, missionId) {
    // Remover habilidade dos upgrades
    const index = gameState.upgrades.indexOf(skillId);
    if (index > -1) {
        gameState.upgrades.splice(index, 1);
    }

    // Resetar miss√£o correspondente
    if (missionId && gameState.missions[missionId]) {
        gameState.missions[missionId].purchased = false;
        gameState.missions[missionId].completed = false;
        gameState.missions[missionId].progress = 0;
    }

    renderHeroesList();
    renderActiveMissions();
    updateUI();
    saveGame();
    console.log(`üîí Habilidade ${skillId} bloqueada e miss√£o ${missionId} resetada!`);
};

// Bloquear todas as habilidades de um her√≥i
window.lockAllSkills = function (heroId) {
    const upgrades = heroUpgrades[heroId];
    if (upgrades) {
        upgrades.forEach(upg => {
            const index = gameState.upgrades.indexOf(upg.id);
            if (index > -1) {
                gameState.upgrades.splice(index, 1);
            }
        });

        // Resetar todas as miss√µes do Naruto
        if (heroId === 'h1') {
            const missions = ['naruto_skill1', 'naruto_skill2', 'naruto_skill3', 'naruto_skill4'];
            missions.forEach(missionId => {
                if (gameState.missions[missionId]) {
                    gameState.missions[missionId].purchased = false;
                    gameState.missions[missionId].completed = false;
                    gameState.missions[missionId].progress = 0;
                }
            });
        }

        renderHeroesList();
        renderActiveMissions();
        updateUI();
        saveGame();
        console.log(`üîí Todas as habilidades do her√≥i ${heroId} bloqueadas e miss√µes resetadas!`);
    } else {
        console.log(`‚ö†Ô∏è Her√≥i ${heroId} n√£o encontrado!`);
    }
};

// Ir para uma zona espec√≠fica
window.goToZone = function (zoneNumber) {
    if (zoneNumber >= 1) {
        gameState.currentZone = zoneNumber;
        if (zoneNumber > gameState.statistics.maxZone) {
            gameState.statistics.maxZone = zoneNumber;
        }
        gameState.monstersKilledInZone = gameState.zoneProgress[zoneNumber] || 0;
        spawnMonster();
        renderArenas();
        updateUI();
        saveGame();
        console.log(`üó∫Ô∏è Voc√™ foi para a zona ${zoneNumber}!`);
    } else {
        console.log(`‚ö†Ô∏è N√∫mero de zona inv√°lido!`);
    }
};

// Completar miss√£o espec√≠fica
window.completeMission = function (missionId) {
    const mission = gameState.missions[missionId];
    if (mission) {
        mission.purchased = true;
        mission.completed = true;
        mission.progress = mission.target;

        // Desbloquear habilidade correspondente
        const skillMap = {
            'naruto_skill1': 'h1_u1',
            'naruto_skill2': 'h1_u2',
            'naruto_skill3': 'h1_u3',
            'naruto_skill4': 'h1_u4'
        };

        const skillId = skillMap[missionId];
        if (skillId && !gameState.upgrades.includes(skillId)) {
            gameState.upgrades.push(skillId);
        }

        renderHeroesList();
        renderActiveMissions();
        updateUI();
        saveGame();
        console.log(`‚úÖ Miss√£o ${missionId} completada e habilidade desbloqueada!`);
    } else {
        console.log(`‚ö†Ô∏è Miss√£o ${missionId} n√£o encontrada!`);
    }
};

// Mostrar comandos dispon√≠veis
window.adminHelp = function () {
    console.log(`
üéÆ ========== COMANDOS ADMIN ========== üéÆ

üí∞ addGold(amount)           - Adicionar gold
üíé addDiamonds(amount)        - Adicionar diamantes
‚ö° setDPS(amount)             - Definir DPS total
üëÜ setClickDamage(amount)     - Definir dano de clique
‚úÖ unlockSkill(skillId)       - Desbloquear habilidade espec√≠fica
   Exemplos: 'h1_u1', 'h1_u2', 'h1_u3', 'h1_u4'
üåü unlockAllSkills(heroId)    - Desbloquear todas as habilidades de um her√≥i
   Exemplos: 'h1' (Naruto), 'h2' (Sasuke), etc.
üó∫Ô∏è  goToZone(number)          - Ir para zona espec√≠fica
üéØ completeMission(missionId) - Completar miss√£o
   Exemplos: 'naruto_skill1', 'naruto_skill2', etc.

üìñ adminHelp()                - Mostrar esta ajuda

========================================
    `);
};

console.log('üîß Modo Admin ativado! Digite adminHelp() para ver os comandos dispon√≠veis.');

// Comando de teste para Skill 4
window.testSkill4Drop = function () {
    const mission4 = gameState.missions.naruto_skill4;
    console.log('üîç ========== TESTE SKILL 4 ==========');
    console.log('Miss√£o comprada?', mission4.purchased);
    console.log('Miss√£o completa?', mission4.completed);
    console.log('Parte 1:', mission4.part1);
    console.log('Parte 2:', mission4.part2);
    console.log('Zona atual:', gameState.currentZone);
    console.log('Zona 100-200?', gameState.currentZone >= 100 && gameState.currentZone <= 200);
    console.log('');

    if (!mission4.purchased) {
        console.log('‚ùå Miss√£o n√£o comprada!');
        return;
    }

    if (!mission4.part1.completed) {
        console.log('‚ùå Parte 1 n√£o est√° completa!');
        console.log('üí° Complete a Parte 1 primeiro');
        return;
    }

    if (mission4.part2.completed) {
        console.log('‚úÖ Parte 2 j√° est√° completa!');
        return;
    }

    // For√ßar um drop
    mission4.part2.progress++;
    console.log('‚úÖ Drop for√ßado! Novo progresso:', mission4.part2.progress + '/' + mission4.part2.target);
    saveGame();
    renderActiveMissions();

    const droppedItem = {
        icon: 'üî¥',
        name: 'Res√≠duo de Chakra da Ky≈´bi',
        description: 'Chakra vermelho e denso da Raposa de Nove Caudas',
        count: 1,
        isImage: false
    };
    showItemDropNotification(droppedItem);
    console.log('========================================');
};



----- FILE: static/js/hero_details_modal.js  (sha1:8c42326f892d, bytes:9434) -----

// ===== MODAL DE DETALHES DO HER√ìI =====
function openHeroDetailsModal(heroId) {
    const hero = gameState.heroes.find(h => h.id === heroId);
    if (!hero) return;

    const modal = document.getElementById('hero-details-modal');
    const content = document.getElementById('hero-details-content');
    const title = document.getElementById('hero-details-title');

    // Definir t√≠tulo
    title.textContent = hero.name;

    // Calcular dano base com buffs
    let baseDamage = hero.currentDps;
    let damageWithBuffs = baseDamage;
    const heroUps = heroUpgrades[hero.id];

    // Coletar buffs por categoria
    let personalBuffs = []; // SELF_DPS_MULT
    let globalBuffsMap = {}; // Para concatenar buffs duplicados
    let otherBuffs = [];    // CRIT_CHANCE, etc

    // Vari√°veis para acumular buffs similares
    let clickMultiplier = 1;
    let dpsMultiplier = 1;
    let bossWindDamageBonus = 0; // Acumular % de dano de vento contra bosses

    if (heroUps) {
        heroUps.forEach(upg => {
            if (gameState.upgrades.includes(upg.id)) {
                if (upg.type === 'SELF_DPS_MULT') {
                    damageWithBuffs *= upg.value;
                    dpsMultiplier *= upg.value;
                } else if (upg.type === 'GLOBAL_DPS_MULT') {
                    const percentBonus = ((upg.value - 1) * 100);
                    const key = "DPS de todos os her√≥is";
                    globalBuffsMap[key] = (globalBuffsMap[key] || 0) + percentBonus;
                } else if (upg.type === 'CRIT_CHANCE') {
                    const percentBonus = (upg.value * 100).toFixed(1);
                    otherBuffs.push(`Chance de cr√≠tico +${percentBonus}%`);
                }
            }
        });
    }

    // Processar buffs das skills do Naruto
    if (hero.id === 1) {
        // Skill 1: Kage Bunshin no Jutsu (x2 Click)
        if (gameState.missions.naruto_skill1?.completed) {
            clickMultiplier *= 2;
        }

        // Skill 2: Tajuu Kage Bunshin (x2 Click)
        if (gameState.missions.naruto_skill2?.completed) {
            clickMultiplier *= 2;
        }

        // Skill 3: Rasengan (+35% dano de Vento contra bosses)
        if (gameState.missions.naruto_skill3?.completed) {
            bossWindDamageBonus += 35;
        }

        // Skill 4: Chakra da Kyuubi (x2.5 Click APENAS, +40% dano de Vento contra bosses)
        // N√ÉO d√° DPS pr√≥prio, apenas Click Damage
        if (gameState.missions.naruto_skill4?.completed) {
            clickMultiplier *= 2.5;
            bossWindDamageBonus += 40;

            // Buff de dano cr√≠tico din√¢mico: +5% a cada 20 n√≠veis
            const critDamageFromLevel = Math.floor(hero.level / 20) * 5;
            if (critDamageFromLevel > 0) {
                personalBuffs.push(`Dano cr√≠tico +${critDamageFromLevel}%`);
            }
        }

        // Aplicar multiplicador de DPS ao damageWithBuffs
        damageWithBuffs *= dpsMultiplier;

        // Adicionar multiplicadores aos buffs pessoais
        if (clickMultiplier > 1) {
            personalBuffs.push(`Dano de Clique: x${clickMultiplier.toFixed(0)}`);
        }

        // Adicionar buff global da Skill 4
        if (gameState.missions.naruto_skill4?.completed) {
            const key = "DPS de todos os her√≥is";
            globalBuffsMap[key] = (globalBuffsMap[key] || 0) + 15;
        }
    }

    // Converter globalBuffsMap para array
    let globalBuffs = Object.entries(globalBuffsMap).map(([key, value]) =>
        `${key} +${value.toFixed(0)}%`
    );

    // Calcular dano elemental
    let elementalDamage = 0;
    let elementalCount = 0;
    let elementalColor = '#00ff00'; // Verde para vento
    let elementalName = 'Vento';
    let elementalIcon = 'üí®';

    if (hero.id === 1) { // Naruto
        if (gameState.missions.naruto_skill1?.completed) elementalCount++;
        if (gameState.missions.naruto_skill2?.completed) elementalCount++;
        if (gameState.missions.naruto_skill3?.completed) elementalCount++;
        if (gameState.missions.naruto_skill4?.completed) elementalCount++;

        if (elementalCount > 0) {
            elementalDamage = damageWithBuffs * (0.15 * elementalCount);
        }
    }

    // Condi√ß√µes especiais - apenas efeitos, sem origem
    let specialConditions = [];

    // Skill 3 do Naruto: Rasengan - Efeito contra inimigos de Raio
    if (hero.id === 1 && gameState.missions.naruto_skill3?.completed) {
        specialConditions.push('Naruto ganha +10% de dano adicional contra inimigos de Raio');
    }

    // Concatenar buff de dano de Vento contra bosses (Skill 3 + Skill 4)
    if (hero.id === 1 && bossWindDamageBonus > 0) {
        specialConditions.push(`Bosses recebem +${bossWindDamageBonus}% de dano de Vento`);
    }

    // Skill 4 do Naruto: Chakra da Kyuubi - Surto
    if (hero.id === 1 && gameState.missions.naruto_skill4?.completed) {
        specialConditions.push('+50% de dano contra bosses com menos de 30% de HP');
    }

    // Montar HTML
    let html = `
        <div class="hero-details-header">
            <img src="${hero.img}" class="hero-details-portrait" alt="${hero.name}">
            <div class="hero-details-name">
                <h3>${hero.name}</h3>
                <p>N√≠vel ${hero.level}</p>
            </div>
        </div>

        <!-- Se√ß√£o de Dano -->
        <div class="hero-details-section">
            <h4>‚öîÔ∏è Atributos de Dano</h4>
            <div class="hero-details-stat">
                <span class="hero-details-stat-label">Dano Base:</span>
                <span class="hero-details-stat-value">${formatNumber(baseDamage)}</span>
            </div>
            <div class="hero-details-stat">
                <span class="hero-details-stat-label">Dano com Buffs:</span>
                <span class="hero-details-stat-value">${formatNumber(damageWithBuffs)}</span>
            </div>
            ${elementalDamage > 0 ? `
            <div class="hero-details-stat">
                <span class="hero-details-stat-label">${elementalIcon} Dano Elemental (${elementalName}):</span>
                <span class="hero-details-stat-value elemental-wind">+${formatNumber(elementalDamage)} (+${elementalCount * 15}%)</span>
            </div>
            ` : ''}
            <div class="hero-details-stat">
                <span class="hero-details-stat-label">üí• Dano Total:</span>
                <span class="hero-details-stat-value" style="color: #ffd700; font-size: 1.2em;">${formatNumber(damageWithBuffs + elementalDamage)}</span>
            </div>
        </div>

        <!-- Se√ß√£o de Buffs Pessoais -->
        ${personalBuffs.length > 0 ? `
        <div class="hero-details-section">
            <h4>‚ú® Buffs Pessoais</h4>
            <p style="color: #aaa; font-size: 0.85em; margin: 0 0 10px 0;">Afetam apenas ${hero.name}</p>
            ${personalBuffs.map(buff => `
                <div class="hero-details-buff-item personal">
                    ‚Ä¢ ${buff}
                </div>
            `).join('')}
        </div>
        ` : ''}

        <!-- Se√ß√£o de Buffs Globais -->
        ${globalBuffs.length > 0 ? `
        <div class="hero-details-section">
            <h4>üåü Buffs Globais</h4>
            <p style="color: #aaa; font-size: 0.85em; margin: 0 0 10px 0;">Afetam todos os her√≥is</p>
            ${globalBuffs.map(buff => `
                <div class="hero-details-buff-item global">
                    ‚Ä¢ ${buff}
                </div>
            `).join('')}
        </div>
        ` : ''}

        <!-- Se√ß√£o de Outros Buffs -->
        ${otherBuffs.length > 0 ? `
        <div class="hero-details-section">
            <h4>‚ö° Outros Buffs</h4>
            ${otherBuffs.map(buff => `
                <div class="hero-details-buff-item other">
                    ‚Ä¢ ${buff}
                </div>
            `).join('')}
        </div>
        ` : ''}

        <!-- Se√ß√£o de Condi√ß√µes Especiais -->
        ${specialConditions.length > 0 ? `
        <div class="hero-details-section">
            <h4>üéØ Condi√ß√µes Especiais</h4>
            <p style="color: #aaa; font-size: 0.85em; margin: 0 0 10px 0;">Efeitos situacionais e b√¥nus elementais</p>
            ${specialConditions.map(condition => `
                <div class="hero-details-condition-item">
                    ‚Ä¢ ${condition}
                </div>
            `).join('')}
        </div>
        ` : ''}
    `;

    content.innerHTML = html;
    modal.style.display = 'flex';
}

// Event listeners para o modal de detalhes do her√≥i
function setupHeroDetailsEventListeners() {
    const modal = document.getElementById('hero-details-modal');
    const closeBtn = document.getElementById('close-hero-details');

    if (closeBtn) {
        closeBtn.onclick = () => {
            modal.style.display = 'none';
        };
    }

    // Fechar ao clicar fora do modal
    window.addEventListener('click', (e) => {
        if (e.target === modal) {
            modal.style.display = 'none';
        }
    });
}

// Adicionar aos event listeners principais
document.addEventListener('DOMContentLoaded', () => {
    setupHeroDetailsEventListeners();
});


----- FILE: static/js/missions_panel.js  (sha1:a09f9557c11b, bytes:6678) -----

// ========================================
// SISTEMA DE ABAS DO PAINEL DIREITO
// ========================================

function switchRightPanelTab(tabName) {
    // Remover classe active de todas as abas e conte√∫dos
    document.querySelectorAll('.tab-icon').forEach(tab => tab.classList.remove('active'));
    document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));

    // Adicionar classe active na aba e conte√∫do selecionados
    document.getElementById(`tab-${tabName}`).classList.add('active');
    document.getElementById(`${tabName}-tab-content`).classList.add('active');

    // Se for a aba de miss√µes, renderizar a lista
    if (tabName === 'missions') {
        renderActiveMissions();
    }
}

// ========================================
// RENDERIZAR MISS√ïES ATIVAS
// ========================================

function renderActiveMissions() {
    const container = document.getElementById('active-missions-list');
    if (!container) return;

    const missions = gameState.missions;

    // CORRE√á√ÉO AUTOM√ÅTICA: Atualizar target da skill 4 parte 1 de 12 para 100
    if (missions.naruto_skill4 && missions.naruto_skill4.part1) {
        if (missions.naruto_skill4.part1.target === 12) {
            console.log('üîß Corrigindo target da skill 4 parte 1: 12 ‚Üí 100');
            missions.naruto_skill4.part1.target = 100;
            saveGame(); // Salvar a corre√ß√£o
        }
    }

    const activeMissions = [];

    // Mapear miss√µes para seus respectivos her√≥is e nomes
    const missionData = {
        naruto_skill1: { hero: 'Naruto', name: 'Kage Bunshin no Jutsu', icon: 'üåÄ' },
        naruto_skill2: { hero: 'Naruto', name: 'Tajuu Kage Bunshin', icon: 'üåÄüåÄ' },
        naruto_skill3: { hero: 'Naruto', name: 'Rasengan', icon: 'üåÄ' },
        naruto_skill4: { hero: 'Naruto', name: 'Chakra da Ky≈´bi ( 1 Cauda )', icon: 'üî¥' }
    };

    // Coletar miss√µes ativas
    for (const [missionId, mission] of Object.entries(missions)) {
        if (mission.purchased && !mission.completed) {
            const data = missionData[missionId];
            if (data) {
                activeMissions.push({
                    id: missionId,
                    hero: data.hero,
                    name: data.name,
                    icon: data.icon,
                    mission: mission
                });
            }
        }
    }

    // Se n√£o houver miss√µes ativas
    if (activeMissions.length === 0) {
        container.innerHTML = `
            <div class="no-missions-message">
                Nenhuma miss√£o ativa no momento.<br>
                <small>Compre habilidades especiais para desbloquear miss√µes!</small>
            </div>
        `;
        return;
    }

    // Renderizar miss√µes ativas
    let html = '';
    for (const item of activeMissions) {
        const mission = item.mission;

        // Para miss√µes com m√∫ltiplas partes (skill 4)
        if (mission.part1) {
            let totalParts = 3;
            let completedParts = 0;
            let currentPart = 1;
            let currentProgress = 0;
            let currentTarget = 0;

            if (mission.part1.completed) {
                completedParts++;
                currentPart = 2;
            } else {
                currentProgress = mission.part1.progress || 0;
                currentTarget = mission.part1.target || 0;
            }

            if (mission.part2 && mission.part2.completed) {
                completedParts++;
                currentPart = 3;
            } else if (mission.part1.completed && !mission.part2?.completed) {
                currentProgress = mission.part2?.progress || 0;
                currentTarget = mission.part2?.target || 0;
            }

            if (mission.part3 && mission.part3.completed) {
                completedParts++;
            } else if (mission.part1.completed && mission.part2?.completed && !mission.part3?.completed) {
                currentPart = 3;
                currentProgress = 0;
                currentTarget = 1; // Parte 3 √© entrega de gold
            }

            // Calcular progresso da parte atual
            const partProgressPercent = currentTarget > 0 ? Math.floor((currentProgress / currentTarget) * 100) : 0;

            html += `
                <div class="mission-item">
                    <div class="mission-item-header">
                        <span class="mission-item-icon">${item.icon}</span>
                        <div>
                            <div class="mission-item-title">${item.name}</div>
                            <div class="mission-item-hero">${item.hero}</div>
                        </div>
                    </div>
                    <div class="mission-progress-bar">
                        <div class="mission-progress-fill" style="width: ${partProgressPercent}%"></div>
                        <div class="mission-progress-text">${currentProgress}/${currentTarget}</div>
                    </div>
                    <div class="mission-item-status">
                        ${!mission.part1.completed ? `Parte 1/3` :
                    !mission.part2.completed ? `Parte 2/3` :
                        !mission.part3.completed ? `Parte 3/3` : 'Completa!'}
                    </div>
                </div>
            `;
        } else {
            // Para miss√µes simples (skills 1, 2, 3)
            const progressPercent = Math.floor((mission.progress / mission.target) * 100);

            html += `
                <div class="mission-item">
                    <div class="mission-item-header">
                        <span class="mission-item-icon">${item.icon}</span>
                        <div>
                            <div class="mission-item-title">${item.name}</div>
                            <div class="mission-item-hero">${item.hero}</div>
                        </div>
                    </div>
                    <div class="mission-progress-bar">
                        <div class="mission-progress-fill" style="width: ${progressPercent}%"></div>
                        <div class="mission-progress-text">${mission.progress}/${mission.target}</div>
                    </div>
                    <div class="mission-item-status">
                        ${progressPercent < 100 ? 'Em andamento...' : 'Pronta para completar!'}
                    </div>
                </div>
            `;
        }
    }

    container.innerHTML = html;
}


----- FILE: templates/index.html  (sha1:bd8f14233330, bytes:14899) -----
<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Naruto Clicker Heroes</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}?v=10">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/tabs_missions.css') }}?v=1">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/mission_complete.css') }}?v=1">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/admin_panel.css') }}?v=1">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/hero_details.css') }}?v=1">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/mission_notification.css') }}?v=1">
    <link
        href="https://fonts.googleapis.com/css2?family=Bangers&family=Shojumaru&family=Roboto:wght@400;700&display=swap"
        rel="stylesheet">
</head>

<body>
    <div class="game-container">
        <!-- Coluna Esquerda: Her√≥is -->
        <div class="panel left-panel">
            <div class="currency-display-container">
                <div class="gold-display-left">
                    üí∞ <span id="player-gold">0</span>
                </div>
                <div class="diamonds-display-left">
                    üíé <span id="player-diamonds">0</span>
                </div>
            </div>
            <div class="header-panel">
                <h2>Equipe Ninja <span class="backpack-icon" id="open-backpack" title="Mochila">üéí</span></h2>
                <div class="stats-display-container">
                    <div class="dps-display">DPS: <span id="total-dps">0</span></div>
                    <div class="click-display">Click: <span id="click-damage-val">1</span></div>
                </div>
            </div>
            <div id="heroes-list" class="scroll-content">
                <!-- Her√≥is ser√£o inseridos aqui via JS -->
            </div>
        </div>

        <!-- Coluna Central: A√ß√£o -->
        <div class="panel center-panel">
            <img src="{{ url_for('static', filename='img/elemental_cycle.png') }}" class="elemental-cycle-guide"
                alt="Ciclo Elemental">


            <div class="arena-selector-container">
                <button id="prev-zone" class="nav-btn">‚óÄ</button>
                <div class="arenas-scroll">
                    <div id="arenas-display">
                        <!-- Arenas visuais -->
                    </div>
                </div>
                <button id="next-zone" class="nav-btn">‚ñ∂</button>
            </div>


            <div class="battle-arena">
                <div class="zone-progress-info">
                    <span id="monsters-killed">0</span>/10
                </div>
                <!-- Cron√¥metro de Boss -->
                <div id="boss-timer" class="boss-timer" style="display: none;">
                    ‚è±Ô∏è <span id="boss-timer-value">30</span>s
                </div>
                <div id="damage-numbers-container"></div>
                <div class="monster-container" id="click-target">
                    <div class="monster-hp-bar">
                        <div id="hp-fill" style="width: 100%;"></div>
                    </div>
                    <div class="monster-hp-text"><span id="current-hp">10</span> HP</div>
                    <div class="monster-visual">
                        <img id="monster-img" src="" alt="Monstro">
                    </div>
                    <div class="monster-info">
                        <div id="monster-name" class="monster-name">Inimigo</div>
                        <div id="monster-level" class="monster-level">N√≠vel 1</div>
                    </div>
                </div>

                <div class="player-controls">
                    <!-- Controls -->
                </div>
            </div>
        </div>

        <!-- Coluna Direita: Progresso e Status -->
        <div class="panel right-panel">
            <!-- Abas de Navega√ß√£o -->
            <div class="right-panel-tabs">
                <div class="tab-icon active" id="tab-stats" onclick="switchRightPanelTab('stats')" title="Estat√≠sticas">
                    üìä
                </div>
                <div class="tab-icon" id="tab-missions" onclick="switchRightPanelTab('missions')"
                    title="Miss√µes Ativas">
                    üéØ
                </div>
            </div>

            <!-- Conte√∫do da Aba de Estat√≠sticas -->
            <div id="stats-tab-content" class="tab-content active">
                <h3>Estat√≠sticas</h3>
                <ul id="stats-list">
                    <li>Monstros Derrotados: <span id="stat-killed">0</span></li>
                    <li>Cliques Realizados: <span id="stat-clicks">0</span></li>
                    <li>Maior Zona: <span id="stat-max-zone">1</span></li>
                </ul>
                <div class="reset-container">
                    <button id="reset-save-btn" class="reset-btn" onclick="resetGame()">RESETAR PROGRESSO</button>
                </div>
            </div>

            <!-- Conte√∫do da Aba de Miss√µes -->
            <div id="missions-tab-content" class="tab-content">
                <h3>Miss√µes Ativas</h3>
                <div id="active-missions-list" class="active-missions-list">
                    <!-- Miss√µes ativas ser√£o inseridas aqui via JS -->
                </div>
            </div>
        </div>
    </div>

    <!-- Modal da Mochila -->
    <div id="backpack-modal" class="backpack-modal">
        <div class="backpack-container">
            <div class="backpack-header">
                <div class="backpack-title">
                    Mochila
                </div>
                <button class="close-backpack" id="close-backpack">‚úñ</button>
            </div>
            <div class="backpack-body">
                <div id="inventory-grid" class="inventory-grid">
                    <!-- Slots ser√£o gerados via JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Miss√£o -->
    <div id="mission-modal" class="backpack-modal">
        <div class="mission-container">
            <div class="mission-header">
                <div class="mission-title">
                    <span>üéØ</span>
                    <span id="mission-title-text">Miss√£o</span>
                </div>
                <button class="close-mission" id="close-mission">‚úñ</button>
            </div>
            <div class="mission-body">
                <div id="mission-content">
                    <!-- Conte√∫do ser√° preenchido via JavaScript -->
                </div>
                <div class="mission-actions">
                    <button id="purchase-mission-btn" class="mission-btn purchase">Comprar Miss√£o</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Conclus√£o de Miss√£o -->
    <div id="mission-complete-modal" class="modal-overlay" style="display: none;">
        <div class="mission-complete-container">
            <div class="mission-complete-header">
                <div class="mission-complete-icon">üéâ</div>
                <h2 id="mission-complete-title">Miss√£o Completada!</h2>
            </div>
            <div class="mission-complete-body">
                <div id="mission-complete-skill-icon" class="skill-icon-large">üåÄ</div>
                <h3 id="mission-complete-skill-name">Habilidade Desbloqueada!</h3>
                <p id="mission-complete-description">Voc√™ completou a miss√£o e desbloqueou uma nova habilidade!</p>
            </div>
            <div class="mission-complete-footer">
                <button id="close-mission-complete" class="mission-complete-btn">Continuar</button>
            </div>
        </div>
    </div>

    <!-- Modal de Detalhes do Her√≥i -->
    <div id="hero-details-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content hero-details-modal">
            <div class="modal-header">
                <h2 id="hero-details-title">Detalhes do Her√≥i</h2>
                <button class="modal-close" id="close-hero-details">‚úñ</button>
            </div>
            <div class="modal-body">
                <div id="hero-details-content">
                    <!-- Conte√∫do ser√° preenchido via JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Admin (Cheat) -->
    <div id="admin-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content admin-modal">
            <div class="modal-header">
                <h2>‚öôÔ∏è Admin Panel</h2>
                <button class="modal-close" id="close-admin">‚úñ</button>
            </div>
            <div class="modal-body">
                <!-- Recursos -->
                <div class="admin-section">
                    <h3>üí∞ Recursos</h3>
                    <div class="admin-input-group">
                        <label for="gold-input">Adicionar Ouro:</label>
                        <input type="number" id="gold-input" placeholder="Digite a quantidade..." min="0" step="1000">
                        <button id="add-gold-btn" class="admin-btn">üí∞ Adicionar</button>
                    </div>
                    <div class="admin-input-group">
                        <label for="diamonds-input">Adicionar Diamantes:</label>
                        <input type="number" id="diamonds-input" placeholder="Digite a quantidade..." min="0" step="10">
                        <button id="add-diamonds-btn" class="admin-btn">üíé Adicionar</button>
                    </div>
                </div>

                <!-- Dano -->
                <div class="admin-section">
                    <h3>‚ö° Dano</h3>
                    <div class="admin-input-group">
                        <label for="dps-input">Definir DPS:</label>
                        <input type="number" id="dps-input" placeholder="Digite o DPS..." min="0" step="1000">
                        <button id="set-dps-btn" class="admin-btn">‚ö° Definir</button>
                    </div>
                    <div class="admin-input-group">
                        <label for="click-damage-input">Definir Dano de Clique:</label>
                        <input type="number" id="click-damage-input" placeholder="Digite o dano..." min="0" step="100">
                        <button id="set-click-damage-btn" class="admin-btn">üëÜ Definir</button>
                    </div>
                </div>

                <!-- Habilidades -->
                <div class="admin-section">
                    <h3>‚úÖ Habilidades do Naruto</h3>

                    <!-- Skill 1 -->
                    <div class="admin-skill-row">
                        <span class="skill-label">üåÄ Skill 1 (Kage Bunshin)</span>
                        <div class="skill-actions">
                            <button id="unlock-skill-1" class="admin-skill-btn unlock">‚úÖ Desbloquear</button>
                            <button id="lock-skill-1" class="admin-skill-btn lock">üîí Bloquear</button>
                        </div>
                    </div>

                    <!-- Skill 2 -->
                    <div class="admin-skill-row">
                        <span class="skill-label">üåÄ Skill 2 (Tajuu Kage Bunshin)</span>
                        <div class="skill-actions">
                            <button id="unlock-skill-2" class="admin-skill-btn unlock">‚úÖ Desbloquear</button>
                            <button id="lock-skill-2" class="admin-skill-btn lock">üîí Bloquear</button>
                        </div>
                    </div>

                    <!-- Skill 3 -->
                    <div class="admin-skill-row">
                        <span class="skill-label">‚ö° Skill 3 (Rasengan)</span>
                        <div class="skill-actions">
                            <button id="unlock-skill-3" class="admin-skill-btn unlock">‚úÖ Desbloquear</button>
                            <button id="lock-skill-3" class="admin-skill-btn lock">üîí Bloquear</button>
                        </div>
                    </div>

                    <!-- Skill 4 -->
                    <div class="admin-skill-row">
                        <span class="skill-label">ü¶ä Skill 4 (Chakra da Ky≈´bi)</span>
                        <div class="skill-actions">
                            <button id="unlock-skill-4" class="admin-skill-btn unlock">‚úÖ Desbloquear</button>
                            <button id="lock-skill-4" class="admin-skill-btn lock">üîí Bloquear</button>
                        </div>
                    </div>

                    <button id="unlock-all-naruto" class="admin-btn full-width">üåü Desbloquear Todas</button>
                    <button id="lock-all-naruto" class="admin-btn full-width lock-all">üîí Bloquear Todas</button>
                </div>

                <!-- Navega√ß√£o -->
                <div class="admin-section">
                    <h3>üó∫Ô∏è Navega√ß√£o</h3>
                    <div class="admin-input-group">
                        <label for="zone-input">Ir para Zona:</label>
                        <input type="number" id="zone-input" placeholder="N√∫mero da zona..." min="1" step="1">
                        <button id="go-to-zone-btn" class="admin-btn">üó∫Ô∏è Ir</button>
                    </div>
                    <div class="admin-quick-zones">
                        <button class="admin-quick-btn" onclick="goToZone(50)">Zona 50</button>
                        <button class="admin-quick-btn" onclick="goToZone(100)">Zona 100</button>
                        <button class="admin-quick-btn" onclick="goToZone(500)">Zona 500</button>
                        <button class="admin-quick-btn" onclick="goToZone(1000)">Zona 1000</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bot√£o Admin (Discreto) -->
    <div id="admin-trigger" title="Admin Panel">‚öôÔ∏è</div>

    <script src="{{ url_for('static', filename='js/anti_zoom.js') }}?v=1"></script>
    <script src="{{ url_for('static', filename='js/game_data_v3.js') }}?v=5"></script>
    <script src="{{ url_for('static', filename='js/missions_panel.js') }}?v=1"></script>
    <script src="{{ url_for('static', filename='js/hero_details_modal.js') }}?v=1"></script>
    <script src="{{ url_for('static', filename='js/game_v3.js') }}?v=25"></script>
</body>

</html>